!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!                            Chemical Insight Structure Sets                             !!
!!                                                                                        !!
!!                               Written by: Dr. Sourav Roy                               !!
!!                                                                                        !!
!!                    School Of Pharmacy, Hebrew University of Jerusalem                  !!
!!                                                                                        !!
!!                                    Jerusalem, Israel                                   !!
!!                                                                                        !!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
module commondat1
implicit none

integer::orbs(50,500),orbsl,freezorb(100),frzn,orbn(50),sl1(10),orbsym(20,20),norbsym(50),frag_at(20,20)&
,frag_atn(20),atm_nb_orbs1(20),atm_nb_orbs(20),ovlp_int,nbasatom(20),nbasis,ovlp_bas_num(20,10),lnum&
,num_act_orb_typ(20),ind_mat(1000,1000)
character(len=5)::symat(20),all_atbas(500)
real*8::symatno(20)
double precision::orb_ovlp_mat(20,20),orb_ovlp_mat1(20,20),ovlp_mat_norm(5000,100)

save
end module commondat1
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
module commondat
implicit none

integer::nao,nae,niao,mult,nlast,nlp,tncs,tnis,is,atom,nabsym,ndet,symm,repl,itb,syb,nnb,rad &
,flgst,noqult,rplc,flg_ion,flg_cov,imbd,nfset,noq0,noq1,noq2,noq3,noq,niabd,nialp,niach,serial &
,nrad,choice,pbond(1000),mbond(1000),nnnatom,nnat_bond(100,2),prio_rad(20,100),norad(20),prad &
,nlpset,lp(100),plpair(100,10),flg1,uoptstr,mnbond,nmbond,main_bond(100),iabd(50),ialp(50),iach(50)
integer::atoset(200,20),at_num(88),at_covrad(88),key_frag,frag_cntr(10)&
,at_ab_symset(20,20),tot_ndet,nrs,mset,loopsymsc(150000) &
,atn(50),absyn(50),qult(100),radical,actv_atom(30),num_frag_cntr,input_flg,ovopt,vpt,all_at_num(100)&
,strt_struc(100,15),nstrt,repl_struc(100,15),nnmat_act(100,2),nnmat_inact(100,2),nactorb,active_orbs(20),&
active_atoms(30),nnat_bond_inact(100,2),nnatominact,tot_atom,biasmat(100),sig_sym_flg,valence_state(54)&
,bond_count(1000,100),totrum,vacorb
character(len=2),public ::at_list(88),at_list_bold(88),int_num(40)
integer,public::atm_nb_sym(20),nalpha,nbeta,str_det_sec(15000,1000),num_norbsym1(100),qflg
!real,dimension(:,:),allocatable::ovlp_mat
real*8::ovval,dist_rel_mat(20,20),biasval(20)&
,dist_nnat(20)
real*8::prime_num(142),dist_mat(20,20),iab_length
character(len=6),public::symtype,norbsym1(100,20)
double precision::dist_act_rel_mat(20,20)
integer::strdet(900000),detmnt(900000,15),det_sign(900000),Rumwrite,set_order

common /info/nlp,tncs,tnis,is,atom,nabsym,atn,absyn,active_atoms,nao,nae,niao,mult,nlast,set_order,loopsymsc
common /mat/dist_mat,flgst,noqult,rplc,nactorb,nstrt,serial,active_orbs,atm_nb_sym,dist_rel_mat,str_det_sec,biasval

common /stct/mnbond,nmbond,nfset,at_num,itb,syb,nnb,rad,prad,noq,noq1,noq2,noq3,dist_act_rel_mat&
,atoset,at_ab_symset,repl,radical,tot_atom,input_flg,biasmat,dist_nnat,Rumwrite,qflg

common /srr/key_frag,num_frag_cntr,imbd,qult,nnat_bond,nnnatom,frag_cntr
common /str1/all_at_num,sig_sym_flg,uoptstr,repl_struc,ovval,actv_atom,noq0,nlpset,lp,plpair,strt_struc,flg1,ndet&
,ovopt,vpt,symtype

DATA valence_state/1,1,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,&
4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5/

DATA at_list/'H','He','Li','Be','B','C','N','O','F','Ne','Na','Mg','Al',&
'Si','P','S','Cl','Ar','K','Ca','Sc','Ti','V','Cr','Mn','Fe','Co','Ni',&
'Cu','Zn','Ga','Ge','As','Se','Br','Kr','Rb','Sr','Y','Zr','Nb','Mo','Tc',&
'Ru','Rh','Pd','Ag','Cd','In','Sn','Sb','Te','I','Xe','Cs','Ba','La','Ce',&
'Pr','Nd','Pm','Sm','Eu','Gd','Tb','Dy','Ho','Er','Tm','Yb','Lu','Hf','Ta',&
'W','Re','Os','Ir','Pt','Au','Hg','Tl','Pb','Bi','Po','At','Rn','Fr','Ra'/

DATA at_list_bold/'H','HE','LI','BE','B','C','N','O','F','NE','NA','MG','AL',&
'SL','P','S','CL','AR','K','CA','SC','TI','V','CR','MN','FE','CO','NR',&
'CU','ZN','GA','GE','AS','SE','BR','KR','RB','SR','Y','ZR','NB','MO','TC',&
'RU','RH','PD','AG','CD','IN','SN','SB','TE','I','XE','CS','BA','LA','CE',&
'PR','ND','PM','SM','EU','GD','TB','DY','HO','ER','TM','YB','LU','HF','TA',&
'W','RE','OS','IR','PT','AU','HG','TL','PB','BI','PO','AT','RN','FR','RA'/

DATA int_num/'1','2','3','4','5','6','7','8','9','10','11','12','13','14','15','16',&
'17','18','19','20','21','22','23','24','25','26','27','28','29','30','31','32','33',&
'34','35','36','37','38','39','40'/

DATA prime_num/11.0, 13.0, 17.0, 19.0, 23.0, 29.0, 31.0, 37.0, 41.0, 43.0, 47.0, 53.0, 59.0, 61.0&
, 67.0, 71.0, 73.0, 79.0, 83.0, 89.0, 97.0, 101.0, 103.0, 107.0, 109.0, 113.0, 127.0, 131.0, 137.0, 139.0,&
 149.0, 151.0, 157.0, 163.0, 167.0, 173.0, 179.0, 181.0, 191.0, 193.0, 197.0, 199.0, 211.0, 223.0, 227.0, 229.0,&
 233.0, 239.0, 241.0, 251.0, 257.0, 263.0, 269.0, 271.0, 277.0, 281.0, 283.0, 293.0, 307.0, 311.0, 313.0, 317.0,&
 331.0, 337.0, 347.0, 349.0, 353.0, 359.0, 367.0, 373.0, 379.0, 383.0, 389.0, 397.0, 401.0, 409.0, 419.0, 421.0,&
 432.0, 433.0, 439.0, 443.0, 449.0, 457.0, 461.0, 463.0, 467.0, 479.0, 487.0, 491.0, 499.0, 503.0, 509.0, 521.0,&
 523.0, 541.0, 547.0, 557.0, 563.0, 569.0, 571.0, 577.0, 587.0, 593.0, 599.0, 601.0, 607.0, 613.0, 617.0, 619.0,&
 631.0, 641.0, 643.0, 647.0, 653.0, 659.0, 661.0, 673.0, 677.0, 683.0, 691.0, 701.0, 709.0, 719.0, 727.0, 733.0,&
 739.0, 743.0, 751.0, 757.0, 761.0, 769.0, 773.0, 787.0, 797.0, 809.0, 811.0, 821.0, 823.0, 827.0, 829.0, 839.0/

!!!! Covalent radii (in pm unit)  taken from 'Webelement' ... from the link
!"http://crystalmaker.com/support/tutorials/atomic-radii/index.html"

DATA at_covrad /37, 32, 134, 90, 82, 77, 75, 73, 71, 69, 154, 130, 118, 111,&
106, 102, 99, 97, 196, 174, 144, 136, 125, 127, 139, 125, 126, 121, 138, 131,&
126, 122, 119, 116, 114, 110, 211, 192, 162, 148, 137, 145, 156, 126, 135, 131,153,&
148, 144, 141, 138, 135, 133, 130, 225, 198, 169, 204, 203, 201, 199, 198, 198,&
196, 194, 192, 192, 189, 190, 187, 160, 150, 138, 146, 159, 128, 137,&
128, 144, 149, 148, 147, 146, 140, 150, 145, 260, 221/
save

end module commondat

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
program main
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

use commondat
use commondat1
implicit none

integer::wig1,nnae,STDOUT,argnum,nstr7,str5(2000,20)
logical :: fileexists
character(len=35)::inputfilename
common/str/str5,nstr7

open(unit=7,file='structures.dat',status='unknown')
!open(unit=9,file='inputfile.xmi',status='unknown')
!open(unit=9,file='structure_set.dat',status='unknown')
open(unit=10,file='structure_set_1.dat',status='unknown')
open(unit=23,file='Rumer_Sets_all.dat',status='unknown')
open(unit=35,file='quality_str.dat',status='unknown')

serial=0
input_flg=0
nstr7=0
Rumwrite=0

argnum=iargc()
if(argnum.eq.0)then
inputfilename='input.dat'
input_flg=1
INQUIRE(FILE=TRIM(inputfilename),EXIST=fileexists)
IF (fileexists) THEN
print*,'Reading from input.dat file.'
call input
ELSE
PRINT*,'SORRY input.dat file does not exist and you also did not put .xmi file'
stop
ENDIF
endif

if(input_flg.eq.0)call read_xmi


if(flgst.eq.1.or.flgst.eq.2) then
call cov_struc
endif
if(flgst.eq.1.or.flgst.eq.3) then
call ion_struc
endif

call close_file
stop
end program main

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine read_xmi
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
use commondat1
implicit none

integer::argnum,l,MDP,sl(50),k,ll,j,i,i1,io,endflg(50),l1,l2,gap(10,100),keyn(15),least&
,l3,l4,k1,bfimat(5,20),gap1(20),dash(20),bfiln(5),&
lastlbfi,ufrzorbn,orbn1,orbn2,gap2(200),k2,k3,k4,k5,k6,k7,nfrag
integer::chinst,orbsl1(50),k8,k9,sl2(10),MDP1
logical :: fileexists
character(len=35)::inputfilename,keywd(15,50),line7(50),line
character(len=4)::lname
character(len=55)::sttr,charst(500),string(4,50)
character(len=90)::line3,line2,line4,line5,line6
character(len=200)::lowercase
integer::atsymset(20,20),nsym,syn(50),at_sym(50),fragorb,ifrag,iorb,ibfi

common/ats/atsymset,nsym,syn,at_sym
print*,'enter read_xmi'

noq0=3000
noq1=3000
noq2=3000
noq3=3000
symm=0
ovval=1.000
ovopt=0
nlpset=0
nfset=0
flg1=1
mult=1




flgst=1
key_frag=0


!if(argnum.eq.1)then
!endif

if(input_flg.eq.1)goto 500

call getarg(1,inputfilename)
l=len(TRIM(inputfilename))
lname=inputfilename(l-3:l)

if(lname.ne.'.xmi') then
print*,'please put the .xmi file as input'
stop
endif
INQUIRE(FILE=TRIM(inputfilename),EXIST=fileexists)
IF (fileexists) THEN
open(unit=21,file=TRIM(inputfilename),status='old')
ELSE
PRINT*,'SORRY This input file does not exist or you may not provide the &
filename at all'
stop
ENDIF
write(9,*)inputfilename
write(23,*)inputfilename

MDP=0
do
read(21,'(a)',iostat=io)

if(io.ne.0)exit
MDP=MDP+1
enddo
rewind(21)
!print*,'MDP',MDP

do i=1,MDP-1
read(21,'(a)')charst(i)
if(index(charst(i),'$end').ne.0)then
MDP1=i
endif
!!!write(9,*)charst(i)
!write(23,*)charst(i)
!sttr(i)=charst(i)(1:4)
!print*,charst(i)
enddo

rewind(21)

do i=1,10
sl1(i)=0
enddo
l=0
l1=0

do i=1,MDP1

if(index(charst(i),'#').eq.1.or.index(charst(i),';').eq.1)goto 789
if(index(charst(i),'#').gt.1)then
ll=index(charst(i),'#')
do k=1,ll
line=charst(i)(k:k)
if(line.eq.'')then
!print*,'charst(i)(1:k-1)',charst(i)(1:k-1)
if(trim(charst(i)(1:k-1)).ne.'')then
charst(i)=charst(i)(1:ll-1)
goto 111
endif
endif
enddo
endif

if(index(charst(i),';').gt.1)then
ll=index(charst(i),';')
do k=1,ll
line=charst(i)(k:k)
if(line.eq.'')then
!print*,'charst(i)(1:k-1)',charst(i)(1:k-1)
if(trim(charst(i)(1:k-1)).ne.'')then
charst(i)=charst(i)(1:ll-1)
goto 111
endif
endif
enddo
endif


111 charst(i)=lowercase(charst(i))

!ll=len(trim(charst(i)))
!do k=1,ll+1
!line5=charst(i)(k:k)
!if(line5.eq.'')then
!sttr=trim(charst(i)(1:k-1))
!if(sttr.eq.'$ctrl'.or.sttr.eq.'$end'.or.sttr.eq.'$orb'.or.sttr.eq.'$frag'.or.sttr.eq.'$bfi'&
!.or.sttr.eq.'$CTRL'.or.sttr.eq.'$END'.or.sttr.eq.'$ORB'.or.sttr.eq.'$FRAG'.or.sttr.eq.'$BFI') then
if(index(charst(i),'$ctrl').ne.0.or.index(charst(i),'$end').ne.0&
.or.index(charst(i),'$orb').ne.0.or.index(charst(i),'$frag').ne.0&
.or.index(charst(i),'$bfi').ne.0) then
l=l+1
if(index(charst(i),'$end').ne.0)then
!if(sttr.eq.'$end'.or.sttr.eq.'$END')then
endflg(l)=1
else
endflg(l)=0
endif
if(endflg(l).ne.endflg(l-1).or.l.eq.1)then
l1=l1+1
sl(l1)=i
!if(sttr.eq.'$ctrl')sl1(l1)=1
if(index(charst(i),'$ctrl').ne.0)sl1(l1)=1
!if(sttr.eq.'$CTRL')sl1(l1)=1
!if(sttr.eq.'$frag')sl1(l1)=2
if(index(charst(i),'$frag').ne.0)sl1(l1)=2
!if(sttr.eq.'$FRAG')sl1(l1)=2
!if(sttr.eq.'$orb')sl1(l1)=3
if(index(charst(i),'$orb').ne.0)sl1(l1)=3
!if(sttr.eq.'$ORB')sl1(l1)=3
!if(sttr.eq.'$bfi')sl1(l1)=4
if(index(charst(i),'$bfi').ne.0)sl1(l1)=4
!if(sttr.eq.'$BFI')sl1(l1)=4
endif
if(endflg(l).eq.0.and.endflg(l-1).eq.0)then
print*,'You might forget to put $end somewhere in the .xmi file'
stop
endif
endif
!endif
!enddo
789 enddo

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!! if fragment section present then orbital section should be read before
!!!!!!!  fragment section

fragorb=0
ifrag=2
iorb=3
k1=0
k2=0
do i=1,10
sl2(i)=0
enddo
do i=1,l1
if(sl1(i).eq.2)then
k1=1
k3=i
endif
enddo
do i=1,l1
if(sl1(i).eq.3)then
k2=1
k4=i
endif
enddo
fragorb=k1*k2
if(fragorb.eq.1)then
sl2(k3)=sl(k4)
sl2(k3+1)=sl(k4+1)
sl2(k4)=sl(k3)
sl2(k4+1)=sl(k3+1)
ifrag=3
iorb=2
do i=1,l1
if(sl2(i).ne.0)then
sl(i)=sl2(i)
endif
enddo
endif

!do i=1,l1
!print*,'sl(i)',i,sl(i)
!enddo
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
l=0
l4=0
do i=1,l1,2
l4=l4+1
l3=0
do j=sl(i)+1,sl(i+1)-1
if(sl1(i).eq.1)then
l=l+1
l2=1
gap(1,1)=0
ll=len(trim(charst(j)))
do k=1,ll+1
line5=charst(j)(k:k)
if(line5.eq.'#')goto 110
if(line5.eq.'')then
l2=l2+1
gap(l,l2)=k
endif
enddo
110 do k=1,l2
if((gap(l,k+1)-gap(l,k)).ne.1)then
l3=l3+1
keywd(l4,l3)=trim(charst(j)(gap(l,k):gap(l,k+1)-1))
endif
enddo
endif
enddo

keyn(l4)=l3
do k=1,l3
!if(trim(keywd(l4,k)(2:7)).eq.'frgtyp'.or.trim(keywd(l4,k)(2:7)).eq.'FRGTYP')key_frag=1
if(trim(keywd(l4,k)(2:7)).eq.'frgtyp')key_frag=1
!if(trim(keywd(l4,k)(2:4)).eq.'nae'.or.trim(keywd(l4,k)(2:4)).eq.'NAE')then
if(trim(keywd(l4,k)(2:4)).eq.'nae')then
ll=len(trim(keywd(l4,k)))
do k1=1,ll+1
line5=keywd(l4,k)(k1:k1)
if(line5.eq.'=')then
line3=keywd(l4,k)(k1+1:ll)
read(line3,'(I2)')nae
endif
enddo
endif
enddo



do k=1,l3
!if(trim(keywd(l4,k)(2:4)).eq.'nao'.or.trim(keywd(l4,k)(2:4)).eq.'NAO')then
if(trim(keywd(l4,k)(2:4)).eq.'nao')then
ll=len(trim(keywd(l4,k)))
do k1=1,ll+1
line5=keywd(l4,k)(k1:k1)
if(line5.eq.'=')then
line3=keywd(l4,k)(k1+1:ll)
read(line3,'(I2)')nao
endif
enddo
endif
enddo


do k=1,l3
!if(trim(keywd(l4,k)(2:5)).eq.'nmul'.or.trim(keywd(l4,k)(2:5)).eq.'NMUL')then
if(trim(keywd(l4,k)(2:5)).eq.'nmul')then
ll=len(trim(keywd(l4,k)))
do k1=1,ll+1
line5=keywd(l4,k)(k1:k1)
if(line5.eq.'=')then
line3=keywd(l4,k)(k1+1:ll)
read(line3,'(I2)')mult
endif
enddo
endif
enddo

do k=1,l3
!if(trim(keywd(l4,k)(2:7)).eq.'chinst'.or.trim(keywd(l4,k)(2:7)).eq.'CHINST')then
if(trim(keywd(l4,k)(2:7)).eq.'chinst')then
ll=len(trim(keywd(l4,k)))
do k1=1,ll+1
line5=keywd(l4,k)(k1:k1)
if(line5.eq.'=')then
line3=keywd(l4,k)(k1+1:ll)
read(line3,'(I2)')chinst
endif
enddo
if(chinst.eq.1)then
flg1=0
itb=1
syb=3
nnb=2
radical=0
mnbond=0
endif
endif
enddo


do k=1,l3
!if(trim(keywd(l4,k)(2:4)).eq.'str'.or.trim(keywd(l4,k)(2:4)).eq.'STR')then
if(trim(keywd(l4,k)(2:4)).eq.'str')then
ll=len(trim(keywd(l4,k)))
do k1=1,ll+1
line5=keywd(l4,k)(k1:k1)
if(line5.eq.'=')then
line3=keywd(l4,k)(k1+1:ll)
!if(trim(line3).eq.'full'.or.trim(line3).eq.'FULL')flgst=1
if(trim(line3).eq.'full')flgst=1
!if(trim(line3).eq.'cov'.or.trim(line3).eq.'COV')flgst=2
if(trim(line3).eq.'cov')flgst=2
!if(trim(line3).eq.'ion'.or.trim(line3).eq.'ION')flgst=3
if(trim(line3).eq.'ion')flgst=3

endif
enddo
endif
enddo
rewind(21)

if(sl1(i).eq.iorb)then
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! reading of orbital section !!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!print*,'orbital section start'

ll=0
l=0
do j=sl(i)+1,sl(i+1)-1
ll=len(trim(charst(j)))
line3=trim(charst(j)(1:1))
if(ll.eq.0)goto 300
if(trim(line3).eq.'#')goto 300
l=l+1
if(l.eq.1)goto 300
k2=0
do k=1,ll+1
line3=trim(charst(j)(k:k))
if(line3.eq.';')goto 301
if(line3.eq.'')then
k2=k2+1
gap2(k2)=k
endif
enddo
301 if(gap2(1).eq.1)then
k5=0
do k=2,k2
if(abs(gap2(k)-gap2(k-1)).ne.1)then
line3=trim(charst(j)(gap2(k-1)+1:gap2(k)-1))
ll=len(trim(line3))
do k3=1,ll
line2=trim(line3(k3:k3))
if(line2.eq.'-')then
line5=trim(charst(j)(gap2(k-1)+1:gap2(k-1)+k3-1))
line6=trim(charst(j)(gap2(k-1)+k3+1:gap2(k)-1))
read(line5,'(I10)')orbn1
read(line6,'(I10)')orbn2
do k4=orbn1,orbn2
k5=k5+1
orbs(l,k5)=k4
enddo
goto 444
endif
enddo
k5=k5+1
read(line3,'(I10)')orbs(l,k5)
endif
444 enddo
endif
if(gap2(k).ne.1)then
k5=0
do k=1,k2
if(k.eq.1)then
line3=trim(charst(j)(1:gap2(k)-1))
ll=len(trim(line3))
do k3=1,ll
line2=trim(line3(k3:k3))
if(line2.eq.'-')then
line5=trim(charst(j)(1:k3-1))
line6=trim(charst(j)(k3+1:gap2(k)-1))
read(line5,'(I10)')orbn1
read(line6,'(I10)')orbn2
do k4=orbn1,orbn2
k5=k5+1
orbs(l,k5)=k4
enddo
goto 445
endif
 enddo
k5=k5+1
read(line3,'(I10)')orbs(l,k5)
endif
if(k.ne.1)then
if(abs(gap2(k)-gap2(k-1)).ne.1)then
line3=trim(charst(j)(gap2(k-1)+1:gap2(k)-1))
ll=len(trim(line3))
do k3=1,ll
line2=trim(line3(k3:k3))
if(line2.eq.'-')then
line5=trim(charst(j)(gap2(k-1)+1:gap2(k-1)+k3-1))
line6=trim(charst(j)(gap2(k-1)+k3+1:gap2(k)-1))
read(line5,'(I10)')orbn1
read(line6,'(I10)')orbn2
do k4=orbn1,orbn2
k5=k5+1
orbs(l,k5)=k4
enddo
goto 445
endif
 enddo
k5=k5+1
read(line3,'(I10)')orbs(l,k5)
endif
endif
445 enddo
endif

orbn(l)=k5
300 enddo
rewind(21)
orbsl=l
niao=l-1-nao
endif

do l=1,orbsl
!print*,'orbitals',orbsl,niao,(orbs(l,k),k=1,orbn(l))
print*,'orbitals',orbsl,niao,orbn(l),(orbs(l,k),k=1,4)
enddo




!do l=1,nfrag
!print*,'fragments',nfrag,(frag_at(l,k),k=1,frag_atn(l))
!enddo



if(sl1(i).eq.4)then

ll=0
l3=0
do j=sl(i)+1,sl(i+1)-1
l3=l3+1
gap1(1)=0
ll=len(trim(charst(j)))
!print*,'trim(charst(j))',trim(charst(j))
l=1
l1=0
do k=1,ll+1
line3=trim(charst(j)(k:k))
if(line3.eq.''.or.line3.eq.'-')then
l=l+1
gap1(l)=k
if(line3.eq.'-')dash(l)=l
endif
enddo
do k=2,l
!print*,'trim(charst(j)(gap1(k-1):gap1(k)))',gap1(k)-gap1(k-1),trim(charst(j)(gap1(k-1)+1:gap1(k)-1))
if(gap1(k)-gap1(k-1).gt.1)then
l1=l1+1
line3=trim(charst(j)(gap1(k-1)+1:gap1(k)-1))
!print*,'l3,l1',l3,l1
read(line3,'(I3)')bfimat(l3,l1)
!print*,'bfimat',bfimat(l3,l1)
if(dash(k).eq.k)then
l1=l1+1
bfimat(l3,l1)=0
endif
endif
enddo
bfiln(l3)=l1
enddo
!do k=1,l3
!print*,'bfimat(k,l2)',l1,(bfimat(k,k1),k1=1,bfiln(k))
!enddo
lastlbfi=l3
l2=0
j=lastlbfi
!print*,'l1l1l1',l1,j,bfiln(j)
do k=1,bfiln(j)-1
!print*,'kkkkkk',k,bfimat(j,k)
if(k.eq.1.and.bfimat(j,k).gt.1)then
do k1=1,bfimat(j,k)-1
l2=l2+1
freezorb(l2)=k1
!print*,'freezorb(l2)**',l2,freezorb(l2)
enddo
endif
if(bfimat(j,k+1).ne.0.or.k.ne.1)then
if(abs(bfimat(j,k+1)-bfimat(j,k)).ne.1)then
if(abs(bfimat(j,k+1)-bfimat(j,k)).ne.bfimat(j,k+1))then
!print*,'bfimat(j,k)+1,bfimat(j,k+1)',bfimat(j,k),bfimat(j,k+1),abs(bfimat(j,k+1)-bfimat(j,k))
do k1=bfimat(j,k)+1,bfimat(j,k+1)-1
l2=l2+1
freezorb(l2)=k1
!print*,'freezorb(l2)**',l2,freezorb(l2)
enddo
endif
endif
endif
enddo

frzn=l2

!do k1=1,frzn
!print*,'freezorb(l2)',frzn,freezorb(k1)
!enddo

endif
if(sl1(i).eq.ifrag)then
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!! reading of fragment section !!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!print*,'fragment section start'
k6=0
k7=0
k8=0
k9=0
do j=1,20
gap1(j)=0
enddo
ll=0
l=0
!print*,'sl',sl(i),sl(i+1)-1
do j=sl(i)+1,sl(i+1)-1
ll=len(trim(charst(j)))
line3=trim(charst(j)(1:1))
if(ll.eq.0)goto 310
if(trim(line3).eq.'#')goto 310
l=l+1
if(l.eq.1)goto 310
k2=0

do k=1,ll+1
line3=trim(charst(j)(k:k))
if(line3.eq.';')goto 311
if(line3.eq.'')then
k2=k2+1
gap2(k2)=k
endif
enddo
311 if(gap2(1).eq.1)then

if(key_frag.eq.1)then
do k=2,k2

if(abs(gap2(k)-gap2(k-1)).ne.1)then
line3=trim(charst(j)(gap2(k-1)+1:gap2(k)-1))

!print*,'line3:xmi',line3

do l1=orbsl-nao+1,orbsl
if(orbs(l1,1).eq.l-1)then
ll=len(trim(line3))
do k3=1,ll
line2=trim(line3(k3:k3))
!if(line2.eq.'S'.or.line2.eq.'s')then
if(line2.eq.'s')then
k6=k6+1
orbsym(4,k6)=l1-1
goto 208
endif
enddo
do k3=1,ll
line2=trim(line3(k3:k3+1))
!if(line2.eq.'PX'.or.line2.eq.'Px'.or.line2.eq.'px')then
if(line2.eq.'px')then
k7=k7+1
orbsym(1,k7)=l1-1
goto 208
endif
enddo
do k3=1,ll
line2=trim(line3(k3:k3+1))
!if(line2.eq.'PY'.or.line2.eq.'Py'.or.line2.eq.'py')then
if(line2.eq.'py')then
k8=k8+1
orbsym(2,k8)=l1-1
goto 208
endif
enddo
do k3=1,ll
line2=trim(line3(k3:k3+1))
!if(line2.eq.'PZ'.or.line2.eq.'Pz'.or.line2.eq.'pz')then
if(line2.eq.'pz')then
k9=k9+1
orbsym(3,k9)=l1-1
goto 208
endif
enddo
endif
208 enddo
do l1=orbsl-nao+1,orbsl
if(orbs(l1,1).eq.l-1)then
l3=0
ll=len(trim(line3))
do k3=1,ll
line2=trim(line3(k3:k3))
!if(line2.eq.'S'.or.line2.eq.'s')then
if(line2.eq.'s')then
l3=l3+1
norbsym1(l1-1,l3)='S'
!print*,'norbsym1(l1-1,l3)S',l1-1,norbsym1(l1-1,l3)
!print*,'k6k6',k6,orbsym(4,k6)
goto 218
endif
enddo
218 do k3=1,ll
line2=trim(line3(k3:k3+1))
!print*,'line2**',line2
!if(line2.eq.'PX'.or.line2.eq.'Px'.or.line2.eq.'px')then
if(line2.eq.'px')then
l3=l3+1
norbsym1(l1-1,l3)='X'
!print*,'norbsym1(l1-1,l3)X',l1-1,norbsym1(l1-1,l3)
!print*,'k7k7',k7
goto 219
endif
enddo
219 do k3=1,ll
line2=trim(line3(k3:k3+1))
!if(line2.eq.'PY'.or.line2.eq.'Py'.or.line2.eq.'py')then
if(line2.eq.'py')then
l3=l3+1
norbsym1(l1-1,l3)='Y'
!print*,'norbsym1(l1-1,l3)Y',l1-1,norbsym1(l1-1,l3)
!print*,'k8k8',k8
goto 220
endif
enddo
220 do k3=1,ll
line2=trim(line3(k3:k3+1))
!if(line2.eq.'PZ'.or.line2.eq.'Pz'.or.line2.eq.'pz')then
if(line2.eq.'pz')then
!print*,'line2inside',line2
l3=l3+1
norbsym1(l1-1,l3)='Z'
!print*,'norbsym1(l1-1,l3)Z',l1-1,norbsym1(l1-1,l3)
!print*,'k9k9',k9,orbsym(3,k9)
goto 221
endif
enddo
endif
221 num_norbsym1(l1-1)=l3
enddo
goto 210
endif
enddo
endif

210 k5=0
do k=2,k2-1
if(abs(gap2(k)-gap2(k-1)).ne.1)then
line3=trim(charst(j)(gap2(k)+1:gap2(k+1)-1))
ll=len(trim(line3))
do k3=1,ll
line2=trim(line3(k3:k3))
if(line2.eq.'-')then
line5=trim(charst(j)(gap2(k)+1:gap2(k)+k3-1))
line6=trim(charst(j)(gap2(k)+k3+1:gap2(k+1)-1))
read(line5,'(I10)')orbn1
read(line6,'(I10)')orbn2
do k4=orbn1,orbn2
k5=k5+1
frag_at(l,k5)=k4
!print*,'frag_at',k5,frag_at(l,k5)
enddo
goto 454
endif
enddo
!print*,'k55555',k5
k5=k5+1
read(line3,'(I10)')frag_at(l,k5)
endif
454 enddo
!print*,'k5555',k5
frag_atn(l)=k5
!print*,'sourav_frag_atn',frag_atn(l)
endif
if(gap2(1).ne.1)then
if(key_frag.eq.1)then
line3=trim(charst(j)(1:gap2(1)-1))
!print*,'line3:xmi',line3

do l1=orbsl-nao+1,orbsl
if(orbs(l1,1).eq.l-1)then
ll=len(trim(line3))
do k3=1,ll
line2=trim(line3(k3:k3))
!print*,'line2**',line2,line3
!if(line2.eq.'S'.or.line2.eq.'s')then
if(line2.eq.'s')then
k6=k6+1
orbsym(4,k6)=l1-1
!print*,'k6k6',k6,orbsym(4,k6)
goto 209
endif
enddo
do k3=1,ll
line2=trim(line3(k3:k3+1))
!print*,'line2**',line2
!if(line2.eq.'PX'.or.line2.eq.'Px'.or.line2.eq.'px')then
if(line2.eq.'px')then
k7=k7+1
orbsym(1,k7)=l1-1
!print*,'k7k7',k7
goto 209
endif
enddo
do k3=1,ll
line2=trim(line3(k3:k3+1))
!if(line2.eq.'PY'.or.line2.eq.'Py'.or.line2.eq.'py')then
if(line2.eq.'py')then
k8=k8+1
orbsym(2,k8)=l1-1
!print*,'k8k8',k8
goto 209
endif
enddo
do k3=1,ll
line2=trim(line3(k3:k3+1))
!if(line2.eq.'PZ'.or.line2.eq.'Pz'.or.line2.eq.'pz')then
if(line2.eq.'pz')then
!print*,'line2inside',line2
k9=k9+1
orbsym(3,k9)=l1-1
!print*,'k9k9',k9,orbsym(3,k9)
goto 209
endif
enddo
endif
!enddo
209 enddo
do l1=orbsl-nao+1,orbsl
if(orbs(l1,1).eq.l-1)then
l3=0
ll=len(trim(line3))
do k3=1,ll
line2=trim(line3(k3:k3))
!print*,'line2**',line2
!if(line2.eq.'S'.or.line2.eq.'s')then
if(line2.eq.'s')then
l3=l3+1
norbsym1(l1-1,l3)='S'
!print*,'norbsym1(l1-1,l3)S',l1-1,norbsym1(l1-1,l3)
!print*,'k6k6',k6,orbsym(4,k6)
goto 318
endif
enddo
318 do k3=1,ll
line2=trim(line3(k3:k3+1))
!print*,'line2**',line2
!if(line2.eq.'PX'.or.line2.eq.'Px'.or.line2.eq.'px')then
if(line2.eq.'px')then
l3=l3+1
norbsym1(l1-1,l3)='X'
print*,'norbsym1(l1-1,l3)X',l1-1,norbsym1(l1-1,l3)
!print*,'k7k7',k7
goto 319
endif
enddo
319 do k3=1,ll
line2=trim(line3(k3:k3+1))
!if(line2.eq.'PY'.or.line2.eq.'Py'.or.line2.eq.'py')then
if(line2.eq.'py')then
l3=l3+1
norbsym1(l1-1,l3)='Y'
!print*,'norbsym1(l1-1,l3)Y',l1-1,norbsym1(l1-1,l3)
!print*,'k8k8',k8
goto 320
endif
enddo
320 do k3=1,ll
line2=trim(line3(k3:k3+1))
!if(line2.eq.'PZ'.or.line2.eq.'Pz'.or.line2.eq.'pz')then
if(line2.eq.'pz')then
!print*,'line2inside',line2
l3=l3+1
norbsym1(l1-1,l3)='Z'
!print*,'norbsym1(l1-1,l3)Z',l1-1,norbsym1(l1-1,l3)
!print*,'k9k9',k9,orbsym(3,k9)
goto 321
endif
enddo
endif
321 num_norbsym1(l1-1)=l3
enddo
endif

k5=0
do k=2,k2
!print*,'k2222',k,k2,charst(j)
line3=trim(charst(j)(gap2(k-1)+1:gap2(k)-1))
if(trim(line3).eq.'') goto 404
!print*,'fragk=2',line3
ll=len(trim(line3))
do k3=1,ll
line2=trim(line3(k3:k3))
if(line2.eq.'-')then
line5=trim(charst(j)(gap2(k-1)+1:gap2(k-1)+k3-1))
line6=trim(charst(j)(gap2(k-1)+k3+1:gap2(k)-1))
read(line5,'(I10)')orbn1
read(line6,'(I10)')orbn2
do k4=orbn1,orbn2
k5=k5+1
frag_at(l,k5)=k4
enddo
goto 455
endif
 enddo
k5=k5+1
404 read(line3,'(I10)')frag_at(l,k5)
455 enddo
frag_atn(l)=k5
!print*,'sourav_frag_atnnnn',frag_atn(l)
endif
310 enddo
rewind(21)
nfrag=l

!do i1=1,nfrag
!print*,'frag_atoms',nfrag,(frag_at(i1,j),j=1,frag_atn(i1))
!enddo
norbsym(4)=k6
norbsym(1)=k7
norbsym(2)=k8
norbsym(3)=k9


endif

enddo


vacorb=nao-nae
nlp=nae-nao
if(vacorb.gt.1)nlp=0
nlast=(mult-1)

if(chinst.eq.1)call input
call read_info

!print*,'exit read_xmi'
500 return
end subroutine read_xmi
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine read_info
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
use commondat1
implicit none

integer::i,i1,i2,i3,k,k1,k2,k3,l,j,unkwn&
,nbasatom1(20),cnt(20),ufrzorbn,ovlp_basis_num(20,10),MNP,iO
integer::fragorb(30),frag_cent(50),frag_cent1(50),k4,k5,nfragcent,n,k9,k10,linenumi,linenumj
integer::bfiexists,n1,n2,n3,n4,l1,l2,j1,i4,sig(20),l3,l4,act_at_num(20),val_state_num(20) &
,pi1(20),pi2(20),k6,k7,nsig,npi1,npi2,k8,ovlp_at_bas_num(20,10),nbas_slab(100)
real*8::oval,a(4)
!biasval(20),least
character(len=5)::atbas(500),act_orb_typ(20,10),atbas_frz(50),line
logical :: fileexists
integer::atsymset(20,20),nsym,syn(50),at_sym(50)
real*8::coordx(100),coordy(100),coordz(100)

common/ats/atsymset,nsym,syn,at_sym
common/coordinate/coordx,coordy,coordz

print*,'enter read_info'

ovlp_int=0
INQUIRE(FILE='x1e.int',EXIST=fileexists)
IF (fileexists) THEN
open (unit=29,file='x1e.int',status='old')
read(29,*)ufrzorbn
ovlp_int=0
!close(29)

!open (unit=29,file='x1e.int',status='old')
MNP=0
do
read(29,'(a)',iostat=io)

if(io.ne.0)exit
MNP=MNP+1
enddo
rewind(29)


do i=1,MNP
read(29,*),line
if(trim(line(1:5)).eq.'SSF0')lnum=i
enddo

!close(29)
ELSE
PRINT*,' x1e.int file does not exist as a result I could not able &
to check if your system has frozen orbitals or not hope you have previded &
correct information otherwise result will be wrong'
ufrzorbn=0
!stop
ENDIF


INQUIRE(FILE='INFO',EXIST=fileexists)
IF (fileexists) THEN
open (unit=39,file='INFO',status='old')
ELSE
PRINT*,'SORRY INFO file does not exist'
stop
ENDIF
read(39,*),tot_atom,nbasis,unkwn
k=0
do i=1,tot_atom
read(39,*),nbasatom(i)
k=k+nbasatom(i)
nbas_slab(i)=k
!print*,'nbasatom',nbasatom(i),nbas_slab(i)
enddo



bfiexists=0
do i=1,10
if(sl1(i).eq.4)bfiexists=1
enddo

if(ufrzorbn.ne.0)then
if(ufrzorbn.lt.k.and.bfiexists.eq.0)then
write(*,*)'it seems that you have frozen orbitals but you forget to put the $bfi section'
stop
else

k=0
do i=1,tot_atom
l=0
k=k+nbasatom(i)
cnt(i)=k
do j=1,frzn
if(freezorb(j).le.cnt(i))then
if(i.gt.1)then
if(freezorb(j).le.cnt(i-1))goto 100 
endif
l=l+1
endif
100 enddo
nbasatom(i)=nbasatom(i)-l
enddo

endif
endif

if(key_frag.eq.0)then
do i=1,200
do j=1,20
atoset(i,j)=0
enddo
enddo

!do i=1,orbsl
!print*,'orbn**********',tot_atom,orbn(i),(orbs(i,j),j=1,orbn(i))
!enddo

!do i=2,niao+1
!j=0
!k=0
!!print*,'iiiiii',i,(orbs(i,l),l=1,orbn(i))
!do i1=1,tot_atom
!!print*,'nbas',nbasatom(i1)
!j=j+nbasatom(i1)
!do l=1,orbn(i)
!if(orbs(i,l).gt.j.or.orbs(i,l).le.j-nbasatom(i1))goto 310
!k=k+1
!atst_inact(i-1,k)=i1
!goto 311
!310 enddo
!311 enddo
!atst_inact_nm(i-1)=k
!atst_inact_val(i-1)=2/k
!enddo
!!k=0
!!do i=1,niao
!!print*,(atst_inact(i,k),k=1,atst_inact_nm(i))
!!enddo
!do i1=1,tot_atom
!inact_elecs(i1)=0
!enddo
!do i1=1,tot_atom
!do i=1,niao
!do i2=1,atst_inact_nm(i)
!if(i1.eq.atst_inact(i,i2))then
!inact_elecs(i1)=inact_elecs(i1)+atst_inact_val(i)
!endif
!enddo
!enddo
!enddo

!print*,(inact_elecs(i),i=1,tot_atom)
!stop

k5=0
j=0
k1=0
k3=0
k4=0
do i1=1,tot_atom
k=0
j=j+nbasatom(i1)
do i=orbsl-nao+1,orbsl
!print*,'active_orbs',i,orbn(i),orbsl,nao,mult
k2=0
do l=1,orbn(i)
if(orbs(i,l).gt.j.or.orbs(i,l).le.j-nbasatom(i1))goto 200
k2=k2+1
enddo
k5=k5+1
k=k+1

do i4=1,k3
if(i1.eq.active_atoms(i4))goto 207
enddo
k3=k3+1
active_atoms(k3)=i1
print*,'active_atoms_1',active_atoms(k3)

207 atoset(i1,k)=i-1
atn(i1)=k 
active_orbs(k5)=i-1
atm_nb_orbs(k5)=i1
!print*,'orbs(i),j**',orbs(i,l),j,i,i1,k
goto 201
200 if(k2.ne.0.and.num_frag_cntr.eq.0)then
k1=k1+1
fragorb(k1)=i-1
if(orbs(i,1).le.j.and.orbs(i,1).gt.j-nbasatom(i1))then
k5=k5+1
k=k+1
k4=k4+1

!print*,'k3k3k3**',k3
do i4=1,k3
if(i1.eq.active_atoms(i4))goto 206
!print*,'i4i4i4',i4
enddo
k3=k3+1
!print*,'k3k3**',k3
active_atoms(k3)=i1
print*,'active_atoms_2',active_atoms(k3)

206 frag_cent(k4)=i1
atoset(i1,k)=i-1
atn(i1)=k 
active_orbs(k5)=i-1
atm_nb_orbs(k5)=i1
endif
endif
if(k2.ne.0.and.num_frag_cntr.ne.0)then
do i3=1,num_frag_cntr
j1=0
do i2=1,frag_cntr(i3)
j1=j1+nbasatom(i2)
enddo
!print*,'j1',j1,frag_cntr(i3)
!if(orbs(i,1).le.j1.and.orbs(i,1).gt.j1-nbasatom(i2))then
k5=k5+1
k=k+1
k4=k4+1
!print*,'k3k3k3:frag_cntr',k3
do i4=1,k3
print*,'i3i3i3',i3,active_atoms(i4)
if(frag_cntr(i3).eq.active_atoms(i4))goto 205
!print*,'i4i4i4',i4
enddo
k3=k3+1
!print*,'k3k3sourav',k3
active_atoms(k3)=frag_cntr(i3)
print*,'active_atoms_3',active_atoms(k3)

205 frag_cent(k4)=frag_cntr(i3)
atoset(frag_cntr(i3),k)=i-1
active_orbs(k5)=i-1
atm_nb_orbs(k5)=frag_cntr(i3)
atn(frag_cntr(i3))=k
!print*,'kkkatn',k
!endif

enddo
endif
201 enddo
!print*,'k33333',k3,i1
enddo

atom=k3
nactorb=k5
!print*,'active_orbs',nactorb,(active_orbs(i),i=1,nactorb)
!print*,'atn',atom,(atn(active_atoms(i)),i=1,atom)
print*,'active_atom',atom,(active_atoms(i),i=1,atom)
!print*,'atm_nb_orbs(k5)',(atm_nb_orbs(i),i=1,nactorb)
do i=1,tot_atom
print*,'atoset:info',(atoset(i,j),j=1,atn(i))
!
enddo

k5=1
frag_cent1(k5)=frag_cent(1)
do i=2,k4
do j=1,k5
if(frag_cent(i).eq.frag_cent1(j))goto 320
enddo
k5=k5+1
frag_cent1(k5)=frag_cent(i-1)
320 enddo
nfragcent=k5
!print*,'num of fragorbs',(fragorb(k),k=1,k1)
!print*,'frag_cent1',(frag_cent1(i),i=1,k5)

if(k1.ne.0.and.num_frag_cntr.eq.0)then
if(k1.eq.1)print*,'You have fragment orbital ',fragorb(1),' . Please mention the &  
central atoms of the fragmants or start the orbitals with basis function of the central atom'
if(k1.gt.1)print*,'You have fragment orbitals ',(fragorb(k),k=1,k1),' . Please mention the &  
central atoms of the fragmants or start the orbitals with basis function of the central atom'
endif

l2=0
do k1=1,tot_atom
l1=0
if(atoset(k1,1).eq.0)goto 321
l2=l2+1
do k2=1,20
if(atoset(k1,k2).ne.0)then
l1=l1+1
!atoset(l2,l1)=atommat(k1,k2)
!print*,'atoset',(atoset(k1,k2),k2=1,5)
endif
enddo
atn(k1)=l1
321 enddo
atom=l2

!do i=1,tot_atom
!!print*,'iii',i
!print*,'atoset_info_2',(atoset(i,j),j=1,5)
!enddo
do i=1,tot_atom
!!print*,'iii**',i
print*,'atoset_info_2',(atoset(i,j),j=1,atn(i))
enddo

endif

do i=1,tot_atom
read(39,*),symat(i),symatno(i),coordx(i),coordy(i),coordz(i)
coordx(i)=coordx(i)*0.529177
coordy(i)=coordy(i)*0.529177
coordz(i)=coordz(i)*0.529177
!print*,'coord**',symat(i),symatno(i),coordx(i),coordy(i),coordz(i)
all_at_num(i)=int(symatno(i))
!print*,'all_at_num',all_at_num(i)
enddo
if(key_frag.eq.0)then
do i=1,atom
act_at_num(i)=symatno(active_atoms(i))
val_state_num(i)=valence_state(act_at_num(i))
enddo

!print*,'act_at_num',(act_at_num(i),i=1,atom)
!print*,'val_state_num',(val_state_num(i),i=1,atom)
endif


!if(k1.ne.0)then
!write(*,*)'as you did not put the central atom of the fragments we took the atom number ='&
!,(frag_cent1(i),i=1,k5),'(',(symat(frag_cent1(i)),i=1,nfragcent),')','as fragment center'
!endif
!990 format(a,1x,I2,1x,a,a,a,a)
!print*,'tot_atom:info',tot_atom
!n=0
!n1=0
!do i=1,tot_atom
!if(atoset(i,1).eq.0)goto 189
!print*,'**********',atoset(i,1),i,symat(i)
!n1=n1+1
!do i3=1,88
!if(symat(i).eq.at_list(i3))then
!print*,'symat(i).eq.at_list(i3)',symat(i),at_list(i3)
!n=n+1
!actv_atom(n)=i
!at_num(n)=i3
!endif
!enddo
!189 enddo
!if(n1.ne.n)then
!n=0
!do i=1,tot_atom
!if(atoset(i,1).eq.0)goto 190
!print*,'**********',atoset(i,1),i,symat(i)
!do i3=1,88
!if(symat(i).eq.at_list_bold(i3))then
!print*,'symat(i).eq.at_list(i3)',symat(i),at_list_bold(i3)
!n=n+1
!actv_atom(n)=i
!at_num(n)=i3
!endif
!enddo
!190 enddo
!
!endif
!do i=1,n
!print*,'at_num',symat(i),at_num(i),actv_atom(i)
!enddo

n=0
do i=1,nbasis
if(frzn.ne.0)then
do j=1,frzn
!print*,'frzn',frzn,freezorb(j)
if(freezorb(j).eq.i)then
read(39,*)atbas_frz(i)
all_atbas(i)=atbas_frz(i)
goto 197
endif
enddo
endif
n=n+1
read(39,*),atbas(n)
all_atbas(i)=atbas(n)
!print*,'atbas:sourav',i,n,atbas(n)
197 enddo

!do i=1,nbasis
!print*,'all_atbas(i)',i,all_atbas(i)
!enddo

!enddo


if(key_frag.eq.0)then

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!! determination of the type of the orbitals 'pi or sigma' !!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
norbsym(4)=0
norbsym(1)=0
norbsym(2)=0
norbsym(3)=0

k=0
k5=0
k8=0
k4=0
k6=0
k1=0
k3=0
do i=orbsl-nao+1,orbsl
k7=0
n=0
!print*,'atom',atom
do i2=1,atom
do i3=1,atn(active_atoms(i2))
print*,'ovlp_act_atm,atoset',active_atoms(i2),atoset(active_atoms(i2),i3)
if(atoset(active_atoms(i2),i3).eq.i-1)then
print*,'active_atoms(i2)',active_atoms(i2),nbasatom(3)
do j=1,active_atoms(i2)
k7=k7+1
n=n+nbasatom(j)
enddo
endif
enddo
enddo
!print*,'n,nbasatom(k7)',k7,n,nbasatom(k7),n-nbasatom(k7),i-1,orbn(i)
!do i2=1,orbn(i)
!print*,'test_ovlp_atbas(orbs(i,i2)',i,orbs(i,i2),atbas(orbs(i,i2))
!enddo




!do k10=1,num_act_orb_typ(i)
!l4=0
!do k9=1,nbasis
!if(all_atbas(k9).eq.act_orb_typ(i,k10))then
!l4=l4+1
!if(l4.eq.valence_state((i)))then
!ovlp_basis_num(i,k10)=k9
!endif
!endif
!enddo
!enddo



do i2=1,orbn(i)
if(orbs(i,i2).le.n.and.orbs(i,i2).gt.n-nbasatom(k7))then
if(atbas(orbs(i,i2)).eq.'S')then
k=k+1
orbsym(4,k)=i-1
!print*,'orbsym(4,k)',orbsym(4,k)
goto 208
endif
endif
enddo
do i2=1,orbn(i)
if(orbs(i,i2).le.n.and.orbs(i,i2).gt.n-nbasatom(k7))then
if(atbas(orbs(i,i2)).eq.'X')then
k3=k3+1
orbsym(1,k3)=i-1
!print*,'orbsym(1,k)',orbsym(1,k3)
goto 208
endif
endif
enddo
do i2=1,orbn(i)
if(orbs(i,i2).le.n.and.orbs(i,i2).gt.n-nbasatom(k7))then
if(atbas(orbs(i,i2)).eq.'Y')then
k4=k4+1
orbsym(2,k4)=i-1
!print*,'orbsym(2,k)',orbsym(2,k4)
goto 208
endif
endif
enddo
do i2=1,orbn(i)
if(orbs(i,i2).le.n.and.orbs(i,i2).gt.n-nbasatom(k7))then
!print*,'atbas(orbs(i,i2))',atbas(orbs(i,i2))
if(atbas(orbs(i,i2)).eq.'Z')then
k8=k8+1
orbsym(3,k8)=i-1
!print*,'orbsym(3,k)',orbsym(3,k8)
goto 208
endif
endif
enddo

208 enddo
norbsym(4)=k
norbsym(1)=k3
norbsym(2)=k4
norbsym(3)=k8


if(ovlp_int.eq.1.and.ovopt.eq.1)then
n2=0
do i=1,atom
n=0
n1=0
n4=0
do i2=1,active_atoms(i)-1
n=n+nbasatom(i2)
enddo
do i2=1,active_atoms(i)
n1=n1+nbasatom(i2)
enddo
do i2=1,frzn
if(freezorb(i2).ge.n.and.freezorb(i2).le.n1)then
n4=n4+1
endif
enddo
n2=n2+n4
do i3=1,atn(active_atoms(i))
l1=0
l2=0
l3=0
l4=0
k9=0
if(n4.eq.0)then
do i2=1,orbn(atoset(active_atoms(i),i3)+1)
print*,'orbn(i)',i2,orbn(atoset(active_atoms(i),i3)+1),orbs(atoset(active_atoms(i),i3)+1,i2)+n2
n3=orbs(atoset(active_atoms(i),i3)+1,i2)+n2
if(n3.lt.n.or.n3.gt.n1)goto 531
if(all_atbas(n3).eq.'S')then
l1=l1+1
if(l1.eq.val_state_num(i))goto 530
endif
if(all_atbas(n3).eq.'X')then
l2=l2+1
if(l2.eq.val_state_num(i))goto 530
endif
if(all_atbas(n3).eq.'Y')then
l3=l3+1
if(l3.eq.val_state_num(i)-1)goto 530
endif
if(all_atbas(n3).eq.'Z')then
l4=l4+1
if(l4.eq.val_state_num(i)-1)goto 530
endif
goto 531
530 k9=k9+1
act_orb_typ(atoset(active_atoms(i),i3),k9)=all_atbas(n3)
ovlp_bas_num(atoset(active_atoms(i),i3),k9)=n3
531 enddo
endif
if(n4.ne.0)then
do i2=1,orbn(atoset(active_atoms(i),i3)+1)
!print*,'orbn(i)',i2,orbn(atoset(active_atoms(i),i3)+1),orbs(atoset(active_atoms(i),i3)+1,i2)+n2
n3=orbs(atoset(active_atoms(i),i3)+1,i2)+n2
!print*,'all_atbas(n3)',n3,all_atbas(n3)
if(n3.lt.n.or.n3.gt.n1)goto 631
if(all_atbas(n3).eq.'S'.and.l1.eq.0)then
l1=1
goto 630
endif
if(all_atbas(n3).eq.'X'.and.l2.eq.0)then
l2=1
goto 630
endif
if(all_atbas(n3).eq.'Y'.and.l3.eq.0)then
l3=1
goto 630
endif
if(all_atbas(n3).eq.'Z'.and.l4.eq.0)then
l4=1
goto 630
endif
goto 631
630 k9=k9+1
act_orb_typ(atoset(active_atoms(i),i3),k9)=all_atbas(n3)
ovlp_bas_num(atoset(active_atoms(i),i3),k9)=n3
631 enddo
endif
num_act_orb_typ(atoset(active_atoms(i),i3))=k9

enddo
!do i3=1,atn(active_atoms(i))
!print*,'act_orb_typ',atoset(active_atoms(i),i3),(act_orb_typ(atoset(active_atoms(i),i3),k10),k10=1,k9)&
!,(ovlp_bas_num(atoset(active_atoms(i),i3),k10),k10=1,k9)
!enddo

enddo

endif

endif

print*,'norbsymmmmm',norbsym(1),norbsym(2),norbsym(3),norbsym(4),atom
!if(ovlp_int.eq.1.and.ovopt.eq.1)then
!do i1=1,nactorb-1
!do j=i1+1,nactorb
!!do i1=1,nactorb
!!do j=1,nactorb
!oval=0.0
!do i2=1,num_act_orb_typ(active_orbs(i1))
!do i3=1,num_act_orb_typ(active_orbs(j))
!n1=ovlp_bas_num(active_orbs(i1),i2)
!n2=ovlp_bas_num(active_orbs(j),i3)
!print*,'n1,n2,nbasis',n1,n2,nbasis,i2,i3
!linenumi=(nbasis*(n1-1)+n2)/4
!linenumj=mod(nbasis*(n1-1)+n2,4)
!n4=linenumj
!if(linenumj.eq.0)then
!linenumi=linenumi-1
!n4=4
!endif
!print*,'lnum',lnum,linenumi,linenumj
!rewind(29)
!do i=1,lnum
!read(29,*),line
!!print*,'line1',i,line
!enddo
!!if(linenumi.eq.0)goto 534
!do i=lnum+1,lnum+linenumi
!read(29,*)line
!!print*,'line2',i,line
!enddo
!534 read(29,*)(a(i),i=1,4)
!print*,(a(i),i=1,4)
!!read(29,*)line
!!print*,line
!n3=num_act_orb_typ(active_orbs(i1))*num_act_orb_typ(active_orbs(j))
!oval=oval+a(n4)/n3
!print*,'oval',oval,a(n4),n3,n4,a(n4)/n3
!rewind(29)
!enddo
!enddo
!orb_ovlp_mat1(i1,j)=oval
!enddo
!enddo
!
!do i1=1,nactorb
!orb_ovlp_mat1(i1,i1)=1.0
!enddo
!
!do i1=1,nactorb-1
!do j=i1+1,nactorb
!orb_ovlp_mat1(j,i1)=orb_ovlp_mat1(i1,j)
!enddo
!enddo
!
!do i1=1,nactorb
!print*,'orb_ovlp_mat1(i1,j)',(orb_ovlp_mat1(i1,j),j=1,nactorb)
!enddo
!
!endif

k5=0
k6=0
do i=1,4
if(norbsym(i).ne.0)then
k5=k5+1
if(i.lt.4)then
k6=1
else
k6=k6+1
endif
at_sym(k5)=k6
syn(k5)=norbsym(i)
do j=1,norbsym(i)
atsymset(k5,j)=orbsym(i,j)
enddo
endif
enddo
nsym=k5


do i=1,nsym
print*,'atsymset',nsym,at_sym(i),(atsymset(i,j),j=1,syn(i))
enddo
!print*,'sig',(sig(i),i=1,nsig)
!print*,'pi1',(pi1(i),i=1,npi1)
!print*,'pi2',(pi2(i),i=1,npi2)

!do i=1,nsym
!print*,'atsymset:info',at_sym(i),(atsymset(i,j),j=1,syn(i))
!enddo


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

print*,'exit read_info'
call geocal(coordx,coordy,coordz)
return
end subroutine read_info
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine geocal(coordx,coordy,coordz)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
use commondat1
implicit none

integer:: i,j,ij,j1,j2,j3,k,ii1,i1,i2,i3,i4,k1,k2,k3,k4,k9,k10,nland,nisland(50),islands(20,50),nncatm,ncatm,&
nnmat(100,100),nnact(100),nnact_1(100),active_orb2(20),active_orb1(20),l,l1,l2,l3,l4,val_st(20)&
,ind(100),act_at_num(20),val_state_num(100),n,n1,n2,n3,n4&
,val_state_num1(100),linenumi,linenumj,active_atoms_sort(100)
real*8::least,bond_dist,ddist,kk,island_mat(20,20)
real*8::coordx(100),coordy(100),coordz(100),oval,a(4)
character(len=5)::act_orb_typ(20,10),line

print*,'enter geocal'
sig_sym_flg=0
if(key_frag.eq.1)then
do i=1,200
do j=1,20
atoset(i,j)=0
enddo
enddo
k3=0
do i=1,tot_atom
ind(i)=1
enddo
do k=orbsl-nao+1,orbsl
if(frag_atn(orbs(k,1)).gt.1)then
write(*,990),'The orbital',k-1,'is a fragment orbital and we took the atom number'&
,frag_at(orbs(k,1)+1,1),'as the central atom.'
write(*,*),'If it is not right please put the central atom number at first place &
in the row in the $frag section and run again.'
endif
if(atoset(frag_at(orbs(k,1)+1,1),ind(frag_at(orbs(k,1)+1,1))).ne.0)&
ind(frag_at(orbs(k,1)+1,1))=ind(frag_at(orbs(k,1)+1,1))+1
if(num_frag_cntr.ne.0)then
do j=1,frag_atn(orbs(k,1)+1)
do i=1,num_frag_cntr
if(frag_cntr(i).eq.frag_at(orbs(k,1)+1,j))then
frag_at(orbs(k,1)+1,1)=frag_cntr(i)
endif
enddo
enddo
endif

atoset(frag_at(orbs(k,1)+1,1),ind(frag_at(orbs(k,1)+1,1)))=k-1
!print*,'atoset22',frag_at(orbs(k,1)+1,1),atoset(frag_at(orbs(k,1)+1,1),ind(frag_at(orbs(k,1)+1,1)))
!print*,'frag_at(orbs(k,1)+1,1)',frag_at(orbs(k,1)+1,1),k-1,k1,atoset(frag_at(orbs(k,1)+1,1),k1)
do i=1,8
print*,'atn:geo_1',atn(active_atoms(i)),active_atoms(i)
enddo
do i=1,k3
if(active_atoms(i).eq.frag_at(orbs(k,1)+1,1))goto 266
enddo
k3=k3+1
active_atoms(k3)=frag_at(orbs(k,1)+1,1)

266 enddo
do i=1,k3
atn(active_atoms(i))=ind(active_atoms(i))
act_at_num(i)=symatno(active_atoms(i))
val_state_num(i)=valence_state(act_at_num(i))
val_state_num1(i)=val_state_num(i)
enddo
do i=1,k3
print*,'atn:geo',atn(active_atoms(i)),active_atoms(i)
enddo
atom=k3

!if(ovlp_int.eq.1.and.ovopt.eq.1)then
!n2=0
!do i=1,atom
!n=0
!n1=0
!n4=0
!do i2=1,active_atoms(i)-1
!n=n+nbasatom(i2)
!enddo
!do i2=1,active_atoms(i)
!n1=n1+nbasatom(i2)
!enddo
!!print*,'frzn',frzn,freezorb(j)
!do i3=1,atn(active_atoms(i))
!l2=0
!l3=0
!l4=0
!k9=0
!!print*,'atn(active_atoms(i)):geo',i3,atn(active_atoms(i))
!do i2=1,num_norbsym1(atoset(active_atoms(i),i3))
!l1=0
!!print*,'orbn(i):geo',i2,orbn(atoset(active_atoms(i),i3)+1),orbs(atoset(active_atoms(i),i3)+1,i2)+n2
!do n3=1+n,n1
!!print*,'all_atbas(n3):geo',n3,all_atbas(n3),norbsym1(atoset(active_atoms(i),i3),i2)
!!if(n3.lt.n.or.n3.gt.n1)goto 531
!val_state_num1(i)=val_state_num(i)
!if(norbsym1(atoset(active_atoms(i),i3),i2).eq.'X')val_state_num1(i)=val_state_num1(i)-1
!if(norbsym1(atoset(active_atoms(i),i3),i2).eq.'Y')val_state_num1(i)=val_state_num1(i)-1
!if(norbsym1(atoset(active_atoms(i),i3),i2).eq.'Z')val_state_num1(i)=val_state_num1(i)-1
!!print*,'val_state_num(i)',val_state_num1(i)
!if(all_atbas(n3).eq.norbsym1(atoset(active_atoms(i),i3),i2))then
!l1=l1+1
!if(l1.eq.val_state_num1(i))goto 530
!endif
!enddo
!goto 531
!530 k9=k9+1
!act_orb_typ(atoset(active_atoms(i),i3),k9)=all_atbas(n3)
!ovlp_bas_num(atoset(active_atoms(i),i3),k9)=n3
!!print*,'ovlp_bas_num(atoset(active_atoms(i),i3),k9)i:geo',ovlp_bas_num(atoset(active_atoms(i),i3),k9),&
!!all_atbas(n3)
!531 enddo
!num_act_orb_typ(atoset(active_atoms(i),i3))=k9
!
!enddo
!!do i3=1,atn(active_atoms(i))
!!print*,'act_orb_typ:geo',atoset(active_atoms(i),i3),(act_orb_typ(atoset(active_atoms(i),i3),k10),k10=1,&
!!num_act_orb_typ(atoset(active_atoms(i),i3)))&
!!,(ovlp_bas_num(atoset(active_atoms(i),i3),k10),k10=1,k9)
!!enddo
!
!enddo
!
!endif

endif

l3=0
l2=0
do k1=1,tot_atom
l1=0
if(atoset(k1,1).eq.0)goto 326
l2=l2+1
do k2=1,20
if(atoset(k1,k2).ne.0)then
l1=l1+1
l3=l3+1
active_orbs(l3)=atoset(k1,k2)
atm_nb_orbs(l3)=k1
endif
enddo
atn(k1)=l1
326 enddo
atom=l2
nactorb=l3

!print*,'nactorb',nactorb,tot_atom
print*,'active_atom**',atom,(active_atoms(i),i=1,atom)
!print*,'atn:atn:sourav',(atn(active_atoms(i)),i=1,atom)
do i=1,nactorb
active_orb2(i)=active_orbs(i)
atm_nb_orbs1(i)=atm_nb_orbs(i)
enddo

k1=0
k=0
436 least=100
do i=1,nactorb
do j=1,k1
if(active_orb1(j).eq.i)goto 337
enddo
if(active_orbs(i).lt.least)then
least=active_orbs(i)
k=i
endif
337 enddo
k1=k1+1
active_orb1(k1)=k
if(k1.lt.nactorb)goto 436
do i=1,nactorb
active_orbs(i)=0
atm_nb_orbs(i)=0
enddo
do i=1,nactorb
active_orbs(i)=active_orb2(active_orb1(i))
atm_nb_orbs(i)=atm_nb_orbs1(active_orb1(i))
enddo



do i=1,tot_atom
print*,'atosetat_geo',atn(i),(atoset(i,j),j=1,atn(i))
enddo

do i=1,nactorb
print*,'sourav4',i
do j=1,4
do k=1,norbsym(j)
if(norbsym(j).ne.0)then
if(active_orbs(i).eq.orbsym(j,k))then
atm_nb_sym(i)=j
endif
endif
enddo
enddo
enddo
!open (unit=29,file='x1e.int',status='old')
!if(ovlp_int.eq.1.and.ovopt.eq.1)then
!print*,'i am here'
!stop
!do i1=1,nactorb-1
!do j=i1+1,nactorb
!oval=0.0
!do i2=1,num_act_orb_typ(active_orbs(i1))
!do i3=1,num_act_orb_typ(active_orbs(j))
!n1=ovlp_bas_num(active_orbs(i1),i2)
!n2=ovlp_bas_num(active_orbs(j),i3)
!linenumi=(nbasis*(n1-1)+n2)/4
!linenumj=mod(nbasis*(n1-1)+n2,4)
!n4=linenumj
!if(linenumj.eq.0)then
!linenumi=linenumi-1
!n4=4
!endif
!rewind(29)
!do i=1,lnum
!read(29,*),line
!enddo
!do i=lnum+1,lnum+linenumi
!read(29,*)line
!enddo
!534 read(29,*)(a(i),i=1,4)
!n3=num_act_orb_typ(active_orbs(i1))*num_act_orb_typ(active_orbs(j))
!oval=oval+a(n4)/n3
!rewind(29)
!enddo
!enddo
!orb_ovlp_mat1(i1,j)=oval
!enddo
!enddo
!
!print*,'sourav5'
!do i1=1,nactorb
!orb_ovlp_mat1(i1,i1)=1.0
!enddo
!
!do i1=1,nactorb-1
!do j=i1+1,nactorb
!orb_ovlp_mat1(j,i1)=orb_ovlp_mat1(i1,j)
!enddo
!enddo
!
!!do i1=1,nactorb
!!print*,'orb_ovlp_mat1(i1,j)',(orb_ovlp_mat1(i1,j),j=1,nactorb)
!!enddo
!endif
!close(29)

!do i=1,nactorb
!print*,'norbsym1(active_atom(i))',active_orbs(i),(norbsym1(active_orbs(i),i1),i1=1,&
!num_norbsym1(active_orbs(i)))
!enddo
!print*,'atm_nb_sym',(atm_nb_sym(i),i=1,nactorb)
!print*,'active_orb',(active_orbs(i),i=1,nactorb)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!! if we take all 'pi' orbitals have non-zero overlapping!!!!

do i=1,nactorb
if(atm_nb_sym(i).lt.4)atm_nb_sym(i)=1
enddo
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
do i=1,atom
print*,'atoset_geo',(atoset(i,j),j=1,atn(i))
enddo
!endif
!print*,'active_orbs',nactorb,(active_orbs(i),i=1,nactorb)
!print*,'atn',atom,(atn(i),i=1,atom)
print*,'active_atom',atom,(active_atoms(i),i=1,atom)
!print*,'atm_nb_orbs**',(atm_nb_orbs(i),i=1,nactorb)
990 format(a,x,I2,x,a,x,I2,x,a)

print*,'tot_atom',tot_atom,atom
j=0
do ij=1,tot_atom-1
!print*,'i',ij
do ii1=ij+1,tot_atom
!print*,'i1',ii1
ddist=sqrt((coordx(ij)-coordx(ii1))**2.0+(coordy(ij)-coordy(ii1))**2.0+&
(coordz(ij)-coordz(ii1))**2.0)
dist_mat(ij,ii1)=ddist
bond_dist=(at_covrad(all_at_num(ij))+at_covrad(all_at_num(ii1)))/100.0
!print*,'ddist,bond_dist',ddist,bond_dist
if(ddist.le.bond_dist)then
k1=0
do i2=1,atom
if(ij.eq.active_atoms(i2))k1=k1+1
if(ii1.eq.active_atoms(i2))k1=k1+1
enddo
if(k1.ne.2)then
dist_act_rel_mat(ij,ii1)=0.0
else
dist_act_rel_mat(ij,ii1)=1.0
endif
dist_rel_mat(ij,ii1)=1.0
else
k1=0
do i2=1,atom
if(ij.eq.active_atoms(i2))k1=k1+1
if(ii1.eq.active_atoms(i2))k1=k1+1
enddo
if(k1.ne.2)then
dist_act_rel_mat(ij,ii1)=0.0
else
dist_act_rel_mat(ij,ii1)=ddist/bond_dist
endif
dist_rel_mat(ij,ii1)=ddist/bond_dist
endif
enddo
enddo


do i=1,tot_atom
dist_act_rel_mat(i,i)=0.0
dist_rel_mat(i,i)=0.0
dist_mat(i,i)=0.0
enddo

do i=1,tot_atom-1
do i1=i+1,tot_atom
dist_act_rel_mat(i1,i)=dist_act_rel_mat(i,i1)
dist_rel_mat(i1,i)=dist_rel_mat(i,i1)
dist_mat(i1,i)=dist_mat(i,i1)
enddo
enddo

do i=1,tot_atom
print*,'dist_mat',(dist_mat(i,i1),i1=1,tot_atom)
enddo
!
!do i=1,tot_atom
!print*,'dist_rel_mat',(dist_rel_mat(i,i1),i1=1,tot_atom)
!enddo
!
!do i=1,tot_atom
!print*,'dist_act_rel_mat',(dist_act_rel_mat(i,i1),i1=1,tot_atom)
!enddo
!do i=1,k
!print*,'read_info:nnmat_act',(nnmat_act(i,i1),i1=1,2)
!enddo
!do i=1,k2
!print*,'read_info:nnmat_inact',(nnmat_inact(i,i1),i1=1,2)
!enddo

!!!!!!!!!!!! below active_atoms() moved to the regular order as
!given in INFO ... for dist matrix formation it was (may be) necessary
! to change it in the order of active orbitals.

j=0

413 k=10000
do i=1,atom
do i1=1,j
if(active_atoms_sort(i1).eq.active_atoms(i))goto 412
enddo
if(k.gt.active_atoms(i))k=active_atoms(i)
412 enddo
j=j+1
active_atoms_sort(j)=k
print*,'k',k
if(j.ne.atom)goto 413

do i=1,atom
active_atoms(i)=active_atoms_sort(i)
enddo

print*,'active_atoms_sort',(active_atoms(i),i=1,atom)

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

k=0
do i=1,tot_atom
least=1000.0
do i1=1,tot_atom
if(dist_act_rel_mat(i,i1).lt.least.and.dist_act_rel_mat(i,i1).ne.0.0)least=dist_act_rel_mat(i,i1)
enddo
do i1=1,tot_atom
k1=0
do i2=1,atom
if(i.eq.active_atoms(i2))k1=k1+1
if(i1.eq.active_atoms(i2))k1=k1+1
enddo
if(k1.eq.2.and.dist_act_rel_mat(i,i1).eq.least)then
k=k+1
nnmat_act(k,1)=i
nnmat_act(k,2)=i1
endif
enddo
enddo

do i=1,k
nnact(i)=nnmat_act(i,1)**2.0+nnmat_act(i,2)**2.0
enddo

do i=1,k
print*,'nnact',nnact(i),nnmat_act(i,1),nnmat_act(i,2)
enddo

j1=0
do i=1,k
do i1=1,j1
if(nnact(i).eq.nnact(nnact_1(i1)))goto 233
enddo
j1=j1+1
nnact_1(j1)=i
233 enddo
nnnatom=j1
do i=1,nnnatom
do j=1,2
nnat_bond(i,j)=nnmat_act(nnact_1(i),j)
!print*,'nnat_bond',nnat_bond(i,j)
enddo
enddo


k2=0
do i=1,tot_atom
least=1000.0
do i1=1,tot_atom
if(dist_rel_mat(i,i1).lt.least.and.dist_rel_mat(i,i1).ne.0.0)least=dist_rel_mat(i,i1)
enddo
do i1=1,tot_atom
k1=0
do i2=1,atom
if(i.eq.active_atoms(i2))k1=k1+1
if(i1.eq.active_atoms(i2))k1=k1+1
enddo

if(k1.ne.2.and.dist_rel_mat(i,i1).eq.least)then
k2=k2+1
nnmat_inact(k2,1)=i
nnmat_inact(k2,2)=i1
endif
enddo
enddo
do i=1,100
nnact(i)=0
nnact_1(i)=0
enddo

do i=1,k2
nnact(i)=nnmat_inact(i,1)**2.0+nnmat_inact(i,2)**2.0
enddo

j1=0
do i=1,k2
do i1=1,j1
if(nnact(i).eq.nnact(nnact_1(i1)))goto 234
enddo
j1=j1+1
nnact_1(j1)=i
234 enddo
nnatominact=j1
do i=1,nnatominact
do j=1,2
nnat_bond_inact(i,j)=nnmat_inact(nnact_1(i),j)
enddo
enddo

!!do i=1,tot_atom
!!print*,'dist_mat',(dist_mat(i,i1),i1=1,tot_atom)
!!enddo
!!
!!do i=1,tot_atom
!!print*,'dist_rel_mat',(dist_rel_mat(i,i1),i1=1,tot_atom)
!!enddo
!!
!!do i=1,tot_atom
!!print*,'dist_act_rel_mat',(dist_act_rel_mat(i,i1),i1=1,tot_atom)
!!enddo
!!do i=1,k
!!print*,'read_info:nnmat_act',(nnmat_act(i,i1),i1=1,2)
!!enddo
!!do i=1,k2
!!print*,'read_info:nnmat_inact',(nnmat_inact(i,i1),i1=1,2)
!!enddo


do i=1,nnnatom
print*,'read_info:nnat_bond',nnnatom,(nnat_bond(i,i1),i1=1,2)
enddo
print*,'nnatominact',nnatominact
do i=1,nnatominact
print*,'read_info:nnat_bond_inact',nnatominact,(nnat_bond_inact(i,i1),i1=1,2)
enddo

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!print*,'tot_atom:geo',tot_atom
n=0
n1=0
do i=1,tot_atom
if(atoset(i,1).eq.0)goto 189
!print*,'**********',atoset(i,1),i,symat(i)
n1=n1+1
do i3=1,88
if(symat(i).eq.at_list(i3))then
!print*,'symat(i).eq.at_list(i3)',symat(i),at_list(i3)
n=n+1
actv_atom(n)=i
at_num(n)=i3
if(i3.le.54)val_st(n)=valence_state(i3)
endif
enddo
189 enddo
if(n1.ne.n)then
n=0
do i=1,tot_atom
if(atoset(i,1).eq.0)goto 190
!print*,'**********',atoset(i,1),i,symat(i)
do i3=1,88
if(symat(i).eq.at_list_bold(i3))then
!print*,'symat(i).eq.at_list(i3)',symat(i),at_list_bold(i3)
n=n+1
actv_atom(n)=i
at_num(n)=i3
if(i3.le.54)val_st(n)=valence_state(i3)
endif
enddo
190 enddo

endif

do i=1,n
print*,'at_num:geo',at_num(i),actv_atom(i),val_st(i)
enddo

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!! Routine to produce the the inactive bias to active atooms
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

do i1=1,20
biasval(i1)=0.0
enddo

do i=1,atom
  do i1=1,100
    biasmat(i1)=0
  enddo
k=0
k=k+1
biasmat(k)=active_atoms(i)
  do i1=1,nnatominact
    do j=1,2
      if(active_atoms(i).eq.nnat_bond_inact(i1,j))goto 235
    enddo
  goto 239
235 if(j.eq.1)then
     k=k+1
     biasmat(k)=nnat_bond_inact(i1,2)
     biasval(i)=biasval(i)+all_at_num(nnat_bond_inact(i1,2))+dist_mat(active_atoms(i),nnat_bond_inact(i1,2))
    else
     k=k+1
     biasmat(k)=nnat_bond_inact(i1,1)
     biasval(i)=biasval(i)+all_at_num(nnat_bond_inact(i1,1))+dist_mat(active_atoms(i),nnat_bond_inact(i1,1))
    endif
239 enddo
ncatm=k
nncatm=0
237 do i2=1+nncatm,ncatm
      do i1=1,nnatominact
        do j=1,2
          if(biasmat(i2).eq.nnat_bond_inact(i1,j))goto 236
        enddo
      goto 238
236 if(j.eq.1)then
        do i3=1,k
          if(biasmat(i3).eq.nnat_bond_inact(i1,2))goto 238
        enddo
        k=k+1
        biasmat(k)=nnat_bond_inact(i1,2)
     biasval(i)=biasval(i)+all_at_num(nnat_bond_inact(i1,2))+dist_mat(active_atoms(i),nnat_bond_inact(i1,2))
     else
         do i3=1,k
           if(biasmat(i3).eq.nnat_bond_inact(i1,1))goto 238
         enddo
         k=k+1
         biasmat(k)=nnat_bond_inact(i1,1)
     biasval(i)=biasval(i)+all_at_num(nnat_bond_inact(i1,1))+dist_mat(active_atoms(i),nnat_bond_inact(i1,1))
     endif
238 enddo
  enddo
nncatm=ncatm
ncatm=k
if(nncatm.ne.ncatm)goto 237
enddo

do i=1,atom
print*,'biasval_active',biasval(i)
enddo
do i=1,nnnatom
print*,'nnat_bond_ild',(nnat_bond(i,j),j=1,2)
enddo

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!! Routine to take care of the Islands of active atooms !!!!
!!!!!!!!! Islands means the cluster of atoms !!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

do i1=1,50
do i=1,20
islands(i,i1)=0
enddo
enddo

i4=0
do i=1,atom
if(i.eq.1)goto 246
do i1=1,i4
do j=1,nisland(i1)
if(active_atoms(i).eq.islands(i1,j))goto 245
enddo
enddo
246 k=0
k=k+1
i4=i4+1
islands(i4,k)=active_atoms(i)
do i1=1,nnnatom
do j=1,2
if(active_atoms(i).eq.nnat_bond(i1,j))goto 240
enddo
goto 241
240 if(j.eq.1)then
k=k+1
islands(i4,k)=nnat_bond(i1,2)
else
k=k+1
islands(i4,k)=nnat_bond(i1,1)
endif
241 enddo
ncatm=k
nncatm=0
242 do i2=1+nncatm,ncatm
do i1=1,nnnatom
do j=1,2
if(islands(i4,i2).eq.nnat_bond(i1,j))goto 243
enddo
goto 244
243 if(j.eq.1)then
do i3=1,k
if(islands(i4,i3).eq.nnat_bond(i1,2))goto 244
enddo
k=k+1
islands(i4,k)=nnat_bond(i1,2)
else
do i3=1,k
if(islands(i4,i3).eq.nnat_bond(i1,1))goto 244
enddo
k=k+1
islands(i4,k)=nnat_bond(i1,1)
endif
244 enddo
enddo
nncatm=ncatm
ncatm=k
!print*,'ncatm,nncatm',ncatm,nncatm
if(nncatm.ne.ncatm)goto 242
nisland(i4)=k
!print*,'nisland(i4)',nisland(i4)
245 enddo
nland=i4
!print*,'nland',nland
!do i=1,nland
!print*,'islands',(islands(i,i1),i1=1,nisland(i))
!enddo




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!lowest distance between two islands
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

if(nland.gt.1)then
j1=nnnatom
do i=1,nland
island_mat(i,i)=0.0
enddo
do i=1,nland-1
do j=i+1,nland
least=100.0
do i1=1,nisland(i)
do i2=1,nisland(j)
if(dist_act_rel_mat(islands(i,i1),islands(j,i2)).lt.least.and.dist_act_rel_mat&
(islands(i,i1),islands(j,i2)).ne.0.0)least=dist_act_rel_mat(islands(i,i1),islands(j,i2))
enddo
enddo
!print*,'island:least',least
island_mat(i,j)=least
island_mat(j,i)=least
enddo
enddo

do i=1,nland
print*,'island_mat(i,j)',(island_mat(i,j),j=1,nland)
enddo

do i=1,nland
least=100.0
do j=1,nland
if(island_mat(i,j).lt.least.and.island_mat(i,j).ne.0.0)then
least=island_mat(i,j)
k1=i
k2=j
island_mat(j,i)=0.0
endif
enddo

dO i1=1,nisland(k1)
do i2=1,nisland(k2)
if(dist_act_rel_mat(islands(k1,i1),islands(k2,i2)).eq.least)then
j1=j1+1
nnat_bond(j1,1)=islands(k1,i1)
nnat_bond(j1,2)=islands(k2,i2)

endif
enddo
enddo
enddo
nnnatom=j1
endif

do i=1,nnnatom
print*,'nnat_bond',(nnat_bond(i,j),j=1,2)
enddo

do i=1,atom
kk=0.0
do j=1,nnnatom
do k=1,2
if(active_atoms(i).eq.nnat_bond(j,k))then
if(k.eq.1)l=2
if(k.eq.2)l=1
kk=kk+dist_mat(active_atoms(i),nnat_bond(j,l))
endif
enddo
enddo
dist_nnat(i)=kk
print*,'dist_nnat',i,kk
enddo

do i=1,nactorb
do j=1,nactorb
if(atm_nb_orbs(i).eq.atm_nb_orbs(j))then
if(atm_nb_sym(i).eq.4.and.atm_nb_sym(j).eq.4)then
sig_sym_flg=1
goto 550
endif
endif
enddo
enddo

print*,'exit geocal'
550 return
end subroutine geocal
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine Keycheck(line)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
implicit none
integer::i,j,k,l,nkey
character(len=200)::line,line1
character(len=10)::Keywd(20),lower(26)
data Keywd/'nset','mout','loose','tight','check','sym','chinst','ovlp','btos',&
'stob','qual','iab','nnb','sbb','udr','udb','prad','lpst','imbd','imps'/
data lower/'a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q',&
'r','s','t','u','v','w','x','y','z'/

!print*,line
line1=''
nkey=20
l=len(trim(line))
k=0
do j=1,l+1
!print*,'line(j:j)',j,'>',line(j:j)
do i=1,26
if(line(j:j).eq.lower(i))then
k=k+1
line1(k:k)=lower(i)
!print*,'line1',k,line1(k:k)
goto 100
endif
enddo
!print*,'line1',line1,line,len(trim(line1))
if(len(trim(line1)).gt.0)then
do i=1,nkey
if(trim(line1).eq.Keywd(i))then
line1=''
k=0
goto 100
endif
enddo
write(*,111),'UNKNOWN KEYWORD:',trim(line1)
write(*,112),'Please choose the keywords from ',(keywd(i),i=1,20)
stop
else
goto 100
endif
100 enddo

111 format(a,2x,a)
112 format(a,2x,20a)


return
end subroutine Keycheck
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
function lowercase(line)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
implicit none
integer::i,j,k,l
character(len=200)::line,lowercase
character(len=2)::line1,lower(26),upper(26)
data upper/'A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q'&
,'R','S','T','U','V','W','X','Y','Z'/
data lower/'a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q',&
'r','s','t','u','v','w','x','y','z'/

!print*,'line1',line
l=len(line)

do j=1,l
line1=line(j:j)
do i=1,26
if(line1.eq.upper(i))then
line(j:j)=lower(i)
goto 100
endif
enddo
100 enddo

!print*,'line2',line
lowercase=line
return
end function lowercase
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine input
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

use commondat
use commondat1
implicit none

integer::i,MDP,io,a,b,i1,j,j1,i2,i3,d,i5,i6,i4,i7,st_num1(100),st_num2(100),num(500),m5,m6,k,kk,p,q,&
l,ll,stn,k1,k2,k3,k4,qult1(100),nbond,nel,n,nset(10),pent_set(5),info_val(4),argnum,num_2,ovlp,runn
character(len=4)::abc,at_orb(100),im_bnd(100),ato,str,at_bas_sym(100),strc,rumr,info_set(4)
character(len=200)::charst(1000)
character(len=2)::prio
character(len=200)::line34,line35,line5,lowercase
character(len=5)::pent,stn1,stn2,stn3
!character(len=15)::sttr,charst(100)
character(len=200)::sttr,Seq(20),aa
real*8::num_1(500)
logical :: fileexists
character(len=35)::inputfilename
integer::atsymset(20,20),nsym,syn(50),at_sym(50),MDP1

common/ats/atsymset,nsym,syn,at_sym
print*,'enter input_1'

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!! default values !!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

symtype='loose'
set_order=0
iab_length=0.0
noq0=3000
noq1=3000
noq2=3000
noq3=3000
symm=0
ovval=1.000
ovopt=0
nlpset=0
nfset=0
runn=0
mset=2
qflg=0
!mult=1
ovlp_int=0
  if(input_flg.eq.1)flg1=1
 if(input_flg.eq.1)nsym=1
if(input_flg.eq.1)nstrt=0
 if(input_flg.eq.1)flgst=1
 if(input_flg.eq.1)niach=0
 if(input_flg.eq.1)niabd=0
 if(input_flg.eq.1)nialp=0
!do i=1,10
!nset(i)=100
!enddo

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

MDP=0
i6=0
i7=0
n=0

if(input_flg.eq.1)then
open(unit=21,file='input.dat',status='unknown')


do
read(21,'(a)',iostat=io)

if(io.ne.0)exit
MDP=MDP+1
enddo
rewind(21)

do i=1,MDP
read(21,'(a)')charst(i)
print*,charst(i)
enddo

rewind(21)
endif
!! do
!!print*,'sourav'
!!      read( 21, *, iostat = IO )sttr    ! reads to EOF -- GOOD!!
!!      if ( IO < 0 ) exit               ! if EOF is reached, exit do
!!      i = i + 1
!!!      NumRec = i                       ! used later for total no. of records
!!!      allocate( Seq(I) )
!!      Seq(I) = sttr
!!      print*, I, Seq(I)
!!      X = Len_Trim( Seq(I) )           ! length of individual sequence
!!      print*, 'Sequence size: ', X
!!      print*
!!    end do
!!stop


if(input_flg.eq.0)then

call getarg(1,inputfilename)
INQUIRE(FILE=TRIM(inputfilename),EXIST=fileexists)
IF (fileexists) THEN
open(unit=21,file=TRIM(inputfilename),status='old')
ELSE
write(*,*)'SORRY This input file does not exist or you may not provide the &
filename at all'
stop
ENDIF

do
read(21,'(a)',iostat=io)

if(io.ne.0)exit
MDP=MDP+1
enddo
rewind(21)

do i=1,MDP
read(21,'(a)')charst(i)
if(index(lowercase(charst(i)),'$end').ne.0)then
MDP1=i
endif
enddo

rewind(21)
endif




do i=MDP1+1,MDP

kk=0
q=0
do j=1,100
st_num1(j)=0
st_num2(j)=0
enddo
do j=1,500
num(j)=0
enddo

!ll=len(trim(charst(i)))
!do k=1,ll+1
!line5=charst(i)(k:k)
!if(line5.eq.'')then
!sttr=trim(charst(i)(1:k-1))
!goto 111
!endif
!enddo

if(index(charst(i),'#').eq.1)goto 789
if(index(charst(i),'#').gt.1)then
ll=index(charst(i),'#')
do k=1,ll
line5=charst(i)(k:k)
if(line5.eq.'')then
!print*,'charst(i)(1:k-1)',charst(i)(1:k-1)
if(trim(charst(i)(1:k-1)).ne.'')then
charst(i)=charst(i)(1:ll-1)
goto 111
endif
endif
enddo
endif


!111 if (sttr.eq.'info'.and.input_flg.eq.1)then
111 charst(i)=lowercase(charst(i))
call Keycheck(charst(i))

if (index(charst(i),'info').ne.0.and.input_flg.eq.1)then
do j=1,i-1
read(21,*)
enddo
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
q=0
kk=0
p=0
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 133
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 143
133 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
143 enddo
stn=0
do k=1,500
num(k)=0
enddo
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
!if(fg10.eq.1)goto 189
if(line34(a:b).ne.'info')then
if(line34(a:b).eq.'nao')then 
stn=stn+1
info_set(stn)='nao'
goto 169
endif
if(line34(a:b).eq.'nae')then 
stn=stn+1
info_set(stn)='nae'
goto 169
endif
if(line34(a:b).eq.'mult')then 
stn=stn+1
info_set(stn)='mult'
goto 169
endif
if(line34(a:b).eq.'niao')then 
stn=stn+1
info_set(stn)='niao'
goto 169
endif
if(stn.ne.0)then
read(line34(a:b),'(I10)')num(stn)
!print*,num(stn),stn
info_val(stn)=num(stn)
!print*,'info_val(stn)',info_val(stn),stn,info_set(stn)
endif
endif
endif
169 enddo
!if(stn.ne.4)then
do k=1,stn
if(info_set(k).eq.'nao')then
nao=info_val(k)
goto 171
endif
enddo
write(*,*)'number of active orbitals "nao" is not given'
stop 
171 do k=1,stn
if(info_set(k).eq.'nae')then
nae=info_val(k)
goto 172
endif
enddo
write(*,*)'number of active orbitals "nae" is not given'
stop 
172 do k=1,stn
if(info_set(k).eq.'mult')then
mult=info_val(k)
goto 173
endif
enddo
write(*,*)'number of active orbitals "mult" is not given'
stop 
173 do k=1,stn
if(info_set(k).eq.'niao')then
niao=info_val(k)
goto 174
endif
enddo
write(*,*)'number of active orbitals "niao" is not given'
stop 
174 rewind(21)
endif 



!if (sttr.eq.'ovlp')then
if (index(charst(i),'ovlp').ne.0)then
do j=1,i-1
read(21,*)
enddo
!read(21,*)abc,symm

read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
p=0
q=0
kk=0
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 53
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 54
53 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
54 enddo
stn=0
do k=1,500
num_1(k)=0
enddo
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
!if(fg10.eq.1)goto 389
if(line34(a:b).eq.'ovlp')ovlp=1
if(line34(a:b).ne.'ovlp')then
if(line34(a:b).ne.'')then
stn=stn+1
!if(line34(a:b).ne.'-')then
if(stn.eq.2)then
read(line34(a:b),*)num_1(stn)
ovval=num_1(stn)
endif
if(stn.eq.1)then
read(line34(a:b),'(I10)')num_2
ovlp=num_2
endif
!print*,num(stn),stn
!endif
endif
endif
endif
enddo
print*,'ovval',ovval,ovlp

rewind(21)
endif

!if (sttr.eq.'sym')then
if (index(charst(i),'sym').ne.0)then
symm=1
!do j=1,i-1
!read(21,*)
!enddo

!read(21,'(a)')line34
if(index(charst(i),'loose').ne.0)then
symtype='loose'
endif
if(index(charst(i),'tight').ne.0)then
symtype='tight'
endif
if(index(charst(i),'check').ne.0)then
symtype='check'
endif
!stn1='qual'
!stn2='s2b'
!stn3='b2s'
if(index(charst(i),'qual').ne.0)then
set_order=0
endif
if(index(charst(i),'stob').ne.0)then
set_order=1
endif
if(index(charst(i),'btos').ne.0)then
set_order=2
endif

!print*,'set_order',set_order
rewind(21)
endif

if(index(charst(i),'inactive_bonds').ne.0.and.symm.eq.1.and.input_flg.eq.1)then
do j=1,i-1
read(21,*)
enddo
read(21,'(a)')line34
print*,line34
line35=line34
ll=len(trim(line34))
p=0
q=0
kk=0
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 2739
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 2740
2739 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
2740 enddo
stn=0
do k=1,500
num(k)=0
enddo
m5=0
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).ne.'inactive_bonds')then
stn=stn+1
if(line34(a:b).ne.'-')then
read(line34(a:b),'(I10)')num(stn)
m5=m5+1
iabd(m5)=num(stn)
endif
endif
endif
enddo
niabd=m5
!print*,'iabd(m5)',(iabd(k),k=1,m5),niabd
rewind(21)
endif


!if(sttr.eq.'inactive_lnps'.and.symm.eq.1.and.input_flg.eq.1)then
if(index(charst(i),'inactive_lnps').ne.0.and.symm.eq.1.and.input_flg.eq.1)then

do j=1,i-1
read(21,*)
enddo
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
p=0
q=0
kk=0
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 3739
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 3740
3739 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
3740 enddo
stn=0
do k=1,500
num(k)=0
enddo
m5=0
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).ne.'inactive_lnps')then
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
m5=m5+1
ialp(m5)=num(stn)
endif
endif
enddo
nialp=m5
rewind(21)
endif

!if(sttr.eq.'inactive_chrg'.and.symm.eq.1.and.input_flg.eq.1)then
if(index(charst(i),'inactive_chrg').ne.0.and.symm.eq.1.and.input_flg.eq.1)then

do j=1,i-1
read(21,*)
enddo
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
p=0
q=0
kk=0
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 339
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 340
339 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
340 enddo
stn=0
do k=1,500
num(k)=0
enddo
m5=0
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).ne.'inactive_chrg')then
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
m5=m5+1
iach(m5)=num(stn)
endif
endif
enddo
niach=m5
rewind(21)
endif


!if (sttr.eq.'frag_cntr')then
if (index(charst(i),'frag_cntr').ne.0)then
do j=1,i-1
read(21,*)
enddo
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 3841
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 3842
3841 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
3842 enddo
stn=0
do k=1,500
num(k)=0
enddo
m5=0
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).ne.'frag_cntr')then
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
m5=m5+1
frag_cntr(m5)=num(stn)
endif
endif
enddo
num_frag_cntr=m5
!print*,'frag_cntrs =',(frag_cntr(k),k=1,num_frag_cntr),'num_frag_cntr =',num_frag_cntr
rewind(21)
endif 



if(index(charst(i),'mout').ne.0)then
do j=1,i-1
read(21,*)
enddo
Read(21,*),aa,mset
if(mset.eq.0)mset=1
mset=mset+1
rewind(21)
endif



!if (sttr.eq.'nset')then
if(index(charst(i),'nset').ne.0)then

do j=1,i-1
read(21,*)
enddo
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 3839
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 3840
3839 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
3840 enddo
stn=0
do k=1,500
num(k)=0
enddo
m5=0
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).ne.'nset')then
if(line34(a:b).ne.'')then
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
m5=m5+1
nset(m5)=num(stn)
if(m5.eq.1)nfset=nset(1)
!if(nset(1).ne.2)then
if(nset(1).ne.0)then
!print*,'m555555555',m5,nset(m5)
 if(m5.eq.2)noq0=nset(2)
 if(m5.eq.3)noq1=nset(3)
 if(m5.eq.4)noq2=nset(4)
 if(m5.eq.5)noq3=nset(5)
endif
endif
endif
endif
enddo
print*,'noq0,noq1,noq2,noq3',noq0,noq1,noq2,noq3,nfset
!print*,'nset',(nset(k),k=1,5)
rewind(21)
endif 
!print*,'nfset',abc,nfset


!if (sttr.eq.'atoms'.and.input_flg.eq.1)then
if (index(charst(i),'atoms').ne.0.and.input_flg.eq.1)then
do j=1,i-1
read(21,*)
enddo
!read(21,*)abc,atom
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
kk=0
p=0
q=0
do k=1,10
pent_set(k)=0
enddo
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 263
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 265
263 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
265 enddo
stn=0
do k=1,500
num(k)=0
enddo
m5=0
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).ne.'atoms')then
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
m5=m5+1
pent_set(m5)=num(stn)
endif
endif
enddo
atom=pent_set(1)
if(atom.eq.0)then
write(*,*)'plese write the number of active atoms (atoms corresponding to &
the active orbitals) after the keyword "atoms" and give the orbital &
numbers corresponding to the each atom in the next line' 
stop
endif
!print*,'atom',atom

do i2=1,atom
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
p=0
q=0
kk=0
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 139
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 140
139 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
140 enddo
stn=0
do k=1,500
num(k)=0
enddo
n=0
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
do i3=1,88
if(line34(a:b).eq.at_list(i3))then
n=n+1
at_num(i2)=i3
goto 189
elseif(line34(a:b).eq.at_list_bold(i3))then
n=n+1
at_num(i2)=i3
!print*,'at_num**',at_num(i2)
goto 189
endif
enddo
if(n.eq.0)then
write(*,991),'Your atom',line34(a:b),'is not included in our list (atomic number 1 to &
88 are included) or you have just made a mistake'
stop
endif
991 format(a,x,a,x,a)
if(line34(a:b).ne.'-')then
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
!print*,num(stn),stn
atoset(i2,stn)=num(stn)
active_atoms(i2)=i2
endif
endif
189 enddo
atn(i2)=stn
atn(i6)=m5
!print*,'atoset_sr',i2,atn(i2),(atoset(i2,i7),i7=1,atn(i2))
!print*,'at_num',at_num(n)
enddo
rewind(21)
!do i3=1,atom
!print*,'at_num:input_1',at_num(i3)
!enddo
endif

!if (sttr.eq.'orbsym'.and.input_flg.eq.1)then
if (index(charst(i),'orbsym').ne.0.and.input_flg.eq.1)then
do j=1,i-1
read(21,*)
enddo
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
kk=0
p=0
q=0
do k=1,10
pent_set(k)=0
enddo
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 25
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 26
25 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
26 enddo
stn=0
do k=1,500
num(k)=0
enddo
m5=0
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).ne.'orbsym')then
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
m5=m5+1
pent_set(m5)=num(stn)
endif
endif
enddo
nsym=pent_set(1)
if(nsym.ge.1)then
!do i2=1,nsym
!i3=i2
!write(str,'(I1)') i3
!at_sym(i2)=trim('sym')//trim(str)
!enddo
do i4=1,nsym
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
p=0
q=0
kk=0
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 27
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 28
27 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
28 enddo
stn=0
do k=1,500
num(k)=0
enddo
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
!if(fg10.eq.1)goto 289
!print*,'at_sym(i4)',i4,at_sym(i4)
if(line34(a:b).eq.'pi')at_sym(i4)=1
if(line34(a:b).eq.'sig')at_sym(i4)=2
if(line34(a:b).ne.'pi')then
if(line34(a:b).ne.'sig')then
stn=stn+1
if(line34(a:b).ne.'-')then
!print*,'line34(a:b)',line34(a:b)
read(line34(a:b),'(I10)')num(stn)
!print*,num(stn),stn
endif
endif
endif
endif
enddo
m5=0
do k=1,stn
if(num(k).eq.0)then
do m6=num(k-1)+1,num(k+1)-1
m5=m5+1
atsymset(i4,m5)=m6
enddo
endif
if(num(k).ne.0)then
m5=m5+1
atsymset(i4,m5)=num(k)
endif
enddo
syn(i4)=m5
!print*,noqult,(qult(k),k=1,noqult)
!read(21,*)abc,a,(atsymset(i7,i5),i5=1,syn(i7))
!print*,'syn,symset',syn(i4),at_sym(i4),(atsymset(i4,i5),i5=1,syn(i4))
enddo
endif
rewind(21)
endif


!if (sttr.eq.'at_basis_sym'.and.input_flg.eq.1)then
if (index(charst(i),'at_basis_sym').ne.0.and.input_flg.eq.1)then
do j=1,i-1
read(21,*)
enddo
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
kk=0
p=0
q=0
do k=1,10
pent_set(k)=0
enddo
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 253
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 255
253 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
255 enddo
stn=0
do k=1,500
num(k)=0
enddo
m5=0
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).ne.'at_basis_sym')then
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
m5=m5+1
pent_set(m5)=num(stn)
endif
endif
enddo
nabsym=pent_set(1)

!print*,'nabset',nabsym
if(nabsym.ge.1)then
do i2=1,nabsym
i3=i2
write(str,'(I1)') i3
at_bas_sym(i2)=trim('sym')//trim(str)
enddo
do i4=1,nabsym
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
p=0
q=0
kk=0
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 239
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 240
239 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
240 enddo
stn=0
do k=1,500
num(k)=0
enddo
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
!if(fg10.eq.1)goto 289
!print*,'at_bas_sym(i4)',i4,at_bas_sym(i4)
if(line34(a:b).ne.at_bas_sym(i4))then
stn=stn+1
if(line34(a:b).ne.'-')then
!print*,'line34(a:b)',line34(a:b)
read(line34(a:b),'(I10)')num(stn)
!print*,num(stn),stn
endif
endif
endif
enddo
m5=0
do k=1,stn
if(num(k).eq.0)then
do m6=num(k-1)+1,num(k+1)-1
m5=m5+1
at_ab_symset(i4,m5)=m6
enddo
endif
if(num(k).ne.0)then
m5=m5+1
at_ab_symset(i4,m5)=num(k)
endif
enddo
absyn(i4)=m5
!print*,noqult,(qult(k),k=1,noqult)
!read(21,*)abc,a,(atsymset(i7,i5),i5=1,syn(i7))
!print*,'syn,at_ab_symset',absyn(i4),(at_ab_symset(i4,i5),i5=1,absyn(i4))
enddo
endif
rewind(21)
endif


!if (sttr.eq.'strc'.and.input_flg.eq.1)then
if (index(charst(i),'strc').ne.0.and.input_flg.eq.1)then
!print*,'sttr',sttr,i
do j=1,i-1
read(21,*)
enddo
read(21,'(a)')line34
line35=line34
!print*,line35
ll=len(trim(line34))
kk=0
p=0
q=0
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 539
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 540
539 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
540 enddo
stn=0
do k=1,500
num(k)=0
enddo
m5=0
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).ne.'strc')then
abc=line34(a:b)
endif
endif
enddo


rewind(21)
if(abc.eq.'full') flgst=1
if(abc.eq.'all') flgst=1
if(abc.eq.'covt') flgst=2
if(abc.eq.'cov') flgst=2
if(abc.eq.'ionc') flgst=3
if(abc.eq.'ion') flgst=3
!print*,flgst
endif 



!if (sttr.eq.'imbd')then
if (index(charst(i),'imbd').ne.0)then
do j=1,i-1
read(21,*)
enddo
!read(21,*)abc,imbd
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
kk=0
p=0
q=0
do k=1,10
pent_set(k)=0
enddo
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 4939
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 4940
4939 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
4940 enddo
stn=0
do k=1,500
num(k)=0
enddo
m5=0
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).ne.'imbd')then
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
m5=m5+1
pent_set(m5)=num(stn)
endif
endif
enddo
imbd=pent_set(1)
if(imbd.ne.0)then

read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
kk=0
q=0
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 1739
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 1740
1739 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
1740 enddo
stn=0
do k=1,500
num(k)=0
enddo
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).ne.'-')then
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
endif
endif
enddo
m5=0
do k=1,stn
if(num(k).ne.0)then
m5=m5+1
main_bond(m5)=num(k)
!print*,'mian_bond',main_bond(m5)
endif
enddo
nmbond=m5/2
!print*,'nmbond',nmbond
m5=0
i1=0

endif
rewind(21)
endif


!if(sttr.eq.'nnat'.and.input_flg.eq.1)then
if(index(charst(i),'nnat').ne.0.and.input_flg.eq.1)then
do j=1,i-1
read(21,*)
enddo
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 739
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 740
739 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
740 enddo
stn=0
do k=1,500
num(k)=0
enddo
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
!if(fg10.eq.1)goto 389
if(line34(a:b).ne.'nnat')then
stn=stn+1
if(line34(a:b).ne.'-')then
read(line34(a:b),'(I10)')num(stn)
!print*,num(stn),stn
endif
endif
endif
enddo
m5=0
do k=1,stn
if(num(k).ne.0)then
m5=m5+1
pbond(m5)=num(k)
endif
enddo
nbond=m5
m5=0
i1=0
do k=1,nbond,2
i2=0
i1=i1+1
do m5=k,k+1
i2=i2+1
nnat_bond(i1,i2)=pbond(m5)
enddo
enddo
nnnatom=nbond/2
!print*,'nbond',nbond
do i1=1,nnnatom
!print*,'nnbond',nnnatom,i1,(nnat_bond(i1,k),k=1,2)
enddo
rewind(21)
endif


!if(sttr.eq.'prad')then
if(index(charst(i),'prad').ne.0)then
do j=1,i-1
read(21,*)
enddo
!read(21,*)abc,prad
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
p=0
q=0
kk=0
do k=1,10
pent_set(k)=0
enddo
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 6939
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 6940
6939 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
6940 enddo
stn=0
do k=1,500
num(k)=0
enddo
m5=0
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).ne.'prad')then
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
m5=m5+1
pent_set(m5)=num(stn)
!print*,num(stn),stn
endif
endif
enddo
prad=pent_set(1)
if(prad.ne.0)then
j1=0
do j=i,i+prad-1
do k=1,100
st_num1(k)=0
st_num2(k)=0
enddo
kk=0
q=0
p=0
j1=j1+1
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 839
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 840
839 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
840 enddo
stn=0
do k=1,500
num(k)=0
enddo
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll+1)then
 a=st_num1(k)
 b=st_num2(k+1)
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
endif
enddo
m5=0
do k=1,stn
if(num(k).ne.0)then
m5=m5+1
prio_rad(j1,m5)=num(k)
endif
enddo
norad(j1)=m5
enddo
endif
rewind(21)
endif

!if(sttr.eq.'lpst')then
if(index(charst(i),'lpst').ne.0)then
do j=1,i-1
read(21,*)
enddo

read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
do k=1,10
pent_set(k)=0
enddo
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 5939
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 5940
5939 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
5940 enddo
stn=0
do k=1,500
num(k)=0
enddo
m5=0
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).ne.'lpst')then
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
m5=m5+1
pent_set(m5)=num(stn)
endif
endif
enddo
nlpset=pent_set(1)
if(nlpset.ne.0)then



do j=1,nlpset
kk=1
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 939
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 940
939 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
940 enddo
stn=0
do k=1,500
num(k)=0
enddo
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).ne.'lset')then
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
endif
endif
enddo
m5=0
do k=1,stn
if(num(k).eq.0)then
do m6=num(k-1)+1,num(k+1)-1
m5=m5+1
plpair(j,m5)=num(k)
enddo
endif
if(num(k).ne.0)then
m5=m5+1
plpair(j,m5)=num(k)
endif
enddo
lp(j)=m5
enddo
endif
rewind(21)
endif


!if(sttr.eq.'imps')then
if(index(charst(i),'imps').ne.0)then
do j=1,i-1
read(21,*)
enddo


read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
kk=0
p=0
q=0
do k=1,10
pent_set(k)=0
enddo
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 439
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 440
439 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
440 enddo
stn=0
do k=1,500
num(k)=0
enddo
m5=0
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).ne.'imps')then
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
m5=m5+1
pent_set(m5)=num(stn)
endif
endif
enddo
nstrt=pent_set(1)
if(nstrt.ne.0)then
l=0
do j=1,nstrt
kk=1
p=0
q=0
read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 1139
!print*,k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 1140
1139 kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
endif
1140 enddo
stn=0
do k=1,500
num(k)=0
enddo
!print*,'kk',kk
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
stn=stn+1
read(line34(a:b),'(I10)')num(stn)
endif
enddo
m5=0
if(stn.eq.0)goto 490
l=l+1
do k=1,stn
if(num(k).eq.0)then
do m6=num(k-1)+1,num(k+1)-1
m5=m5+1
strt_struc(l,m5)=num(k)
enddo
endif
if(num(k).ne.0)then
m5=m5+1
strt_struc(l,m5)=num(k)
endif
enddo
nel=m5
if(nel.ne.nae)then
write(*,*)'please check your starting structures, may be number of active electrons are wrong'
stop
endif
enddo
endif
490 rewind(21)
print*,'imps',stn,nel,nstrt
do m6=1,nstrt
print*,(strt_struc(m6,j),j=1,nel)
enddo
endif



!if (sttr.eq.'iab'.or.sttr.eq.'sbb'.or.sttr.eq.'nnb'.or.sttr.eq.'udr'.or.sttr.eq.'udb')then
if (index(charst(i),'iab').ne.0.or.index(charst(i),'sbb').ne.0&
.or.index(charst(i),'nnb').ne.0.or.index(charst(i),'udr').ne.0&
.or.index(charst(i),'udb').ne.0)then
runn=runn+1
if(runn.eq.1)then
itb=0
syb=0
nnb=0
radical=0
mnbond=0
endif

do j=1,i-1
read(21,*)
enddo

read(21,'(a)')line34
line35=line34
ll=len(trim(line34))
q=0
kk=0
p=0
do k=1,ll+1
line5=line34(k:k)
if(line5.eq.'')then
q=q+1
if(k.eq.1)p=1
if(p.eq.1)goto 3949
!print*,'k',k
if(q.eq.1)then
kk=1
st_num1(1)=1
endif
kk=kk+1
st_num1(kk)=k+1
st_num2(kk)=k
goto 3941
3949 kk=kk+1
!print*,'k**',k
st_num1(kk)=k+1
st_num2(kk)=k
endif
3941 enddo
stn=0
do k=1,500
num(k)=0
enddo
m5=0
!print*,'kk**',kk
do k=1,kk
a=0
b=0
if(st_num2(k+1)-st_num2(k).ne.1.and.st_num2(k).le.ll)then
 a=st_num1(k)
 b=st_num2(k+1)
if(line34(a:b).eq.'iab')then
pent=line34(a:b)
stn=stn+1
goto 117
endif
if(line34(a:b).eq.'sbb')then
pent=line34(a:b)
stn=stn+1
goto 117
endif
if(line34(a:b).eq.'nnb')then
pent=line34(a:b)
stn=stn+1
goto 117
endif
if(line34(a:b).eq.'udr')then
pent=line34(a:b)
stn=stn+1
goto 117
endif
if(line34(a:b).eq.'udb')then
pent=line34(a:b)
stn=stn+1
goto 117
endif
read(line34(a:b),'(I10)')num(stn)

endif



117 enddo

if(pent.eq.'iab')itb=num(stn)
if(pent.eq.'sbb')syb=num(stn)
if(pent.eq.'nnb')nnb=num(stn)
if(pent.eq.'udr')radical=num(stn)
if(pent.eq.'udb')mnbond=num(stn)
print*,'itb,syb,nnb,radical,mnbond:input',itb,syb,nnb,radical,mnbond
endif
rewind(21)

!if (sttr.eq.'iab_len')then
if (index(charst(i),'iab_len').ne.0)then

do j=1,i-1
read(21,*)
enddo

read(21,*)line34,iab_length
rewind(21)
endif

789 enddo



!do i1=1,6
!print*,nmbond(i1),i1,(main_bond(i1,k),k=1,nmbond(i1))
!enddo
!do j=1,nlpset
!print*,nlpset,lp,(plpair(j,k),k=1,lp)
!enddo
!print*,'input_1',nao,nae,mult,niao,atn(1),atn(2)

vacorb=nao-nae
nlp=nae-nao
if(vacorb.gt.1)nlp=0
if(qult(1).eq.0)then
noqult=(1+(nae-nlast-nlp*2)/2)*(1+(nae-nlast-nlp*2)/2)
do j=1,noqult
qult(j)=j
enddo
endif

do i=1,10
pent_set(i)=0
enddo
!print*,'itb,syb,nnb,radical,mnbond:11',itb,syb,nnb,radical,mnbond
if(prad.eq.0)radical=0
if(imbd.eq.0)mnbond=0
!print*,'itb,syb,nnb,radical,mnbond:22',itb,syb,nnb,radical,mnbond
pent_set(1)=itb
pent_set(2)=syb
pent_set(3)=nnb
pent_set(4)=radical
pent_set(5)=mnbond
print*,'itb,syb,nnb,radical,mnbond:22',itb,syb,nnb,radical,mnbond

l=1
do j=1,5
if(l.lt.pent_set(j))l=pent_set(j)
enddo

!print*,'ll:pent_set',l
k=0
do j=1,l
do i=1,5
if(pent_set(i).eq.j)then
k=k+1
goto 131
!pent_set(i)=k
endif
enddo
goto 130
131 do i=1,5
if(pent_set(i).eq.j)then
pent_set(i)=k
endif
enddo
130 enddo
itb=pent_set(1)
syb=pent_set(2)
nnb=pent_set(3)
radical=pent_set(4)
mnbond =pent_set(5)
       
itb=itb+1
syb=syb+1
nnb=nnb+1
radical=radical+1
mnbond=mnbond+1
print*,'itb,syb,nnb,radical,mnbond',itb,syb,nnb,radical,mnbond
if(itb.eq.1.and.syb.eq.1.and.nnb.eq.1.and.radical.eq.1.and.mnbond.eq.1.and.flg1.ne.1)then
!itb=1
!syb=2
!nnb=3
!radical=4
!mnbond=5
qflg=1
endif
nlast=(mult-1)

if(ovlp.eq.0)ovopt=0
if(ovlp.eq.2)ovopt=1
if(ovlp.eq.1.and.nfset.eq.0)ovopt=0
if(ovlp.eq.1.and.nfset.eq.1)ovopt=1
if(ovlp.eq.1.and.nfset.eq.2)ovopt=1
if(ovlp.eq.1.and.nfset.eq.3)ovopt=1
!!!!!!!!! "vpt" is the option for user specifying overlap value "ovval". It will work
!!!!!!!!!!!!!only for vpt=1. To lock it please put any other value
vpt=1

write(7,*)'******************************************************************************************'
write(7,900)'*','active orbs =',nao,'active electrons =',nae,'multiplicity =',mult,'inactive orbs =',niao
write(7,*)'******************************************************************************************'
write(7,*)'******************************************************************************************'
900 format(a,1x,a,1x,I4,3x,a,1x,I4,3x,a,1x,I4,3x,a,1x,I4)

!print*,'itb,syb,nnb,radical,mnbond',itb,syb,nnb,radical,mnbond
!print*,'exit input_1'

return
end subroutine input
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine cov_struc
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

common/quality/str_quality_1,str_quality_2,bondq,tqlty,bqlty,sqlty,tnqs,nssym,qulsym,symq,&
sigsym,tnqs_sig

integer::ijk,ij,i1,i2,i3,i4,i5,i6,i7,i8,i9,i10,i11,i12,i13,perm_nstr,nssym,totset,&
i14,i15,i16,i17,i18,i19,i20,i21,k1,k2,k3,k4,k5,STDOUT,a,c,b,d,e,f,nnn,elporb,x,y
integer::i,j,k,l,j1,m,j2,ii,jj,iii,n1,j3,j4,j5,wig2,tnqs,lonep,bonds,allp
integer::alstr,fullcovstr(15000,20),symq(15000),sigsym(15000),tnqs_sig&
,qulsym(15000),str_quality_1(15000),str_quality_2(15000),bondq(150000),tqlty,bqlty,sqlty,symqq(15000)
real*8::factorial,symsc(15000),T1,T2
integer,dimension(:,:),allocatable::strc,fstr,strct,num
integer,dimension(:),allocatable::n,nn
!!! memory allocation !!!!!!!
x=100000
y=100

allocate(strc(x,y))
allocate(strct(x,y))
allocate(n(x))
allocate(nn(x))
allocate(num(x,y))
!!! initialization of arrays !!!
strc(x,y)=0
strct(x,y)=0
n(x)=0
nn(x)=0
num(x,y)=0
!!! ionic and covalent flags
flg_ion=0
flg_cov=1
!!!! new structures generation part starts !!!!!
vacorb=nao-nae
lonep=nae-nao
if(vacorb.gt.0)lonep=0
bonds=(nae-lonep*2-nlast)/2
d=nao
e=2
f=d-e
c=factorial(d)/(factorial(e)*factorial(f))
!!!! production of the set of bonded orbitals strats !!!!!
i4=0
do i1=1,nao-1
  do i2=i1+1,nao
    i4=i4+1
    do i3=1,2
    i5=i2
      if(i3.eq.1)i5=i1
    strc(i4,i3)=i5
    n(i4)=i1
    enddo
  enddo
enddo
totset=i4
!!!! production of the set of bonded orbitals ends !!!!!
!!!! production of the covalent bonding part start !!!!!
i=0
j=0
do i1=1,totset
j=1
nn(1)=i1
  if(j.eq.bonds)then
  i=i+1
  k4=0
    do k2=1,bonds
      do k5=1,2
      k4=k4+1
      strct(i,k4)=strc(nn(k2),k5)
      enddo
    enddo
  goto 121
  endif

do i2=i1+1,totset
j=2
l=0
  do k=1,2
    if(strc(nn(1),k).eq.n(i2))then
    l=l+1
    endif
  enddo
  if(l.eq.0)goto 142
  goto 122
142 l=0 
  do k=1,2
    do k1=1,2
      if(strc(i2,k).eq.strc(nn(1),k1))then
      l=l+1
      endif
    enddo
  enddo
  if(l.eq.0)goto 162
  goto 122
162 nn(2)=i2
if(j.eq.bonds)then
i=i+1
k4=0
do k2=1,bonds
do k5=1,2
k4=k4+1
strct(i,k4)=strc(nn(k2),k5)
enddo
enddo
!print*,'strct',(strct(i,k),k=1,k4)
goto 122
endif

do i3=i2+1,totset
!print*,'sourav',i3
j=3
l=0
do k1=1,j-1
do k=1,2
if(strc(nn(k1),k).eq.n(i3))then
l=l+1
endif
enddo
enddo
!print*,'i3,l',i2,l
if(l.eq.0)goto 143
goto 123
143 l=0 
do k2=1,j-1
 do k=1,2
do k1=1,2
if(strc(i3,k).eq.strc(nn(k2),k1))then
l=l+1
endif
enddo
enddo
enddo
if(l.eq.0)goto 163
goto 123
163 nn(3)=i3
if(j.eq.bonds)then
i=i+1
k4=0
do k2=1,bonds
do k5=1,2
k4=k4+1
!print*,strc(nn(k2),k5)
strct(i,k4)=strc(nn(k2),k5)
enddo
enddo
!print*,'strct',(strct(i,k),k=1,k4)
goto 123
endif

do i4=i3+1,totset
j=4
l=0
do k1=1,j-1
do k=1,2
if(strc(nn(k1),k).eq.n(i4))then
l=l+1
endif
enddo
enddo
if(l.eq.0)goto 144
goto 124
144 l=0 
do k2=1,j-1
 do k=1,2
do k1=1,2
if(strc(i4,k).eq.strc(nn(k2),k1))then
l=l+1
endif
enddo
enddo
enddo
if(l.eq.0)goto 164
goto 124
164 nn(4)=i4
if(j.eq.bonds)then
i=i+1
k4=0
do k2=1,bonds
do k5=1,2
k4=k4+1
strct(i,k4)=strc(nn(k2),k5)
enddo
enddo
!print*,'strct',(strct(i,k),k=1,k4)
goto 124
endif


do i5=i4+1,totset
j=5
l=0
do k1=1,j-1
do k=1,2
if(strc(nn(k1),k).eq.n(i5))then
l=l+1
endif
enddo
enddo
if(l.eq.0)goto 145
goto 125
145 l=0 
do k2=1,j-1
 do k=1,2
do k1=1,2
if(strc(i5,k).eq.strc(nn(k2),k1))then
l=l+1
endif
enddo
enddo
enddo
if(l.eq.0)goto 165
goto 125
165 nn(5)=i5
if(j.eq.bonds)then
i=i+1
k4=0
do k2=1,bonds
do k5=1,2
k4=k4+1
strct(i,k4)=strc(nn(k2),k5)
enddo
enddo
!print*,'strct',(strct(i,k),k=1,k4)
goto 125
endif

do i6=i5+1,totset
j=6
l=0
do k1=1,j-1
do k=1,2
if(strc(nn(k1),k).eq.n(i6))then
l=l+1
endif
enddo
enddo
if(l.eq.0)goto 146
goto 126
146 l=0 
do k2=1,j-1
 do k=1,2
do k1=1,2
if(strc(i6,k).eq.strc(nn(k2),k1))then
l=l+1
endif
enddo
enddo
enddo
if(l.eq.0)goto 166
goto 126
166 nn(6)=i6
!print*,'nn4',nn(6)
if(j.eq.bonds)then
!print*,'sourav2',nn(1),nn(2)
i=i+1
k4=0
do k2=1,bonds
do k5=1,2
k4=k4+1
!print*,strc(nn(k2),k5)
strct(i,k4)=strc(nn(k2),k5)
enddo
enddo
!print*,'strct',(strct(i,k),k=1,k4)
goto 126
endif

do i7=i6+1,totset
!print*,'souravi4',i7,totset
j=7
l=0
do k1=1,j-1
do k=1,2
if(strc(nn(k1),k).eq.n(i7))then
l=l+1
endif
enddo
enddo
!print*,'i3,l',i2,l
if(l.eq.0)goto 147
goto 127
147 l=0 
do k2=1,j-1
 do k=1,2
do k1=1,2
if(strc(i7,k).eq.strc(nn(k2),k1))then
l=l+1
endif
enddo
enddo
enddo
if(l.eq.0)goto 167
goto 127
167 nn(7)=i7
!print*,'nn4',nn(7)
if(j.eq.bonds)then
!print*,'sourav2',nn(1),nn(2)
i=i+1
k4=0
do k2=1,bonds
do k5=1,2
k4=k4+1
!print*,strc(nn(k2),k5)
strct(i,k4)=strc(nn(k2),k5)
enddo
enddo
!print*,'strct',(strct(i,k),k=1,k4)
goto 127
endif

127 enddo
126 enddo
125 enddo
124 enddo
123 enddo
122 enddo
121 enddo
!!!! production of the covalent bonding part of the structures ends !!!!!

alstr=i

strc(x,y)=0
n(x)=0
nn(x)=0


do i1=1,alstr
do k4=1,bonds*2
strc(i1,k4)=strct(i1,k4)
enddo
enddo
!do i1=1,i
!print*,(strc(i1,k4),k4=1,bonds*2)
!enddo

!!!!! production of the lone pairs and radical part of the structures starts !!!!!!
if(nlast.ne.0.or.lonep.ne.0)then
i=0
  do ii=1,alstr
  k5=0
  i2=0
   do i1=1,nao
     do k1=1,bonds*2
       if(i1.eq.strct(ii,k1)) goto 530
     enddo
i2=i2+1
num(ii,i2)=i1

530 enddo
allp=i2
!!!!! production of the lone pair part of the structures starts !!!!!!
if(lonep.ne.0)then
j=0
m=0
  do i1=1,allp
  j=1
  n(1)=i1
    if (j.eq.lonep) then
    i=i+1
    j4=0
      do j1=lonep,1,-1
        do j2=1,2
        j4=j4+1
        strc(i,j4)=num(ii,n(j1))
        enddo
      enddo
    j2=0
      do j3=1,bonds*2
      j2=j3+j4
      strc(i,j2)=strct(ii,j3)
      enddo
    goto 399
    endif

do i2=i1+1,allp
j=2
  if(i2.eq.n(1))goto 401
  n(2)=i2
    if (j.eq.lonep) then
    i=i+1
    j4=0
      do j1=1,lonep
        do j2=1,2
        j4=j4+1
        strc(i,j4)=num(ii,n(j1))
        enddo
      enddo
    j2=0
      do j3=1,bonds*2
      j2=j3+j4
      strc(i,j2)=strct(ii,j3)
      enddo
      goto 401
    endif

do i3=i2+1,allp
j=3
do k=1,2
if(i3.eq.n(k))goto 402
enddo
n(3)=i3
if (j.eq.lonep) then
i=i+1
j4=0
do j1=1,lonep
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
goto 402
endif

do i4=i3+1,allp
j=4
do k=1,3
if(i4.eq.n(k))goto 403
enddo
n(4)=i4
if (j.eq.lonep) then
i=i+1
j4=0
do j1=1,lonep
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
goto 403
endif

do i5=i4+1,allp
j=5
do k=1,4
if(i5.eq.n(k))goto 404
enddo
n(5)=i5
if (j.eq.lonep) then
i=i+1
j4=0
do j1=1,lonep
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
goto 404
endif

do i6=i5+1,allp
j=6
do k=1,5
if(i6.eq.n(k))goto 405
enddo
n(6)=i6
if (j.eq.lonep) then
i=i+1
j4=0
do j1=1,lonep
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
goto 405
endif

do i7=i6+1,allp
j=7
do k=1,6
if(i7.eq.n(k))goto 406
enddo
n(7)=i7
if (j.eq.lonep) then
i=i+1
j4=0
do j1=1,lonep
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
goto 406
endif

do i8=i7+1,allp
j=8
do k=1,7
if(i8.eq.n(k))goto 407
enddo
n(8)=i8
if (j.eq.lonep) then
i=i+1
j4=0
do j1=1,lonep
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
goto 407
endif

do i9=i8+1,allp
j=9
do k=1,8
if(i9.eq.n(k))goto 408
enddo
n(9)=i9
if (j.eq.lonep) then
i=i+1
j4=0
do j1=1,lonep
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
goto 408
endif

do i10=i9+1,allp
j=10
do k=1,9
if(i10.eq.n(k))goto 409
enddo
n(10)=i10
if (j.eq.lonep) then
i=i+1
j4=0
do j1=1,lonep
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
goto 409
endif

409 enddo
408 enddo
407 enddo
406 enddo
405 enddo
404 enddo
403 enddo
402 enddo
401 enddo
399 enddo
endif
enddo
if (lonep.ne.0) alstr=i
!!!!! production of the radical part of the structures starts !!!!!!
if(nlast.ne.0)then
  do i=1,alstr
  j4=nae-nlast
    do i1=1,nae
      do i2=1,nae-nlast
        if(strc(i,i2).eq.i1)goto 555
      enddo
      j4=j4+1
      strc(i,j4)=i1
555 enddo
enddo
endif
endif
!!!!! production of the lone pairs and radical part of the structures ends !!!!!!
deallocate(num)
990 format(30I3)
656 deallocate(strct)
!!!!!!! new structures generation part ends !!!!!!!!!!!!!!!!!!!!!!!
d=nao
e=nlp
f=nao-nlp
elporb=nao-nlp
c=factorial(d)/(factorial(e)*factorial(f))
call wigner(elporb,wig2)
deallocate(n)
deallocate(nn)

write(7,*)'  '
write(7,*)'                  covalent structures   '
write(7,*)'                  -------------------   '
write(7,*)'  '

write(7,307)' You have',alstr,' covalent structures among'
write(7,307)'them',wig2*c,' covalent structures are permissible'
write(7,*)' '
write(7,*)'      [] and {} in front of the structures specifies the quality of the structures.'
write(7,*)'1st number in [] specifies intra-atomic bond quality and 2nd number specifies ' 
write(7,*)'symmetry breaking bond quality. Where {} specifies the overall quality of the structures'
write(7,*)'*************************************************************** '
307 format(2x,a,I7,a)


do i=1,alstr
do i1=1,nae
fullcovstr(i,i1)=strc(i,i1)+niao
enddo
enddo

deallocate(strc)

if(symm.eq.1) then
if(sig_sym_flg.eq.1)call symmetry_cal_sig(nlp,fullcovstr,alstr,symsc,symq,nssym)
if(sig_sym_flg.ne.1)call symmetry_cal_pi(nlp,fullcovstr,alstr,symsc,symq,nssym)

!do ij=1,alstr
!print*,'qulsym(ij),symq(ij)',qulsym(ij),symq(ij),(fullcovstr(ij,j1),j1=1,nao-nlp+nlp*2)
!print*,'qulsym(ij),symq(ij)',qulsym(ij),symq(ij),alstr,nssym,tnqs
!enddo


nnn=0
do ij=1,tnqs
do ijk=nssym,1,-1
do j2=1,alstr
if(symq(j2).eq.ijk)then
nnn=nnn+1
if(niao.eq.0)then
write(7,900),'cov structure',nnn,')',qulsym(j2),(fullcovstr(j2,j1),j1=1,nao-nlp+nlp*2)
endif
if(niao.ne.0)then
write(7,901),'cov structure',nnn,')',qulsym(j2),1,':',niao,(fullcovstr(j2,j1),j1=1,nao-nlp+nlp*2)
endif
endif
210 enddo
write(7,*)'******************************************************'
enddo
enddo
else

do j2=1,alstr
if(niao.eq.0)then
write(7,902),'cov structure',j2,')',(fullcovstr(j2,j1),j1=1,nao-nlp+nlp*2)
endif
if(niao.ne.0)then
write(7,903),'cov structure',j2,')',1,':',niao,(fullcovstr(j2,j1),j1=1,nao-nlp+nlp*2)
endif

enddo
write(7,*)'******************************************************'
endif
900 format(a,I5,a,x,I3,3x,30(I5))
901 format(a,I5,a,x,I3,3x,I3,x,a,I3,30(I5))
902 format(a,I5,a,x,30(I5))
903 format(a,I5,a,x,I3,x,a,I3,30(I5))


if(nfset.eq.3)write(23,*)'********** RUMER STRUCTURES ******************'
if(nfset.eq.5)write(10,*)'**********ALL POSSIBLE RUMER STRUCTURES ******************'
if(flg1.eq.1)then
write(10,*)'********** RUMER STRUCTURES ******************'
endif
if(flg1.eq.0.and.nfset.ne.5)then
write(10,*)'******* CHEM. QUAL. STRUCTURES **************'
endif

perm_nstr=wig2*c
write(10,*),perm_nstr,' covalent structures' 
write(23,*),perm_nstr,' covalent structures' 
if(nfset.ne.5)write(10,913),'IAB','NNB','SBB','fqual'
write(23,913),'IAB','NNB','SBB','fqual'
913 format(x,a,x,a,x,a,x,a)
call str_selection(fullcovstr,nlp,alstr,perm_nstr)
!print*,'total num covstr',tncs
print*,'exit cove_struc'
return
end subroutine cov_struc
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine ion_struc
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

common/quality/str_quality_1,str_quality_2,bondq,tqlty,bqlty,sqlty,tnqs,nssym,qulsym,symq,&
sigsym,tnqs_sig
common/str/str5,nstr7

   integer::i1,i2,i3,i4,i5,i6,i7,i8,i9,i10,i11,i12,i13,perm_nstr,nssym,nnn,x,y, &
i14,i15,i16,i17,i18,i19,i20,i21,k1,k2,STDOUT,rns,jjj,m1,c,c1,d,e,f,elporb,wig2,tnqs
   integer::i,j,k,l,l2,j1,m,j2,ii,jj,iii,n1,j3,j4,j5,nnlp,nnao,nos,nofs,j6,j7,j8,ij,ijk,nstruc
   integer::alionstr,symq(15000),sigsym(15000),tnqs_sig,ion_str_p(1000,15),ald_ionstr(5000,20)&
   ,qulsym(15000),fullionstr(15000,20),str_quality_1(15000),str5(2000,20),nstr7,ll,lll,&
   str_quality_2(15000),bondq(150000),tqlty,bqlty,sqlty,str_p(1000,15),istrbn,strbn
integer::llll,str2(15000,20),str3(15000,20),str4(15000,20),space(1000),covnris(1000)&
,covris(1000),fvec(15000,1000),strn(10000),l1,m119,m20,q_fac(15000),quality_fac(15000)
integer::bonds,alstr,totset,allp,k4,k5,l3,l4,a,b,totistr
   real*8::factorial,symsc(15000)
   integer,dimension(:,:),allocatable::strc,strct,num,istrc
   integer,dimension(:),allocatable::n,nn,num1

print*,'enter ion_struc',niao
x=100000
y=100

!allocate(strc(x,y))
allocate(strct(x,y))
allocate(istrc(x,y))
allocate(num(x,y))
allocate(num1(x))
allocate(n(x))
allocate(nn(x))

!strc(x,y)=0
strct(x,y)=0
istrc(x,y)=0
n(x)=0
nn(x)=0
num(x,y)=0
num1(x)=0

write(7,*)''
write(7,*)'                              ionic structures '
write(7,*)'                              ---------------- '

flg_ion=1
flg_cov=0

!symm=0

m=0
j=0
i=0
nos=0
nofs=0
nnao=0
jjj=0
!print*,'nnlp',nlp,nao,nlast
if(vacorb.gt.0)nlp=nlp+1
do nnlp=nlp+1,nlp+(nao-nlp-nlast)/2
allocate(strc(x,y))
strc(x,y)=0

bonds=(nae-nnlp*2-nlast)/2
d=nao
e=2
f=d-e
!print*,'fac',d,e,f,elporb,bonds
c=factorial(d)/(factorial(e)*factorial(f))

c=bonds
d=nae-nnlp*2
b=int(d/2)
a=2**b
e=nae-nnlp*2-2*b
totistr=factorial(d)/(factorial(e)*a*factorial(c))

!print*,'totistr',totistr
!!!! production of the set of bonded orbitals strats !!!!!

if(bonds.ne.0)then
i4=0
do i1=1,nao-1
do i2=i1+1,nao
i4=i4+1
do i3=1,2
i5=i2
if(i3.eq.1)i5=i1
strc(i4,i3)=i5
n(i4)=i1
enddo
enddo
enddo
!do j2=1,i4
!print*,'bond',j2,n(j2),(strc(j2,j1),j1=1,2)
!enddo
totset=i4
!print*,'totset',i4
!!!! production of the set of bonded orbitals ends !!!!!

!!!! production of the covalent bonding part of the structures start !!!!!
i=0
j=0
do i1=1,totset
!print*,'sourav',i1,totset
j=1
nn(1)=i1
!print*,'nn1',nn(1)
if(j.eq.bonds)then
!print*,'sourav1',j
i=i+1
k4=0
do k2=1,bonds
do k5=1,2
k4=k4+1
strct(i,k4)=strc(nn(k2),k5)
enddo
enddo
goto 121
endif

do i2=i1+1,totset
j=2
l=0
do k=1,2
if(strc(nn(1),k).eq.n(i2))then
l=l+1
endif
enddo
if(l.eq.0)goto 142
goto 122
142 l=0 
 do k=1,2
do k1=1,2
if(strc(i2,k).eq.strc(nn(1),k1))then
l=l+1
endif
enddo
enddo
if(l.eq.0)goto 162
goto 122
162 nn(2)=i2
if(j.eq.bonds)then
i=i+1
k4=0
do k2=1,bonds
do k5=1,2
k4=k4+1
!print*,strc(nn(k2),k5)
strct(i,k4)=strc(nn(k2),k5)
enddo
enddo
!print*,'strct',(strct(i,k),k=1,k4)
goto 122
endif

do i3=i2+1,totset
j=3
l=0
do k1=1,j-1
do k=1,2
if(strc(nn(k1),k).eq.n(i3))then
l=l+1
endif
enddo
enddo
if(l.eq.0)goto 143
goto 123
143 l=0 
do k2=1,j-1
 do k=1,2
do k1=1,2
if(strc(i3,k).eq.strc(nn(k2),k1))then
l=l+1
endif
enddo
enddo
enddo
if(l.eq.0)goto 163
goto 123
163 nn(3)=i3
if(j.eq.bonds)then
i=i+1
k4=0
do k2=1,bonds
do k5=1,2
k4=k4+1
strct(i,k4)=strc(nn(k2),k5)
enddo
enddo
!print*,'strct',(strct(i,k),k=1,k4)
goto 123
endif

do i4=i3+1,totset
!print*,'souravi4',i4,totset
j=4
l=0
do k1=1,j-1
do k=1,2
if(strc(nn(k1),k).eq.n(i4))then
l=l+1
endif
enddo
enddo
!print*,'i3,l',i2,l
if(l.eq.0)goto 144
goto 124
144 l=0 
do k2=1,j-1
 do k=1,2
do k1=1,2
if(strc(i4,k).eq.strc(nn(k2),k1))then
l=l+1
endif
enddo
enddo
enddo
if(l.eq.0)goto 164
goto 124
164 nn(4)=i4
!print*,'nn4',nn(4)
if(j.eq.bonds)then
!print*,'sourav2',nn(1),nn(2)
i=i+1
k4=0
do k2=1,bonds
do k5=1,2
k4=k4+1
!print*,strc(nn(k2),k5)
strct(i,k4)=strc(nn(k2),k5)
enddo
enddo
!print*,'strct',(strct(i,k),k=1,k4)
goto 124
endif


do i5=i4+1,totset
!print*,'souravi4',i5,totset
j=5
l=0
do k1=1,j-1
do k=1,2
if(strc(nn(k1),k).eq.n(i5))then
l=l+1
endif
enddo
enddo
!print*,'i3,l',i2,l
if(l.eq.0)goto 145
goto 125
145 l=0 
do k2=1,j-1
 do k=1,2
do k1=1,2
if(strc(i5,k).eq.strc(nn(k2),k1))then
l=l+1
endif
enddo
enddo
enddo
if(l.eq.0)goto 165
goto 125
165 nn(5)=i5
!print*,'nn4',nn(5)
if(j.eq.bonds)then
!print*,'sourav2',nn(1),nn(2)
i=i+1
k4=0
do k2=1,bonds
do k5=1,2
k4=k4+1
!print*,strc(nn(k2),k5)
strct(i,k4)=strc(nn(k2),k5)
enddo
enddo
!print*,'strct',(strct(i,k),k=1,k4)
goto 125
endif

do i6=i5+1,totset
!print*,'souravi4',i4,totset
j=6
l=0
do k1=1,j-1
do k=1,2
if(strc(nn(k1),k).eq.n(i6))then
l=l+1
endif
enddo
enddo
!print*,'i3,l',i2,l
if(l.eq.0)goto 146
goto 126
146 l=0 
do k2=1,j-1
 do k=1,2
do k1=1,2
if(strc(i6,k).eq.strc(nn(k2),k1))then
l=l+1
endif
enddo
enddo
enddo
if(l.eq.0)goto 166
goto 126
166 nn(6)=i6
!print*,'nn4',nn(6)
if(j.eq.bonds)then
!print*,'sourav2',nn(1),nn(2)
i=i+1
k4=0
do k2=1,bonds
do k5=1,2
k4=k4+1
!print*,strc(nn(k2),k5)
strct(i,k4)=strc(nn(k2),k5)
enddo
enddo
!print*,'strct',(strct(i,k),k=1,k4)
goto 126
endif

do i7=i6+1,totset
!print*,'souravi4',i7,totset
j=7
l=0
do k1=1,j-1
do k=1,2
if(strc(nn(k1),k).eq.n(i7))then
l=l+1
endif
enddo
enddo
!print*,'i3,l',i2,l
if(l.eq.0)goto 147
goto 127
147 l=0 
do k2=1,j-1
 do k=1,2
do k1=1,2
if(strc(i7,k).eq.strc(nn(k2),k1))then
l=l+1
endif
enddo
enddo
enddo
if(l.eq.0)goto 167
goto 127
167 nn(7)=i7
!print*,'nn4',nn(7)
if(j.eq.bonds)then
!print*,'sourav2',nn(1),nn(2)
i=i+1
k4=0
do k2=1,bonds
do k5=1,2
k4=k4+1
!print*,strc(nn(k2),k5)
strct(i,k4)=strc(nn(k2),k5)
enddo
enddo
!print*,'strct',(strct(i,k),k=1,k4)
goto 127
endif

127 enddo
126 enddo
125 enddo
124 enddo
123 enddo
122 enddo
121 enddo
!!!! production of the covalent bonding part of the structures ends !!!!!

alstr=i

strc(x,y)=0
n(x)=0
nn(x)=0


do i1=1,alstr
do k4=1,bonds*2
strc(i1,k4)=strct(i1,k4)
enddo
enddo
!do i1=1,alstr
!print*,(strc(i1,k4),k4=1,bonds*2)
!enddo
endif
if(bonds.eq.0)then
alstr=1
strc(x,y)=0
strct(x,y)=0
endif
!do i1=1,1000
!print*,'strc',(strc(i1,i2),i2=1,4)
!enddo
!!!!! production of the lone pairs and radical part of the structures starts !!!!!!
if(nlast.ne.0.or.nnlp.ne.0)then
i=0
j5=0
ll=0
do ii=1,alstr
k5=0
i2=0
if(bonds.ne.0)then
do i1=1,nao
do k1=1,bonds*2
if(i1.eq.strct(ii,k1)) goto 530
enddo
i2=i2+1
num(ii,i2)=i1

530 enddo
else
do i1=1,nao
i2=i2+1
num(ii,i2)=i1
enddo
endif
allp=i2

!print*,'num*****',nnlp,(num(ii,i2),i2=1,allp)

!!!!! production of the lone pair part of the structures starts !!!!!!

if(nnlp.ne.0)then
!print*,'cov:lp',nnlp,allp
j=0
m=0
do i1=1,allp
!if(nnlp.eq.3)then
!print*,'allp',i1
!endif
j=1
n(1)=i1
!if(nnlp.eq.3)print*,'sourav1'
if (j.eq.nnlp) then
i=i+1
j4=0
do j1=nnlp,1,-1
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
!print*,(strc(i,l),l=1,nao)
goto 399
endif

do i2=i1+1,allp
!if(nnlp.eq.3)print*,'sourav2',i2
j=2
if(i2.eq.n(1))goto 401
n(2)=i2
if (j.eq.nnlp) then
i=i+1
j4=0
do j1=1,nnlp
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
!print*,(strc(i,l),l=1,nao)
goto 401
endif

do i3=i2+1,allp
!if(nnlp.eq.3)print*,'sourav2',i3
j=3
do k=1,2
if(i3.eq.n(k))goto 402
enddo
n(3)=i3
!print*,'n3',n(3)
if (j.eq.nnlp) then
i=i+1
j4=0
!if(nnlp.eq.3)print*,'sourav3',num(1,n(3)),i,nnlp,ii
!print*,(strc(i,j1),j1=1,2)
do j1=1,nnlp
!print*,'jjj',j
!print*,num(ii,n(j1))
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
!print*,'strc',strc(i,j4)
enddo
enddo

!if(nnlp.eq.3)print*,'sourav4'
if(bonds.ne.0)then
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
endif
!print*,'sourav_strc',(strc(i,l),l=1,j4)
goto 402
endif

do i4=i3+1,allp
j=4
do k=1,3
if(i4.eq.n(k))goto 403
enddo
n(4)=i4
!print*,(n(l),l=1,nao)
if (j.eq.nnlp) then
i=i+1
j4=0
do j1=1,nnlp
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
!print*,'num',i,num(ii,n(j1)),strc(i,j4)
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
!print*,'sourav gadha'
!print*,'strc',(strc(i,l),l=1,nae)
goto 403
endif

!print*,'sourav4'
do i5=i4+1,allp
j=5
do k=1,4
if(i5.eq.n(k))goto 404
enddo
n(5)=i5
if (j.eq.nnlp) then
i=i+1
j4=0
do j1=1,nnlp
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
!print*,(strc(i,l),l=1,nao)
goto 404
endif

do i6=i5+1,allp
j=6
do k=1,5
if(i6.eq.n(k))goto 405
enddo
n(6)=i6
if (j.eq.nnlp) then
i=i+1
j4=0
do j1=1,nnlp
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
!print*,(strc(i,l),l=1,nao)
goto 405
endif

do i7=i6+1,allp
j=7
do k=1,6
if(i7.eq.n(k))goto 406
enddo
n(7)=i7
if (j.eq.nnlp) then
i=i+1
j4=0
do j1=1,nnlp
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
goto 406
endif

do i8=i7+1,allp
j=8
do k=1,7
if(i8.eq.n(k))goto 407
enddo
n(8)=i8
if (j.eq.nnlp) then
i=i+1
j4=0
do j1=1,nnlp
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
goto 407
endif

do i9=i8+1,allp
j=9
do k=1,8
if(i9.eq.n(k))goto 408
enddo
n(9)=i9
if (j.eq.nnlp) then
i=i+1
j4=0
do j1=1,nnlp
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
goto 408
endif

do i10=i9+1,allp
j=10
do k=1,9
if(i10.eq.n(k))goto 409
enddo
n(10)=i10
if (j.eq.nnlp) then
i=i+1
j4=0
do j1=1,nnlp
do j2=1,2
j4=j4+1
strc(i,j4)=num(ii,n(j1))
enddo
enddo
j2=0
do j3=1,bonds*2
j2=j3+j4
strc(i,j2)=strct(ii,j3)
enddo
goto 409
endif

409 enddo
408 enddo
407 enddo
406 enddo
405 enddo
404 enddo
403 enddo
402 enddo
401 enddo
399 enddo
endif
if(bonds.eq.0)j2=j4
!do j1=ll+1,i
!print*,'strccc',j1,(strc(j1,i2),i2=1,j2)
!enddo

if(nlast.ne.0)then
do j1=ll+1,i
l=0
do i3=1,allp
do i2=1,nnlp*2,2
!print*,'strcnum',strc(j1,i2),num(ii,i3)
if(strc(j1,i2).eq.num(ii,i3))goto 439
enddo
l=l+1
num1(l)=num(ii,i3)
439 enddo
!print*,'num1',(num1(i1),i1=1,l)

do i2=1,l
j=1
nn(1)=num1(i2)
if(nlast.eq.j)then
j5=j5+1
l4=0
do l2=1,j2
istrc(j5,l2)=strc(j1,l2)
enddo
do l2=j2+1,nae
l4=l4+1
istrc(j5,l2)=nn(l4)
enddo
!print*,'istrc',(istrc(j5,l2),l2=1,nae)
goto 501
endif

do i3=i2+1,l
j=2
nn(2)=num1(i3)
if(nlast.eq.j)then
j5=j5+1
l4=0
do l2=1,j2
istrc(j5,l2)=strc(j1,l2)
enddo
do l2=j2+1,nae
l4=l4+1
istrc(j5,l2)=nn(l4)
enddo
goto 502
endif

do i4=i3+1,l
j=3
nn(3)=num1(i4)
if(nlast.eq.j)then
j5=j5+1
l4=0
do l2=1,j2
istrc(j5,l2)=strc(j1,l2)
enddo
do l2=j2+1,nae
l4=l4+1
istrc(j5,l2)=nn(l4)
enddo
goto 503
endif

do i5=i4+1,l
j=4
nn(4)=num1(i5)
if(nlast.eq.j)then
j5=j5+1
l4=0
do l2=1,j2
istrc(j5,l2)=strc(j1,l2)
enddo
do l2=j2+1,nae
l4=l4+1
istrc(j5,l2)=nn(l4)
enddo
goto 504
endif


do i6=i5+1,l
j=5
nn(5)=num1(i6)
if(nlast.eq.j)then
j5=j5+1
l4=0
do l2=1,j2
istrc(j5,l2)=strc(j1,l2)
enddo
do l2=j2+1,nae
l4=l4+1
istrc(j5,l2)=nn(l4)
enddo
goto 505
endif


do i7=i6+1,l
j=6
nn(6)=num1(i7)
if(nlast.eq.j)then
j5=j5+1
l4=0
do l2=1,j2
istrc(j5,l2)=strc(j1,l2)
enddo
do l2=j2+1,nae
l4=l4+1
istrc(j5,l2)=nn(l4)
enddo
goto 506
endif


506 enddo
505 enddo
504 enddo
503 enddo
502 enddo
501 enddo


enddo
endif

ll=i
enddo
if(nlast.ne.0)then
alstr=j5

strc(x,y)=0


do i1=1,alstr
do k4=1,nae
strc(i1,k4)=istrc(i1,k4)
enddo
enddo
endif

!print*,'j5j5',j5
if (nnlp.ne.0) alstr=i
if (nlast.ne.0) alstr=j5
!do i1=1,alstr
!print*,(strc(i1,k4),k4=1,nae)
!enddo



endif



990 format(30I3)

!!!!!!! new structures generation part ends !!!!!!!!!!!!!!!!!!!!!!!


write(7,902)'number of lone pairs=',nnlp
write(7,*)'                              '
do i=1,alstr
do i1=1,nae
!print*,'sourav1',i,i1,alstr,nae,nlp
fullionstr(i,i1)=strc(i,i1)+niao
enddo
!print*,'fullionstr',i,(fullionstr(i,i1),i1=1,nae)
enddo
deallocate(strc)

!do j1=1,rns
!print*,j1,')',(allionstr(j1,j2),j2=1,nae)
!enddo
!print*,'***********************************'
d=nao
e=nao-nnlp
f=d-e
elporb=nae-nnlp*2
c=factorial(d)/(factorial(e)*factorial(f))
call wigner(elporb,wig2)

d=0
e=0
f=0
d=nao-nnlp
e=nae-2*nnlp
f=(nao-nnlp)-(nae-2*nnlp)
c1=factorial(d)/(factorial(e)*factorial(f))
perm_nstr=wig2*c1*c
write(7,307)' You have ',alstr,' ionic structures of the &
set of ',nnlp,' lone pair'
write(7,307)'among which',wig2*c1*c,'  structures are permissible mathematically'
write(7,*)'*******************************************************************&
*************************'
307 format(2x,a,I7,a,I3,a)
if(symm.eq.1)then

if(sig_sym_flg.eq.1)call symmetry_cal_sig(nlp,fullionstr,alstr,symsc,symq,nssym)
if(sig_sym_flg.ne.1)call symmetry_cal_pi(nlp,fullionstr,alstr,symsc,symq,nssym)

nnn=0
do ijk=nssym,1,-1
do j2=1,alstr
if(symq(j2).eq.ijk)then
nnn=nnn+1
if(niao.eq.0)then
write(7,900),'ion structure',nnn,')',qulsym(j2),(fullionstr(j2,j1),j1=1,nao-nlp+nlp*2)
endif
if(niao.ne.0)then
write(7,901),'ion structure',nnn,')',qulsym(j2),1,':',niao,(fullionstr(j2,j1),j1=1,nao-nlp+nlp*2)
endif
endif
210 enddo
write(7,*)'******************************************************'
enddo
else
do j2=1,alstr
if(niao.eq.0)then
write(7,903),'ion structure',j2,')',(fullionstr(j2,j1),j1=1,nao-nlp+nlp*2)
endif
if(niao.ne.0)then
write(7,904),'ion structure',j2,')',1,':',niao,(fullionstr(j2,j1),j1=1,nao-nlp+nlp*2)
endif
enddo
write(7,*)'******************************************************'
endif
900 format(a,I5,a,x,I3,3x,30(I5))
901 format(a,I5,a,x,I3,3x,I3,x,a,I3,30(I5))
903 format(a,I5,a,x,30(I5))
904 format(a,I5,a,x,I3,x,a,I3,30(I5))

902 format(30x,a,x,I5)


write(7,*)''
write(7,*)'--------------------------------------------------------------------------'
write(7,*)''

jj=alstr
nos=i
nofs=jjj
is=jj
write(10,*)
write(23,*)
write(10,*)'----------------  Ionic Structures  -------------'
write(23,*)'----------------  Ionic Structures  -------------'
write(10,312),perm_nstr,' ionic structures of ',nnlp,' lone pair'
write(23,312),perm_nstr,' ionic structures of ',nnlp,' lone pair'
write(10,913),'IAB','NNB','SBB','fqual'
write(23,913),'IAB','NNB','SBB','fqual'
913 format(x,a,x,a,x,a,x,a)

if(perm_nstr.eq.is.or.nfset.ne.0) call str_selection(fullionstr,nnlp,alstr,perm_nstr)
if(perm_nstr.ne.is.and.nfset.eq.0)then

230 format(a,20I5)
!do i=1,nstr7
!print*,(str5(i,j),j=1,nae)
!enddo
do i=1,nstr7
ll=0
do j=nlp*2+1,nae-nlast,2
ll=ll+1
str_p(i,ll)=prime_num(str5(i,j))*prime_num(str5(i,j+1))
enddo
if(nlast.ne.0)then
do j=nae-nlast+1,nae
ll=ll+1
str_p(i,ll)=prime_num(str5(i,j))
enddo
endif
enddo
strbn=ll

!do i=1,nstr7
!print*,(str_p(i,j),j=1,strbn)
!enddo

do i=1,jj
ll=0
do j=nnlp*2+1,nae-nlast,2
ll=ll+1
ion_str_p(i,ll)=prime_num(fullionstr(i,j))*prime_num(fullionstr(i,j+1))
space(i)=ion_str_p(i,ll)
enddo
if(nlast.ne.0)then
do j=nae-nlast+1,nae
ll=ll+1
ion_str_p(i,ll)=prime_num(fullionstr(i,j))
space(i)=space(i)*prime_num(fullionstr(i,j))
enddo
endif
istrbn=ll
enddo

!do i=1,jj
!print*,i,(ion_str_p(i,j),j=1,istrbn),space(i)
!enddo

lll=0
llll=0
do i=1,jj
do i1=1,nstr7
ll=0
do i3=1,istrbn
do i2=1,strbn
!print*,ion_str_p(i,i3),str_p(i1,i2)
if(ion_str_p(i,i3).eq.str_p(i1,i2))then
ll=ll+1
goto 721
endif
enddo
721 enddo
if(ll.eq.istrbn)then
lll=lll+1
covris(lll)=i
goto 717
endif
enddo 
717 enddo 

llll=0
do i=1,jj
do i1=1,lll
if(i.eq.covris(i1))goto 718
enddo
llll=llll+1
covnris(llll)=i
!print*,'covnris(llll)',llll,covnris(llll)
718 enddo

ll=0
do i=lll+1,lll+llll
ll=ll+1
covris(i)=covnris(ll)
enddo

do i=1,lll+llll
!print*,'1111111111',i
ll=0
if(space(covris(i)).ne.0)then
!print*,'iiiiisourav',i
do i1=i,lll
l2=0
do i2=1,nnlp*2,2
do i3=1,nnlp*2,2
if(fullionstr(covris(i),i2).eq.fullionstr(covris(i1),i3))l2=l2+1
enddo
enddo

if(space(covris(i)).eq.space(covris(i1)).and.l2.eq.nnlp)then
ll=ll+1
strn(ll)=covris(i1)
do j=1,nae
str3(ll,j)=fullionstr(covris(i1),j)
enddo
!print*,i1,ll,space(covris(i1)),(str3(ll,j),j=1,nae)
if(i.ne.i1)space(covris(i1))=0
endif

enddo
!print*,'wig2',wig2,ll,llll
if(ll.eq.wig2)then
call quality_factor(nnlp,str3,ll,quality_fac,str_quality_1,str_quality_2,bondq)
do m119=1,ll
if(niao.eq.0)then
write(10,800),str_quality_1(m119),bondq(m119),str_quality_2(m119)&
,quality_fac(m119),'|',(str3(m119,m20),m20=1,nae)
endif
if(niao.gt.1)then
write(10,801),str_quality_1(m119),bondq(m119),str_quality_2(m119)&
,quality_fac(m119),'|',1,':',niao,(str3(m119,m20),m20=1,nae)
endif
if(niao.eq.1)then
write(10,809),str_quality_1(m119),bondq(m119),str_quality_2(m119)&
,quality_fac(m119),'|',1,1,(str3(m119,m20),m20=1,nae)
endif
enddo
else
l=0
do i1=1,llll
!print*,'space(covris(i)),covnris(i1)',i1,space(covris(i)),space(covnris(i1))
l2=0
do i2=1,nnlp*2,2
do i3=1,nnlp*2,2
if(fullionstr(covris(i),i2).eq.fullionstr(covnris(i1),i3))l2=l2+1
enddo
enddo
if(space(covris(i)).eq.space(covnris(i1)).and.l2.eq.nnlp)then
l=l+1
ll=ll+1
strn(ll)=covnris(i1)
do j=1,nae
str4(l,j)=fullionstr(covnris(i1),j)
enddo
do j=1,nae
str3(ll,j)=fullionstr(covnris(i1),j)
enddo
!print*,'str3ll',ll,covnris(i1),(str3(ll,j),j=1,nae)
if(i.ne.i1+lll)space(covris(lll+i1))=0
endif
enddo

!do i1=1,ll
!print*,'str3',(str3(i1,j),j=1,nae)
!enddo



if(ll.eq.totistr)then
if(l.gt.1) call quality_factor(nnlp,str4,l,quality_fac,str_quality_1,str_quality_2,bondq)
if(l.gt.1) call qult_str_arrange(nnlp,str4,l,quality_fac,str2,q_fac)
l1=0
do i1=l+1,ll
l1=l1+1
do j=1,nae
str3(i1,j)=str2(l1,j)
enddo
enddo
call quality_factor(nnlp,str3,ll,quality_fac,str_quality_1,str_quality_2,bondq)
call vector_rep(nnlp,str3,ll,fvec)
call write_xmi_new_2(nnlp,wig2,str3,ll,q_fac,quality_fac,fvec) 
endif
endif
endif
enddo

endif

312 format(I3,x,a,x,I3,x,a)
 enddo

tnis=nofs

800 format(I3,2x,I3,2x,I3,2x,I3,x,a,x,25I4)
801 format(I3,2x,I3,2x,I3,2x,I3,x,a,x,I2,a,I2,x,25I4)
809 format(I3,2x,I3,2x,I3,2x,I3,x,a,x,I3,I3,x,25I4)

deallocate(strct)
deallocate(istrc)
deallocate(n)
deallocate(nn)
deallocate(num)
deallocate(num1)

print*,'exit ion_struc'

return
end subroutine ion_struc

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
function factorial(n)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::i,j,n
real*8::factorial

!print*,'enter factorial'
!print*,'n,n
j=1
do i=n,1,-1
j=j*i
enddo
factorial=j
!print*,'fact',j

n=0
!print*,'exit factorial'
return
end function factorial
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
function dfactorial(n)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::i,j,n
real*8::dfactorial

!print*,'enter dfactorial'
!print*,'n,n
j=1
do i=n,1,-2
j=j*i
enddo
dfactorial=j
!print*,'fact',j

n=0
print*,'exit dfactorial'
return
end function dfactorial

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine wigner(nnae,wig2)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!! This subroutine calculates the number of permisible structures by wigner's
!!! theorem
use commondat
implicit none

integer::wig2,nm,s,i,j,k,l,b,m,nnae
real*8::a,factorial,ss


!print*,'enter wigner2'
j=0
m=mod(nnae,2)
if(m.eq.1)then
ss=0.5
a=2.0*ss+1.0
do i=1,nnae,2
j=j+1
enddo
k=j+1
l=j-1
wig2=a*factorial(nnae)/(factorial(k)*factorial(l))
endif

if(m.eq.0)then
if(mult.eq.1)s=0
if(mult.eq.3)s=1
b=2*s+1
k=(nnae/2)+1+s
l=(nnae/2)-s

wig2=b*factorial(nnae)/(factorial(k)*factorial(l))
endif


return
end subroutine wigner
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine close_file
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

close(7)

end subroutine close_file

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine write_rumer_xmi(nl,str,nstr,rumer,rumer_rad,q_fac)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none
common/quality/str_quality_1,str_quality_2,bondq,tqlty,bqlty,sqlty,tnqs,nssym,qulsym,symq,&
sigsym,tnqs_sig

integer::i,i7,nstr,m19,m20,nl,rumer(15000),rumer_rad(15000),q_fac(15000),str_quality_1(15000),bondq(150000),allrum,&
str(15000,20),str_quality_2(15000),tqlty,bqlty,sqlty,tnqs,nssym,qulsym(15000),symq(15000),col(1000),sigsym(15000),tnqs_sig&
,rumstr(500,20)
real*8::ovlp
Double Precision::D(1000)

print*,'enter write_rumer_xmi',nstr
allrum=1
tqlty=0
bqlty=0
sqlty=0
i7=0
do m19=1,nstr
if(rumer(m19)*rumer_rad(m19).eq.1)then
i7=i7+1
col(i7)=m19
do m20=1,nae
rumstr(i7,m20)=str(m19,m20)
enddo
if(nfset.eq.3.or.nfset.eq.5)goto 200
if(niao.eq.0)then
write(10,914),str_quality_1(m19),bondq(m19),str_quality_2(m19),'|',(str(m19,m20),m20=1,nae)
endif
if(niao.gt.1)then
write(10,915),str_quality_1(m19),bondq(m19),str_quality_2(m19),'|',1,':',niao,(str(m19,m20),m20=1,nae)
endif
if(niao.eq.1)then
write(10,916),str_quality_1(m19),bondq(m19),str_quality_2(m19),'|',1,1,(str(m19,m20),m20=1,nae)
endif
tqlty=tqlty+str_quality_1(m19)
bqlty=bqlty+bondq(m19)
sqlty=sqlty+str_quality_2(m19)
endif
200 enddo
open(unit=31,file='Rumer_Sets.dat',status='unknown')
if(allrum.eq.1)call All_Rumer_set(rumstr,i7,nl)
if(nfset.eq.5)stop
if(nfset.eq.3)goto 201
if(ovopt.eq.1)then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(10,912)'Overlap of this set of the structures =',1.0-ovlp
endif
write(10,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty

!write(10,910)'intra bond quality','sym break quality','nnbond quality'
!write(10,911),tqlty,sqlty,bqlty


914 format(I3,x,I3,x,I3,x,a,x,25I4)
915 format(I3,x,I3,x,I3,x,a,x,I1,a,I1,x,25I4)
916 format(I3,x,I3,x,I3,x,a,x,I3,I3,x,25I4)
910 format(a,a,I3,x,a,I3,x,a,I3)
912 format(a,3x,F10.3)
!910 format(a,x,a,x,a,x,a)
!911 format(15x,I3,7x,I3,7x,I3)
print*,'exit write_rumer_xmi'
    
!201 close(21)
201 return
end subroutine write_rumer_xmi
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

subroutine All_Rumer_set(rumstr,setno,nlonep)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!! N! number of Runmer set generates here 
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

common/orb1/orbs1,rstr,nlpr
integer::j,i,i1,i2,i3,i4,i5,i6,i7,i8,i9,i10,i11,i12,i13,i14,n1,k,nlpr
integer::setno,nlonep,rstr(500,20),permutation(100),orbs1(20),orbs2(20),rumstr(500,20)

nlpr=nlonep
print*,'enter All_Rumer_set',setno
do i=1,setno
do i1=1,nae
rstr(i,i1)=rumstr(i,i1)
enddo
enddo
i=0
do j=nlonep*2+1,nae
i=i+1
orbs2(i)=rumstr(1,j)
enddo
n1=i

!print*,'orns_rum',(orbs2(i),i=1,n1)

i=100
do j=1,n1
if(orbs2(j).lt.i)i=orbs2(j)
enddo

orbs1(1)=i
k=1
do j=1,20
i=i+1
!print*,i
do i1=1,n1
if(i.eq.orbs2(i1))then
k=k+1
orbs1(k)=i
print*,i
endif
enddo
enddo
!print*,(orbs1(i),i=1,n1)

j=0
do i1=1,n1
permutation(1)=orbs1(i1)

do i2=1,n1
if(permutation(1).eq.orbs1(i2))goto 201
permutation(2)=orbs1(i2)
if(n1.eq.2)then
j=j+1
call rumer(permutation,n1,j,setno,nlpr)
goto 201
endif

do i3=1,n1
do i=1,2
if(permutation(i).eq.orbs1(i3))goto 202
enddo
permutation(3)=orbs1(i3)
if(n1.eq.3)then
j=j+1
call rumer(permutation,n1,j,setno,nlpr)
goto 202
endif

do i4=1,n1
do i=1,3
if(permutation(i).eq.orbs1(i4))goto 203
enddo
permutation(4)=orbs1(i4)
if(n1.eq.4)then
j=j+1
call rumer(permutation,n1,j,setno,nlpr)
goto 203
endif

do i5=1,n1
do i=1,4
if(permutation(i).eq.orbs1(i5))goto 204
enddo
permutation(5)=orbs1(i5)
if(n1.eq.5)then
j=j+1
call rumer(permutation,n1,j,setno,nlpr)
goto 204
endif

do i6=1,n1
do i=1,5
if(permutation(i).eq.orbs1(i6))goto 205
enddo
permutation(6)=orbs1(i6)
if(n1.eq.6)then
j=j+1
call rumer(permutation,n1,j,setno,nlpr)
goto 205
endif
do i7=1,n1
do i=1,6
if(permutation(i).eq.orbs1(i7))goto 206
enddo
permutation(7)=orbs1(i7)
if(n1.eq.7)then
j=j+1
call rumer(permutation,n1,j,setno,nlpr)
goto 206
endif

do i8=1,n1
do i=1,7
if(permutation(i).eq.orbs1(i8))goto 207
enddo
permutation(8)=orbs1(i8)
if(n1.eq.8)then
j=j+1
call rumer(permutation,n1,j,setno,nlpr)
goto 207
endif

do i9=1,n1
do i=1,8
if(permutation(i).eq.orbs1(i9))goto 208
enddo
permutation(9)=orbs1(i9)
if(n1.eq.9)then
j=j+1
call rumer(permutation,n1,j,setno,nlpr)
goto 208
endif

do i10=1,n1
do i=1,9
if(permutation(i).eq.orbs1(i10))goto 209
enddo
permutation(10)=orbs1(i10)
if(n1.eq.10)then
j=j+1
call rumer(permutation,n1,j,setno,nlpr)
goto 209
endif

do i11=1,n1
do i=1,10
if(permutation(i).eq.orbs1(i11))goto 210
enddo
permutation(11)=orbs1(i11)
if(n1.eq.11)then
j=j+1
call rumer(permutation,n1,j,setno,nlpr)
goto 210
endif
210 enddo
209 enddo
208 enddo
207 enddo
206 enddo
205 enddo
204 enddo
203 enddo
202 enddo
201 enddo
200 enddo
print*,'exit All_Rumer_set'

return
end subroutine All_Rumer_set
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine rumer(permutation,n,j,setno,nl)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!! All the Rumer sets are written in the file "Rumer_Sets.dat" varified
!! with the subroutine "Rumer_set_id" and then written in the file
!! "Rumer_Sets_all.dat" with full format of the output.
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none
common/orb1/orbs1,rstr,nlonep

integer::permutation(100),n,i,i1,i2,j,orbs1(20),rstr(500,20),setno,m20,m19,rstr1(2000,20),nlonep
Double Precision::bond_rum(10000,100),bond_rum1(10000,100),k1,k2
integer::l,ll,jj,nl,rum_count(10000),set_num(100),Rid

!totrum=j
Rumwrite=0
do i=1,setno
do i1=1,nlonep*2
rstr1(i,i1)=rstr(i,i1)
enddo
enddo

print*,'enter rumer'
do i=1,setno
do i1=1,nae
do i2=1,n
if(rstr(i,i1).eq.orbs1(i2))then
!write(21,*),i2,rstr(i,i1),orbs1(i2),permutation(i2)
rstr1(i,i1)=permutation(i2)
!write(21,*),i1,rstr(i,i1)
endif
enddo
enddo
enddo


if(j.eq.1)then
jj=0
goto 103
endif
call Rumer_set_id(rstr1,setno,nlonep,Rid,set_num) 
if(Rid.eq.1)goto 100



103 jj=jj+1

write(31,*)'set number',jj,(permutation(i),i=1,n),setno
write(23,*)'permutation',jj,'>',(permutation(i),i=1,n)
write(23,*)'*****************************************************'
write(23,*)
do m19=1,setno
write(31,914),(rstr1(m19,m20),m20=1,nae)
if(nfset.eq.5)write(10,915),1,':',niao,(rstr1(m19,m20),m20=1,nae)
!if(niao.eq.0)then
!write(23,914),(rstr1(m19,m20),m20=1,nae)
!endif
if(niao.gt.1)then
!write(23,915),1,':',niao,(rstr1(m19,m20),m20=1,nae)
!write(10,915),q_fac(m19),1,':',niao,(str(m19,m20),m20=1,nae)
endif
!if(niao.eq.1)then
!write(23,916),1,1,(rstr1(m19,m20),m20=1,nae)
!endif
enddo
!write(23,*)
if(nfset.eq.5)write(10,*)'set number',jj

900 format(a,I3,10I5)

914 format(x,25I4)
915 format(x,I1,a,I3,x,25I4)
916 format(x,I3,I3,x,25I4)
print*,'exit rumer'
totrum=jj
print*,'totrum',totrum
!stop
100 return
end subroutine rumer

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine rumer_structures(nl,str,nstr,rumer,rumer_rad)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::kk,k2,k3,k4,k5,k6,k7,k8,k9,nl,nstr,rum,rum1,rum2,rum3,rum4,rrad(100),rrad1,x,y
integer::str(15000,20),rumer(15000),rumer_rad(15000),rumer1(15000,100),rumer2(15000,100)

print*,'enter rumer_structures'

do k6=1,15000
rumer(k6)=0
rumer_rad(k6)=0
enddo
do k3=1,15000
do k6=1,100
rumer1(k3,k6)=0
enddo
enddo
do k3=1,nstr
do k6=1,nae-nl*2-nlast
do k7=nl*2+1,nae-nlast
do k8=1,k6
if(rumer1(k3,k8).eq.str(k3,k7))goto 389
enddo
if(str(k3,k7).gt.rumer1(k3,k6))then
rumer1(k3,k6)=str(k3,k7)
!print*,'**',rumer1(k3,k6)
endif
389 enddo
enddo
enddo
do k3=1,15000
do k6=1,100
rumer2(k3,k6)=0
enddo
enddo

231 format(20I3)
do k3=1,nstr
k7=0
do k6=nae-nl*2-nlast,1,-1
k7=k7+1
rumer2(k3,k7)=rumer1(k3,k6)

!print*,rumer2(k3,k7)
enddo
enddo
do k3=1,nstr
print*,'**',(rumer2(k3,k6),k6=1,nae-nl*2-nlast)
enddo
do k6=1,15000
rumer(k6)=0
enddo
!print*,'k7',k7
do k9=1,nstr
!write(*,231),(str(k9,k6),k6=1,nae)
rum=0
do k6=nl*2+1,nae-nlast,2
do k2=1,k7
k8=k6
if(str(k9,k8).eq.rumer2(k9,k2))rum1=k2
enddo
do k2=1,k7
k8=k6+1
if(str(k9,k8).eq.rumer2(k9,k2))rum2=k2
enddo

do k5=k6+2,nae-nlast,2
do k2=1,k7
k8=k5
if(str(k9,k8).eq.rumer2(k9,k2))rum3=k2
enddo
do k2=1,k7
k8=k5+1
if(str(k9,k8).eq.rumer2(k9,k2))rum4=k2
enddo

if((rum1-rum3)*(rum1-rum4)*(rum2-rum3)*(rum2-rum4).gt.0)then

rum=rum+1
endif
enddo
enddo
kk=0
do k6=1,((nae-nl*2-nlast)/2)-1
kk=kk+k6
enddo

!print*,'rum1,rum2,rum',rum1,rum2,rum
if(rum.eq.kk)then
rumer(k9)=1
!print*,'rumer(k9)',rumer(k9)
endif
enddo

do k6=1,15000
rumer_rad(k6)=1
enddo
if(nlast.ne.0)then
do k3=1,15000
do k6=1,100
rumer2(k3,k6)=0
rumer1(k3,k6)=0
enddo
enddo
do k3=1,nstr
do k6=1,nae-nl*2
do k7=nl*2+1,nae
do k8=1,k6
if(rumer1(k3,k8).eq.str(k3,k7))goto 390
enddo
if(str(k3,k7).gt.rumer1(k3,k6))then
rumer1(k3,k6)=str(k3,k7)
!print*,rumer1(k6)
endif
390 enddo
enddo
enddo
do k3=1,15000
do k6=1,100
rumer2(k3,k6)=0
enddo
enddo
do k3=1,15000
k7=0
do k6=nae-nl*2,1,-1
k7=k7+1
rumer2(k3,k7)=rumer1(k3,k6)

enddo
enddo

do k9=1,nstr
rum=0
do k6=nae-nlast+1,nae
do k2=1,k7
!print*,str(k9,k6),rumer2(k9,k2)
if(str(k9,k6).eq.rumer2(k9,k2))rrad(k6)=k2
enddo
enddo
do k6=nl*2+1,nae-nlast,2
do k2=1,k7
k8=k6
if(str(k9,k8).eq.rumer2(k9,k2))rum1=k2
enddo
do k2=1,k7
k8=k6+1
if(str(k9,k8).eq.rumer2(k9,k2))rum2=k2
enddo
do k4=nae-nlast+1,nae
!print*,'rrad,rum1,rum2',rrad(k4),rum1,rum2
if((rrad(k4)-rum1)*(rrad(k4)-rum2).gt.0)then
rum=rum+1
endif
enddo
enddo
if(rum.lt.((nae-nlast-nl*2)/2)*nlast)then
rumer_rad(k9)=0
!print*,'rumer_rad(k9)',rumer_rad(k9)
endif
enddo


endif

print*,'exit rumer_structures'
return
end subroutine rumer_structures
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine sym_check(nl,str2,n,sym_str_sl,sym_str_num,numsymset)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

common/quality/str_quality_1,str_quality_2,bondq,tqlty,bqlty,sqlty,tnqs,nssym,qulsym,symq,&
sigsym,tnqs_sig

logical :: fileexists
character(len=35)::inputfilename
integer::i,i1,i2,i3,i4,i5,i6,i7,i8,l,l1,m,bnd,n,nl,numsymset,nsymset,nsymstr,str6(100,20),str2(15000,20)
integer::str_quality_1(15000),str_quality_2(15000),bondq(150000),tqlty,bqlty,sqlty,tnqs,nssym,sym_check_flg,&
qulsym(15000),symq(15000),sigsym(15000),tnqs_sig,sym_str_sl1(1000,100),sym_str_sl(1000,100),sym_str_num(1000),&
sym_str_num1(1000),val,stc

print*, 'enter sym_check'
inputfilename='sym_str_set.dat'
INQUIRE(FILE=TRIM(inputfilename),EXIST=fileexists)
IF (fileexists) THEN
open(unit=43,file='sym_str_set.dat',status='unknown')
ELSE
PRINT*,'SORRY sym_str_set.dat file does not exist'
print*,'please write the file: at the top need to mention the number of sets and then number of structures in each sets'
print*,'please leave a empty line after each segment'
stop
ENDIF



read(43,*)nsymset,nsymstr
stc=0
bnd=(nae-nl*2-nlast)/2

101 do i=1,nsymset
read(43,*)
do i2=1,numsymset
do i4=1,sym_str_num(i2)
sym_str_sl1(i2,i4)=sym_str_sl(i2,i4)
enddo
enddo
do i1=1,nsymstr
read(43,*)(str6(i1,i2),i2=1,nae)
do i3=1,n
m=0
do i4=nl*2+1,nl*2+bnd*2,2
do i7=nl*2+1,nl*2+bnd*2,2
l=0
do i5=i4,i4+1
do i8=i7,i7+1
if(str6(i1,i5).eq.str2(i3,i8))then
l=l+1
goto 109
endif
enddo
109 enddo
if(l.eq.2)then
m=m+1
goto 111
endif
enddo
goto 112
111 enddo
if(m.eq.bnd)then
do i2=1,numsymset
do i4=1,sym_str_num(i2)
if(sym_str_sl1(i2,i4).eq.i3)then
sym_str_sl1(i2,i4)=0
endif
enddo
enddo
endif
112 enddo
enddo

do i2=1,1000
sym_str_num1(i2)=0
enddo

do i2=1,numsymset
do i4=1,sym_str_num(i2)
if(sym_str_sl1(i2,i4).ne.0)val=1
if(sym_str_sl1(i2,i4).eq.0)val=0
sym_str_num1(i2)=sym_str_num1(i2)+val
enddo
enddo

!do i2=1,numsymset
!print*,sym_str_num1(i2),sym_str_num(i2)
!enddo

!do i3=1,numsymset
!do i2=1,sym_str_num(i)
!write(*,200),i,')',(str2(sym_str_sl(i3,i2),i4),i4=1,nae)
!enddo
!enddo

sym_check_flg=1
do i2=1,numsymset
if(sym_str_num(i2)-sym_str_num1(i2).ne.0.and.sym_str_num(i2)-sym_str_num1(i2).ne.sym_str_num(i2))then
sym_check_flg=0
goto 114
endif
enddo
114 do i3=1,nsymstr
write(10,202)(str6(i3,i2),i2=1,nae)
enddo
if(sym_check_flg.eq.1)then
stc=stc+1
write(10,201)'set',i,'is symmetric'
endif
if(sym_check_flg.eq.0)write(10,201)'set',i,'is not symmetric'
write(10,*)

enddo
write(10,*),'Total number of symmetric sets =',stc

200 format (I2,a,2x,20I3)
201 format (a,I5,2x,a)
202 format (20I3)

!do i2=1,numsymset
!print*,(sym_str_sl(i2,i3),i3=1,sym_str_num(i2))
!enddo
!print*,'******************'
!do i2=1,numsymset
!do i3=1,sym_str_num(i2)
!print*,i2,sym_str_sl(i2,i3),(str2((sym_str_sl(i2,i3)),i4),i4=1,nae)
!enddo
!enddo

print*, 'exit sym_check'
stop
end subroutine sym_check
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine qult_str_arrange(nl,str2,n,q_fac,str1,q_fac1)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

common/quality/str_quality_1,str_quality_2,bondq,tqlty,bqlty,sqlty,tnqs,nssym,qulsym,symq,&
sigsym,tnqs_sig

integer::i1,i5,i6,i7,l,l1,k,m,bnd,nsymstr,ll,nstsymset,sym_str_num_final(50000),sym_str_qual(50000)
integer::sym_str_sl(50000,1000),sym_str_sl1(50000),sym_str_sl_final(50000,1000),nn,sll,&
sym_str_num(50000),sym_str_num1(50000),val,mq_fac,msymq,mloopsymsc,ind,qfac_comb(15000),j1,sl
integer::i,i2,i3,i4,i9,m16,m18,m19,q_fac(15000),q_fac1(15000),k6,k7,k8,k9,st_ct(15000),st_ct1(150000),ii,kk
integer::str1(15000,20),str2(15000,20),n,jj,j,nqul1,nl,iii,x,y,z,iij,i8,q_cnt(10000),fq_fac(15000)&
,str_quality_1(15000),str_quality_2(15000),bondq(150000),sigsym(15000),tnqs_sig&
,tqlty,bqlty,sqlty,tnqs,nssym,qulsym(15000),symq(15000),symq_final(15000),ij,ijk,qt,qtg,q,noqt&
,mat(100,100),cnt(15000),qt_max,q_max,lll,sym_str_qual1(50000,1000),str_cnt1(50000),nssym1,mm
integer::shorting_mat(10,15000)
integer,dimension(:,:),allocatable::str3
integer,dimension(:),allocatable::qual4,qual3,str_cnt,q_fac2,bdq,bdq1,qul1
integer,dimension(:),allocatable::stq1,stq2,stq3,stq4,sl_num,sl_qfac,q_fac3

!set_order desides if the symmetric sets arranged according to quality or size
! set_order=0 means quality
! set_order=1 means  smaller to larger sets
! set_order=2 means larger to smaller sets
print*,'set_order',set_order
!stop
print*,'enter qult_str_arrange,symm',symm
x=50000
y=20
z=50000

allocate(q_fac2(x))
allocate(qul1(x))
allocate(qual3(x))
allocate(qual4(x))
allocate(bdq(x))
allocate(bdq1(x))
allocate(str_cnt(z))
allocate(stq1(x))
allocate(stq2(x))
allocate(stq3(x))
allocate(stq4(x))
allocate(str3(x,y))
allocate(sl_num(x))
allocate(sl_qfac(x))
allocate(q_fac3(x))

q_fac2(x)=0
qul1(x)=0
qual3(x)=0
qual4(x)=0
bdq(x)=0
bdq1(x)=0
str_cnt(z)=0
stq1(x)=0
stq2(x)=0
stq3(x)=0
stq4(x)=0
!str3(x,y)=0
sl_num(x)=0
sl_qfac(x)=0
q_fac3(x)=0


do i=1,15000
st_ct1(i)=0
enddo

print*,'nstrtIIIIIIIIIIIIIIIII',nstrt

jj=1
do m19=1,n
write(*,231),'str2:qarng',m19,(str2(m19,m18),m18=1,nae),q_fac(m19),symq(m19)
!print*,'str2',m19,q_fac(m19)
if(m19.eq.1)qul1(1)=q_fac(1)
j=jj
do i=1,j
if(qul1(i).eq.q_fac(m19))goto 373
enddo
jj=jj+1
qul1(jj)=q_fac(m19)
!print*,'qul1',qul1(jj)
373 enddo
nqul1=jj

print*,'nqul1',nqul1


do k6=1,15000
qual3(k6)=0
enddo

print*,'check1'
do k6=1,nqul1
do k7=1,nqul1
do k8=1,k6
if(qual3(k8).eq.qul1(k7))goto 389
enddo
if(qul1(k7).gt.qual3(k6))then
qual3(k6)=qul1(k7)
print*,'**',qual3(k6)
endif
389 enddo
enddo
print*,'check2'

k7=0
do k6=jj,1,-1
k7=k7+1
qual4(k7)=qual3(k6)
enddo

print*,'check3'

do m18=1,15000
do m19=1,nae
str1(m18,m19)=0
enddo
enddo

print*,n,noqult
!!!!! for the non-symmetric system .. if user dont want to take the symmetry in the calculations !!!!!!!!! 
if(symm.eq.0)then
i4=0
do m18=1,nqul1
do m19=1,n
!print*,q_fac(m19),qult(m18)
if(q_fac(m19).eq.qual4(m18))then 
i4=i4+1
do i3=1,nae
str1(i4,i3)=str2(m19,i3)
enddo
q_fac1(i4)=q_fac(m19)
stq1(i4)=str_quality_1(m19)
stq2(i4)=str_quality_2(m19)
bdq(i4)=bondq(m19)
!lfst1(i4)=lfst(m19)
endif
enddo
enddo


endif

!do m18=1,n
!print*,'sourav1',m18,(str2(m18,m19),m19=1,nae),qulsym(m18),symq(m18),q_fac(m18),tnqs,nssym,nqul1
!enddo

!!!!! for the symmetric system .. if user opted to take the symmetry calculations !!!!!!!!! 
if(symm.ne.0)then
!!do i=1,n
!!print*,'i,qfac',i,q_fac(i),symq(i)
!!enddo
!!
!!print*,'check3'
!!ind=0
!!do i=1,n
!!if(ind.lt.q_fac(i))ind=q_fac(i)
!!enddo
!!mq_fac=ind
!!
!!ind=0
!!do i=1,n
!!if(ind.lt.symq(i))ind=symq(i)
!!enddo
!!msymq=ind
!!
ind=0
do i=1,n
if(ind.lt.loopsymsc(i))ind=loopsymsc(i)
enddo
mloopsymsc=ind
!!print*,'mq_fac,msymq,mloopsymsc',mq_fac,msymq,mloopsymsc
do i=1,n
print*,'qqqqqqqqqqqqqqqqqqq',q_fac(i),symq(i),loopsymsc(i)
enddo

do j=1,n
  do i=1,4
  shorting_mat(i,j)=0
  enddo
enddo

do j=1,n
i=2
shorting_mat(i,j)=shorting_mat(i,j)+q_fac(j)
!print*,'shorting_mat_loop',shorting_mat(i,j),q_fac(j)
i=3
shorting_mat(i,j)=shorting_mat(i,j)+loopsymsc(j)
i=4
shorting_mat(i,j)=shorting_mat(i,j)+symq(j)
enddo

do j=1,n
print*,'shorting_mat',(shorting_mat(i,j),i=1,4)
enddo

noqt=1
do i=2,4
  if(shorting_mat(i,1).gt.0)then
  noqt=noqt+1
  endif
enddo

!print*,'noqt noqt',noqt
!do i=1,n
!print*,'shorting_mat',(shorting_mat(j,i),j=1,noqt)
!enddo

if(noqt.gt.2)then
  do i=2,noqt-1
  qt_max=1
    do j=1,n
      if(qt_max.lt.shorting_mat(i+1,j))qt_max=shorting_mat(i+1,j)
!if (i.eq.3)print*,'loop',qt_max,shorting_mat(i+1,j)
    enddo
print*,'qt_max,i',qt_max,i
    do j=1,n
      shorting_mat(i+1,j)=qt_max*(shorting_mat(i,j)-1)+shorting_mat(i+1,j)
!print*,'qt_max*(shorting_mat(i,j)-1)+shorting_mat(i+1,j)',shorting_mat(i+1,j)
    enddo
!if(i.eq.2)then
  qt_max=1
    do j=1,n
      if(qt_max.lt.shorting_mat(i+1,j))qt_max=shorting_mat(i+1,j)
!if (i.eq.3)print*,'loop',qt_max,shorting_mat(i+1,j)
    enddo
print*,'sourav_qt_max',qt_max,n
print*,'noqt noqt',noqt
do i1=1,n
print*,'shorting_mat middle',i,(shorting_mat(j,i1),j=1,noqt)
enddo
m=1
nn=0
do i1=1,qt_max
if(nn.eq.1) then
m=m+1
nn=0
endif
do j=1,n
if(i1.eq.shorting_mat(i+1,j))then
nn=1
!print*,'shorting_mat(i+1,j)',shorting_mat(i+1,j)
shorting_mat(i+1,j)=m
!qfac_comb(j)=m
!print*,'mm,j,shorting',m,j,qfac_comb(j)
endif
enddo
enddo
!endif
  enddo
endif

print*,'noqt noqt',noqt
do i=1,n
print*,'shorting_mat',(shorting_mat(j,i),j=1,noqt)
enddo

do i=1,n
qfac_comb(i)=shorting_mat(4,i)
if(qfac_comb(i).eq.0)then
print*,'ii',i
stop
endif
enddo

ind=0
do i=1,n
if(ind.lt.qfac_comb(i))ind=qfac_comb(i)
enddo
mq_fac=ind
print*,'mq_fac',mq_fac

!do j=1,n
!!fq_fac(j)=shorting_mat(noqt,j),noqt=1,4)
!print*,'fq_fac',qfac_comb(j)
!!print*,'fq_fac',fq_fac(j)
!enddo

bnd=(nae-nl*2-nlast)/2
print*,'bnd',bnd
m=0
ll=0
mm=0
301 do i=1,mq_fac
!print*,'iiiii',i
!if(mloopsymsc.ne.0)then
!do k=1,mloopsymsc
!print*,'i,k',i,k
!do j=1,msymq
!print*,'i,k,j',i,k,j
lll=1
l=0
ll=ll+1
do i1=1,n
!print*,'i1',i1
do i2=1,mm
if(str_cnt1(i2).eq.i1)goto 307
enddo
if(qfac_comb(i1).eq.i)then
!if(loopsymsc(i1).eq.k)then
!if(symq(i1).eq.j)then
lll=0
m=m+1
mm=mm+1
l=l+1
!print*,'mmmmm1, ',m,i1,i,j,ll,loopsymsc(i1)

str_cnt1(mm)=i1
sym_str_sl(ll,l)=i1
sym_str_qual(ll)=q_fac(i1)
sym_str_qual1(ll,l)=q_fac(i1)
!endif
!endif
endif
307 enddo
!print*,'sourav out side of the loop'
!if(lll.eq.0)sym_str_num(ll)=l
sym_str_num(ll)=l

!if(lll.eq.1)ll=ll-1
if(m.eq.n)then

print*,'mmmm',m,n
nssym1=ll
goto 101
endif
!enddo
!enddo
!endif
!if(mloopsymsc.eq.0)then
!!do j=1,msymq
!lll=1
!l=0
!ll=ll+1
!do i1=1,n
!do i2=1,mm
!if(str_cnt1(i2).eq.i1)goto 407
!enddo
!if(q_fac(i1).eq.i)then
!if(symq(i1).eq.j)then
!lll=0
!m=m+1
!mm=mm+1
!print*,'mmmmm2',m,i1,i,j,ll,loopsymsc(i1)
!l=l+1
!
!str_cnt1(mm)=i1
!sym_str_sl(ll,l)=i1
!sym_str_qual(ll)=q_fac(i1)
!sym_str_qual1(ll,l)=q_fac(i1)
!endif
!endif
!407 enddo
!if(lll.eq.0)sym_str_num(ll)=l
!
!if(lll.eq.1)ll=ll-1
!if(m.eq.n)then
!
!nssym1=ll
!goto 101
!endif
!!enddo
!endif
enddo
print*,'check4',m,n
goto 301

101 print*,'nssym1',nssym1
ll=0
do i2=1,nssym1
ll=ll+sym_str_num(i2)
!print*,(sym_str_sl(i2,i3),i3=1,sym_str_num(i2))!,'|',(sym_str_qual1(i2,i3),i3=1,sym_str_num(i2)),'|',sym_str_qual(i2)
print*,'sym_str_qual1',(sym_str_qual1(i2,i3),i3=1,sym_str_num(i2)),'|',sym_str_qual(i2)
enddo
print*,'total num str',ll

if(symtype.eq.'check')then
call sym_check(nl,str2,n,sym_str_sl,sym_str_num,nssym1)
endif

nstsymset=0
ll=0
if(nstrt.ne.0)then
do i1=1,nstrt
print*,(strt_struc(i1,i5),i5=1,nae)
do i3=1,n
!print*,'i3333',i3
m=0
do i4=nl*2+1,nl*2+bnd*2,2
do i7=nl*2+1,nl*2+bnd*2,2
l=0
do i5=i4,i4+1
do i8=i7,i7+1
!print*,'str6,str2',str6(i1,i5),str2(i3,i8)
if(strt_struc(i1,i5).eq.str2(i3,i8))then
l=l+1
goto 109
endif
enddo
109 enddo
!print*,'llll',l
if(l.eq.2)then
m=m+1
goto 111
endif
enddo
goto 112
111 enddo
!print*,'mmmm',m,bnd
if(m.eq.bnd)then
!print*,'i3i3i3',i3
do i2=1,nssym1
do i4=1,sym_str_num(i2)
if(sym_str_sl(i2,i4).eq.i3)then
ll=ll+1
sym_str_sl1(ll)=i2
print*,'sym_str_sl1(ll)',sym_str_sl1(ll)
endif
enddo
enddo
endif
112 enddo
enddo
!!!! nstsymset=number of starting symmetry set
nstsymset=ll

print*,'ll',ll,sym_str_sl1(1)

ll=0
do i2=1,nssym1
write(*,*),'sym_str_sl',(sym_str_sl(i2,i3),i3=1,sym_str_num(i2))
enddo
print*,'total num str',ll

do i4=1,nstsymset
do i3=1,sym_str_num(sym_str_sl1(i4))
sym_str_sl_final(i4,i3)=sym_str_sl(sym_str_sl1(i4),i3)
enddo
sym_str_num_final(i4)=sym_str_num(sym_str_sl1(i4))
enddo 

!i9=0
!do i4=1,nstsymset
!do i3=1,sym_str_num(sym_str_sl1(i4))
!i9=i9+1
!str_cnt(i9)=sym_str_sl(sym_str_sl1(i4),i3)
!symq_final(i9)=symq(sym_str_sl(sym_str_sl1(i4),i3))
!do j=1,nae
!str1(i9,j)=str2(sym_str_sl(sym_str_sl1(i4),i3),j)
!enddo
!q_fac1(i9)=q_fac(sym_str_sl(sym_str_sl1(i4),i3))
!stq1(i9)=str_quality_1(sym_str_sl(sym_str_sl1(i4),i3))
!stq2(i9)=str_quality_2(sym_str_sl(sym_str_sl1(i4),i3))
!bdq(i9)=bondq(sym_str_sl(sym_str_sl1(i4),i3))
!enddo
!enddo



endif

l=0
!ll=0
!lll=0
print*,'nssym1',nssym1
do i=1,10000
do i2=1,nssym1
!if(nstrt.ne.0)then
!do i4=1,nstsymset
!if(i2.eq.sym_str_sl1(i4))goto 115
!enddo
!endif
if(sym_str_qual(i2).eq.i)then
l=l+1
sym_str_num_final(l)=sym_str_num(i2)
!lll=lll+sym_str_num_final(l)
!print*,'all steps',sym_str_num_final(l),lll
do i3=1,sym_str_num(i2)
!ll=ll+1
sym_str_sl_final(l,i3)=sym_str_sl(i2,i3)
enddo
!print*,'lll,sym_str_sl_final',l,(sym_str_sl_final(l,i3),i3=1,sym_str_num_final(l))
endif
115 enddo
enddo
!print*,'lllllllll',ll,lll
!endif

if(set_order.eq.1.or.set_order.eq.2)then
print*,'bigger,smaller'
do l=1,nssym1
sym_str_num(l)=sym_str_num_final(l)
do i3=1,sym_str_num(l)
sym_str_sl(l,i3)=sym_str_sl_final(l,i3)
enddo
enddo

endif


!!!bigger set is going top
if(set_order.eq.2)then
print*,'bigger set is going top'
l=ll
do i=10000,1,-1
do i2=1,nssym1
!if(nstrt.ne.0)then
!do i4=1,nstsymset
!if(i2.eq.sym_str_sl1(i4))goto 113
!enddo
!endif
if(sym_str_num(i2).eq.i)then
l=l+1
sym_str_num_final(l)=sym_str_num(i2)
do i3=1,sym_str_num(i2)
sym_str_sl_final(l,i3)=sym_str_sl(i2,i3)
enddo
endif
113 enddo
enddo
endif


!!!smaller sets is going top
if(set_order.eq.1)then
print*,'smaller sets is going top'
l=ll
do i=1,10000
do i2=1,nssym1
!if(nstrt.ne.0)then
!do i4=1,nstsymset
!if(i2.eq.sym_str_sl1(i4))goto 114
!enddo
!endif
if(sym_str_num(i2).eq.i)then
l=l+1
sym_str_num_final(l)=sym_str_num(i2)
do i3=1,sym_str_num(i2)
sym_str_sl_final(l,i3)=sym_str_sl(i2,i3)
enddo
endif
114 enddo
enddo

endif
!
!
!!print*,'*********************************'
!!print*,'sourav is here',nssym1
!ll=0
!do i2=1,nssym1
!ll=ll+sym_str_num_final(i2)
!!write(*,906),(sym_str_sl_final(i2,i3),i3=1,sym_str_num_final(i2))
!!!print*,'lll,sym_str_sl_final',l,(sym_str_sl_final(l,i3),i3=1,sym_str_num_final(l))
!enddo
!print*,'total str',ll
!906 format (50I5)
!stop

!l=0
i9=0
do i1=1,nssym1
!l=l+sym_str_num_final(i1)
!print*,'i1i1',i1,l
do i2=1,sym_str_num_final(i1)
i9=i9+1
!print*,'i2i2',i2,sym_str_num_final(i1),i9
str_cnt(i9)=sym_str_sl_final(i1,i2)
do j=1,nae
str1(i9,j)=str2(sym_str_sl_final(i1,i2),j)
enddo
q_fac1(i9)=i1
!q_fac1(i9)=q_fac(sym_str_sl_final(i1,i2))
stq1(i9)=str_quality_1(sym_str_sl_final(i1,i2))
stq2(i9)=str_quality_2(sym_str_sl_final(i1,i2))
bdq(i9)=bondq(sym_str_sl_final(i1,i2))
enddo
enddo

print*,'i9i9i9',i9
!stop
do i9=1,n
write(*,231),'str2str2',i9,(str1(i9,m18),m18=1,nae),q_fac1(i9),bdq(i9)
enddo
231 format(a,30I4)
endif
do i=1,n
str_quality_1(i)=stq1(i)
str_quality_2(i)=stq2(i)
bondq(i)=bdq(i)
enddo

do i=1,n
write(*,231),'symmstr',i,(str1(i,m18),m18=1,nae),q_fac1(i),bdq(i),str_quality_1(i),str_quality_2(i)
enddo

if(nstrt.ne.0.and.symm.eq.1)then
do j=1,n
do k=1,nstrt
if(nl.ne.0)then
sl=0
do i=1,nl*2,2
do i1=1,nl*2,2
if(str1(j,i).eq.strt_struc(k,i1))then
sl=sl+1
endif
enddo
enddo
if (sl.eq.nl)goto 372
goto 471
endif

372 sll=0
do i=nl*2+1,nae-nlast,2
do i1=nl*2+1,nae-nlast,2
sl=0
do i3=i,i+1
do i4=i1,i1+1
if(str1(j,i3).eq.strt_struc(k,i4))then
sl=sl+1
if(sl.eq.2)then
sll=sll+1
goto 473
endif
endif
enddo
enddo
enddo
473 enddo
if(sll.eq.(nae-nlast-nl*2)/2)goto 374
goto 471

374 if(nlast.ne.0)then
sl=0
do i=nae-(nlast-1),nae
do i1=nae-(nlast-1),nae
if(str1(j,i).eq.strt_struc(k,i1))then
sl=sl+1
endif
enddo
enddo
if(sl.eq.nlast)goto 375
goto 471
endif

375 sl_qfac(k)=q_fac1(j)
print*,'sl_qfac',sl_qfac(k)
471 enddo
enddo

do i=1,nstrt
print*,'sl_qfac(i)',sl_qfac(i)
enddo

stop

j1=0
l=0
do j=1,n
do i=1,nstrt
if(sl_qfac(i).eq.q_fac1(j))then
l=l+1
sl_num(l)=j
goto 376
endif
j1=j1+1
do i1=1,nae
str3(j1,i1)=str1(j,i1)
enddo
q_fac3(j1)=q_fac1(j)
stq1(j1)=str_quality_1(j)
stq2(j1)=str_quality_2(j)
bdq(j1)=bondq(j)
376 enddo
enddo
do j=1,n
do i=1,l
if(sl_num(i).ne.j)goto 377
j1=j1+1
do i1=1,nae
str3(j1,i1)=str1(j,i1)
enddo
q_fac3(j1)=q_fac1(j)
stq1(j1)=str_quality_1(j)
stq2(j1)=str_quality_2(j)
bdq(j1)=bondq(j)
377 enddo
enddo

do j=1,n
print*,'rearranged',(str3(j,i1),i1=1,nae)
enddo
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!! below part works when user wish to have some structures always in the top of the list !!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!


!stop

!allocate(str3(x,y))
str3(x,y)=0

if(nstrt.ne.0.and.symm.eq.0)then
jj=0
if(nl.ne.0)then
jj=0
do i3=1,nstrt
ii=0
do i=1,nl*2,2 
do i2=1,nl*2,2
if(strt_struc(i3,i).eq.str1(1,i2))then
ii=ii+1
endif
enddo
enddo
if(ii.eq.nl)then
jj=jj+1
st_ct(jj)=i3
endif
enddo
endif

print*,'***********nl,jj***************',nl,jj
if(jj.ne.0)then
kk=0
do i=1,n
!print*,'str1',(str1(i,m19),m19=1,nae)
do k8=1,jj
iii=0
k9=st_ct(k8)
!print*,'strt_struc',(strt_struc(k9,m19),m19=1,nae)
do i2=nl*2+1,nae-nlast,2
do k6=nl*2+1,nae-nlast,2
ii=0
do i4=i2,i2+1
do i3=k6,k6+1
!print*,'k9,i3,i4,strt_struc(k9,i3),str1(n,i4)',k9,i3,i4,strt_struc(k9,i3),str1(n,i4)
if(strt_struc(k9,i3).eq.str1(i,i4))then
ii=ii+1
!print*,'ii',ii
endif
enddo
enddo
if(ii.eq.2)then
iii=iii+ii
!print*,'ii,iii**',ii,iii,nae-nl*2-nlast
if(iii.eq.nae-nl*2-nlast)then
kk=kk+1
st_ct1(kk)=i
!print*,'st_ct1(kk)',st_ct1(kk)
if(kk.eq.jj)goto 340
goto 360
endif
goto 350
endif
enddo
350 enddo
enddo
360 enddo


340 jj=0
do i=1,kk
jj=jj+1
do m18=1,nae
str3(jj,m18)=str1(st_ct1(i),m18)
enddo
q_fac2(jj)=q_fac1(st_ct1(i))
stq3(jj)=stq1(st_ct1(i))
stq4(jj)=stq2(st_ct1(i))
bdq1(jj)=bdq(st_ct1(i))
enddo

do i=1,n
do i2=1,kk
if(i.eq.st_ct1(i2))goto 370
enddo
jj=jj+1
do m18=1,nae
str3(jj,m18)=str1(i,m18)
enddo
q_fac2(jj)=q_fac1(i)
stq3(jj)=stq1(i)
stq4(jj)=stq2(i)
bdq1(jj)=bdq(i)
370 enddo

print*,'souravooooo'
do i=1,n
q_fac1(i)=0
str_quality_1(i)=0
str_quality_2(i)=0
bondq(i)=0
do i2=1,nae
str1(i,i2)=0
enddo
enddo

do i=1,n
q_fac1(i)=q_fac2(i)
str_quality_1(i)=stq3(i)
str_quality_2(i)=stq4(i)
bondq(i)=bdq1(i)
do i2=1,nae
str1(i,i2)=str3(i,i2)
enddo
enddo

endif


if(nl.eq.0)then
kk=0
do i=1,n
!print*,'str1',(str1(i,m19),m19=1,nae)
do k9=1,nstrt
iii=0
print*,'strt_struc',(strt_struc(k9,m19),m19=1,nae)
do i2=1,nae-nlast,2
do k6=1,nae-nlast,2
ii=0
do i4=i2,i2+1
do i3=k6,k6+1
!print*,'k9,i3,i4,strt_struc(k9,i3),str1(n,i4)',k9,i3,i4,strt_struc(k9,i3),str1(n,i4)
if(strt_struc(k9,i3).eq.str1(i,i4))then
ii=ii+1
!print*,'ii',ii
endif
enddo
enddo
if(ii.eq.2)then
iii=iii+ii
!print*,'ii,iii**',ii,iii,nae-nl*2-nlast
if(iii.eq.nae-nlast)then
kk=kk+1
st_ct1(kk)=i
!print*,'st_ct1(kk)',st_ct1(kk)
if(kk.eq.nstrt)goto 341
goto 361
endif
goto 351
endif
enddo
351 enddo
enddo
361 enddo


341 jj=0
do i=1,kk
jj=jj+1
do m18=1,nae
str3(jj,m18)=str1(st_ct1(i),m18)
enddo
q_fac2(jj)=q_fac1(st_ct1(i))
stq3(jj)=stq1(st_ct1(i))
stq4(jj)=stq2(st_ct1(i))
bdq1(jj)=bdq(st_ct1(i))
enddo

do i=1,n
do i2=1,kk
if(i.eq.st_ct1(i2))goto 371
enddo
jj=jj+1
do m18=1,nae
str3(jj,m18)=str1(i,m18)
enddo
q_fac2(jj)=q_fac1(i)
stq3(jj)=stq1(i)
stq4(jj)=stq2(i)
bdq1(jj)=bdq(i)
371 enddo

print*,'souravooooo'
do i=1,n
q_fac1(i)=0
str_quality_1(i)=0
str_quality_2(i)=0
bondq(i)=0
do i2=1,nae
str1(i,i2)=0
enddo
enddo

do i=1,n
q_fac1(i)=q_fac2(i)
str_quality_1(i)=stq3(i)
str_quality_2(i)=stq4(i)
bondq(i)=bdq1(i)
do i2=1,nae
str1(i,i2)=str3(i,i2)
enddo
enddo

endif


endif

do m18=1,n
Print*,'str1*******',m18,(str1(m18,m19),m19=1,nae),q_fac1(m18),bondq(m18)
!,str_quality_1(m18),str_quality_2(m18),bondq(m18),qulsym(m18),symq(m18)
!print*,'q_fac1',q_fac1(m18)
enddo

print*,'end of quality str arrange'
!do i=1,kk
!print*,'st_ct1(kk)',st_ct1(i),kk
!enddo
!print*,'i4',i4
deallocate(str3)
deallocate(q_fac2)
deallocate(qul1)
deallocate(qual3)
deallocate(qual4)
deallocate(bdq)
deallocate(bdq1)
deallocate(str_cnt)
deallocate(stq1)
deallocate(stq2)
deallocate(stq3)
deallocate(stq4)
!deallocate(str3)
deallocate(sl_num)
deallocate(sl_qfac)
deallocate(q_fac3)
print*,'exit qult_str_arrange,symm',symm

stop
return
end subroutine qult_str_arrange
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine prio_rad_str(nl,str1,ncqs,pref_radical)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::i,j,i3,i4,i5,i6,i7,ii,m16,m17,m18,m19,m23,nl,ncqs,qual2(15000),qul1(15000),&
qul2(15000),jj,nqul1,nqul2,qt,qual3(15000),qual4(15000),k6,k7,k8,pref_radical(15000)
integer::str1(15000,20),qual1(15000),qcs_serial(15000),q_fac(15000)

!!!!! starting the arrangement of the structures according to priority radicles!!!


print*,'enter prio_rad_str'
do i=1,15000
!pref_radical(i)=2
pref_radical(i)=nlast+1
enddo

!print*,'nlpset',nlpset
if(nlpset.eq.0)goto 102
do i5=1,nlpset
ii=0
do i=1,nl*2,2
!print*,'i',i
do j=1,nl
if(plpair(i5,j).eq.str1(1,i))then
ii=ii+1
endif
enddo
enddo
!print*,'ii',ii
if(ii.ne.nl) goto 103
if(ii.eq.nl)then
jj=i5
if(plpair(i5,nl+1).ne.0.)goto 100
if(plpair(i5,nl+1).eq.0.)goto 102
endif
103 enddo
goto 101
!102 print*,'i51',jj,plpair(i5,nl+1)


!102 print*,'sourav'
102 do i=1,ncqs
!print*,'sourav1',(str1(i,i4),i4=1,nae)
do j=1,prad
!print*,'norad',norad(j)
ii=0
do i3=1,norad(j)
do i4=nae-nlast+1,nae
if(str1(i,i4).eq.prio_rad(j,i3))then
ii=ii+1
endif
enddo
enddo
if(ii.eq.norad(j))then
pref_radical(i)=pref_radical(i)-1
!print*,'pref_radical(i)',pref_radical(i)
endif
enddo
enddo

!print*,'sourav2'
if(nlpset.eq.0)goto 101
100 if(plpair(jj,nl+1).eq.0) goto 101


do i=1,ncqs
do j=nl+1,lp(jj)
i7=plpair(jj,j)
ii=0
do i3=1,norad(i7)
do i4=nae-nlast+1,nae
if(str1(i,i4).eq.prio_rad(i7,i3))then
ii=ii+1
endif
enddo
enddo
!print*,'norad(i7)',norad(i7)
if(ii.eq.norad(i7))then
pref_radical(i)=pref_radical(i)-1
endif
enddo
enddo

!101 enddo


!101 do m19=1,ncqs
!!print*,'pref_rad',pref_radical(m19)
!write(*,231),m19,(str1(m19,i4),i4=1,nae)
!enddo
231 format(30I3)

print*,'exit prio_rad_str'

101 return
end subroutine prio_rad_str
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine main_bond_str(nl,str1,ncqs,qual1,qual2,str2,q_fac)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::jj,nl,str1(15000,15),str2(15000,15),ncqs,qual1(15000),qual2(15000),i,j,k,l &
,qul2(15000),qul1(15000),q_fac(15000),nqul,m19,k6,k7,k8,nqul1,nqul2,qt,qtg &
,qual3(15000),qual4(15000)

print*,'enter main_bond_str'
!do i=1,ncqs
!write(*,231)qual1(i),qual2(i),(str1(i,j),j=1,nae)
!enddo

jj=1
do m19=1,ncqs
!print*,'q_fac2',q_fac(m19)
if(m19.eq.1)qul1(1)=qual1(1)
j=jj
do i=1,j
if(qul1(i).eq.qual1(m19))goto 373
enddo
jj=jj+1
qul1(i)=qual1(m19)
!print*,'qul',qul(i)
373 enddo
nqul1=jj

jj=1
do m19=1,ncqs
!print*,'q_fac2',q_fac(m19)
if(m19.eq.1)qul2(1)=qual2(1)
j=jj
do i=1,j
if(qul2(i).eq.qual2(m19))goto 374
enddo
jj=jj+1
qul2(i)=qual2(m19)
!print*,'qul',qul(i)
374 enddo
nqul2=jj

do k6=1,15000
qual3(k6)=0
qual4(k6)=0
enddo

do k6=1,nqul1
do k7=1,nqul1
do k8=1,k6
if(qual3(k8).eq.qul1(k7))goto 389
enddo
if(qul1(k7).gt.qual3(k6))then
qual3(k6)=qul1(k7)
!print*,'**',qul1(k6)
endif
389 enddo
enddo

do k6=1,nqul2
do k7=1,nqul2
do k8=1,k6
if(qual4(k8).eq.qul2(k7))goto 399
enddo
if(qul2(k7).gt.qual4(k6))then
qual4(k6)=qul2(k7)
!print*,'**',qul1(k6)
endif
399 enddo
enddo

do k6=1,15000
qul1(k6)=0
qul2(k6)=0
enddo

k7=0
do k6=nqul1,1,-1
k7=k7+1
qul1(k7)=qual3(k6)
enddo

k7=0
do k6=nqul2,1,-1
k7=k7+1
qul2(k7)=qual4(k6)
enddo

k=0
qt=0
qtg=1
do m19=1,nqul1
!do j=((nae-(nl*2+nlast))/2)+1,1,-1
do j=1,nqul2
if(qtg.ne.k)qt=qt+1
qtg=k
!print*,'jjj',j
do i=1,ncqs
!print*,'qul,q_fac',qul(m19),q_fac(i),nqul
if(qul1(m19).ne.qual1(i))goto 100
!if(qual2(i).eq.j-1)then
if(qual2(i).eq.qul2(j))then
k=k+1
do l=1,nae
str2(k,l)=str1(i,l)
enddo
!write(*,231)(str2(k,k7),k7=1,nae)
q_fac(k)=qt
!print*,qt
endif
100 enddo
enddo
enddo

!do i=1,nqs
!write(*,231)(str2(i,j),j=1,nae)
!enddo
231 format(20I3)
print*,'exit main_bond_str'

return
end subroutine main_bond_str
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine main_bond_cal(nl,str1,ncqs,mbondq)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::m19,m18,i1,i2,i3,i4,i5,i6,i7,i8,i9,ii,iii,iiii,nl,ncqs
integer::nn(10),str1(15000,20),mbondq(15000)

print*,'enter main_bond_cal'
do i1=1,15000
mbondq(i1)=1+(nae-nl*2-nlast)/2
enddo

!!do i1=1,6
!!write(*,231)(main_bond(i1,i2),i2=1,nmbond(i1))
!!enddo
!i4=0
!do i1=1,ncqs
!!write(*,231)(str1(i1,i2),i2=1,nae)
!i8=1
!if(nl.ne.0)then
!do i3=1,nlpset
!ii=0
!do i6=1,nl*2
!do i4=1,lp
!!print*,'plpair',plpair(i3,i4)
!if(str1(i1,i6).eq.plpair(i3,i4))then
!ii=ii+1
!endif
!enddo
!enddo
!if(ii.eq.nl*2)then
!i8=i3
!!print*,'iiii88888',i8
!goto 529
!endif
!678 enddo
!goto 527
!endif


do i1=1,ncqs
i9=0
do i3=1,100
bond_count(i1,i3)=0
enddo
iiii=1+(nae-nl*2-nlast)/2
do i3=1+nl*2,(nae-nlast),2
i9=0
nn(1)=0
nn(2)=0
do i4=1,nmbond*2,2
i9=i9+1
iii=0
do i5=i3,i3+1
do i7=i4,i4+1
!print*,str1(i1,i5),main_bond(i8,i7),i7,i8
if(str1(i1,i5).eq.main_bond(i7))then
!print*,'***********',str1(i1,i5),main_bond(i8,i7)
iii=iii+1
!print*,'iii',iii
if(mod(i5,2).eq.0) nn(2)=i5
if(mod(i5,2).eq.1) nn(1)=i5
endif
enddo

enddo
if(iii.ne.2) goto 517
iiii=iiii-1
bond_count(i1,i9)=bond_count(i1,i9)+1
517 enddo
enddo
mbondq(i1)=iiii
!print*,'iiii',iiii
enddo

do i1=1,ncqs
write(*,231)i1,(str1(i1,i2),i2=1,nae),mbondq(i1)
write(*,231)(bond_count(i1,i2),i2=1,nmbond)
enddo
231 format (30I3)

print*,'exit main_bond_cal'
return
end subroutine main_bond_cal
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!subroutine nnat_bond_loop(k1,k2,new_mat,nrow)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!implicit none 
!
!integer::i,i1,j,k1,k1,nrow,new_mat(10,10)
!
!do i=1,k1
!do i1=1,k2
!
!enddo
!enddo
!
!end subroutine nnat_bond_loop
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine symmetry_cal_pi(nl,str1,ncqs,stsymsc,symq,nssym)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
use commondat1
implicit none

common/ats/atsymset,nsym,syn,at_sym
common/loops/full_nn_group,fullgrp,natom,nelimt,sl_group,tot_orb,nn_group

integer::m19,m18,i,i1,i2,i3,i4,i5,i6,i7,i8,ii,iii,iiii,nl,ncqs,k,k1,k2,n1,n2,n3,n4,n5,n6,l6,&
nd,fullgrp,k3,k4,k5,k6,k7,k8,k9,k10,k11,k12,k13,k14,k15,k16,k17,k18,k19,k20,k21,k22,k23,k24,&
k25,k26,k27,n,j1,j2,j3,j4,j5,j6,j7,j8,j9,j10,nssym,j,jj,nn1,nn2,kkk,n11,n12,n17,n18,n9,l,b3,b4
integer::nnat_bond_new(100,2),tot_orb(100),nn_count(50),sig_orb(100),sig_orb_1(100),nsig,nnatom,natom
integer::kk,nscore(100),nnscore,ipnum,connectivity_row(20,20),b1,b2,l1,l2,l3,l4,nnat_bond_1(100,2)
double precision::tscore,stsymsc(15000),strscore,bd_dist,score(100,2),new_score(100,2),lpna,&
ssym(15000),order(15000)
integer::nn(10),str1(15000,20),mbondq(15000),nn_group(50,10),nelimt(50),full_nn_group(1000),&
sl_group(50,10),symq(15000),numbond,loop_score,nrow,new_mat(10,10),ncrow

integer::atsymset(20,20),nsym,syn(50),at_sym(50),loop_score_row(20),coordination_mat(20,20)
real*8::atoset_symscr(1000),piscr,losc,lone_score(15000),symq1(15000),cot(1000),sig_sym_sc(15000)&
,sym_sets(15000),n7,n8,coord_score,bndscore(20)
real::stsymsc1(15000)

print*,'enter symm_pi, symm',symm
open(unit=15,file='sympi.temp',status='unknown')

do i3=1,atom
print*,'atoset_symm_pi',(atoset(active_atoms(i3),i4),i4=1,atn(active_atoms(i3)))
enddo

do i=1,100
  do i1=1,2
    score(i,i1)=0.0
  enddo
enddo

i4=0
do i3=1,atom
  lpna=0.0
  k=i3
  if(input_flg.eq.1)then
    do i1=1,niabd
      if(k.eq.iabd(i1))then
       lpna=lpna+1.0/prime_num(2)
      print*,'lpna1',lpna
      endif
    enddo
    do i2=1,nialp
      if(k.eq.ialp(i2))then
       lpna=lpna+1.0/prime_num(1)
      print*,'lpna2',lpna
      endif
    enddo
    do i2=1,niach
      if(k.eq.iach(i2))then
       lpna=lpna+1.0/prime_num(3)
      print*,'lpna3',lpna
      endif
    enddo
  else
!  lpna=lpna+biasval(i3)+dist_nnat(i3)+atn(active_atoms(i3))/prime_num(1)
  lpna=biasval(i3)+dist_nnat(i3)
      print*,'lpna4',lpna
  endif
!   score(i3,2)=lpna+1.0/at_num(i3)
   score(i3,2)=lpna+at_num(i3)
!print*,i3,lpna,at_num(i3),score(i3,2)
enddo

!!!!!!!!!!!!!!!! coordination score start !!!!!!!!!!!!!!
do i1=1,nnnatom
print*,'nnat_bond1',(nnat_bond(i1,i2),i2=1,2)
enddo

!l1=100000
!l2=0
!do i1=1,nnnatom
!do i2=1,2
!if(nnat_bond(i1,i2).lt.l1)l1=nnat_bond(i1,i2)
!if(nnat_bond(i1,i2).gt.l2)l2=nnat_bond(i1,i2)
!enddo
!enddo
!print*,'l1,l2',l1,l2,l2-l1+1,nnnatom*2

!if(l2-l1+1.gt.nnnatom*2)then
!l3=0
!l4=0
!do i1=l1,l2
!if(l4.eq.0)l3=l3+1
!l4=1
!do i2=1,nnnatom
!do i3=1,2
!!print*,'i1,i2,i3,l3',i1,i2,i3,l3
!if(nnat_bond(i2,i3).eq.i1)then
!nnat_bond_1(i2,i3)=l3
!!print*,'i1,i2,i3,l3**',i1,i2,i3,l3
!l4=0
!endif
!enddo
!enddo
!enddo
!!endif
!k=0
!do i1=1,nnnatom
!do i2=1,nrow
!k=k+1
!do i3=1,2
!nnat_bond_1(k,i3)=new_mat(i2,i3)
!enddo
!enddo
!enddo
!
!do i1=1,nnnatom
!print*,'nnat_bond2',(nnat_bond_1(i1,i2),i2=1,2)
!enddo



!n6=0
!n7=0
!n8=0
!do i2=1,nnnatom
!do i1=1,2
!nnat_bond_new(i2,i1)=nnat_bond(i2,i1)
!enddo
!print*,(nnat_bond_new(i2,i1),i1=1,2),'|',(nnat_bond_1(i2,i1),i1=1,2)
!enddo

n5=0
do i2=1,nnnatom
do i1=1,2
do i3=1,n5
if(nnat_bond(i2,i1).eq.tot_orb(i3)) goto 531
enddo
n5=n5+1
tot_orb(n5)=nnat_bond(i2,i1)
531 enddo
enddo



!do i1=1,atom
!n5=n5+1
!tot_orb(n5)=i1+nao+niao
!enddo

do i2=1,n5
print*,'n5,tot_orb',n5,tot_orb(i2)
enddo

do i1=1,atom
n1=0
do i3=1,nnnatom
do i4=1,2
if(active_atoms(i1).eq.nnat_bond(i3,i4))then
n1=n1+1
endif
enddo
enddo
nn_count(i1)=n1
enddo
do i3=1,atom
print*,'nn_count',nn_count(i3)
enddo

print*,'atom',atom,nnnatom

m18=0
m19=0
do i3=1,n5
k=tot_orb(i3)
m19=0
do i2=1,nnnatom
do i1=1,2
!print*,'atom',k,nnat_bond_new(i2,i1)
if(k.eq.nnat_bond(i2,i1))then
if(i1.eq.1)i5=2
if(i1.eq.2)i5=1
m19=m19+1
m18=m18+1
nn_group(i3,m19)=nnat_bond(i2,i5)
print*,'nnat_bond(i2,i5)',i3,k,i2,i1,i5,m19,nnat_bond(i2,i5),nn_group(i3,m19)
sl_group(i3,m19)=m18
endif
enddo
enddo
nelimt(i3)=m19
!print*,'nelimt(i3)',nelimt(i3)
enddo

!!! 'nn_group' specify orbitals in tot_orb array are connected with which other
!!! orbitals

natom=n5
do i3=1,n5
print*,'*nn_group*',nelimt(i3),(nn_group(i3,i4),i4=1,nelimt(i3))
enddo
do i3=1,n5
print*,'*sl_group*',(sl_group(i3,i4),i4=1,nelimt(i3))
enddo

m19=0
do i3=1,n5
do i4=1,nelimt(i3)
m19=m19+1
full_nn_group(m19)=nn_group(i3,i4)
enddo
enddo
fullgrp=m19

write(*,*),'full_nn_g',m19,(full_nn_group(i3),i3=1,m19)


!!!!!!!!!!!!!!!! coordination score ends !!!!!!!!!!!!!!
do i=1,ncqs
do i3=1,atom
new_score(i3,2)=score(i3,2)
print*,'score',i,i3,score(i3,2)
enddo
print*,'*****************************************************'
write(*,233),'structures',(str1(i,i3),i3=1,nae)
233 format(a,20I3)

!! if the structures have active lone pairs and or radicals the associated atoms are being scored in 'new_score()'.
!!if(nl.ne.0)then
!!  do i2=1,nl*2,2
!!    do i3=1,atom
!!      do i4=1,atn(active_atoms(i3))
!!        if(str1(i,i2).eq.atoset(active_atoms(i3),i4))then
!!          new_score(i3,2)=new_score(i3,2)+1.0/prime_num(2)
!!        endif
!!      enddo
!!    enddo
!!  enddo
!!endif
!!
!!if(nlast.ne.0)then
!!  do i2=nae-nlast+1,nae
!!    do i3=1,atom
!!      do i4=1,atn(active_atoms(i3))
!!        if(str1(i,i2).eq.atoset(active_atoms(i3),i4))then
!!          new_score(i3,2)=new_score(i3,2)+1.0/prime_num(3)
!!        endif
!!      enddo
!!    enddo
!!  enddo
!!endif


!! Scoring of the bonds of the structures started from here
!! the score of the bond is given by the score of the atoms involeved in the bond

strscore=0.0
!ipnum=3
ipnum=0
numbond=0
do i1=1+nl*2,nae-nlast,2
tscore=0.0
n1=0
n2=0
n3=0
n4=0
n5=0
n6=0
n11=0
n12=0
n17=0
n18=0
n9=0
kkk=0
  do i2=i1,i1+1
  b1=str1(i,i1)
  b2=str1(i,i1+1)
print*,'bond between',str1(i,i1),str1(i,i1+1)
    do i3=1,atom
      do i4=1,atn(active_atoms(i3))
        if(str1(i,i2).eq.atoset(active_atoms(i3),i4))then
          if(i2.eq.i1) then
          n1=i3
          n11=active_atoms(i3)
            do k1=1,nsym
              do k2=1,syn(k1)
                if(atoset(active_atoms(i3),i4).eq.atsymset(k1,k2))then
                n3=k1
                n18=atsymset(k1,k2)
                endif
              enddo
            enddo
          endif
          if(i2.eq.i1+1) then
          n2=i3
          n12=active_atoms(i3)
            do k1=1,nsym
              do k2=1,syn(k1)
                if(atoset(active_atoms(i3),i4).eq.atsymset(k1,k2))then
                n4=k1
                n5=atsymset(k1,k2)
                endif
              enddo
            enddo
          endif
        endif
      enddo
    enddo
  enddo

!print*,'n1,n2,n3,n4',n1,n2,n3,n4
if(n3.eq.n4)then
  do k1=1,nsym
    do k2=1,syn(k1)
      if(n5.eq.atsymset(k1,k2))then
      n6=at_sym(k1)
      endif
    enddo
  enddo
!print*,'if orb similar pi or sig',n6
if(n6.eq.1)kkk=ipnum+2
if(n6.eq.2)kkk=ipnum+1
!  tscore=new_score(n1,2)+new_score(n2,2)+1.0/prime_num(kkk)
  tscore=new_score(n1,2)+new_score(n2,2)+kkk/(new_score(n1,2)+new_score(n2,2))
!print*,'score_similar',tscore,new_score(n1,2),new_score(n2,2),kkk/(new_score(n1,2)+new_score(n2,2))
endif


if(n3.ne.n4)then
  do k1=1,nsym
    do k2=1,syn(k1)
      if(n5.eq.atsymset(k1,k2))then
      n6=at_sym(k1)
      endif
    enddo
  enddo
do k1=1,nsym
  do k2=1,syn(k1)
    if(n18.eq.atsymset(k1,k2))then
     n9=at_sym(k1)
    endif
  enddo
enddo

!print*,'if orb desimilar',n6,n9
if(symtype.eq.'loose')then
  if(n6.eq.1.and.n9.eq.1)kkk=ipnum+2
    if(n6.ne.n9)kkk=ipnum+3
  endif
!print*,'kkk',kkk
if(symtype.eq.'tight')then
  if(n6.eq.1.and.n9.eq.1)then
  kkk=ipnum+3
!print*,'kkk3',kkk
  else
  if(n3.eq.1.or.n4.eq.1)kkk=ipnum+4
  if(n3.eq.2.or.n4.eq.2)kkk=ipnum+5
!print*,'kkk4,5',kkk
  endif
endif
!tscore=new_score(n1,2)+new_score(n2,2)+1.0/prime_num(kkk)
tscore=new_score(n1,2)+new_score(n2,2)+kkk/(new_score(n1,2)+new_score(n2,2))
!print*,'score_disimilar',tscore,new_score(n1,2),new_score(n2,2),kkk
endif
nnscore=0.0
nd=0

do i2=1,nactorb
  if(str1(i,i1).eq.active_orbs(i2))then
  k1=atm_nb_orbs(i2)
  endif
  if(str1(i,i1+1).eq.active_orbs(i2))then
  k2=atm_nb_orbs(i2)
  endif
enddo
tscore=tscore+dist_mat(k1,k2)
!print*,'tscore with bond length',tscore,dist_mat(k1,k2)
print*,'b1,b2****',b1,b2,atom
do i3=1,atom
do i4=1,atn(active_atoms(i3))
print*,'i3,i4,b1,atoset(i3,i4)',i3,i4,b1,atoset(active_atoms(i3),i4)
if(b1.eq.atoset(active_atoms(i3),i4))then
b3=active_atoms(i3)
endif
enddo
enddo

do i3=1,atom
do i4=1,atn(active_atoms(i3))
if(b2.eq.atoset(active_atoms(i3),i4))then
b4=active_atoms(i3)
endif
enddo
enddo

print*,'b3,b4*****',b3,b4

do i2=1,natom
if(b3.eq.tot_orb(i2))l1=i2
enddo
!print*,'l1',l1
do i2=1,nelimt(l1)
 if(b4.eq.nn_group(l1,i2))then
!n=1
!nscore(n)=prime_num(9)
!nscore(n)=0
!print*,'nscore before loop start',nscore(n)
!goto 101
loop_score=1
numbond=numbond+1
loop_score_row(numbond)=loop_score+1
coordination_mat(numbond,1)=b1
coordination_mat(numbond,2)=b2
goto 555
 endif
enddo

 call symm_loops(b3,b4,loop_score,connectivity_row,ncrow)
do i3=1,ncrow
print*,'loop_score 1',loop_score
print*,'connectivity_row',(connectivity_row(i3,i2),i2=1,loop_score)
enddo
do i3=1,ncrow
numbond=numbond+1
loop_score_row(numbond)=loop_score+1
do i2=1,loop_score+1
coordination_mat(numbond,i2)=connectivity_row(i3,i2)
enddo
bndscore(numbond)=tscore
enddo

!bndscore(numbond)=tscore
555 strscore=strscore+tscore
print*,'strscore',strscore
enddo
call coordination_val(coordination_mat,numbond,loop_score_row,bndscore,coord_score)
print*,'str_score',strscore,coord_score
stsymsc(i)=1.0/strscore+coord_score
write(15,*)stsymsc(i)
enddo

rewind(15)
do i=1,ncqs
read(15,105)stsymsc1(i)
enddo
105 format(F8.4)

jj=1
do m19=1,ncqs
if(m19.eq.1)ssym(1)=stsymsc1(1)
j=jj
do i=1,j
if(ssym(i).eq.stsymsc1(m19))goto 373
enddo
jj=jj+1
ssym(i)=stsymsc1(m19)
373 enddo
nssym=jj
print*,'nssym',nssym

do i=1,10000
order(i)=0.0
enddo

do k3=1,nssym
do k4=1,nssym
do k5=1,k3
if(order(k5).eq.ssym(k4))goto 389
enddo
if(ssym(k4).gt.order(k3))then
order(k3)=ssym(k4)
endif
389 enddo
enddo

n=0
jj=0
do i=1,nssym
jj=jj+1
do j=1,ncqs
if(order(i).eq.stsymsc1(j))then
symq(j)=jj
endif
enddo
enddo
print*,'symqsymq_pi'
do j=1,ncqs
write(*,231),j,(str1(j,k),k=1,nae),symq(j)
enddo

231 format(20I3)

CALL SYSTEM ("rm sympi.temp")

print*,'leaving symmetry_cal_pi, symm',symm
200 return
end subroutine symmetry_cal_pi
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine symmetry_cal_sig(nl,str1,ncqs,stsymsc,symq,nssym)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
use commondat1
implicit none

integer::m19,m18,i,i1,i2,i3,i4,i5,i6,i7,i8,ii,iii,iiii,nl,ncqs,k,k1,k2,n1,n2,n3,n4,n5,n6,l1,l3,l6,&
nd,fullgrp,k3,k4,k5,k6,k7,k8,k9,k10,k11,k12,k13,k14,k15,k16,k17,k18,k19,k20,k21,k22,k23,k24,&
k25,k26,k27,n,j1,j2,j3,j4,j5,j6,j7,j8,j9,j10,nssym,j,jj,nn1,nn2,kkk,n17,n18,n9,ii2,nnat_bond_new_1(100,2)
integer::nnat_bond_new(100,2),tot_orb(100),nn_count(50),sig_orb(100),sig_orb_1(100),nsig,nnatom,natom&
,nn4,nn5,nna
real*8::tscore,score(100,2),new_score(100,2),stsymsc(15000),ssym(15000),order(15000),lpna,&
losc,lone_score(15000),symq1(5000),cot(1000),sig_sym_sc(15000),sym_sets(15000),n7,n8,bd_dist
integer::kk,nscore(100),nnscore,ipnum,loop_score,loopsc,ncrow
!double precision::rscore,strscore
real*8::rscore,strscore,scr,bndscore(20),coord_score
!real::nnscore,rscore,strscore
integer::nn(10),str1(15000,20),mbondq(15000),nn_group(50,10),nelimt(50),&
full_nn_group(1000),sl_group(50,10),symq(15000),connectivity_row(20,20)
!integer::kval(1000),deadend(20)
integer::atsymset(20,20),nsym,syn(50),at_sym(50),numbond,numbond1,loop_score_row(20),coordination_mat(20,20)
real*8::atoset_symscr(1000),piscr
real::stsymsc1(15000)

common/ats/atsymset,nsym,syn,at_sym
common/loops/full_nn_group,fullgrp,natom,nelimt,sl_group,tot_orb,nn_group
print*,'enter symmetry_cal_sig, symm',symm
!! iabd--> inactive bonds associated with the atoms
!! ialp--> inactive lone pairs associated with the atoms
!! score()--> scoring of the atoms depending on the the 'iabd', 'ialp' and atomic number (at_number)
open(unit=15,file='symsig.temp',status='unknown')

do k1=1,nsym
print*,'at_sym(k1)',at_sym(k1)
enddo



!do i3=1,atom
!print*,'atoset_symm_sig',(atoset(active_atoms(i3),i4),i4=1,atn(active_atoms(i3)))
!print*,'active_atoms',active_atoms(i3)
!enddo


do i=1,100
do i1=1,2
score(i,i1)=0.0
enddo
enddo

print*,'prime_num',prime_num(2)
i4=0
do i3=1,atom
!lpna=prime_num(1)
lpna=0.0
k=i3
!k=active_atom(i3)
if(input_flg.eq.1)then
do i1=1,niabd
if(k.eq.iabd(i1))then
lpna=lpna+1.0/prime_num(2)
print*,'lpna',lpna,prime_num(2)
endif
enddo
!print*,'rajat roy',nialp
do i2=1,nialp
if(k.eq.ialp(i2))then
!print*,'rajat'
lpna=lpna+1/prime_num(1)
endif
enddo
do i2=1,niach
if(k.eq.iach(i2))then
!print*,'rajat'
lpna=lpna+1/prime_num(3)
endif
enddo
else

!lpna=lpna+biasval(i3)+dist_nnat(i3)+atn(active_atoms(i3))/prime_num(1)
lpna=lpna+biasval(i3)+dist_nnat(i3)
endif
!score(i3,2)=lpna+1.0/prime_num(at_num(i3))
!score(i3,2)=lpna+1.0/at_num(i3)
score(i3,2)=lpna+at_num(i3)
print*,'score:symme',score(i3,2),at_num(i3),biasval(i3),dist_nnat(i3)
enddo



print*,'symmetry_cal',nnnatom
n6=0
n7=0
n8=0
do i2=1,nnnatom
do i1=1,2
nnat_bond_new(i2,i1)=nnat_bond(i2,i1)+nao+niao
enddo
print*,(nnat_bond_new(i2,i1),i1=1,2),'|',(nnat_bond(i2,i1),i1=1,2)
enddo
n5=0
do i2=1,nnnatom
do i1=1,2
do i3=1,n5
if(nnat_bond_new(i2,i1).eq.tot_orb(i3)) goto 537
enddo
n5=n5+1
tot_orb(n5)=nnat_bond_new(i2,i1)
537 enddo
enddo
!n5=0
!do i1=1,atom
!n5=n5+1
!tot_orb(n5)=i1+nao+niao
!enddo

do i1=1,atom
n1=0
do i3=1,nnnatom
do i4=1,2
if(active_atoms(i1).eq.nnat_bond(i3,i4))then
!if(i1.eq.nnat_bond(i3,i4))then
n1=n1+1
endif
enddo
enddo
nn_count(i1)=n1
enddo
do i3=1,atom
print*,'nn_count',nn_count(i3)
enddo



! do i3=1,atom
!print*,'active_atom',i3,active_atoms(i3)
! do i4=1,atn(active_atoms(i3))
!print*,'atn',i4,atn(active_atoms(i3))
!print*,'atn(i3),syn(2)',syn(nsym),(atsymset(nsym,k2),k2=1,syn(nsym))
!enddo
!enddo

do i3=1,atom
print*,'atoset',(atoset(i3,i4),i4=1,atn(i3))
enddo


print*,'atom:atom',atom
n2=nnnatom
n4=0
n3=0
n6=0
 do i3=1,atom
print*,'iiiiiiiiiiiiiiiiiiii33333333333',i3
n1=0
do i4=1,atn(active_atoms(i3))
! do i4=1,atn(i3)
!print*,'atn**',i4,atn(active_atoms(i3))
 do k2=1,syn(nsym)
!print*,'atn(i3),syn(2)',atn(active_atoms(i3)),syn(nsym),atsymset(nsym,k2)
 if(atoset(active_atoms(i3),i4).eq.atsymset(nsym,k2))then
! if(atoset(i3,i4).eq.atsymset(nsym,k2))then
n1=n1+1
n6=n6+1
!sig_orb(n1)=atoset(i3,i4)
sig_orb(n1)=atoset(active_atoms(i3),i4)
sig_orb_1(n6)=sig_orb(n1)
print*,'sig_orb(n1)',sig_orb(n1),n1
 endif
 enddo
 enddo
!!nsig=n1
 if(n1.gt.0)then
n3=n3+1
k=0
!if(nn_count(i3).eq.1)k=1
!print*,'k',k,i3,nn_count(i3)
 do i2=1,nnnatom
 do i1=1,2
 if(i3.eq.nnat_bond(i2,i1))then
k=k+1
if(k.gt.n1)goto 113
n4=n4+1
!sig_orb_1(n4)=sig_orb(k)
nnat_bond_new(i2,i1)=sig_orb(k)
print*,'nnat_bond_new(i2,i1)***',i2,i1,nnat_bond(i2,i1),nnat_bond_new(i2,i1),sig_orb(k)
 endif
 enddo
113 enddo
!print*,'n1',n1,niao+nao+n3,n3
 do i1=1,n1
n2=n2+1
n5=n5+1
nnat_bond_new(n2,1)=niao+nao+i3
nnat_bond_new(n2,2)=sig_orb(i1)
tot_orb(n5)=sig_orb(i1)
 enddo
if(n1.gt.2)then
 do i1=1,n1
if(i1.ne.n1)ii2=i1+1
if(i1.eq.n1)ii2=1
n2=n2+1
nnat_bond_new(n2,1)=sig_orb(i1)
nnat_bond_new(n2,2)=sig_orb(ii2)
 enddo
endif
endif
 enddo
!!!!!!!!!!!!
nnatom=n2
nsig=n6
!!!! nsig=number of sigma orbital
!!!! nnatom= number of connected pair of orbitals in the extended CM
print*,'nsig',nsig,nnatom

natom=n5
!!!! natom=number of extended orbitals

do i2=1,nnnatom
print*,'nnat_bond',(nnat_bond(i2,i3),i3=1,2)
enddo
do i2=1,nnatom
print*,'nnat_bond_new',(nnat_bond_new(i2,i3),i3=1,2),nnatom
enddo
!print*,'sig_orb_1(n4)',(sig_orb_1(i2),i2=1,n4)
do i2=1,n5
print*,'tot_orb',tot_orb(i2),n5,nnatom
enddo

call nnat_bond_sig(nnat_bond_new,nnatom,sig_orb_1,nsig,nnat_bond_new_1,nna)
do i2=1,nna
print*,'nnat_bond_new_new',(nnat_bond_new_1(i2,i3),i3=1,2),nna
enddo

!231 format(20I3)
m18=0
m19=0
do i3=1,n5
k=tot_orb(i3)
m19=0
!do i2=1,nnatom
do i2=1,nna
do i1=1,2
!print*,'atom',k,nnat_bond_new(i2,i1)
!if(k.eq.nnat_bond_new(i2,i1))then
if(k.eq.nnat_bond_new_1(i2,i1))then
if(i1.eq.1)i5=2
if(i1.eq.2)i5=1
m19=m19+1
m18=m18+1
nn_group(i3,m19)=nnat_bond_new_1(i2,i5)
!print*,'nnat_bond(i2,i5)',i3,k,i2,i1,i5,m19,nnat_bond_new(i2,i5),nn_group(i3,m19)
sl_group(i3,m19)=m18
endif
enddo
enddo
nelimt(i3)=m19
!print*,'nelimt(i3)',nelimt(i3)
enddo


!!! 'nn_group' specify orbitals in tot_orb array are connected with which other
!!! orbitals

do i3=1,n5
print*,'*nn_group*',nelimt(i3),(nn_group(i3,i4),i4=1,nelimt(i3))
enddo
do i3=1,n5
print*,'*sl_group*',(sl_group(i3,i4),i4=1,nelimt(i3))
enddo

m19=0
do i3=1,n5
do i4=1,nelimt(i3)
m19=m19+1
full_nn_group(m19)=nn_group(i3,i4)
enddo
enddo
fullgrp=m19

write(*,*),'full_nn_g',m19,(full_nn_group(i3),i3=1,m19)
!goto 200
!endif
!!!!! Scoring of the structures has been started from here !!!

do i=1,ncqs
sig_sym_sc(i)=1.0
enddo


do i=1,ncqs
loopsc=0
do i3=1,atom
new_score(i3,2)=score(i3,2)
enddo

!! if the structures have active lone pairs and or radicals the associated atoms are being scored in 'new_score()'.

!print*,'symmetry_cal_sym_cross'
write(*,231)(str1(i,i1),i1=1,nae)
!print*,'tscore**,nl',nl
!!if(nl.ne.0)then
!!!print*,'rajat',nl
!!do i2=1,nl*2,2
!!!print*,i2
!!do i3=1,atom
!!do i4=1,atn(active_atoms(i3))
!!!print*,'atoset(active_atoms(i3),i4)',atoset(active_atoms(i3),i4)
!!if(str1(i,i2).eq.atoset(active_atoms(i3),i4))then
!!
!!new_score(i3,2)=new_score(i3,2)+1.0/prime_num(2)
!!!print*,'new score2',new_score(i3,2)
!!endif
!!enddo
!!enddo
!!enddo
!!endif
!!
!!if(nlast.ne.0)then
!!!print*,'rajat',nlast,nae-nlast+1,atom
!!do i2=nae-nlast+1,nae
!!do i3=1,atom
!!do i4=1,atn(active_atoms(i3))
!!if(str1(i,i2).eq.atoset(active_atoms(i3),i4))then
!!
!!new_score(i3,2)=new_score(i3,2)+1.0/prime_num(3)
!!endif
!!enddo
!!!print*,'new score3',i3,new_score(i3,2)
!!enddo
!!enddo
!!endif


!! Scoring of the bonds of the structures started from here
!! the score of the bond is given by the score of the atoms involeved in the


!bond
!do i3=1,atom
!do i4=1,atn(active_atoms(i3))
!!print*,'atoset(active_atoms(i3),i4)',atoset(active_atoms(i3),i4)
!enddo
!enddo
! do i3=1,nsig
!  print*,'sig_orb_1(i3)',sig_orb_1(i3),nsig
!enddo

strscore=0.0
ipnum=3
!print*,'strset'
numbond=0
numbond1=0
do i1=1+nl*2,nae-nlast,2
tscore=0.0
rscore=0.0
n1=0
n2=0
n3=0
n4=0
do i2=i1,i1+1
do i3=1,atom
do i4=1,atn(active_atoms(i3))
!do i4=1,atn(i3)
if(str1(i,i2).eq.atoset(active_atoms(i3),i4))then
!if(str1(i,i2).eq.atoset(i3,i4))then
if(i2.eq.i1) then
n1=active_atoms(i3)
!n1=i3
endif
if(i2.eq.i1+1) then
n2=active_atoms(i3)
!n2=i3

endif
endif
enddo
enddo
!print*,'bond***',str1(i,i2),n1,n2
enddo
n4=str1(i,i1)
n5=str1(i,i1+1)
do i2=1,nsym
do i3=1,syn(i2)
!print*,'atsymset',i2,i3,n4,n4,atsymset(i2,i3)
if(n4.eq.atsymset(i2,i3))nn4=i2
if(n5.eq.atsymset(i2,i3))nn5=i2
enddo
enddo
!print*,'nn4,nn5',nn4,nn5,n4,n5
if(nsym.eq.1)then
if(symtype.eq.'tight'.or.symtype.eq.'loose')then
if(nn4.eq.1.and.nn5.eq.1)scr=1.0
endif
endif
if(nsym.eq.2)then
if(symtype.eq.'tight'.or.symtype.eq.'loose')then
if(nn4.eq.2.and.nn5.eq.2)scr=1.0
if(nn4.eq.1.and.nn5.eq.1)scr=2.0
if(nn4.eq.1.and.nn5.eq.2)scr=4.0
if(nn4.eq.2.and.nn5.eq.1)scr=4.0
endif
endif
if(nsym.eq.3)then
if(symtype.eq.'tight')then
if(nn4.eq.3.and.nn5.eq.3)scr=1.0
if(nn4.eq.1.and.nn5.eq.1)scr=2.0
if(nn4.eq.2.and.nn5.eq.2)scr=2.0
if(nn4.eq.1.and.nn5.eq.2)scr=3.0
if(nn4.eq.2.and.nn5.eq.1)scr=3.0
if(nn4.eq.1.and.nn5.eq.3)scr=4.0
if(nn4.eq.3.and.nn5.eq.1)scr=4.0
if(nn4.eq.2.and.nn5.eq.3)scr=5.0
if(nn4.eq.3.and.nn5.eq.2)scr=5.0
endif
if(symtype.eq.'loose')then
if(nn4.eq.3.and.nn5.eq.3)scr=1.0
if(nn4.eq.1.and.nn5.eq.1)scr=2.0
if(nn4.eq.2.and.nn5.eq.2)scr=2.0
if(nn4.eq.1.and.nn5.eq.2)scr=2.0
if(nn4.eq.2.and.nn5.eq.1)scr=2.0
if(nn4.eq.1.and.nn5.eq.3)scr=3.0
if(nn4.eq.3.and.nn5.eq.1)scr=3.0
if(nn4.eq.2.and.nn5.eq.3)scr=3.0
if(nn4.eq.3.and.nn5.eq.2)scr=3.0
endif
endif
!tscore=n4*new_score(n1,2)+n5*new_score(n2,2)
tscore=new_score(n1,2)+new_score(n2,2)+scr/(new_score(n1,2)+new_score(n2,2))

do i2=1,nactorb
  if(str1(i,i1).eq.active_orbs(i2))then
  k11=atm_nb_orbs(i2)
  endif
  if(str1(i,i1+1).eq.active_orbs(i2))then
  k22=atm_nb_orbs(i2)
  endif
enddo
tscore=tscore+dist_mat(k11,k22)
print*,'tscore with bond length',k11,k22,tscore,dist_mat(k11,k22)

!print*,'searching for orbs',tscore,n1,n2
!print*,'tscore,scr,OSS,ABS(topology)',tscore,scr,scr/(new_score(n1,2)+new_score(n2,2)),new_score(n1,2)+new_score(n2,2)
nnscore=0.0
nd=0
n1=0
n2=0
n3=0
n4=0
!do i3=1,nsig
!print*,'sig_orb_1',sig_orb_1(i3)
!enddo
 do i2=i1,i1+1
!print*,'i2',i2,str1(i,i2)
 do i3=1,nsig
  if(sig_orb_1(i3).eq.str1(i,i2))then
n3=n3+1
if(i2.eq.i1)n1=str1(i,i2)
if(i2.eq.i1+1)n2=str1(i,i2)
!print*,'n1,n2',n1,n2,n3,str1(i,i2)
goto 232
  endif
 enddo
 do i3=1,atom
 do i4=1,atn(active_atoms(i3))
! do i4=1,atn(i3)
  if(str1(i,i2).eq.atoset(active_atoms(i3),i4))then
!  if(str1(i,i2).eq.atoset(i3,i4))then
   if(i2.eq.i1) then
n1=i3+nao+niao
   endif
    if(i2.eq.i1+1) then
n2=i3+nao+niao
    endif
  endif
 enddo
 enddo
 232 enddo

!print*,'n3,bons',n3,n1,n2,n5,n18
!print*,'tscore',tscore

!loop_score=1
if(n1.gt.n2)then
k1=n2
k2=n1
else
k1=n1
k2=n2
endif
print*,'k1,k2,bond',k1,k2,natom
do i2=1,natom
if(k1.eq.tot_orb(i2))l1=i2
enddo
!print*,'l1',l1
do i2=1,nelimt(l1)
 if(k2.eq.nn_group(l1,i2))then
n=1
!nscore(n)=prime_num(9)
!nscore(n)=0
!print*,'nscore before loop start',nscore(n)
!goto 101
ncrow=1
loop_score=1
numbond=numbond+1
loop_score_row(numbond)=loop_score+1
coordination_mat(numbond,1)=k1
coordination_mat(numbond,2)=k2
goto 555
 endif
enddo

if(k1.ne.k2)call symm_loops(k1,k2,loop_score,connectivity_row,ncrow)
do i3=1,ncrow
numbond=numbond+1
loop_score_row(numbond)=loop_score+1
do i2=1,loop_score+1
coordination_mat(numbond,i2)=connectivity_row(i3,i2)
enddo
print*,'coordination_mat',(coordination_mat(numbond,i2),i2=1,loop_score+1)
enddo
if(k1.eq.k2)loop_score=0
goto 555
!555 print*,'tscore_before',tscore
555 if(loop_score.ne.0)tscore=tscore+1.0/loop_score
!print*,'loop_score',loop_score
!print*,'kk*,tscore',tscore,loop_score
!endif
rscore=1.0/tscore
do i2=1,ncrow
numbond1=numbond1+1
bndscore(numbond1)=rscore
enddo
!print*,'nearest neighbor is',kk,tscore,rscore
strscore=strscore+rscore
!strscore=strscore+tscore
if(loop_score.ne.0)loopsc=loopsc+prime_num(loop_score)
if(loop_score.eq.0)loopsc=loopsc+1000
!print*,strscore
!print*,'strscore,tscore,loop_score,loopsc',strscore,tscore,prime_num(loop_score),loopsc
enddo
print*,'numbond',numbond
do i1=1,numbond
print*,'loop_score_row',loop_score_row(i1)
print*,'coordination_mat',(coordination_mat(i1,i2),i2=1,loop_score_row(i1))
enddo

call coordination_val(coordination_mat,numbond,loop_score_row,bndscore,coord_score)

stsymsc(i)=strscore+coord_score
!stsymsc(i)=strscore
loopsymsc(i)=loopsc
print*,'stsymsc(i)',i,stsymsc(i),loopsymsc(i),coord_score
write(15,*)stsymsc(i)
enddo



rewind(15)
do i=1,ncqs
read(15,909)stsymsc1(i)
print*,i,stsymsc1(i)
enddo
909 format (F10.6)


jj=1
do m19=1,ncqs
!print*,'q_fac2',q_fac2(m19)
if(m19.eq.1)ssym(1)=stsymsc1(1)
j=jj
do i=1,j
if(ssym(i).eq.stsymsc1(m19))goto 373
enddo
jj=jj+1
ssym(i)=stsymsc1(m19)
!print*,qul(i)
373 enddo
nssym=jj
print*,'nssym',nssym

do i=1,jj
print*,ssym(i)
enddo

do i=1,10000
order(i)=0.0
enddo

do k3=1,nssym
do k4=1,nssym
do k5=1,k3
if(order(k5).eq.ssym(k4))goto 389
enddo
if(ssym(k4).gt.order(k3))then
order(k3)=ssym(k4)
endif
389 enddo
print*,'**order',k3,order(k3)
enddo

jj=0
do i=1,nssym
jj=jj+1
do j=1,ncqs
if(order(i).eq.stsymsc1(j))then
write(*,231)(str1(j,i1),i1=1,nae)
print*,'order(i),stsymsc(j)',order(i),stsymsc1(j)
if(nlast.ne.0)then
losc=0.0
do i1=nae-nlast,nae
do i2=1,syn(1)
if(str1(j,i1).eq.atsymset(1,i2))goto 531
enddo
goto 532
531 losc=losc+1.0/prime_num(str1(j,i1))
532 enddo
lone_score(j)=losc
endif
symq(j)=jj
!lsym(j)=loopsymsc(j)
print*,'symq(j),lsym(j)',symq(j),loopsymsc(j)
endif
enddo
enddo




print*,'sub:symmetry_cal'
do i=1,ncqs
!if(symq(i).eq.4)then
write(*,231),(str1(i,j),j=1,nae),symq(i)
!print*,lone_score(i)
!endif
enddo
print*,'sub:symmetry_cal'
!do i=1,ncqs
!write(*,231)(str2(i,j),j=1,nae)
!enddo
231 format(20I5)
!call sigma_symm(nl,ncqs,str1)
CALL SYSTEM ("rm symsig.temp")
print*,'exit symmetry_cal_sig, symm',symm
200 return
end subroutine symmetry_cal_sig
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

subroutine nnat_bond_sig(nnat_bond_new,n,sig_orb,nsig,nnat_bond_new_1,j)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::i,i1,i2,i3,i4,i5,i6,j,k,l,nnat_bond_new(100,2),nnat_bond_new_1(100,2),n
integer::atoset_sig(20,10),atn_sig(20),orbs_sig(10),sig_orb(100),nsig,k1,k2,c1,c2,s_orbs(0)
integer::k3,k4
real*8::coordx(100),coordy(100),coordz(100),a,b,c,d,sig_coord(50,3),norm,kk,sig_dist_mat(40,40)

common/coordinate/coordx,coordy,coordz


k=0
do i=1,atom
if(atn(i).gt.2)then
j=0
do i1=1,atn(i)
do i2=1,nsig
print*,'atoset',atoset(active_atoms(i),i1),sig_orb(i2)
if(atoset(active_atoms(i),i1).eq.sig_orb(i2))then
j=j+1
orbs_sig(j)=sig_orb(i2)
endif
enddo
enddo
if(j.gt.2)then
k=k+1
do i4=1,j
atoset_sig(k,i4)=orbs_sig(i4)
enddo
atn_sig(k)=j
endif
endif
enddo


do i=1,k
print*,'atoset_sig',(atoset_sig(i,j),j=1,atn_sig(i))
enddo
j=0
do i2=1,n
do i3=1,2
do i=1,k
do i1=1,atn_sig(i)
if(atoset_sig(i,i1).eq.nnat_bond_new(i2,i3))then
k1=nnat_bond_new(i2,i3)
if(i3.eq.1)k2=nnat_bond_new(i2,2)
if(i3.eq.2)k2=nnat_bond_new(i2,1)
do i4=1,atn_sig(i)
if(k2.eq.atoset_sig(i,i4))goto 103
enddo
endif
enddo
enddo
enddo
j=j+1
nnat_bond_new_1(j,1)=nnat_bond_new(i2,1)
nnat_bond_new_1(j,2)=nnat_bond_new(i2,2)
103 enddo



l=0
k1=0
do i=1,k
do i1=1,atn_sig(i)
do i2=1,n
do i3=1,2
if(atoset_sig(i,i1).eq.nnat_bond_new(i2,i3))then
k1=nnat_bond_new(i2,i3)
if(i3.eq.1)k2=nnat_bond_new(i2,2)
if(i3.eq.2)k2=nnat_bond_new(i2,1)
!endif
!enddo
if(k2.gt.nao+niao)k2=k2-nao-niao
do i4=1,atn_sig(i)
if(k2.eq.atoset_sig(i,i4))goto 100
enddo

c1=0
c2=0
do i5=1,atom
do i6=1,atn(i5)
if(k1.eq.atoset(active_atoms(i5),i6))c1=i5
if(k2.eq.atoset(active_atoms(i5),i6))c2=i5
enddo
enddo

if(c2.eq.0)c2=k2
if(c1.eq.c2)goto 100
l=l+1
print*,'c1, c2 ***************',c1,c2
a=coordx(c2)-coordx(c1)
b=coordy(c2)-coordy(c1)
c=coordz(c2)-coordz(c1)
norm=1.0/sqrt(a**2.0 + b**2.0 + c**2.0)
d=0.3
s_orbs(l)=k1
sig_coord(l,1)=coordx(c1)+a*d*norm
sig_coord(l,2)=coordy(c1)+b*d*norm
sig_coord(l,3)=coordz(c1)+c*d*norm

print*,'a,b,c',a,b,c
print*,'c1 coord',coordx(c1),coordy(c1),coordz(c1)
print*,'c2 coord',coordx(c2),coordy(c2),coordz(c2)
print*,'sig_coord',l,sig_coord(l,1),sig_coord(l,2),sig_coord(l,3)


endif
enddo
100 enddo
enddo

do i1=1,l
!print*,'s_orbs',s_orbs(i1)
print*,'sig_coord',i1,sig_coord(i1,1),sig_coord(i1,2),sig_coord(i1,3)
enddo
print*,'**************',sig_coord(2,1)

do i1=1,l
do i2=1,l
sig_dist_mat(i1,i2)=0.0
enddo
enddo

do i1=1,l
print*,'sig_coord i1** i1',i1,sig_coord(i1,1),sig_coord(i1,2),sig_coord(i1,3)
do i2=1,l
sig_dist_mat(i1,i2)=0.0
print*,'sig_coord',i2,sig_coord(i2,1),sig_coord(i2,2),sig_coord(i2,3)
sig_dist_mat(i1,i2)=sqrt((sig_coord(i1,1)-sig_coord(i2,1))**2.0 + &
(sig_coord(i1,2)-sig_coord(i2,2))**2.0 + &
(sig_coord(i1,3)-sig_coord(i2,3))**2.0)
!print*,'coord1',i1,sig_coord(i1,1),sig_coord(i1,2),sig_coord(i1,3)
!print*,'coord2',i2,sig_coord(i2,1),sig_coord(i2,2),sig_coord(i2,3)
print*,'sig_dist_mat',sig_dist_mat(i1,i2)
enddo
enddo

do i1=1,l
print*,'sig_dist_mat',(sig_dist_mat(i1,i2),i2=1,l)
enddo

do i1=1,l
kk=1000.0
do i2=1,l
if(i1.eq.i2)goto 101
if(sig_dist_mat(i1,i2).lt.kk)kk=sig_dist_mat(i1,i2)
101 enddo
print*,'kk',kk

do i2=1,l
if(kk.eq.sig_dist_mat(i1,i2))then


do i3=1,j
do i4=1,2
if(s_orbs(i1).eq.nnat_bond_new_1(i3,i4))then
k3=nnat_bond_new_1(i3,i4)
if(i4.eq.1)k4=nnat_bond_new_1(i3,2)
if(i4.eq.2)k4=nnat_bond_new_1(i3,1)
endif
enddo
if(s_orbs(i2).eq.k4) goto 102
enddo


j=j+1
nnat_bond_new_1(j,1)=s_orbs(i1)
nnat_bond_new_1(j,2)=s_orbs(i2)
print*,'nnat_bond_new_1',nnat_bond_new_1(j,1),nnat_bond_new_1(j,2)
endif
102 enddo
enddo

enddo

do i1=1,j
print*,'new_mat',(nnat_bond_new_1(i1,i2),i2=1,2)
enddo


return
end subroutine nnat_bond_sig
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine coordination_val(coordination_mat,numbond,loop_score_row,bndscore,coord_score)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::i,i1,i2,i3
integer::coordination_mat(20,20),numbond,loop_score_row(20),new_row,loop_score_new(20)
real*8::bndscore(20),coord_score,c_score,score
common/lp/loop_score_new

print*,'enter coordination_val ********************************'
do i=1,numbond
print*,'coordination_mat',(coordination_mat(i,i2),i2=1,loop_score_row(i))
enddo

do i=1,20
loop_score_new(i)=loop_score_row(i)
enddo

coord_score=0.0
do i=1,numbond
!print*,'coordination_mat,i',i,'>',(coordination_mat(i,i2),i2=1,loop_score_row(i))
if (coordination_mat(i,1).ne.0)then
c_score=0.0
do i1=i+1,numbond
!print*,'coordination_mat,i1',i1,'>',(coordination_mat(i1,i2),i2=1,loop_score_row(i1))
if(i.ne.i1)then
if (coordination_mat(i1,1).ne.0)then
score=0.0
do i2=1,loop_score_row(i)
do i3=1,loop_score_row(i1)
if (coordination_mat(i,i2).eq.coordination_mat(i1,i3))then
!score=score+(bndscore(i)/(loop_score_row(i)-1))*((loop_score_row(i)-1)-(new_row(i2,i)-1))+ &
!(bndscore(i1)/(loop_score_row(i1)-1))*((loop_score_row(i1)-1)-(new_row(i3,i1)-1))
score=score+(bndscore(i)/new_row(i2,i)+bndscore(i1)/new_row(i3,i1))
print*,'bndscore(i),bndscore(i1),(i,i2),(i1,i3),new_row(i2,i),new_row(i3,i1)',&
bndscore(i),bndscore(i1),'(',i,i2,')','(',i1,i3,')',new_row(i2,i),new_row(i3,i1)
!print*,'i,i1,i2,i3,score',i,i1,i2,i3,score
endif
enddo
enddo
if(score.ne.0.0)c_score=c_score+1.0/score
!c_score=c_score+score
!print*,'c_score',c_score
endif
endif
enddo
!if(c_score.ne.0.0)coord_score=coord_score+1.0/c_score
if(c_score.ne.0.0)coord_score=coord_score+c_score
print*,'coord_score',coord_score
endif
enddo


return
end subroutine coordination_val
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
function new_row(l,n)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

integer::n,l,i,i1,i2,i3,loop_score_row(20),new_row_1(20),new_row
common/lp/loop_score_row

k=int(loop_score_row(n)/2)+mod(loop_score_row(n),2)
if (mod(loop_score_row(n),2).eq.0)then
i1=0
do i=1,loop_score_row(n)/2
i1=i1+1
new_row_1(i1)=k-ABS(k-i)
enddo

do i=loop_score_row(n)/2,1,-1
i1=i1+1
new_row_1(i1)=k-ABS(k-i)
enddo

endif
if (mod(loop_score_row(n),2).eq.1)then
do i=1,loop_score_row(n)
new_row_1(i)=k-abs(k-i)
enddo
endif
new_row=new_row_1(l)
!print*,'new_row,n,new_row_1',new_row,n,'|',(new_row_1(i),i=1,loop_score_row(n))

return
end function new_row
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine symm_loops(k1,k2,loop_score,connectivity_row,nrow)

use commondat
implicit none

common/loops/full_nn_group,fullgrp,natom,nelimt,sl_group,tot_orb,nn_group
integer::k1,k2,k3,k4,k5,k6,k7,i,i1,i2,i3,i4,i5,i6,j,natom,fullgrp,loop_score1,nrow
integer::nn_group(50,10),nelimt(50),full_nn_group(1000),sl_group(50,10),tot_orb(100)
integer::nloop(100),orbs1(200),orbs2(200),orbs3(40),gr_sl,n,nsl,nsl1,ii,iii,flg,loop_score
integer::ii0,ii1,ii2,ii3,ii4,ii5,ii6,ii7,ii8,ii9,ii10,ii11,ii12,ii13,j1,j2,&
j3,j4,j5,j6,j7,j8,j9,j10,j11,j12,j13,l,maxlp
integer::ls1,ls2,ls3,ls4,ls5,ls6,ls7,ls8,ls9,ls10,ls11,ls12,ls13,ls14,connectivity(20,20),&
connectivity_row(20,20),nn,nnn(10)

print*,'enter_symm_loops',k1,k2
!do i3=1,natom
!print*,'*nn_group*',nelimt(i3),(nn_group(i3,i4),i4=1,nelimt(i3))
!enddo
!do i3=1,natom
!print*,'*sl_group*',(sl_group(i3,i4),i4=1,nelimt(i3))
!enddo
nsl=0
nsl1=0
ii=0
iii=0
i4=0
i5=0
flg=0
maxlp=15
loop_score1=0
!do i=1,natom
!print*,'sourav1'
!print*,'tot_orb',tot_orb(i)
!enddo
!do i=1,natom
!print*,'nelimt',nelimt(i),tot_orb(i)
!enddo
l=0
do i=1,natom
if(k1.eq.tot_orb(i))goto 101
enddo

101 do j=1,nelimt(i)
!print*,'loop0'
do i6=1,maxlp
orbs2(i6)=0
enddo
!do i6=1,1
!if(orbs2(i6).eq.nn_group(i,j))goto 205
!enddo
!orbs2(1)=nn_group(i,j)
ls1=0
!print*,'k2,nn_group',k2,nn_group(i,j),i,j
if(k2.eq.nn_group(i,j))then
iii=iii+1
ls1=ls1+1
connectivity(iii,1)=k1
connectivity(iii,2)=k2
nloop(iii)=ls1+1
!print*,'nloopnloopnloop',nloop(iii)
goto 205
else
if(k1.ne.nn_group(i,j))then
!do i6=1,ii
!if(nn_group(i,j).eq.orbs1(i6))goto 205
!enddo
l=1
ii=ii+1
orbs3(ii)=nn_group(i,j)
!print*,'orbs3',orbs3(ii)
endif
endif
205 enddo

!if(l.eq.1)ls1=ls1+1
ii0=ii
!!! loop 1
do j1=1,ii0
ii=1
!print*,'loop1'
do i6=1,maxlp
orbs2(i6)=0
enddo
!do i6=1,1
!if(orbs2(i6).eq.orbs3(j1))goto 204
!enddo
orbs2(1)=orbs3(j1)
!print*,'orbs2**',(orbs2(i6),i6=1,1)
l=0
ls2=ls1
do i=1,natom
if(orbs3(j1).eq.tot_orb(i))goto 102
enddo
goto 204
102 do i1=1,nelimt(i)
!print*,'k2,nn_group',k2,nn_group(i,i1),i,i1
if(k2.eq.nn_group(i,i1))then
iii=iii+1
ls2=ls2+1
connectivity(iii,1)=k1
connectivity(iii,2)=orbs2(1)
connectivity(iii,3)=k2
nloop(iii)=ls2+1
!print*,'nloopnloopnloop',nloop(iii)
goto 204
else
if(k1.ne.nn_group(i,i1))then
!do i6=1,ii
!if(nn_group(i,i1).eq.orbs1(i6))goto 301
!enddo
l=1
ii=ii+1
orbs1(ii)=nn_group(i,i1)
!print*,'orbs1',orbs1(ii)
endif
endif

301 enddo
if(l.eq.1)ls2=ls2+l
ii1=ii
!!! loop 2
do j2=2,ii1
ii=ii1
!print*,'loop2'
do i6=2,maxlp
orbs2(i6)=0
enddo
do i6=1,1
if(orbs2(i6).eq.orbs1(j2))goto 203
enddo
orbs2(2)=orbs1(j2)
!print*,'orbs2',(orbs2(i6),i6=1,2)
l=0
ls3=ls2
do i=1,natom
if(orbs1(j2).eq.tot_orb(i))goto 103
enddo

goto 204
103 do i1=1,nelimt(i)
!print*,'k2,nn_group',k2,nn_group(i,i1),i,i1
if(k2.eq.nn_group(i,i1))then
iii=iii+1
ls3=ls3+1
connectivity(iii,1)=k1
do i6=1,2
connectivity(iii,i6+1)=orbs2(i6)
enddo
connectivity(iii,4)=k2
nloop(iii)=ls3+1
!print*,'nloopnloopnloop',nloop(iii)
goto 203
else
if(k1.ne.nn_group(i,i1))then
!do i6=1,ii
!if(nn_group(i,i1).eq.orbs1(i6))goto 302
!enddo
ii=ii+1
l=1
orbs1(ii)=nn_group(i,i1)
!print*,'orbs1',orbs1(ii)
endif
endif

302 enddo
ii2=ii
if(l.eq.1)ls3=ls3+l
!!! loop 3
do j3=ii1+1,ii2
ii=ii2
!print*,'loop3'
do i6=3,maxlp
orbs2(i6)=0
enddo
do i6=1,2
if(orbs2(i6).eq.orbs1(j3))goto 202
enddo
orbs2(3)=orbs1(j3)
!print*,'orbs2',(orbs2(i6),i6=1,3)
l=0
ls4=ls3
do i=1,natom
if(orbs1(j3).eq.tot_orb(i))goto 104
enddo

goto 203
104 do i1=1,nelimt(i)
!print*,'k2,nn_group',k2,nn_group(i,i1),i,i1
if(k2.eq.nn_group(i,i1))then
iii=iii+1
ls4=ls4+1
connectivity(iii,1)=k1
do i6=1,3
connectivity(iii,i6+1)=orbs2(i6)
enddo
connectivity(iii,5)=k2
nloop(iii)=ls4+1
!print*,'nloopnloopnloop',nloop(iii)
goto 202
else
if(k1.ne.nn_group(i,i1))then
!do i6=1,ii
!if(nn_group(i,i1).eq.orbs1(i6))goto 303
!enddo
ii=ii+1
l=1
orbs1(ii)=nn_group(i,i1)
!print*,'orbs1',orbs1(ii)
endif
endif

303 enddo
ii3=ii
if(l.eq.1)ls4=ls4+l
!!! loop 4
do j4=ii2+1,ii3
ii=ii3
!print*,'loop4'
do i6=4,maxlp
orbs2(i6)=0
enddo
do i6=1,3
if(orbs2(i6).eq.orbs1(j4))goto 201
enddo
orbs2(4)=orbs1(j4)
!print*,'orbs2**',(orbs2(i6),i6=1,4)
l=0
ls5=ls4
do i=1,natom
if(orbs1(j4).eq.tot_orb(i))goto 105
enddo
goto 202

105 do i1=1,nelimt(i)
!print*,'k2,nn_group',k2,nn_group(i,i1),i,i1
if(k2.eq.nn_group(i,i1))then
iii=iii+1
ls5=ls5+1
connectivity(iii,1)=k1
do i6=1,4
connectivity(iii,i6+1)=orbs2(i6)
enddo
connectivity(iii,6)=k2
nloop(iii)=ls5+1
!print*,'nloopnloopnloop',nloop(iii)
goto 201
else
if(k1.ne.nn_group(i,i1))then
!do i6=1,ii
!if(nn_group(i,i1).eq.orbs1(i6))goto 304
!enddo
ii=ii+1
l=1
orbs1(ii)=nn_group(i,i1)
!print*,'orbs1',orbs1(ii)
endif
endif

304 enddo
if(l.eq.1)ls5=ls5+l
ii4=ii
!!! loop 5
do j5=ii3+1,ii4
ii=ii4
!print*,'loop5',j5,ii3+1,ii4,'|',orbs1(j5),ii
do i6=5,maxlp
orbs2(i6)=0
enddo
do i6=1,4
if(orbs2(i6).eq.orbs1(j5))goto 200
enddo
orbs2(5)=orbs1(j5)
!print*,'orbs2**',(orbs2(i6),i6=1,5)
l=0
ls6=ls5
do i=1,natom
if(orbs1(j5).eq.tot_orb(i))goto 106
enddo
goto 201

106 do i1=1,nelimt(i)
!!print*,'k2,nn_group',k2,nn_group(i,i1),i,i1
if(k2.eq.nn_group(i,i1))then
iii=iii+1
ls6=ls6+1
connectivity(iii,1)=k1
do i6=1,5
connectivity(iii,i6+1)=orbs2(i6)
enddo
connectivity(iii,7)=k2
nloop(iii)=ls6+1
!print*,'nloopnloopnloop',nloop(iii)
goto 200
else
if(k1.ne.nn_group(i,i1))then
!do i6=1,ii
!if(nn_group(i,i1).eq.orbs1(i6))goto 305
!enddo
ii=ii+1
l=1
orbs1(ii)=nn_group(i,i1)
!print*,'orbs1',orbs1(ii)
endif
endif

305 enddo
if(l.eq.1)ls6=ls6+l
ii5=ii
!!! loop 6
do j6=ii4+1,ii5
ii=ii5
!print*,'loop6',ii
do i6=6,maxlp
orbs2(i6)=0
enddo
do i6=1,5
if(orbs2(i6).eq.orbs1(j6))goto 199
enddo
orbs2(6)=orbs1(j6)
!print*,'orbs2**',(orbs2(i6),i6=1,6)
l=0
ls7=ls6
do i=1,natom
if(orbs1(j6).eq.tot_orb(i))goto 107
enddo
goto 200

107 do i1=1,nelimt(i)
!!print*,'k2,nn_group',k2,nn_group(i,i1),i,i1
if(k2.eq.nn_group(i,i1))then
iii=iii+1
ls7=ls7+1
connectivity(iii,1)=k1
do i6=1,6
connectivity(iii,i6+1)=orbs2(i6)
enddo
connectivity(iii,8)=k2
nloop(iii)=ls7+1
!print*,'nloopnloopnloop',nloop(iii)
goto 199
else
if(k1.ne.nn_group(i,i1))then
!do i6=1,ii
!if(nn_group(i,i1).eq.orbs1(i6))goto 306
!enddo
ii=ii+1
l=1
orbs1(ii)=nn_group(i,i1)
!print*,'orbs1',orbs1(ii)
endif
endif

306 enddo
if(l.eq.1)ls7=ls7+l
ii6=ii
!!! loop 7
do j7=ii5+1,ii6
ii=ii6
!print*,'loop7',ii
do i6=7,maxlp
orbs2(i6)=0
enddo
do i6=1,6
if(orbs2(i6).eq.orbs1(j7))goto 198
enddo
orbs2(7)=orbs1(j7)
!print*,'orbs2**',(orbs2(i6),i6=1,7)
l=0
ls8=ls7
do i=1,natom
if(orbs1(j7).eq.tot_orb(i))goto 108
enddo
goto 199

108 do i1=1,nelimt(i)
!!print*,'k2,nn_group',k2,nn_group(i,i1),i,i1
if(k2.eq.nn_group(i,i1))then
iii=iii+1
ls8=ls8+1
connectivity(iii,1)=k1
do i6=1,7
connectivity(iii,i6+1)=orbs2(i6)
enddo
connectivity(iii,9)=k2
nloop(iii)=ls8+1
!print*,'nloopnloopnloop',nloop(iii)
goto 198
else
if(k1.ne.nn_group(i,i1))then
!do i6=1,ii
!if(nn_group(i,i1).eq.orbs1(i6))goto 307
!enddo
ii=ii+1
l=1
orbs1(ii)=nn_group(i,i1)
!print*,'orbs1',orbs1(ii)
endif
endif

307 enddo
if(l.eq.1)ls8=ls8+l
ii7=ii
!!! loop 8
do j8=ii6+1,ii7
ii=ii7
!print*,'loop8',ii
do i6=8,maxlp
orbs2(i6)=0
enddo
do i6=1,7
if(orbs2(i6).eq.orbs1(j8))goto 197
enddo
orbs2(8)=orbs1(j8)
!print*,'orbs2**',(orbs2(i6),i6=1,8)
l=0
ls9=ls8
do i=1,natom
if(orbs1(j8).eq.tot_orb(i))goto 109
enddo
goto 198

109 do i1=1,nelimt(i)
!print*,'k2,nn_group',k2,nn_group(i,i1),i,i1
if(k2.eq.nn_group(i,i1))then
iii=iii+1
ls9=ls9+1
connectivity(iii,1)=k1
do i6=1,8
connectivity(iii,i6+1)=orbs2(i6)
enddo
connectivity(iii,10)=k2
nloop(iii)=ls9+1
!print*,'nloopnloopnloop',nloop(iii)
goto 197
else
if(k1.ne.nn_group(i,i1))then
!do i6=1,ii
!if(nn_group(i,i1).eq.orbs1(i6))goto 308
!enddo
ii=ii+1
l=1
orbs1(ii)=nn_group(i,i1)
!print*,'orbs1',orbs1(ii)
endif
endif

308 enddo
if(l.eq.1)ls9=ls9+l
ii8=ii
!!! loop 9
do j9=ii7+1,ii8
ii=ii8
!print*,'loop9',ii
do i6=9,maxlp
orbs2(i6)=0
enddo
do i6=1,8
if(orbs2(i6).eq.orbs1(j9))goto 196
enddo
orbs2(9)=orbs1(j9)
!print*,'orbs2**',(orbs2(i6),i6=1,9)
l=0
ls10=ls9
do i=1,natom
if(orbs1(j9).eq.tot_orb(i))goto 110
enddo
goto 197

110 do i1=1,nelimt(i)
!print*,'k2,nn_group',k2,nn_group(i,i1),i,i1
if(k2.eq.nn_group(i,i1))then
iii=iii+1
ls10=ls10+1
connectivity(iii,1)=k1
do i6=1,9
connectivity(iii,i6+1)=orbs2(i6)
enddo
connectivity(iii,11)=k2
nloop(iii)=ls10+1
!print*,'nloopnloopnloop',nloop(iii)
goto 196
else
if(k1.ne.nn_group(i,i1))then
!do i6=1,ii
!if(nn_group(i,i1).eq.orbs1(i6))goto 309
!enddo
ii=ii+1
l=1
orbs1(ii)=nn_group(i,i1)
!print*,'orbs1',orbs1(ii)
endif
endif

309 enddo
if(l.eq.1)ls10=ls10+l
ii9=ii
!!! loop 10
do j10=ii8+1,ii9
ii=ii9
!print*,'loop10'
do i6=10,maxlp
orbs2(i6)=0
enddo
do i6=1,9
if(orbs2(i6).eq.orbs1(j10))goto 195
enddo
orbs2(10)=orbs1(j10)
!print*,'orbs2**',(orbs2(i6),i6=1,10)
l=0
ls11=ls10
do i=1,natom
if(orbs1(j10).eq.tot_orb(i))goto 111
enddo
goto 196

111 do i1=1,nelimt(i)
!print*,'k2,nn_group',k2,nn_group(i,i1),i,i1
if(k2.eq.nn_group(i,i1))then
iii=iii+1
ls11=ls11+1
connectivity(iii,1)=k1
do i6=1,10
connectivity(iii,i6+1)=orbs2(i6)
enddo
connectivity(iii,12)=k2
nloop(iii)=ls11+1
!print*,'nloopnloopnloop',nloop(iii)
goto 195
else
if(k1.ne.nn_group(i,i1))then
!do i6=1,ii
!if(nn_group(i,i1).eq.orbs1(i6))goto 310
!enddo
ii=ii+1
l=1
orbs1(ii)=nn_group(i,i1)
!print*,'orbs1',orbs1(ii)
endif
endif

310 enddo
if(l.eq.1)ls11=ls11+l
ii10=ii
!!! loop 11
do j11=ii9+1,ii10
ii=ii10
!print*,'loop11'
do i6=11,maxlp
orbs2(i6)=0
enddo
do i6=1,10
if(orbs2(i6).eq.orbs1(j11))goto 194
enddo
orbs2(11)=orbs1(j11)
!print*,'orbs2**',(orbs2(i6),i6=1,11)
l=0
ls12=ls11
do i=1,natom
if(orbs1(j11).eq.tot_orb(i))goto 112
enddo
goto 195

112 do i1=1,nelimt(i)
!print*,'k2,nn_group',k2,nn_group(i,i1),i,i1
if(k2.eq.nn_group(i,i1))then
iii=iii+1
ls12=ls12+1
connectivity(iii,1)=k1
do i6=1,11
connectivity(iii,i6+1)=orbs2(i6)
enddo
connectivity(iii,13)=k2
nloop(iii)=ls12+1
!print*,'nloopnloopnloop',nloop(iii)
goto 194
else
if(k1.ne.nn_group(i,i1))then
!do i6=1,ii
!if(nn_group(i,i1).eq.orbs1(i6))goto 311
!enddo
ii=ii+1
l=1
orbs1(ii)=nn_group(i,i1)
!print*,'orbs1',orbs1(ii),ls1
endif
endif

311 enddo
if(l.eq.1)ls12=ls12+l
ii11=ii
!!! loop 12
!print*,'loop12'
do j12=ii10+1,ii11
ii=ii11
do i6=12,maxlp
orbs2(i6)=0
enddo
do i6=1,11
if(orbs2(i6).eq.orbs1(j12))goto 193
enddo
orbs2(12)=orbs1(j12)
!print*,'orbs2**',(orbs2(i6),i6=1,12)
l=0
ls13=ls12
do i=1,natom
if(orbs1(j12).eq.tot_orb(i))goto 113
enddo
goto 194

113 do i1=1,nelimt(i)
!!print*,'k2,nn_group',k2,nn_group(i,i1),i,i1
if(k2.eq.nn_group(i,i1))then
iii=iii+1
ls13=ls13+1
connectivity(iii,1)=k1
do i6=1,12
connectivity(iii,i6+1)=orbs2(i6)
enddo
connectivity(iii,14)=k2
nloop(iii)=ls13+1
!print*,'nloopnloopnloop',nloop(iii)
goto 193
else
if(k1.ne.nn_group(i,i1))then
!do i6=1,ii
!if(nn_group(i,i1).eq.orbs1(i6))goto 312
!enddo
ii=ii+1
l=1
orbs1(ii)=nn_group(i,i1)
!print*,'orbs1',orbs1(ii)
endif
endif

312 enddo
if(l.eq.1)ls13=ls13+l
ii12=ii
!!! loop 13
!print*,'loop13'
do j13=ii11+1,ii12
ii=ii12
do i6=13,maxlp
orbs2(i6)=0
enddo
do i6=1,12
if(orbs2(i6).eq.orbs1(j13))goto 192
enddo
orbs2(13)=orbs1(j13)
!print*,'orbs2**',(orbs2(i6),i6=1,13)
l=0
ls14=ls13
do i=1,natom
if(orbs1(j13).eq.tot_orb(i))goto 114
enddo
goto 193

114 do i1=1,nelimt(i)
!print*,'k2,nn_group',k2,nn_group(i,i1),i,i1
if(k2.eq.nn_group(i,i1))then
iii=iii+1
ls14=ls14+1
connectivity(iii,1)=k1
do i6=1,13
connectivity(iii,i6+1)=orbs2(i6)
enddo
connectivity(iii,15)=k2
nloop(iii)=ls14+1
!print*,'nloopnloopnloop',nloop(iii)
goto 192
else
if(k1.ne.nn_group(i,i1))then
!do i6=1,ii
!if(nn_group(i,i1).eq.orbs1(i6))goto 313
!enddo
ii=ii+1
orbs1(ii)=nn_group(i,i1)
!print*,'orbs1',orbs1(ii)
endif
endif

313 enddo
192 enddo

193 enddo

194 enddo

195 enddo

196 enddo

197 enddo

198 enddo

199 enddo

200 enddo

201 enddo

202 enddo

203 enddo

204 enddo

!205 enddo

n=1000
do i1=1,iii
if(n.gt.nloop(i1))n=nloop(i1)
enddo

loop_score=n
nn=0
l=0
do i1=1,iii
if(loop_score.eq.nloop(i1))then
l=l+1
nnn(l)=i1
nn=nn+1
endif
enddo

print*,'nnn**',(nnn(i),i=1,l)

do i2=1,20
do i1=1,20
connectivity_row(i1,i2)=0
enddo
enddo
!print*,'',nnn,nloop(nnn)
!if (nn.eq.1)then
do i2=1,l
do i1=1,nloop(nnn(i2))+1
connectivity_row(i2,i1)=connectivity(nnn(i2),i1)
!print*,'connectivity_row',connectivity_row(i1)
enddo
enddo

nrow=l
!endif

print*,'nloop',(nloop(i1),i1=1,iii)
do i1=1,iii
print*,'connectivity',(connectivity(i1,i2),i2=1,nloop(i1)+1)
enddo
do i2=1,l
print*,'connectivity_row',(connectivity_row(i2,i1),i1=1,nloop(nnn(i2))+1)
enddo

print*,'shortestgest loop',n
!if(k1.eq.24.and.k2.eq.29)stop

100 return
end subroutine symm_loops
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine nnat_bond_cal(nl,str1,ncqs,bondq)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!! This subroutine calculates the number of nearest neighbour bonds !!!!!

use commondat
implicit none

integer::m19,m18,i1,i2,i3,i4,i5,i6,i7,ii,iii,iiii,nl,ncqs
integer::nn(10),str1(15000,20),bondq(150000)

print*,'enter nnat_bond_cal'
do i1=1,150000
bondq(i1)=0
enddo

if(nnnatom.eq.0) goto 900
231 format (30I3)
i4=0
do i1=1,ncqs
write(*,231)(str1(i1,i2),i2=1,nae)
iiii=1+(nae-nl*2-nlast)/2
do i3=1+nl*2,(nae-nlast),2
iii=0
nn(1)=0
nn(2)=0
do i5=i3,i3+1
do i4=1,atom
do i7=1,atn(active_atoms(i4))
if(str1(i1,i5).eq.atoset(active_atoms(i4),i7))then
iii=iii+1
if(mod(i5,2).eq.0) nn(2)=i4
if(mod(i5,2).eq.1) nn(1)=i4
goto 517
endif
enddo

enddo
517 enddo
if(nn(2).eq.nn(1))goto 400
if(iii.ne.2) goto 400
do i6=1,nnnatom
ii=0
do i7=1,2
do i4=1,2
if(nn(i4).eq.nnat_bond(i6,i7))then
ii=ii+1
endif
enddo
enddo
if(ii.eq.2)then
iiii=iiii-1
goto 400
endif
enddo

400 enddo
bondq(i1)=iiii
!print*,'nnbd:iiii',iiii
enddo

print*,'exit nnat_bond_cal'
900 return
end subroutine nnat_bond_cal
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine nnat_bond_cal_2(nl,str1,ncqs,bondq)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::m19,m18,i,i1,i2,i3,i4,i5,i6,i7,iii,iiii,nl,ncqs,k
integer::nn(20),str1(15000,20),bondq(150000),sl(500000)
real::least,bondq1_dist(15000)
double precision::ii,bondq_dist(150000)

print*,'enter nnat_bond_cal_2'

open(unit=13,file='nnbd.temp',status='unknown')
do i1=1,150000
bondq(i1)=0
bondq_dist(i1)=0.0
enddo

231 format (30I3)
i4=0
do i1=1,ncqs
ii=0.0
!write(*,231)i1,(str1(i1,i2),i2=1,nae)
do i3=1+nl*2,(nae-nlast),2
iii=0
nn(1)=0
nn(2)=0
do i5=i3,i3+1
do i4=1,atom
do i7=1,atn(active_atoms(i4))
!print*,'atn(i4)',atn(active_atoms(i4)),active_atoms(i4)
!print*,'atoset',str1(i1,i5),atoset(active_atoms(i4),i7)
if(str1(i1,i5).eq.atoset(active_atoms(i4),i7))then
iii=iii+1
if(mod(i5,2).eq.0) nn(2)=active_atoms(i4)
if(mod(i5,2).eq.1) nn(1)=active_atoms(i4)
!print*,'------------',nn(1),nn(2)
goto 517
endif
enddo

enddo
517 enddo
print*,'nn(2),nn(1)',nn(2),nn(1),iii
if(iii.ne.2) goto 400
if(nn(2).eq.nn(1))then

!!! changes done for EDEN
iab_length=1.00
!!!!!!!!!!!!!!!!!!!!!!!!!

if (iab_length.eq.0.0)ii=ii+100.0
if (iab_length.ne.0.0)ii=ii+iab_length
!print*,'iab_length',iab_length
goto 400
endif
ii=ii+dist_act_rel_mat(nn(1),nn(2))
!print*,'dist_act_rel_mat(nn(1),nn(2))',dist_act_rel_mat(nn(1),nn(2)),ii
400 enddo
bondq_dist(i1)=ii
!print*,'bondq_dist(i1)',bondq_dist(i1),ii
write(13,*)bondq_dist(i1)
enddo
rewind(13)
do i1=1,ncqs
read(13,105)bondq1_dist(i1)
!write(*,*),i1,bondq1_dist(i1)
enddo
105 format (F8.4)
iii=0
iiii=0
211 least=10000.0
do i=1,ncqs
do i1=1,iii
if(i.eq.sl(i1))goto 210
enddo
if(bondq1_dist(i).le.least)least=bondq1_dist(i)
210 enddo
!print*,'least',least
if(least.ne.100.0.or.least.ne.0.0)iiii=iiii+1
do i=1,ncqs
if(bondq1_dist(i).eq.least)then
iii=iii+1
bondq(i)=iiii
sl(iii)=i
endif
enddo
if(iii.ne.ncqs)goto 211

do i=1,ncqs
write(*,231)i,(str1(i,i2),i2=1,nae),bondq(i)
!print*,'bondq(i)',i,bondq(i)
enddo
CALL SYSTEM ("rm nnbd.temp")
print*,'exit nnat_bond_cal_2'
900 return
end subroutine nnat_bond_cal_2
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine quality_factor(nl,str1,ncqs,q_fac,str_quality_1,str_quality_2,bondq)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

common/ats/atsymset,nsym,syn,at_sym

integer::i,j,nl,qt,qt_cnt(10),ncqs,i9,m16,m17,m18,m19,qtg,str1(15000,20),equality,noqt&
,jj,nqul1,nqul2,i4,q_fac(15000),k6,k7,k8,str_quality_1(15000),str_quality_2(15000)&
,bondq(150000),qual_mat(6,15000),q,pref_radical(15000),qt_max,mbondq(15000)
integer::atsymset(20,20),nsym,syn(50),at_sym(50),fchrgq(15000)

print*,'enter_quality factor, symm',symm
print*,'itb,syb,nnb,radical,mnbond',itb,syb,nnb,radical,mnbond
if(qflg.eq.1)then 
do j=1,ncqs
q_fac(j)=1
enddo
goto 555
endif
if(itb.ne.1.or.flg1.eq.1) call intra_bond_factor(nl,str1,ncqs,str_quality_1)
if(syb.ne.1.and.nsym.ne.1) call symm_break_factor(nl,str1,ncqs,str_quality_2)
if(input_flg.eq.1)then
  if(nnb.ne.1.or.flg1.eq.1) call nnat_bond_cal(nl,str1,ncqs,bondq)
endif
if(input_flg.eq.0)then
  if(nnb.ne.1.or.flg1.eq.1) call nnat_bond_cal_2(nl,str1,ncqs,bondq)
endif
if(radical.ne.1.and.prad.ne.0.and.nlast.ne.0.or.flg1.eq.1) call prio_rad_str(nl,str1,ncqs,pref_radical)
if(mnbond.ne.1.and.imbd.ne.0.or.flg1.eq.1) call main_bond_cal(nl,str1,ncqs,mbondq)

do j=1,ncqs
  do i=1,6
  qual_mat(i,j)=0
  enddo
enddo

do j=1,ncqs
i=itb
qual_mat(i,j)=qual_mat(i,j)+str_quality_1(j)
i=syb
qual_mat(i,j)=qual_mat(i,j)+str_quality_2(j)
i=nnb
qual_mat(i,j)=qual_mat(i,j)+bondq(j)
i=radical
qual_mat(i,j)=qual_mat(i,j)+pref_radical(j)
i=mnbond
qual_mat(i,j)=qual_mat(i,j)+mbondq(j)
enddo

213 format(10I5)

noqt=1
do i=2,6
  if(qual_mat(i,1).gt.0)then
  noqt=noqt+1
  endif
enddo

if(noqt.gt.2)then
  do i=2,noqt-1
  qt_max=1
    do j=1,ncqs
      if(qt_max.lt.qual_mat(i+1,j))qt_max=qual_mat(i+1,j)
    enddo
    do j=1,ncqs
      qual_mat(i+1,j)=qt_max*(qual_mat(i,j)-1)+qual_mat(i+1,j)
    enddo
  enddo
endif

do j=1,ncqs
q_fac(j)=qual_mat(noqt,j)
enddo
!do j=1,ncqs
!write(*,200),j,q_fac(j),(str1(j,i),i=1,nae)
!enddo
!stop
200 format(20I3)

print*,'leaving_quality factor, symm',symm
555 return
end subroutine quality_factor
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine vector_rep(nl,str1,totstr,vec)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
! vector representation of the structures for independency calculations
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
use commondat1
implicit none 

common/ats/atsymset,nsym,syn,at_sym
integer::j,j1,j2,i,i1,i2,i3,i4,i5,i6,i7,i8,k,k6,k7,k8,k11,k12,k13,k14,k15,l,nend,c1,c2,c3,c4,c5,c6,c,d,e,f,totstr,&
cof,ntdet,det,det1,nl,permtn1,permtn2,permtn,tndet,kk,kkk,x,y,z,detno,n1,n2,n3,n4,n5,n6,n7,n8,i9,i10,i11,&
c7,c8,c9,c10
integer::rum1(1000),rum2(1000),m(5000),bonds(1000),coef(5000),vec(15000,1000),str1(15000,20)
integer::score(40),score_sym(40),col(20),detcount,col1(2,20)
real*8::factorial,norm_const,detn
Double Precision::D1(1000),aldet_new,aldet(1000)
integer::atsymset(20,20),nsym,syn(50),at_sym(50)


   integer,dimension(:,:),allocatable::str2,beta,beta1,alfa,vector,all_det,sign_det,all_det_new

print*,'enter vector_rep,symm',symm
x=900000
y=10000
z=1000

allocate(sign_det(x,z))
allocate(str2(x,y))
allocate(beta(x,y))
allocate(beta1(x,y))
allocate(alfa(x,y))
allocate(vector(x,y))
allocate(all_det(x,y))
allocate(all_det_new(x,y))

str2(x,y)=0
beta(x,y)=0
beta1(x,y)=0
alfa(x,y)=0
vector(x,y)=0
all_det(x,y)=0
str_det_sec(x,z)=0

do i=1,900000
strdet(i)=0
enddo

print*,'sub: vector 1'
!!!!!!! "rum1()" is the orbital numbers except lone paires !!!!!
!!!!!!! "rum2()" is the orbital numbers except lone paires arranged in increasing order !!!!!

!do i1=1,totstr
!write(10,*),(str1(i1,i2),i2=1,nae)
!enddo

do k6=1,1000
rum1(k6)=0
enddo
do k6=1,nae-nl*2
!print*,'nnlp',k6
do k7=nl*2+1,nae
do k8=1,k6
if(rum1(k8).eq.str1(1,k7))goto 469
enddo
if(str1(1,k7).gt.rum1(k6))then
rum1(k6)=str1(1,k7)
!print*,rum1(k6)
endif
469 enddo
enddo
do k6=1,1000
rum2(k6)=0
enddo
k7=0
do k6=nae-nl*2,1,-1
k7=k7+1
rum2(k7)=rum1(k6)

enddo
nend=k7+mod(k7,2)


!!!!!!! "all_det()" are the all possible determinants of the set. Ex. for 5
!electrons in 5 orbitals case : there must be 3 alfa and two beta in each
!determinant so the possible number of determinants are= !5/(!3*!2)=10 so all_det()
!is the 10 defferent sets of determinant. 

k11=0
k12=0
do i1=1,k7
!print*,'sourav'
k11=1
m(1)=i1
if (k11.eq.nend/2) then
k12=k12+1
do k15=1,nend/2
all_det(k12,k15)=rum2(m(k15))
enddo
goto 100
endif

do i2=i1,k7
k11=2
if(i2.eq.m(1))goto 101
m(2)=i2
if (k11.eq.nend/2) then
k12=k12+1
do k15=1,nend/2
all_det(k12,k15)=rum2(m(k15))
enddo
goto 101
endif

do i3=i2,k7
k11=3
do k13=1,2
if(i3.eq.m(k13))goto 102
enddo
m(3)=i3
if (k11.eq.nend/2) then
k12=k12+1
do k15=1,nend/2
all_det(k12,k15)=rum2(m(k15))
enddo
goto 102
endif

do i4=i3,k7
k11=4
do k14=1,3
if(i4.eq.m(k14))goto 103
enddo
m(4)=i4
if (k11.eq.nend/2) then
k12=k12+1
do k15=1,nend/2
all_det(k12,k15)=rum2(m(k15))
enddo
goto 103
endif

!print*,'sourav4'
do i5=i4,k7
k11=5
do k14=1,4
if(i5.eq.m(k14))goto 104
enddo
m(5)=i5
if (k11.eq.nend/2) then
k12=k12+1
do k15=1,nend/2
all_det(k12,k15)=rum2(m(k15))
enddo
goto 104
endif

do i6=i5,k7
k11=6
do k14=1,5
if(i6.eq.m(k14))goto 105
enddo
m(6)=i6
if (k11.eq.nend/2) then
k12=k12+1
do k15=1,nend/2
all_det(k12,k15)=rum2(m(k15))
enddo
!print*,(all_det(k12,l),l=1,k7/2)
goto 105
endif

do i7=i6,k7
k11=7
do k14=1,6
if(i7.eq.m(k14))goto 106
enddo
m(7)=i7
if (k11.eq.nend/2) then
k12=k12+1
do k15=1,nend/2
all_det(k12,k15)=rum2(m(k15))
enddo
!print*,(all_det(k12,l),l=1,k7/2)
goto 106
endif

do i8=i7,k7
k11=8
do k14=1,7
if(i8.eq.m(k14))goto 107
enddo
m(8)=i8
if (k11.eq.nend/2) then
k12=k12+1
do k15=1,nend/2
all_det(k12,k15)=rum2(m(k15))
enddo
!print*,(all_det(k12,l),l=1,k7/2)
goto 107
endif

do i9=i8,k7
k11=9
do k14=1,8
if(i9.eq.m(k14))goto 108
enddo
m(9)=i9
if (k11.eq.nend/2) then
k12=k12+1
do k15=1,nend/2
all_det(k12,k15)=rum2(m(k15))
enddo
!print*,(all_det(k12,l),l=1,k7/2)
goto 108
endif

do i10=i9,k7
k11=10
do k14=1,9
if(i10.eq.m(k14))goto 109
enddo
m(10)=i10
if (k11.eq.nend/2) then
k12=k12+1
do k15=1,nend/2
all_det(k12,k15)=rum2(m(k15))
enddo
!print*,(all_det(k12,l),l=1,k7/2)
goto 109
endif

109 enddo
108 enddo
107 enddo
106 enddo
105 enddo
104 enddo
103 enddo
102 enddo
101 enddo
100 enddo

ntdet=k12
!print*,'sub: vector 2'
print*,'symmetry index3',symm

d=nae-nl*2
e=nend/2
f=d-e
c=factorial(d)/(factorial(e)*factorial(f))
do i1=1,c
i4=nend/2
do i3=1,nae-nl*2
do i2=1,nend/2
if(all_det(i1,i2).eq.rum2(i3))goto 557
enddo
i4=i4+1
!print*,rum2(i3),i4
all_det(i1,i4)=rum2(i3)
557 enddo
nbeta=(nae-(nl*2)-(mult-1))/2
nalpha=nbeta+(mult-1)

if (nl.ne.0)then
i2=0
do i3=1,nalpha
i2=i2+1
all_det_new(i1,i2)=all_det(i1,i3)

enddo
do i3=1,nl,2
i2=i2+1
all_det_new(i1,i2)=str1(1,i3)
enddo
do i3=nalpha+1,nalpha+nbeta
i2=i2+1
all_det_new(i1,i2)=all_det(i1,i3)
enddo
do i3=1,nl,2
i2=i2+1
all_det_new(i1,i2)=str1(1,i3)
!print*,'all_det_new(i1,i4)=str1(1,i3)',i2,all_det_new(i1,i2),str1(1,i3)
enddo
endif

if(nl.eq.0)then
do i3=1,nae
all_det_new(i1,i3)=all_det(i1,i3)
enddo
endif

!print*,i1,'all_det',(all_det(i1,i2),i2=1,nae-nl*2)
!write(9,300),'all_det_new',i1,(all_det_new(i1,i2),i2=1,nalpha+nbeta+nl*2)

print*,'symmetry index4',symm
enddo
tot_ndet=i1
do i1=1,900000
do i2=1,10000
vector(i1,i2)=0
enddo
enddo

i4=0
tndet=0
do i7=1,totstr
!write(9,*),(str1(i7,i2),i2=1,nae)
j=0
i2=0
detcount=0
do i4=1,1000
bonds(i4)=0
enddo
do i1=nl*2+1,nae-nlast
i2=i2+1
bonds(i2)=str1(i7,i1)
enddo

!!!!!!  'struc_albe () ' is the determinants of each structures presenting only alfas !!!!!!
!!!!!!  for two bonds and one unpaired electrons Ex. (1-2)(3-4)5, two bonds
!!!!!!  between orb 1,2 and orbs 3,4 and unpaired electron in in 5. then the
!!!!!!  determinants are (a1b2-a2b1)(a3b4-a4b3)a5 taking unpaired as alfa. so the
!!!!!!  determinants are a1b2a3b4a5-a1b2a4b3a5-a2b1a3b4a5+a2b1a4b3a5 to delet the a,b
!!!!!!  notation or to make it in only number sets we put all alfas first and beta
!!!!!!  second, therefore the number set representing the above determinants are =
!!!!!!  135/24 - 145/23 - 235/14 + 245/13, 'cof()' is the sign of the determinants.  !!!!!!!

do i1=1,5000
m(i1)=0
enddo

print*,'sub: vector 3'
k11=0
k12=0
cof=1
do i1=1,2
cof=cof*(-1)**(i1-1)
c1=cof
k11=1
m(1)=i1
if (k11.eq.(nae-nl*2-nlast)/2) then
k12=k12+1
do k15=1,(nae-nl*2-nlast)/2
str2(k12,k15)=bonds(m(k15))
coef(k12)=cof
enddo
print*,'sourav1',coef(k12),(str2(k12,l),l=1,(nae-nl*2-nlast)/2)
goto 200
endif

do i2=3,4
cof=cof*(-1)**(i2-1)
c2=cof
k11=2
if(i2.eq.m(1))goto 201
m(2)=i2
if (k11.eq.(nae-nl*2-nlast)/2) then
k12=k12+1
do k15=1,(nae-nl*2-nlast)/2
str2(k12,k15)=bonds(m(k15))
coef(k12)=cof
enddo
print*,'sourav2',coef(k12),(str2(k12,l),l=1,(nae-nl*2-nlast)/2)
goto 201
endif

do i3=5,6
cof=cof*(-1)**(i3-1)
c3=cof
k11=3
!print*,'sourav1'
do k13=1,2
if(i3.eq.m(k13))goto 202
enddo
!print*,'sourav2'
m(3)=i3
if (k11.eq.(nae-nl*2-nlast)/2) then
k12=k12+1
do k15=1,(nae-nl*2-nlast)/2
str2(k12,k15)=bonds(m(k15))
coef(k12)=cof
enddo
!print*,'sourav',coef(k12),(str2(k12,l),l=1,(nae-nl*2-nlast)/2)
goto 202
endif

do i4=7,8
cof=cof*(-1)**(i4-1)
c4=cof
k11=4
do k14=1,3
if(i4.eq.m(k14))goto 203
enddo
m(4)=i4
!print*,(m(l),l=1,nao)
if (k11.eq.(nae-nl*2-nlast)/2) then
k12=k12+1
do k15=1,(nae-nl*2-nlast)/2
str2(k12,k15)=bonds(m(k15))
coef(k12)=cof
enddo
!print*,'sourav',coef(k12),(str2(k12,l),l=1,(nae-nl*2-nlast)/2)
goto 203
endif

!print*,'sourav4'
do i5=9,10
cof=cof*(-1)**(i5-1)
c5=cof
k11=5
do k14=1,4
if(i5.eq.m(k14))goto 204
enddo
m(5)=i5
if (k11.eq.(nae-nl*2-nlast)/2) then
k12=k12+1
do k15=1,(nae-nl*2-nlast)/2
str2(k12,k15)=bonds(m(k15))
coef(k12)=cof
enddo
!print*,(strc(i,l),l=1,nae-nl*2-nlast)
goto 204
endif

do i6=11,12
cof=cof*(-1)**(i6-1)
c6=cof
k11=6
do k14=1,5
if(i6.eq.m(k14))goto 205
enddo
m(6)=i6
if (k11.eq.(nae-nl*2-nlast)/2) then
k12=k12+1
do k15=1,(nae-nl*2-nlast)/2
str2(k12,k15)=bonds(m(k15))
coef(k12)=cof
enddo
!print*,(str2(i,l),l=1,nae-nlp*2-nlast)
goto 205
endif

do i8=13,14
cof=cof*(-1)**(i8-1)
c7=cof
k11=7
do k14=1,6
if(i8.eq.m(k14))goto 206
enddo
m(7)=i8
if (k11.eq.(nae-nl*2-nlast)/2) then
k12=k12+1
do k15=1,(nae-nl*2-nlast)/2
str2(k12,k15)=bonds(m(k15))
coef(k12)=cof
enddo
!print*,(str2(i,l),l=1,nae-nlp*2-nlast)
goto 206
endif

do i9=15,16
cof=cof*(-1)**(i9-1)
c8=cof
k11=8
do k14=1,7
if(i9.eq.m(k14))goto 207
enddo
m(8)=i9
if (k11.eq.(nae-nl*2-nlast)/2) then
k12=k12+1
do k15=1,(nae-nl*2-nlast)/2
str2(k12,k15)=bonds(m(k15))
coef(k12)=cof
enddo
!print*,(str2(i,l),l=1,nae-nlp*2-nlast)
goto 207
endif

do i10=17,18
cof=cof*(-1)**(i10-1)
c9=cof
k11=9
do k14=1,8
if(i10.eq.m(k14))goto 208
enddo
m(9)=i10
if (k11.eq.(nae-nl*2-nlast)/2) then
k12=k12+1
do k15=1,(nae-nl*2-nlast)/2
str2(k12,k15)=bonds(m(k15))
coef(k12)=cof
enddo
goto 208
endif

do i11=19,20
cof=cof*(-1)**(i11-1)
c10=cof
k11=10
do k14=1,9
if(i11.eq.m(k14))goto 209
enddo
m(10)=i11
if (k11.eq.(nae-nl*2-nlast)/2) then
k12=k12+1
do k15=1,(nae-nl*2-nlast)/2
str2(k12,k15)=bonds(m(k15))
coef(k12)=cof
enddo
goto 209
endif

209 cof=c10
enddo
208 cof=c9
enddo
207 cof=c8
enddo
206 cof=c7
enddo
205 cof=c6
enddo
204 cof=c5
enddo
203 cof=c4
enddo
202 cof=c3
enddo
201 cof=c2
enddo
200 cof=c1
enddo

print*,'symmetry index5',symm
ndet=k12

do k14=1,k12
tndet=tndet+1
i8=(nae-nl*2-nlast)/2
do i6=nae-nlast+1,nae
i8=i8+1
str2(k14,i8)=str1(i7,i6)
enddo
i5=0
do i1=1,i8
do i2=nl*2+1,nae-nlast
if(str2(k14,i1).eq.str1(i7,i2))then
if(mod(i2,2).eq.1)i3=i2+1
if(mod(i2,2).eq.0)i3=i2-1
endif
enddo
beta1(k14,i1)=str1(i7,i3)
enddo

k7=0
if(nl.ne.0)then
do k6=1,nl*2,2
k7=k7+1
alfa(k14,k7)=str1(i7,k6)
beta(k14,k7)=str1(i7,k6)
enddo
endif

do k6=1,(nae-nl*2-nlast)/2
k7=k7+1
alfa(k14,k7)=str2(k14,k6)
beta(k14,k7)=beta1(k14,k6)
enddo

!write(9,*),'det:vector',(alfa(k14,k6),k6=1,k7),(beta(k14,k6),k6=1,k7)
!print*,'sub: vector 4'

if(nlast.ne.0)then
do k6=nae-nlast+1,nae
k7=k7+1
alfa(k14,k7)=str1(i7,k6)
enddo
endif

do k6=1,1000
rum1(k6)=0
enddo

k7=0
i5=0
kkk=0
permtn1=0
770 k=100
kk=0
do k6=1,(nae-nl*2-nlast)/2+nl+nlast
do k8=1,k7
if(rum1(k8).eq.alfa(k14,k6))goto 769
enddo
kk=kk+1
if(k.gt.alfa(k14,k6))then
kkk=kk
k=alfa(k14,k6)
endif
769 enddo
k7=k7+1
i5=i5+1
rum1(k7)=k
permtn1=permtn1+(kkk-1)
detmnt(tndet,i5)=k
strdet(tndet)=i7

!print*,'strdet',strdet(tndet),tndet
!print*,'detmnt1',detmnt(tndet,i5)
!print*,'kk,k7,permtn1',kk,k7,permtn1
!print*,'rum1',rum1(k7)

print*,'symmetry index6',symm
if(k7.lt.((nae-nl*2-nlast)/2)+nl+nlast)goto 770


do k6=1,1000
rum1(k6)=0
enddo

k7=0
permtn2=0
kkk=0
780 k=1000
kk=0
do k6=1,(nae-nl*2-nlast)/2+nl
!print*,'k6',k6
do k8=1,k7
if(rum1(k8).eq.beta(k14,k6))goto 789
enddo
kk=kk+1
!print*,'nnlp',beta(k14,k6),k
if(k.gt.beta(k14,k6))then
kkk=kk
k=beta(k14,k6)
!print*,'kk',kk
endif
789 enddo
!print*,'kkk',k
k7=k7+1
i5=i5+1
rum1(k7)=k
permtn2=permtn2+(kkk-1)
detmnt(tndet,i5)=k
strdet(tndet)=i7

!print*,'strdet',strdet(tndet),tndet
!print*,'detmnt2',detmnt(tndet,i5)

!print*,'kk,permtn2',kk,permtn2
!print*,'rum1',rum1(k7)

if(k7.lt.((nae-nl*2-nlast)/2)+nl+nlast)goto 780

permtn=permtn1+permtn2

det_sign(tndet)=(-1)**permtn
j=j+1
sign_det(i7,j)=det_sign(tndet)
detcount=detcount+1
str_det_sec(i7,detcount)=tndet

enddo
300 format (a,20I3)

!print*,'sub: vector 5'



do i1=1,k12
i4=nend/2
do i3=1,nae-nl*2
do i2=1,nend/2
if(str2(i1,i2).eq.rum2(i3))goto 558
enddo
i4=i4+1
!print*,rum2(i3),i4
str2(i1,i4)=rum2(i3)
558 enddo
enddo

i3=0
do i1=1,ndet
do i2=1,ntdet
det=0
det1=0
do i3=1,nend/2
do i4=1,nend/2
if(str2(i1,i3).eq.all_det(i2,i4))then
det=det+1
endif
enddo
enddo
if(det.eq.nend/2)then
do i3=1+nend/2,nae-nl*2
do i4=1+nend/2,nae-nl*2
if(str2(i1,i3).eq.all_det(i2,i4))then
det1=det1+1
endif
enddo
enddo
if(det1.eq.(nae-nl*2)-(nend/2))then
i3=i3+1
vector(i7,i2)=1*coef(i1)
endif
endif
enddo
enddo

i3=0
do i2=1,ntdet
if(vector(i7,i2).ne.0)then
i3=i3+1
vec(i7,i3)=i2
endif
enddo

detno=i3

detn= real(detno,4)
!write(*,321),i7,'vec',(vec(i7,i4),i4=1,i3)
norm_const=1/sqrt(detn)

!write(9,321),i7,'vector>',(vector(i7,i4),i4=1,ntdet)

enddo

!write(9,*),'ntdet,tndet,ndet',ntdet,tndet,ndet
!do i=1,totstr
!write(9,321),i,'vector>',(vector(i,i4),i4=1,ntdet)
!enddo

print*,'symmetry index7',symm,totstr*ndet,totstr,ndet
do l=1,totstr*ndet
write(*,123),'detmnt(l,i)',(detmnt(l,i),i=1,nae),det_sign(l)
enddo
123 format(a,2x,50I5)
321 format(I5,a,500I3)
!!!end of independency test

339 print*,'exit vector_rep,symm',symm
deallocate(sign_det)
deallocate(str2)
deallocate(beta)
deallocate(beta1)
deallocate(alfa)
deallocate(vector)
deallocate(all_det)
return
end subroutine vector_rep

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine overlap(nl,str1,totstr)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
use commondat1
implicit none

integer::i,i1,i2,i3,i4,i5,i6,i7,j,k,l,col1(2,1000),nl,str1(15000,20),totstr,nio
real::orb_ovlp_mat1_norm(10,10)
Double Precision::D1(1000),aldet_new
double precision::ovlp_mat(5000,100)

nio=niao
if(ovlp_int.eq.0)then
  do i=1,nactorb
    do j=1,nactorb
      if(i.eq.j)then
      orb_ovlp_mat1(i,j)=4.0
      else
        if(atm_nb_sym(i).eq.atm_nb_sym(j))then 
          if(atm_nb_orbs(i).eq.atm_nb_orbs(j))then
          orb_ovlp_mat1(i,j)=3.0
          else
          orb_ovlp_mat1(i,j)=2.0/dist_rel_mat(atm_nb_orbs(i),atm_nb_orbs(j))
          endif
        else
        orb_ovlp_mat1(i,j)=0.0
        endif
      endif
    enddo
  enddo
endif

do i1=1,5000
  do i2=1,100
    ovlp_mat(i1,i2)=0.0
  enddo
enddo

print*,'symmetry index1',symm
do i1=1,totstr
  do i2=i1,totstr
    do i3=1,ndet
      do i4=1,ndet
      aldet_new=1.0
        do i5=1,nalpha+nl
        col1(1,i5)=detmnt(str_det_sec(i1,i3),i5)-nio
        enddo
        do i5=1,nalpha+nl
        col1(2,i5)=detmnt(str_det_sec(i2,i4),i5)-nio
        enddo
        call MatLDR1('orb',col1,nalpha+nl,D1)
        do i6=1,nalpha+nl
        aldet_new=aldet_new*D1(i6)
        enddo
        do i6=1,20
        col1(1,i6)=0
        col1(2,i6)=0
        enddo
        i6=0
        do i5=nalpha+nl+1,nalpha+nl+nbeta+nl
        i6=i6+1
        col1(1,i6)=detmnt(str_det_sec(i1,i3),i5)-nio
        enddo
        i6=0
        do i5=nalpha+nl+1,nalpha+nl+nbeta+nl
        i6=i6+1
        col1(2,i6)=detmnt(str_det_sec(i2,i4),i5)-nio
        enddo
        call MatLDR1('orb',col1,nbeta+nl,D1)
        do i6=1,nbeta+nl
        aldet_new=aldet_new*D1(i6)
        enddo
        ovlp_mat(i1,i2)=ovlp_mat(i1,i2)+aldet_new*det_sign(str_det_sec(i1,i3))*det_sign(str_det_sec(i2,i4))
      enddo
    enddo
  enddo
enddo

print*,'symmetry index2',symm
do i1=1,totstr
  do i2=i1+1,totstr
  ovlp_mat(i2,i1)=ovlp_mat(i1,i2)
  enddo
enddo

do i1=1,totstr
  do i2=1,totstr
  ovlp_mat_norm(i1,i2)=ovlp_mat(i1,i2)/sqrt(ovlp_mat(i1,i1)*ovlp_mat(i2,i2))
  enddo
enddo

321 format(I5,a,50I3)
320 format(I5,a,50F11.3)

return
end subroutine overlap
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine matrx_norm(ovlp_mat,totstr,ovlp_mat_norm)
implicit none

integer::i1,i2,totstr
double precision::ovlp_mat(5000,100),ovlp_mat_norm(5000,100)

do i1=1,totstr
do i2=1,totstr
ovlp_mat_norm(i1,i2)=ovlp_mat(i1,i2)/sqrt(ovlp_mat(i1,i1)*ovlp_mat(i2,i2))
enddo
enddo


end subroutine matrx_norm
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine intra_bond_factor(nl,str,tonstruc,str_quality_1)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::nl,i2,m8,l1,l2,l3,k1,k2,m13,m14,str(15000,20),str_quality_1(15000),tonstruc

print*,'enter intra_bond_factor'
do m8=1,15000
str_quality_1(m8)=1
enddo

l3=1
do m8=1,tonstruc
!print*,'ssttr',(str(m8,i2),i2=1,nae)
l2=1
do k2=1+nl*2,nae-nlast,2
do m13=1,atom
l1=0
do m14=1,atn(active_atoms(m13))
if(atn(active_atoms(m13)).eq.1)goto 505
do k1=k2,k2+1
if(str(m8,k1).eq.atoset(active_atoms(m13),m14))then
l1=l1+1
endif
enddo
505 enddo
if(l1.eq.2) then
l2=l2+l3
goto 506
endif
enddo
506 enddo
str_quality_1(m8)=l2
!print*,'intra_bond_factor',str_quality_1(m8)
enddo


print*,'exit intra_bond_factor'
return
end subroutine intra_bond_factor
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine symm_break_factor(nl,str,tonstruc,str_quality_2)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::nl,i2,m8,l1,l2,l3,k1,k2,m13,m14,str(15000,20),str_quality_2(15000),tonstruc
integer::atsymset(20,20),nsym,syn(50),at_sym(50)

common/ats/atsymset,nsym,syn,at_sym

print*,'enter symm_break_factor'
do m8=1,15000
str_quality_2(m8)=1
enddo
do m8=1,tonstruc
!print*,'symm_break:sttr',(str(m8,i2),i2=1,nae)
l2=1
if(nsym.eq.1)goto 509
if(nsym.ne.1)l2=1+(nae-nlast-nl*2)/2
do k2=1+nl*2,nae-nlast,2
!print*,'k2',k2
do m13=1,nsym
l1=0
do m14=1,syn(m13)
if(syn(m13).eq.1)goto 507
do k1=k2,k2+1
if(str(m8,k1).eq.atsymset(m13,m14))then
l1=l1+1
endif
enddo
507 enddo
if(l1.eq.2) then
l2=l2-1 
goto 508
endif
enddo
508 enddo
str_quality_2(m8)=l2
509 enddo

!print*,'tonstruc',tonstruc
do m8=1,tonstruc
!!quality_fac(m8)=str_quality_1(m8)*str_quality_2(m8)-(str_quality_2(m8)-1)*(str_quality_1(m8)-1)
print*,'symm_break:sttr',(str(m8,i2),i2=1,nae)
print*,'qqqqqq',str_quality_2(m8)
enddo

print*,'exit symm_break_factor'
return
end subroutine symm_break_factor
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!subroutine w_s_x(nl,strn,str3,ncqs,q_fac2)
!!!
!!!!!!! this subroutine select the independent structures and write them in the .xmi file 
!!!!!!! for the symmetric set of structures of a symmetric molecule (as opted by user) ....
!!!!!!! subroutine started to select the structures of highest quality biggest
!!!!!!! symmetric set and select the structures as a set of symmetric set if
!!!!!!! they are independent with the previous sets or reject the full set
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!use commondat
!!implicit none
!!common/quality/str_quality_1,str_quality_2,bondq,tqlty,bqlty,sqlty,tnqs,nssym,qulsym,symq,&
!!sigsym,tnqs_sig
!!common/str/str5,nstr7
!!
!!integer::nl,strn,ncqs,tostr,initstr,i,i1,i2,i3,i4,i5,i6,i7,i8,i9,m119,m18,m19,m20,m21,m23,m24,count&
!!,qul(100),nqul,j,jj,jjj,fg,flg,ii5,m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,x,y,strs
!!integer::i5up16,i16i7,m16m21,i5up15,i15i7,m15m21,i5up14,i14i7,m14m21,i5up13,i13i7,m13m21,i5up12,i12i7,m12m21,&
!!i5up11,i11i7,m11m21,i5up10,i10i7,m10m21,i5up9,i9i7,m9m21,i5up8,i8i7,m8m21,i5up7,i7i7,m7m21,i5up6,i6i7,m6m21,&
!!i5up5,i5i7,m5m21,i5up4,i4i7,m4m21,i5up3,i3i7,m3m21,i5up2,i2i7,m2m21,i5up1,i1i7,m1m21,i5up17,i17i7,m17m21
!!integer::str3(15000,20),q_fac2(15000),finalvec(15000),strset(1000),col(1000),sigsym(15000),tnqs_sig,&
!!ffvec2(15000,1000),bondq(15000),bondq4(15000),nqset(15000),str5(2000,20),nstr7,&
!!tndet,totstr,Ifail,indpnt,strno(1000),str_quality_1(15000),str_quality_2(15000),ttqlty0,ttqlty&
!!,tqlty,bqlty,sqlty,hqlty,tnqs,nssym,qulsym(15000),symq(15000),set_number,ttqlty1,det_inv,ttqlty2,ttqlty3
!!integer::rumer(15000),rumer_rad(15000),quality_fac(15000),rumset,u1,max_set,mns
!!!integer,dimension(:),allocatable::qq1,qq2,qq
!!integer::qq1(5000),qq2(5000),qq(5000),str2(2000,20),Rid,set_num(100)
!!real*8::ovlp
!!Double Precision::D(1000)
!!character(10)::dd,a
!!character(len=100)::outfile
!!
!!
!!print*,'enter write_symm_xmi'
!!!x=100000
!!!y=100
!!!
!!!allocate(str2(x,y))
!!!allocate(qq(x))
!!!allocate(qq1(x))
!!!allocate(qq2(x))
!!!str2(x,y)=0
!!!qq(x)=0
!!!qq1(x)=0
!!!qq2(x)=0
!!mns=0
!!u1=1
!!max_set=75000
!!
!!if(nfset.eq.3.or.nfset.eq.5)then
!!rumset=0
!!call rumer_structures(nl,str3,ncqs,rumer,rumer_rad)
!!call write_rumer_xmi(nl,str3,ncqs,rumer,rumer_rad,quality_fac)
!!endif
!!
!!!print *,'write_symm_xmi'
!!set_number=0
!!bqlty=0
!!tqlty=0
!!sqlty=0
!!hqlty=0
!!indpnt=2
!!!ovlpval=1.0
!!if(noq0.gt.strn)then
!!ttqlty0=noq0
!!else
!!ttqlty0=strn+noq0
!!endif
!!ttqlty1=strn+noq1
!!ttqlty2=strn+noq2
!!ttqlty3=strn+noq3
!!
!!write(*,*)'ttqlty1,ttqlty2,ttqlty3',ttqlty1,ttqlty2,ttqlty3,ttqlty0,noq1,noq2,noq3,noq0,nfset
!!!!!!!!! strn = number of permissible structures !!!!
!!!print*,'sou1',strn,ndet,nl,ncqs
!!do i=1,ncqs
!!write(*,231),i,(str3(i,j),j=1,nae),q_fac2(i),str_quality_1(i),str_quality_2(i),bondq(i)
!!enddo
!!!if(indpnt.eq.1)then
!!!call vector_rep(nl,str3,ncqs,ffvec2)
!!!endif
!!!print*,'sou1',strn,ndet,nl,ncqs
!!!do i1=1,ncqs
!!!print*,(ffvec2(i1,i),i=1,ndet)
!!!enddo
!!!call quality_factor(nl,str3,ncqs,q_fac2,q_1,q_2)
!!jj=1
!!do m19=1,ncqs
!!!print*,'q_fac2',q_fac2(m19)
!!if(m19.eq.1)qul(1)=q_fac2(1)
!!j=jj
!!do i=1,j
!!if(qul(i).eq.q_fac2(m19))goto 373
!!enddo
!!jj=jj+1
!!qul(i)=q_fac2(m19)
!!!print*,qul(i)
!!373 enddo
!!nqul=jj
!!!print*,'ncqs',ncqs
!!
!!do i=1,nqul
!!jjj=0
!!jj=0
!!do m19=1,ncqs
!!!print*,qul(i),q_fac2(m19)
!!if(qul(i).eq.q_fac2(m19))then
!!jjj=jjj+1
!!jj=m19
!!endif
!!enddo
!!nqset(i)=jjj
!!strset(i)=jj
!!print*,'nqset(i)',i,nqset(i),qul(i),strset(i)
!!!write(*,231),(str3(i,j),j=1,nae)
!!enddo
!!
!!flg=0
!!totstr=0
!!i7=0
!!m21=0
!!i5=ndet
!!do i8=1,1000
!!finalvec(i8)=0
!!enddo
!!do m19=1,10000
!!do m18=1,15
!!str2(m19,m18)=0
!!enddo
!!enddo
!!
!!
!!i5up1=i5
!!i1i7=i7
!!m1m21=m21
!!
!!!!!!! LOOP STARTS !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!
!!!!!!! loop 1 >>>
!!do m1=1,nqul
!!print*,'loop1'
!!
!!do i=i5up1+1,i5
!!finalvec(i)=0
!!enddo
!!
!!do m19=i1i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!
!!i7=i1i7
!!totstr=i1i7
!!m21=m1m21
!!
!!jj=0
!!
!!flg=0
!!
!!if(nqset(m1).gt.strn)goto 701
!!
!!if(m1.eq.1)then
!!do i=1,strset(m1)
!!totstr=totstr+1
!!strno(totstr)=i
!!enddo
!!else
!!do i=strset(m1-1)+1,strset(m1)
!!totstr=totstr+1
!!strno(totstr)=i
!!enddo
!!endif
!!if(totstr.gt.strn)goto 701
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!if(Ifail.eq.1)goto 701
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!call MatLDR('str',strno,totstr,D)
!!
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!if(1.0-ovlp.gt.ovval)goto 701
!!endif
!!
!!m21=m21+nqset(m1)
!!if(m21.gt.strn) goto 701
!!
!!if(m1.eq.1)strs=0
!!if(m1.ne.1)strs=strset(m1-1)
!!
!!do m19=strs+1,strset(m1)
!!if(q_fac2(m19).ne.qul(m1))goto 601
!!i7=i7+1
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=1
!!601 enddo
!!if(i7.eq.strn) then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!enddo
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!if(nfset.eq.3)then
!!Rumwrite=1
!!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!!endif
!!
!!if(ovopt.eq.1) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!
!!goto 701
!!endif
!!
!!i5up2=i5
!!i2i7=i7
!!m2m21=m21
!!
!!!!!!! loop 2 >>>
!!
!!do m2=m1+1,nqul
!!print*,'loop2'
!!
!!do i=i5up2+1,i5
!!finalvec(i)=0
!!enddo
!!
!!do m19=i2i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!
!!i7=i2i7
!!totstr=i2i7
!!m21=m2m21
!!
!!jj=0
!!
!!flg=0
!!
!!if(nqset(m2).gt.strn)goto 702
!!
!!do i=strset(m2-1)+1,strset(m2)
!!totstr=totstr+1
!!strno(totstr)=i
!!enddo
!!if(totstr.gt.strn)goto 702
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!
!!if(Ifail.eq.1) goto 702
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!call MatLDR('str',strno,totstr,D)
!!
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!if(1.0-ovlp.gt.ovval)goto 702
!!endif
!!
!!
!!m21=m21+nqset(m2)
!!if(m21.gt.strn) goto 702
!!
!!
!!do m19=strset(m2-1)+1,strset(m2)
!!if(q_fac2(m19).ne.qul(m2))goto 602
!!i7=i7+1
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=2
!!602 enddo
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!enddo
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!if(nfset.eq.3)then
!!Rumwrite=1
!!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!!endif
!!if(ovopt.eq.1) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!goto 702
!!endif
!!
!!
!!i5up3=i5
!!i3i7=i7
!!m3m21=m21
!!
!!!!!!! loop 3 >>>
!!
!!do m3=m2+1,nqul
!!print*,'loop3'
!!
!!do i=i5up3+1,i5
!!finalvec(i)=0
!!enddo
!!
!!do m19=i3i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!
!!i7=i3i7
!!totstr=i3i7
!!m21=m3m21
!!
!!jj=0
!!
!!flg=0
!!
!!!do m19=strset(m3-1)+1,strset(m3)
!!
!!if(nqset(m3).gt.strn)goto 703
!!
!!do i=strset(m3-1)+1,strset(m3)
!!totstr=totstr+1
!!strno(totstr)=i
!!print*,'strno',strno(totstr)
!!enddo
!!if(totstr.gt.strn)goto 703
!!do i=1,totstr
!!print*,'strno_all',strno(i)
!!enddo
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!!write(9,*),'ifail',ifail,det_inv
!!
!!print*,'Ifail',Ifail,i7,q_fac2(m19)
!!if(Ifail.eq.1) goto 703
!!!do i=strset(m3-1)+1,strset(m3)
!!!strno(totstr)=0
!!!totstr=totstr-1
!!!enddo
!!!goto 703
!!!endif
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!!print*,'MatLDR_write_xmi',totstr
!!call MatLDR('str',strno,totstr,D)
!!
!!!print*,'DDD',(D(i),i=1,totstr)
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!!print*,'ovval',1.0-ovlp,ovlp
!!if(1.0-ovlp.gt.ovval)goto 703
!!endif
!!
!!m21=m21+nqset(m3)
!!if(m21.gt.strn) goto 703
!!!print*,'sourav_xmi_sym'
!!
!!!303 enddo
!!
!!
!!do m19=strset(m3-1)+1,strset(m3)
!!if(q_fac2(m19).ne.qul(m3))goto 603
!!i7=i7+1
!!print*,'new struc',i7,m19,q_fac2(m19),str_quality_1(m19),str_quality_2(m19),bondq(m19)
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=3
!!603 enddo
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!!tqlty=tqlty+qq1(m119)
!!!bqlty=bqlty+bondq4(m119)
!!!sqlty=sqlty+qq2(m119)
!!enddo
!!!endif
!!print*,'ttqlty,ttqlty0',ttqlty,ttqlty0
!!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!!endif
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!!if(nfset.eq.0.or.nfset.gt.1) then
!!if(ovopt.eq.vpt) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!!write(9,910)'quality value',ttqlty
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!!endif
!!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!!'ovval',1.0-ovlp
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!!write(9,911),tqlty,sqlty,bqlty
!!!bqlty=0
!!!!set_number=set_number+1
!!!write(9,*),'Set_number=',set_number
!!!write(9,*),'    '
!!!endif
!!!endif
!!!if(nfset.eq.1)goto 379
!!goto 703
!!endif
!!
!!i5up4=i5
!!i4i7=i7
!!m4m21=m21
!!
!!!!! loop 4 >>>
!!do m4=m3+1,nqul
!!print*,'loop4'
!!!print*,'m4m4m4',m4
!!do i=i5up4+1,i5
!!finalvec(i)=0
!!enddo
!!do m19=i4i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!i7=i4i7
!!totstr=i4i7
!!m21=m4m21
!!
!!jj=0
!!
!!flg=0
!!!do m19=strset(m4-1)+1,strset(m4)
!!
!!if(nqset(m4).gt.strn)goto 704
!!
!!do i=strset(m4-1)+1,strset(m4)
!!totstr=totstr+1
!!strno(totstr)=i
!!print*,'strno',strno(totstr)
!!enddo
!!
!!if(totstr.gt.strn)goto 704
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!!write(9,*),'ifail',ifail,det_inv
!!!print*,'ifail4',ifail
!!print*,'Ifail',Ifail,i7,q_fac2(m19)
!!if(Ifail.eq.1) goto 704
!!!strno(totstr)=0
!!!totstr=totstr-1
!!!goto 304
!!!endif
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!!print*,'MatLDR_write_xmi',totstr
!!call MatLDR('str',strno,totstr,D)
!!
!!!print*,'DDD',(D(i),i=1,totstr)
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!!print*,'ovval',1.0-ovlp,ovlp
!!if(1.0-ovlp.gt.ovval)goto 704
!!endif
!!
!!
!!m21=m21+nqset(m4)
!!if(m21.gt.strn) goto 704
!!!print*,'sourav_xmi_sym'
!!
!!!304 enddo
!!
!!
!!do m19=strset(m4-1)+1,strset(m4)
!!if(q_fac2(m19).ne.qul(m4))goto 604
!!i7=i7+1
!!print*,'new struc',i7,m19,q_fac2(m19),str_quality_1(m19),str_quality_2(m19),bondq(m19)
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=4
!!604 enddo
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!!tqlty=tqlty+qq1(m119)
!!!bqlty=bqlty+bondq4(m119)
!!!sqlty=sqlty+qq2(m119)
!!enddo
!!!endif
!!print*,'ttqlty,ttqlty0',ttqlty,ttqlty0
!!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!!endif
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!!if(nfset.eq.0.or.nfset.gt.1) then
!!if(ovopt.eq.vpt) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!!write(9,910)'quality value',ttqlty
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!!endif
!!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!!'ovval',1.0-ovlp
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!!write(9,911),tqlty,sqlty,bqlty
!!!bqlty=0
!!!!set_number=set_number+1
!!!write(9,*),'Set_number=',set_number
!!!write(9,*),'    '
!!!endif
!!!endif
!!!if(nfset.eq.1)goto 379
!!goto 704
!!endif
!!
!!i5up5=i5
!!i5i7=i7
!!m5m21=m21
!!
!!!!!!! loop 5 >>>
!!do m5=m4+1,nqul
!!print*,'loop5'
!!!print*,'m5m5m5',m5
!!do i=i5up5+1,i5
!!finalvec(i)=0
!!enddo
!!do m19=i5i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!i7=i5i7
!!totstr=i5i7
!!!print*,'totstr5',totstr
!!m21=m5m21
!!
!!jj=0
!!
!!flg=0
!!!do m19=strset(m5-1)+1,strset(m5)
!!
!!if(nqset(m5).gt.strn)goto 705
!!
!!do i=strset(m5-1)+1,strset(m5)
!!totstr=totstr+1
!!strno(totstr)=i
!!print*,'strno',strno(totstr)
!!enddo
!!
!!if(totstr.gt.strn)goto 705
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!!write(9,*),'ifail',ifail,det_inv
!!print*,'Ifail',Ifail,i7,q_fac2(m19)
!!if(Ifail.eq.1) goto 705
!!
!!!strno(totstr)=0
!!!totstr=totstr-1
!!!goto 305
!!!endif
!!!endif
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!!print*,'MatLDR_write_xmi',totstr
!!call MatLDR('str',strno,totstr,D)
!!
!!!print*,'DDD',(D(i),i=1,totstr)
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!!print*,'ovval',1.0-ovlp,ovlp
!!if(1.0-ovlp.gt.ovval)goto 705
!!endif
!!
!!
!!m21=m21+nqset(m5)
!!if(m21.gt.strn) goto 705
!!!print*,'sourav_xmi_sym'
!!
!!!305 enddo
!!
!!!print*,'jj',jj,m5,nqul
!!!print*,'******jj',jj
!!
!!do m19=strset(m5-1)+1,strset(m5)
!!if(q_fac2(m19).ne.qul(m5))goto 605
!!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!!i7=i7+1
!!print*,'new struc',i7,m19,q_fac2(m19),str_quality_1(m19),str_quality_2(m19),bondq(m19)
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=5
!!605 enddo
!!!print*,'i7 5',i7,m5
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!!tqlty=tqlty+qq1(m119)
!!!bqlty=bqlty+bondq4(m119)
!!!sqlty=sqlty+qq2(m119)
!!enddo
!!!endif
!!print*,'ttqlty,ttqlty0',ttqlty,ttqlty0
!!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!!endif
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!!if(nfset.eq.0.or.nfset.gt.1) then
!!if(nfset.eq.3)then
!!Rumwrite=1
!!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!!endif
!!if(ovopt.eq.1) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!!write(9,910)'quality value',ttqlty
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!!endif
!!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!!'ovval',1.0-ovlp
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!!write(9,911),tqlty,sqlty,bqlty
!!!bqlty=0
!!!!set_number=set_number+1
!!!write(9,*),'Set_number=',set_number
!!!write(9,*),'    '
!!!endif
!!!endif
!!!if(nfset.eq.1)goto 379
!!goto 705
!!endif
!!
!!i5up6=i5
!!i6i7=i7
!!m6m21=m21
!!
!!do m6=m5+1,nqul
!!
!!print*,'loop6'
!!!print*,'m6m6m6',m6
!!do i=i5up6+1,i5
!!finalvec(i)=0
!!enddo
!!do m19=i6i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!i7=i6i7
!!totstr=i6i7
!!!print*,'totstr6',totstr
!!m21=m6m21
!!
!!jj=0
!!
!!flg=0
!!!do m19=strset(m6-1)+1,strset(m6)
!!
!!if(nqset(m6).gt.strn)goto 706
!!
!!do i=strset(m6-1)+1,strset(m6)
!!totstr=totstr+1
!!strno(totstr)=i
!!print*,'strno',strno(totstr)
!!enddo
!!
!!if(totstr.gt.strn)goto 706
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!!write(9,*),'ifail',ifail,det_inv
!!!print*,'ifail6',ifail
!!print*,'Ifail',Ifail,i7,q_fac2(m19),str_quality_1(m19),str_quality_2(m19),bondq(m19)
!!if(Ifail.eq.1)goto 706
!!!!do i8=1,nae
!!!!str4(totstr,i8)=0
!!!!enddo
!!!strno(totstr)=0
!!!totstr=totstr-1
!!!goto 306
!!!endif
!!!endif
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!!print*,'MatLDR_write_xmi',totstr
!!call MatLDR('str',strno,totstr,D)
!!
!!!print*,'DDD',(D(i),i=1,totstr)
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!!print*,'ovval',1.0-ovlp,ovlp
!!if(1.0-ovlp.gt.ovval)goto 706
!!endif
!!
!!
!!m21=m21+nqset(m6)
!!if(m21.gt.strn) goto 706
!!!print*,'sourav_xmi_sym'
!!
!!!306 enddo
!!
!!!print*,'jj',jj,m6,nqul
!!!print*,'******jj',jj
!!
!!do m19=strset(m6-1)+1,strset(m6)
!!if(q_fac2(m19).ne.qul(m6))goto 606
!!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!!i7=i7+1
!!print*,'new struc',i7,m19,q_fac2(m19),str_quality_1(m19),str_quality_2(m19),bondq(m19)
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=6
!!606 enddo
!!!print*,'i7  6',i7,m6
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!!tqlty=tqlty+qq1(m119)
!!!bqlty=bqlty+bondq4(m119)
!!!sqlty=sqlty+qq2(m119)
!!enddo
!!!endif
!!print*,'ttqlty,ttqlty0',ttqlty,ttqlty0
!!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0,tqlty,ttqlty1,bqlty,ttqlty2,sqlty,ttqlty3
!!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!!endif
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!!if(nfset.eq.0.or.nfset.gt.1) then
!!if(nfset.eq.3)then
!!Rumwrite=1
!!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!!endif
!!if(ovopt.eq.1) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!!write(9,910)'quality value',ttqlty
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!!endif
!!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!!'ovval',1.0-ovlp
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!!write(9,911),tqlty,sqlty,bqlty
!!!bqlty=0
!!!!set_number=set_number+1
!!!write(9,*),'Set_number=',set_number
!!!write(9,*),'    '
!!!endif
!!!endif
!!!if(nfset.eq.1)goto 379
!!goto 706
!!endif
!!
!!i5up7=i5
!!i7i7=i7
!!m7m21=m21
!!
!!do m7=m6+1,nqul
!!print*,'loop7'
!!!print*,'m7m7m7',m7
!!do i=i5up7+1,i5
!!finalvec(i)=0
!!enddo
!!do m19=i7i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!i7=i7i7
!!totstr=i7i7
!!!print*,'totstr7',totstr
!!m21=m7m21
!!
!!jj=0
!!
!!flg=0
!!!do m19=strset(m7-1)+1,strset(m7)
!!
!!if(nqset(m7).gt.strn)goto 707
!!
!!do i=strset(m7-1)+1,strset(m7)
!!totstr=totstr+1
!!strno(totstr)=i
!!print*,'strno',strno(totstr)
!!enddo
!!if(totstr.gt.strn)goto 707
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!!write(9,*),'ifail',ifail,det_inv
!!print*,'Ifail',Ifail,i7,q_fac2(m19)
!!if(Ifail.eq.1)goto 707
!!!!do i8=1,nae
!!!!str4(totstr,i8)=0
!!!!enddo
!!!strno(totstr)=0
!!!totstr=totstr-1
!!!goto 307
!!!endif
!!!endif
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!!print*,'MatLDR_write_xmi',totstr
!!call MatLDR('str',strno,totstr,D)
!!
!!!print*,'DDD',(D(i),i=1,totstr)
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!!print*,'ovval',1.0-ovlp,ovlp
!!if(1.0-ovlp.gt.ovval)goto 707
!!endif
!!
!!
!!m21=m21+nqset(m7)
!!if(m21.gt.strn) goto 707
!!!print*,'sourav_xmi_sym'
!!
!!!307 enddo
!!
!!!print*,'jj',jj,m7,nqul
!!!407 if(jj.eq.nqset(m7))then
!!!print*,'******jj',jj
!!
!!do m19=strset(m7-1)+1,strset(m7)
!!if(q_fac2(m19).ne.qul(m7))goto 607
!!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!!i7=i7+1
!!print*,'new struc',i7,m19,q_fac2(m19),str_quality_1(m19),str_quality_2(m19),bondq(m19)
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=7
!!607 enddo
!!print*,'i7 7',i7,strn
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!!tqlty=tqlty+qq1(m119)
!!!bqlty=bqlty+bondq4(m119)
!!!sqlty=sqlty+qq2(m119)
!!enddo
!!!endif
!!print*,'ttqlty,ttqlty0',ttqlty,ttqlty0
!!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!!endif
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!!if(nfset.eq.0.or.nfset.gt.1) then
!!if(nfset.eq.3)then
!!Rumwrite=1
!!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!!endif
!!if(ovopt.eq.1) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!!write(9,910)'quality value',ttqlty
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!!endif
!!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!!'ovval',1.0-ovlp
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!!write(9,911),tqlty,sqlty,bqlty
!!!bqlty=0
!!!!set_number=set_number+1
!!!write(9,*),'Set_number=',set_number
!!!write(9,*),'    '
!!!endif
!!!endif
!!!if(nfset.eq.1)goto 379
!!goto 707
!!endif
!!
!!i5up8=i5
!!i8i7=i7
!!m8m21=m21
!!
!!do m8=m7+1,nqul
!!print*,'loop8'
!!!print*,'m8m8m8',m8
!!do i=i5up8+1,i5
!!finalvec(i)=0
!!enddo
!!do m19=i8i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!i7=i8i7
!!totstr=i8i7
!!!print*,'totstr8',totstr
!!m21=m8m21
!!
!!jj=0
!!
!!flg=0
!!!do m19=strset(m8-1)+1,strset(m8)
!!
!!if(nqset(m8).gt.strn)goto 708
!!
!!do i=strset(m8-1)+1,strset(m8)
!!totstr=totstr+1
!!strno(totstr)=i
!!print*,'strno',strno(totstr)
!!enddo
!!
!!if(totstr.gt.strn)goto 708
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!!write(9,*),'ifail',ifail,det_inv
!!print*,'Ifail',Ifail,i7,q_fac2(m19)
!!if(Ifail.eq.1)goto 708
!!
!!!!do i8=1,nae
!!!!str4(totstr,i8)=0
!!!!enddo
!!!strno(totstr)=0
!!!totstr=totstr-1
!!!goto 308
!!!endif
!!!endif
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!!print*,'MatLDR_write_xmi',totstr
!!call MatLDR('str',strno,totstr,D)
!!
!!!print*,'DDD',(D(i),i=1,totstr)
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!!print*,'ovval',1.0-ovlp,ovlp
!!if(1.0-ovlp.gt.ovval)goto 708
!!endif
!!
!!
!!m21=m21+nqset(m8)
!!if(m21.gt.strn) goto 708
!!!print*,'sourav_xmi_sym'
!!
!!!308 enddo
!!
!!!print*,'jj',jj,m7,nqul
!!!408 if(jj.eq.nqset(m8))then
!!!print*,'******jj',jj
!!
!!do m19=strset(m8-1)+1,strset(m8)
!!if(q_fac2(m19).ne.qul(m8))goto 608
!!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!!i7=i7+1
!!print*,'new struc',i7,m19,q_fac2(m19)
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=8
!!608 enddo
!!!print*,'i7 8',i7,m8
!!print*,'i7 7',i7,strn
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!!tqlty=tqlty+qq1(m119)
!!!bqlty=bqlty+bondq4(m119)
!!!sqlty=sqlty+qq2(m119)
!!enddo
!!!endif
!!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!!endif
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!!if(nfset.eq.0.or.nfset.gt.1) then
!!if(nfset.eq.3)then
!!Rumwrite=1
!!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!!endif
!!if(ovopt.eq.1) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!!write(9,910)'quality value',ttqlty
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!!endif
!!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!!'ovval',1.0-ovlp
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!!write(9,911),tqlty,sqlty,bqlty
!!!bqlty=0
!!!!set_number=set_number+1
!!!write(9,*),'Set_number=',set_number
!!!write(9,*),'    '
!!!endif
!!!endif
!!!if(nfset.eq.1)goto 379
!!goto 708
!!endif
!!
!!i5up9=i5
!!i9i7=i7
!!m9m21=m21
!!
!!do m9=m8+1,nqul
!!print*,'loop9'
!!!print*,'m9m9m9',m9
!!do i=i5up9+1,i5
!!finalvec(i)=0
!!enddo
!!do m19=i9i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!i7=i9i7
!!totstr=i9i7
!!!print*,'totstr9',totstr
!!m21=m9m21
!!
!!jj=0
!!
!!flg=0
!!!do m19=strset(m9-1)+1,strset(m9)
!!
!!if(nqset(m9).gt.strn)goto 709
!!
!!do i=strset(m9-1)+1,strset(m9)
!!totstr=totstr+1
!!strno(totstr)=i
!!print*,'strno',strno(totstr)
!!enddo
!!
!!if(totstr.gt.strn)goto 709
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!!write(9,*),'ifail',ifail,det_inv
!!!print*,'ifail9',ifail
!!print*,'Ifail',Ifail,i7,q_fac2(m19)
!!if(Ifail.eq.1)goto 709
!!!!do i8=1,nae
!!!!str4(totstr,i8)=0
!!!!enddo
!!!strno(totstr)=0
!!!totstr=totstr-1
!!!goto 309
!!!endif
!!!endif
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!!print*,'MatLDR_write_xmi',totstr
!!call MatLDR('str',strno,totstr,D)
!!
!!!print*,'DDD',(D(i),i=1,totstr)
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!!print*,'ovval',1.0-ovlp,ovlp
!!if(1.0-ovlp.gt.ovval)goto 709
!!endif
!!
!!
!!m21=m21+nqset(m9)
!!if(m21.gt.strn) goto 709
!!!print*,'sourav_xmi_sym'
!!
!!!309 enddo
!!
!!!print*,'jj',jj,m9,nqul
!!!409 if(jj.eq.nqset(m9))then
!!!print*,'******jj',jj
!!
!!do m19=strset(m9-1)+1,strset(m9)
!!if(q_fac2(m19).ne.qul(m9))goto 609
!!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!!i7=i7+1
!!print*,'new struc',i7,m19,q_fac2(m19)
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=9
!!609 enddo
!!!print*,'i7 9',i7,m9
!!print*,'i7 7',i7,strn
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!!tqlty=tqlty+qq1(m119)
!!!bqlty=bqlty+bondq4(m119)
!!!sqlty=sqlty+qq2(m119)
!!enddo
!!!endif
!!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!!endif
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!!if(nfset.eq.0.or.nfset.gt.1) then
!!if(nfset.eq.3)then
!!Rumwrite=1
!!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!!endif
!!if(ovopt.eq.1) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!!write(9,910)'quality value',ttqlty
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!!endif
!!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!!'ovval',1.0-ovlp
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!!write(9,911),tqlty,sqlty,bqlty
!!!bqlty=0
!!!!set_number=set_number+1
!!!write(9,*),'Set_number=',set_number
!!!write(9,*),'    '
!!!endif
!!!endif
!!!if(nfset.eq.1)goto 379
!!goto 709
!!endif
!!
!!i5up10=i5
!!i10i7=i7
!!m10m21=m21
!!
!!do m10=m9+1,nqul
!!print*,'loop10'
!!!print*,'m10m10m10',m10
!!do i=i5up10+1,i5
!!finalvec(i)=0
!!enddo
!!do m19=i10i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!i7=i10i7
!!totstr=i10i7
!!!print*,'totstr10',totstr
!!m21=m10m21
!!
!!jj=0
!!
!!flg=0
!!!do m19=strset(m10-1)+1,strset(m10)
!!
!!if(nqset(m10).gt.strn)goto 710
!!
!!do i=strset(m10-1)+1,strset(m10)
!!totstr=totstr+1
!!strno(totstr)=i
!!print*,'strno',strno(totstr)
!!enddo
!!
!!if(totstr.gt.strn)goto 710
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!!write(9,*),'ifail',ifail,det_inv
!!print*,'Ifail',Ifail,i7,q_fac2(m19)
!!if(Ifail.eq.1)goto 710
!!!!do i8=1,nae
!!!!str4(totstr,i8)=0
!!!!enddo
!!!strno(totstr)=0
!!!totstr=totstr-1
!!!goto 310
!!!endif
!!!endif
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!!print*,'MatLDR_write_xmi',totstr
!!call MatLDR('str',strno,totstr,D)
!!
!!!print*,'DDD',(D(i),i=1,totstr)
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!!print*,'ovval',1.0-ovlp,ovlp
!!if(1.0-ovlp.gt.ovval)goto 710
!!endif
!!
!!
!!m21=m21+nqset(m10)
!!if(m21.gt.strn) goto 710
!!!print*,'sourav_xmi_sym'
!!
!!!310 enddo
!!
!!!print*,'jj',jj,m10,nqul
!!!410 if(jj.eq.nqset(m10))then
!!!print*,'******jj',jj
!!
!!do m19=strset(m10-1)+1,strset(m10)
!!if(q_fac2(m19).ne.qul(m10))goto 610
!!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!!i7=i7+1
!!print*,'new struc',i7,m19
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=10
!!610 enddo
!!!print*,'i7 10',i7,m10
!!print*,'i7 7',i7,strn
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!!tqlty=tqlty+qq1(m119)
!!!bqlty=bqlty+bondq4(m119)
!!!sqlty=sqlty+qq2(m119)
!!enddo
!!!endif
!!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!!endif
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!!if(nfset.eq.0.or.nfset.gt.1) then
!!if(nfset.eq.3)then
!!Rumwrite=1
!!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!!endif
!!if(ovopt.eq.1) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!!write(9,910)'quality value',ttqlty
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!!endif
!!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!!'ovval',1.0-ovlp
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!!write(9,911),tqlty,sqlty,bqlty
!!!bqlty=0
!!!!set_number=set_number+1
!!!write(9,*),'Set_number=',set_number
!!!write(9,*),'    '
!!!endif
!!!endif
!!!if(nfset.eq.1)goto 379
!!goto 710
!!endif
!!
!!i5up11=i5
!!i11i7=i7
!!m11m21=m21
!!
!!do m11=m10+1,nqul
!!print*,'loop11'
!!!print*,'m11m11m11',m11
!!do i=i5up11+1,i5
!!finalvec(i)=0
!!enddo
!!do m19=i11i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!i7=i11i7
!!totstr=i11i7
!!!print*,'totstr11',totstr
!!m21=m11m21
!!
!!jj=0
!!
!!flg=0
!!!do m19=strset(m11-1)+1,strset(m11)
!!
!!if(nqset(m11).gt.strn)goto 711
!!
!!do i=strset(m11-1)+1,strset(m11)
!!totstr=totstr+1
!!strno(totstr)=i
!!enddo
!!
!!if(totstr.gt.strn)goto 711
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!!write(9,*),'ifail',ifail,det_inv
!!print*,'Ifail',Ifail,i7
!!if(Ifail.eq.1)goto 711
!!!!do i8=1,nae
!!!!str4(totstr,i8)=0
!!!!enddo
!!!strno(totstr)=0
!!!totstr=totstr-1
!!!goto 311
!!!endif
!!!endif
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!!print*,'MatLDR_write_xmi',totstr
!!call MatLDR('str',strno,totstr,D)
!!
!!!print*,'DDD',(D(i),i=1,totstr)
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!!print*,'ovval',1.0-ovlp,ovlp
!!if(1.0-ovlp.gt.ovval)goto 711
!!endif
!!
!!
!!m21=m21+nqset(m11)
!!if(m21.gt.strn) goto 711
!!!print*,'sourav_xmi_sym'
!!
!!!311 enddo
!!
!!!print*,'jj',jj,m11,nqul
!!!411 if(jj.eq.nqset(m11))then
!!!print*,'******jj',jj
!!
!!do m19=strset(m11-1)+1,strset(m11)
!!if(q_fac2(m19).ne.qul(m11))goto 611
!!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!!i7=i7+1
!!print*,'new struc',i7,m19
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=11
!!611 enddo
!!!print*,'i7 11',i7,m11
!!print*,'i7 7',i7,strn
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!!tqlty=tqlty+qq1(m119)
!!!bqlty=bqlty+bondq4(m119)
!!!sqlty=sqlty+qq2(m119)
!!enddo
!!!endif
!!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!!endif
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!!if(nfset.eq.0.or.nfset.gt.1) then
!!if(nfset.eq.3)then
!!Rumwrite=1
!!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!!endif
!!if(ovopt.eq.1) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!!write(9,910)'quality value',ttqlty
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!!endif
!!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!!'ovval',1.0-ovlp
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!!write(9,911),tqlty,sqlty,bqlty
!!!bqlty=0
!!!!set_number=set_number+1
!!!write(9,*),'Set_number=',set_number
!!!write(9,*),'    '
!!!endif
!!!endif
!!!if(nfset.eq.1)goto 379
!!goto 711
!!endif
!!
!!i5up12=i5
!!i12i7=i7
!!m12m21=m21
!!
!!do m12=m11+1,nqul
!!print*,'loop12'
!!!print*,'m12m12m12',m12
!!do i=i5up12+1,i5
!!finalvec(i)=0
!!enddo
!!do m19=i12i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!i7=i12i7
!!totstr=i12i7
!!!print*,'totstr12',totstr
!!m21=m12m21
!!
!!jj=0
!!
!!flg=0
!!!do m19=strset(m12-1)+1,strset(m12)
!!
!!if(nqset(m12).gt.strn)goto 712
!!
!!do i=strset(m12-1)+1,strset(m12)
!!totstr=totstr+1
!!strno(totstr)=i
!!enddo
!!
!!if(totstr.gt.strn)goto 712
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!!write(9,*),'ifail',ifail,det_inv
!!print*,'Ifail',Ifail,i7
!!if(Ifail.eq.1)goto 712
!!!!do i8=1,nae
!!!!str4(totstr,i8)=0
!!!!enddo
!!!strno(totstr)=0
!!!totstr=totstr-1
!!!goto 312
!!!endif
!!!endif
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!!print*,'MatLDR_write_xmi',totstr
!!call MatLDR('str',strno,totstr,D)
!!
!!!print*,'DDD',(D(i),i=1,totstr)
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!!print*,'ovval',1.0-ovlp,ovlp
!!if(1.0-ovlp.gt.ovval)goto 712
!!endif
!!
!!
!!m21=m21+nqset(m12)
!!if(m21.gt.strn) goto 712
!!!print*,'sourav_xmi_sym'
!!
!!
!!!312 enddo
!!
!!!print*,'jj',jj,m12,nqul
!!!412 if(jj.eq.nqset(m12))then
!!!print*,'******jj',jj
!!
!!do m19=strset(m12-1)+1,strset(m12)
!!if(q_fac2(m19).ne.qul(m12))goto 612
!!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!!i7=i7+1
!!print*,'new struc',i7,m19
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=12
!!612 enddo
!!!print*,'i7 12',i7,m12
!!print*,'i7 7',i7,strn
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!!tqlty=tqlty+qq1(m119)
!!!bqlty=bqlty+bondq4(m119)
!!!sqlty=sqlty+qq2(m119)
!!enddo
!!!endif
!!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!!endif
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!!if(nfset.eq.0.or.nfset.gt.1) then
!!if(nfset.eq.3)then
!!Rumwrite=1
!!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!!endif
!!if(ovopt.eq.1) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!!write(9,910)'quality value',ttqlty
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!!endif
!!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!!'ovval',1.0-ovlp
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!!write(9,911),tqlty,sqlty,bqlty
!!!bqlty=0
!!!!set_number=set_number+1
!!!write(9,*),'Set_number=',set_number
!!!write(9,*),'    '
!!!endif
!!!endif
!!!if(nfset.eq.1)goto 379
!!goto 712
!!endif
!!
!!i5up13=i5
!!i13i7=i7
!!m13m21=m21
!!
!!do m13=m12+1,nqul
!!print*,'loop13'
!!
!!!print*,'m13m13m13',m13
!!do i=i5up13+1,i5
!!finalvec(i)=0
!!enddo
!!do m19=i13i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!i7=i13i7
!!totstr=i13i7
!!!print*,'totstr13',totstr
!!m21=m13m21
!!
!!jj=0
!!
!!flg=0
!!!do m19=strset(m13-1)+1,strset(m13)
!!
!!if(nqset(m13).gt.strn)goto 713
!!
!!do i=strset(m13-1)+1,strset(m13)
!!totstr=totstr+1
!!strno(totstr)=i
!!enddo
!!
!!if(totstr.gt.strn)goto 713
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!!write(9,*),'ifail',ifail,det_inv
!!!print*,'ifail13',ifail
!!print*,'Ifail',Ifail,i7
!!if(Ifail.eq.1)goto 713
!!!!do i8=1,nae
!!!!str4(totstr,i8)=0
!!!!enddo
!!!strno(totstr)=0
!!!totstr=totstr-1
!!!goto 313
!!!endif
!!!endif
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!!print*,'MatLDR_write_xmi',totstr
!!call MatLDR('str',strno,totstr,D)
!!
!!!print*,'DDD',(D(i),i=1,totstr)
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!!print*,'ovval',1.0-ovlp,ovlp
!!if(1.0-ovlp.gt.ovval)goto 713
!!endif
!!
!!m21=m21+nqset(m13)
!!if(m21.gt.strn) goto 713
!!!print*,'sourav_xmi_sym'
!!
!!!313 enddo
!!
!!!print*,'jj',jj,m13,nqul
!!!413 if(jj.eq.nqset(m13))then
!!!print*,'******jj',jj
!!
!!do m19=strset(m13-1)+1,strset(m13)
!!if(q_fac2(m19).ne.qul(m13))goto 613
!!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!!i7=i7+1
!!print*,'new struc',i7,m19
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=13
!!613 enddo
!!!print*,'i7 13',i7,m13
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!!tqlty=tqlty+qq1(m119)
!!!bqlty=bqlty+bondq4(m119)
!!!sqlty=sqlty+qq2(m119)
!!enddo
!!!endif
!!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!!if(nfset.eq.0.or.nfset.gt.1) then
!!if(nfset.eq.3)then
!!Rumwrite=1
!!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!!endif
!!if(ovopt.eq.1) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!!write(9,910)'quality value',ttqlty
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!!endif
!!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!!'ovval',1.0-ovlp
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!!write(9,911),tqlty,sqlty,bqlty
!!!bqlty=0
!!!!set_number=set_number+1
!!!write(9,*),'Set_number=',set_number
!!!write(9,*),'    '
!!!endif
!!!endif
!!!if(nfset.eq.1)goto 379
!!goto 713
!!endif
!!
!!i5up14=i5
!!i14i7=i7
!!m14m21=m21
!!
!!do m14=m13+1,nqul
!!print*,'loop14'
!!!print*,'m14m14m14',m14
!!do i=i5up14+1,i5
!!finalvec(i)=0
!!enddo
!!do m19=i14i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!i7=i14i7
!!totstr=i14i7
!!!print*,'totstr14',totstr
!!m21=m14m21
!!
!!jj=0
!!
!!flg=0
!!!do m19=strset(m14-1)+1,strset(m14)
!!
!!if(nqset(m14).gt.strn)goto 714
!!
!!do i=strset(m14-1)+1,strset(m14)
!!totstr=totstr+1
!!strno(totstr)=i
!!enddo
!!
!!if(totstr.gt.strn)goto 714
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!!write(9,*),'ifail',ifail,det_inv
!!print*,'Ifail',Ifail,i7
!!if(Ifail.eq.1)goto 714
!!!!do i8=1,nae
!!!!str4(totstr,i8)=0
!!!!enddo
!!!strno(totstr)=0
!!!totstr=totstr-1
!!!goto 314
!!!endif
!!!endif
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!!print*,'MatLDR_write_xmi',totstr
!!call MatLDR('str',strno,totstr,D)
!!
!!!print*,'DDD',(D(i),i=1,totstr)
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!!print*,'ovval',1.0-ovlp,ovlp
!!if(1.0-ovlp.gt.ovval)goto 714
!!endif
!!
!!
!!m21=m21+nqset(m14)
!!if(m21.gt.strn) goto 714
!!!print*,'sourav_xmi_sym'
!!
!!!314 enddo
!!
!!!print*,'jj',jj,m14,nqul
!!!414 if(jj.eq.nqset(m14))then
!!!print*,'******jj',jj
!!
!!do m19=strset(m14-1)+1,strset(m14)
!!if(q_fac2(m19).ne.qul(m14))goto 614
!!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!!i7=i7+1
!!print*,'new struc',i7,m19
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=14
!!614 enddo
!!!print*,'i7 14',i7,m14
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!!tqlty=tqlty+qq1(m119)
!!!bqlty=bqlty+bondq4(m119)
!!!sqlty=sqlty+qq2(m119)
!!enddo
!!!endif
!!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!!endif
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!!if(nfset.eq.0.or.nfset.gt.1) then
!!if(nfset.eq.3)then
!!Rumwrite=1
!!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!!endif
!!if(ovopt.eq.1) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!!write(9,910)'quality value',ttqlty
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!!endif
!!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!!'ovval',1.0-ovlp
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!!write(9,911),tqlty,sqlty,bqlty
!!!bqlty=0
!!!!set_number=set_number+1
!!!write(9,*),'Set_number=',set_number
!!!write(9,*),'    '
!!!endif
!!!endif
!!!if(nfset.eq.1)goto 379
!!goto 714
!!endif
!!
!!i5up15=i5
!!i15i7=i7
!!m15m21=m21
!!
!!do m15=m14+1,nqul
!!print*,'loop15'
!!!print*,'m15m15m15',m15
!!do i=i5up15+1,i5
!!finalvec(i)=0
!!enddo
!!do m19=i15i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!i7=i15i7
!!totstr=i15i7
!!!print*,'totstr15',totstr
!!m21=m15m21
!!
!!jj=0
!!
!!flg=0
!!!do m19=strset(m15-1)+1,strset(m15)
!!
!!if(nqset(m15).gt.strn)goto 715
!!
!!do i=strset(m15-1)+1,strset(m15)
!!totstr=totstr+1
!!strno(totstr)=i
!!enddo
!!
!!if(totstr.gt.strn)goto 715
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!!write(9,*),'ifail',ifail,det_inv
!!print*,'Ifail',Ifail,i7
!!if(Ifail.eq.1)goto 715
!!!!do i8=1,nae
!!!!str4(totstr,i8)=0
!!!!enddo
!!!strno(totstr)=0
!!!totstr=totstr-1
!!!goto 315
!!!endif
!!!endif
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!!print*,'MatLDR_write_xmi',totstr
!!call MatLDR('str',strno,totstr,D)
!!
!!!print*,'DDD',(D(i),i=1,totstr)
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!!print*,'ovval',1.0-ovlp,ovlp
!!if(1.0-ovlp.gt.ovval)goto 715
!!endif
!!
!!
!!m21=m21+nqset(m15)
!!if(m21.gt.strn) goto 715
!!!print*,'sourav_xmi_sym'
!!
!!!315 enddo
!!
!!!print*,'jj',jj,m15,nqul
!!!415 if(jj.eq.nqset(m15))then
!!!print*,'******jj',jj
!!
!!do m19=strset(m15-1)+1,strset(m15)
!!if(q_fac2(m19).ne.qul(m15))goto 615
!!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!!i7=i7+1
!!print*,'new struc',i7,m19
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=15
!!615 enddo
!!!print*,'i7 15',i7,m15
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!!tqlty=tqlty+qq1(m119)
!!!bqlty=bqlty+bondq4(m119)
!!!sqlty=sqlty+qq2(m119)
!!enddo
!!!endif
!!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!!endif
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!!if(nfset.eq.0.or.nfset.gt.1) then
!!if(nfset.eq.3)then
!!Rumwrite=1
!!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!!endif
!!if(ovopt.eq.1) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!!write(9,910)'quality value',ttqlty
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!!endif
!!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!!'ovval',1.0-ovlp
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!!write(9,911),tqlty,sqlty,bqlty
!!!bqlty=0
!!!!set_number=set_number+1
!!!write(9,*),'Set_number=',set_number
!!!write(9,*),'    '
!!!endif
!!!endif
!!!if(nfset.eq.1)goto 379
!!goto 715
!!endif
!!
!!i5up16=i5
!!i16i7=i7
!!m16m21=m21
!!
!!do m16=m15+1,nqul
!!print*,'loop16'
!!!print*,'m16m16m16',m16
!!do i=i5up16+1,i5
!!finalvec(i)=0
!!enddo
!!do m19=i16i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!i7=i16i7
!!totstr=i16i7
!!!print*,'totstr16',totstr
!!m21=m16m21
!!
!!jj=0
!!
!!flg=0
!!!do m19=strset(m16-1)+1,strset(m16)
!!
!!if(nqset(m16).gt.strn)goto 716
!!
!!do i=strset(m16-1)+1,strset(m16)
!!totstr=totstr+1
!!strno(totstr)=i
!!enddo
!!if(totstr.gt.strn)goto 716
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!!write(9,*),'ifail',ifail,det_inv
!!print*,'Ifail',Ifail,i7
!!if(Ifail.eq.1)goto 716
!!!!do i8=1,nae
!!!!str4(totstr,i8)=0
!!!!enddo
!!!strno(totstr)=0
!!!totstr=totstr-1
!!!goto 316
!!!endif
!!!endif
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!!print*,'MatLDR_write_xmi',totstr
!!call MatLDR('str',strno,totstr,D)
!!
!!!print*,'DDD',(D(i),i=1,totstr)
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!!print*,'ovval',1.0-ovlp,ovlp
!!if(1.0-ovlp.gt.ovval)goto 716
!!endif
!!
!!
!!m21=m21+nqset(m16)
!!if(m21.gt.strn) goto 716
!!!print*,'sourav_xmi_sym'
!!
!!!316 enddo
!!
!!!print*,'jj',jj,m16,nqul
!!!416 if(jj.eq.nqset(m16))then
!!!print*,'******jj',jj
!!
!!do m19=strset(m16-1)+1,strset(m16)
!!if(q_fac2(m19).ne.qul(m16))goto 616
!!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!!i7=i7+1
!!print*,'new struc',i7,m19
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!count=16
!!616 enddo
!!!print*,'i7 16',i7,m16
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!!tqlty=tqlty+qq1(m119)
!!!bqlty=bqlty+bondq4(m119)
!!!sqlty=sqlty+qq2(m119)
!!enddo
!!!endif
!!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!!endif
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!!if(nfset.eq.0.or.nfset.gt.1) then
!!if(nfset.eq.3)then
!!Rumwrite=1
!!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!!endif
!!if(ovopt.eq.1) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!!write(9,910)'quality value',ttqlty
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!!endif
!!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!!'ovval',1.0-ovlp
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!!write(9,911),tqlty,sqlty,bqlty
!!!bqlty=0
!!!!set_number=set_number+1
!!!write(9,*),'Set_number=',set_number
!!!write(9,*),'    '
!!!endif
!!!endif
!!!if(nfset.eq.1)goto 379
!!goto 716
!!endif
!!
!!
!!i5up17=i5
!!i17i7=i7
!!m17m21=m21
!!
!!do m17=m16+1,nqul
!!print*,'loop17'
!!!print*,'m17m17m17',m17
!!do i=i5up17+1,i5
!!finalvec(i)=0
!!enddo
!!do m19=i17i7+1,i7
!!strno(m19)=0
!!do i8=1,15
!!str2(m19,i8)=0
!!enddo
!!enddo
!!i7=i17i7
!!totstr=i17i7
!!!print*,'totstr17',totstr
!!m21=m17m21
!!
!!jj=0
!!
!!flg=0
!!!do m19=strset(m17-1)+1,strset(m17)
!!
!!if(nqset(m17).gt.strn)goto 717
!!
!!do i=strset(m17-1)+1,strset(m17)
!!totstr=totstr+1
!!strno(totstr)=i
!!enddo
!!
!!if(totstr.gt.strn)goto 717
!!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!!write(9,*),'ifail',ifail,det_inv
!!print*,'Ifail',Ifail,i7
!!if(Ifail.eq.1)goto 717
!!!strno(totstr)=0
!!!totstr=totstr-1
!!!goto 317
!!!endif
!!!endif
!!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!!print*,'MatLDR_write_xmi',totstr
!!call MatLDR('str',strno,totstr,D)
!!
!!!print*,'DDD',(D(i),i=1,totstr)
!!ovlp=1.0
!!do i=1,totstr
!!ovlp=ovlp*D(i)
!!enddo
!!!print*,'ovval',1.0-ovlp,ovlp
!!if(1.0-ovlp.gt.ovval)goto 717
!!endif
!!
!!
!!m21=m21+nqset(m17)
!!if(m21.gt.strn) goto 717
!!!print*,'sourav_xmi_sym'
!!
!!!317 enddo
!!
!!!417 if(jj.eq.nqset(m17))then
!!
!!do m19=strset(m17-1)+1,strset(m17)
!!if(q_fac2(m19).ne.qul(m17))goto 617
!!i7=i7+1
!!print*,'new struc',i7,m19
!!do i3=1,nae
!!str2(i7,i3)=str3(m19,i3)
!!enddo
!!col(i7)=m19
!!qq(i7)=q_fac2(m19)
!!qq1(i7)=str_quality_1(m19)
!!qq2(i7)=str_quality_2(m19)
!!bondq4(i7)=bondq(m19)
!!flg=1
!!617 enddo
!!!print*,'i7 16',i7,m17
!!if(i7.eq.strn) then
!!!if(nfset.gt.0)then
!!ttqlty=0
!!tqlty=0
!!bqlty=0
!!sqlty=0
!!do m119=1,i7
!!ttqlty=ttqlty+qq(m119)
!!!tqlty=tqlty+qq1(m119)
!!!bqlty=bqlty+bondq4(m119)
!!!sqlty=sqlty+qq2(m119)
!!enddo
!!!endif
!!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!!if(ttqlty.le.ttqlty0)then
!!set_number=set_number+1
!!mns=mns+1
!!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!!if(nfset.eq.1.and.set_number.gt.1)then
!!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!!endif
!!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!enddo
!!!if(nfset.eq.0.or.nfset.gt.1) then
!!if(nfset.eq.3)then
!!Rumwrite=1
!!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!!endif
!!if(ovopt.eq.1) then
!!call MatLDR('str',col,i7,D)
!!
!!ovlp=1.0
!!do i=1,i7
!!ovlp=ovlp*D(i)
!!enddo
!!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!!endif
!!!write(9,910)'quality value',ttqlty
!!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!bqlty=0
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!!endif
!!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!!'ovval',1.0-ovlp
!!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!!if(mns.eq.max_set)then
!!if(u1.eq.mset-1) goto 379
!!close(9+u1)
!!mns=0
!!u1=u1+1
!!if(u1.le.9)then
!!write(a,'(I1)')u1
!!endif
!!if(u1.gt.9.and.u1.lt.100)then
!!write(a,'(I2)')u1
!!endif
!!if(u1.gt.99.and.u1.lt.1000)then
!!write(a,'(I3)')u1
!!endif
!!if(u1.eq.1000)then
!!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!!sets. Please increase the limit'
!!goto 379
!!endif
!!outfile='structure_set_'//trim(a)//trim('.dat')
!!open(unit=9+u1,file=outfile,status='unknown')
!!endif
!!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!!write(9,911),tqlty,sqlty,bqlty
!!!bqlty=0
!!!!set_number=set_number+1
!!!write(9,*),'Set_number=',set_number
!!!write(9,*),'    '
!!!endif
!!!endif
!!!if(nfset.eq.1)goto 379
!!endif
!!
!!717 enddo
!!!print*,'count',count
!!if(indpnt.eq.2)then
!!if (count.eq.1)goto 702
!!if (count.eq.2)goto 703
!!if (count.eq.3)goto 704
!!if (count.eq.4)goto 705
!!if (count.eq.5)goto 706
!!if (count.eq.6)goto 707
!!if (count.eq.7)goto 708
!!if (count.eq.8)goto 709
!!if (count.eq.9)goto 710
!!if (count.eq.10)goto 711
!!if (count.eq.11)goto 712
!!if (count.eq.12)goto 713
!!if (count.eq.13)goto 714
!!if (count.eq.14)goto 715
!!if (count.eq.15)goto 716
!!endif
!!!if (count.eq.16)goto 717
!!
!!if(indpnt.eq.1)then
!!if (count.eq.1)goto 701
!!if (count.eq.2)goto 702
!!if (count.eq.3)goto 703
!!if (count.eq.4)goto 704
!!if (count.eq.5)goto 705
!!if (count.eq.6)goto 706
!!if (count.eq.7)goto 707
!!if (count.eq.8)goto 708
!!if (count.eq.9)goto 709
!!if (count.eq.10)goto 710
!!if (count.eq.11)goto 711
!!if (count.eq.12)goto 712
!!if (count.eq.13)goto 713
!!if (count.eq.14)goto 714
!!if (count.eq.15)goto 715
!!if (count.eq.16)goto 716
!!endif
!!
!!716 enddo
!!
!!715 enddo
!!
!!714 enddo
!!
!!713 enddo
!!
!!712 enddo
!!
!!711 enddo
!!
!!710 enddo
!!
!!709 enddo
!!
!!708 enddo
!!
!!707 enddo
!!
!!706 enddo
!!
!!705 enddo
!!
!!704 enddo
!!
!!703 enddo
!!
!!702 enddo
!!
!!701 enddo
!!!enddo
!!
!!
!!!379 do m19=1,i7
!!!if(niao.eq.0)then
!!!write(9,900),qq(m19),(str2(m19,m20),m20=1,nae)
!!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!!write(9,901),qq(m19),bondq4(m19),1,':',niao,(str2(m19,m20),m20=1,nae)
!!!!write(9,901),m19,1,':',niao,(str2(m19,m20),m20=1,nae)
!!!!write(*,900),m19,niao,(str2(m19,m20),m20=1,nae)
!!!!write(9,*)qq(m19)
!!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!!write(9,909),qq(m19),1,':',niao,(str2(m19,m20),m20=1,nae)
!!!endif
!!
!!
!!!do m19=1,i7
!!!if(niao.eq.0)then
!!!write(9,900),qq1(m19),qq2(m19),bondq4(m19),'|',(str2(m19,m20),m20=1,nae)
!!!endif
!!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!!if(niao.gt.1)then
!!!write(9,901),qq1(m19),qq2(m19),bondq4(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!!endif
!!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!!if(niao.eq.1)then
!!!write(9,909),qq1(m19),qq2(m19),bondq4(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!!endif
!!!tqlty=tqlty+qq1(m19)
!!!bqlty=bqlty+bondq4(m19)
!!!sqlty=sqlty+qq2(m19)
!!!enddo
!!
!!!900 format(25I4)
!!!901 format(I3,x,I3,x,I1,a,I1,x,25I4)
!!!909 format(I3,x,I1,a,I1,x,25I4)
!!
!!900 format(I3,x,I3,x,I3,x,I3,x,a,x,25I4)
!!901 format(I3,x,I3,x,I3,x,I3,x,a,x,I1,a,I3,x,25I4)
!!909 format(I3,x,I3,x,I3,x,I3,x,a,x,I3,I3,x,25I4)
!!!910 format(a,x,a,x,a,x,a)
!!!911 format(15x,I3,7x,I3,7x,I3)
!!910 format(a,I3)
!!920 format(a,2x,I5,2x,a,2x,100I5)
!!911 format(15x,I3,7x,I3,7x,I3)
!!912 format(a,3x,F10.3)
!!
!!close(21)
!!
!!open(unit=121,file='script10',status='unknown')
!!write(121,111)'rm -rf','Rumer_Sets.dat'
!!close(121)
!!CALL SYSTEM ("chmod +x script10 ")
!!CALL SYSTEM ("./script10 ")
!!CALL SYSTEM ("rm script10 ")
!!111 format(a,x,a)
!!
!!231 format(50I3)
!!!deallocate(str2)
!!!deallocate(qq)
!!!deallocate(qq1)
!!!deallocate(qq2)
!!print*,'exit write_symm_xmi'
!!
!!379 return
!!end subroutine w_s_x

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine check_str_bond(nl,strn,str3,ncqs)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!! this subroutine creates the bond serials need to check the 
!! independency in bond slab way
use commondat
implicit none

integer::i,i1,i2,i3,j,j1,j2,nl,strn,ncqs,str3(15000,20),num_orb(20),num_orb1(20),&
totbnd,totseorb,str_bnd(15000,1000),str_rad(500,20),bond_sl(10000,2),least
common /chek/totbnd,totseorb,str_bnd,str_rad,bond_sl,num_orb


print*,'enter check_str_bond'
print*,'sourav1'
i1=0
do i=1,nae-nl*2
i1=i1+1
num_orb(i1)=str3(1,i+nl*2)
enddo

least=1000
do i2=1,i1
if(least.gt.num_orb(i2))least=num_orb(i2)
enddo

i3=0
320 do i2=1,i1
if(least.eq.num_orb(i2))then
i3=i3+1
num_orb1(i3)=least
goto 321
endif
enddo
321 least=least+1
if (i3.lt.i1)goto 320

do i=1,i1
num_orb(i)=num_orb1(i)
enddo

i2=0
do j1=1,i1
do j2=j1+1,i1
i2=i2+1
bond_sl(i2,1)=num_orb(j1)
bond_sl(i2,2)=num_orb(j2)
enddo
enddo

print*,'sourav2'
totbnd=i2
totseorb=i1

do i=1,15000
do i1=1,1000
str_bnd(i,i1)=0
enddo
enddo

do i=1,ncqs
do i1=nl*2+1,nae-nlast,2
do j=1,totbnd
j1=0
do i2=i1,i1+1
do i3=1,2
if(str3(i,i2).eq.bond_sl(j,i3))then
j1=j1+1
endif
enddo
enddo
if(j1.eq.2)then
str_bnd(i,j)=1
goto 200
endif
enddo
200 enddo
enddo

do i=1,500
do i1=1,20
str_rad(i,i2)=0
enddo
enddo

if(nlast.ne.0)then
do i=1,ncqs
do i1=nae-nlast+1,nae
do i2=1,totseorb
if(str3(i,i1).eq.num_orb(i2))then
str_rad(i,i2)=1
goto 201
endif
enddo
201 enddo
enddo
endif

!print*,'str',(str3(1,i),i=1,nae)
!do i=1,totbnd
!print*,'bond_sl',i,'<<',(bond_sl(i,j),j=1,2)
!enddo
do i=1,ncqs
write(*,100),'str3',i,'>',(str3(i,j),j=1,nae)
write(*,100),'str_bnd',i,'>',(str_bnd(i,j),j=1,totbnd)
enddo
100 format(a,I3,a,50I4)
!stop

print*,'exit check_str_bond'
return
end subroutine check_str_bond
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine write_xmi_new_2(nl,strn,str3,ncqs,q_fac2,quality_fac,ffvec2)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

common/quality/str_quality_1,str_quality_2,bondq,tqlty,bqlty,sqlty,tnqs,nssym,qulsym,symq,&
sigsym,tnqs_sig
common/str/str5,nstr7
common/qfacRumid/qq1,bondq4,qq2,qq,rumset

integer::nl,strn,ncqs,tostr,initstr,s,i,i1,i2,i3,i4,i5,i6,i7,i8,i9,m119,tqlty,set_number,&
mn1,mn2,&
m16,m15,m14,m13,m12,m11,m10,m9,m8,m7,m6,m5,m4,m3,m2,m1,m17,m18,m19,mm19,m20,m21,m23,m24,Ifailn&
,qul(100),nqul,j,jj,fg,flg,olp,qsn,countm19,i5up1,i5up2,i5up3,i5up4,i5up5,i5up6,i5up7,i5up8,i5up9 &
,i5up10,i5up11,i5up12,i5up13,i5up14,i5up15,i5up16,i5up17,i5up18,i5up19,i5up20,&
i1i7,i2i7,i3i7,i4i7,i5i7,i6i7,i7i7,i8i7,i9i7,i10i7,i11i7,i12i7,i13i7,i14i7,i15i7,i16i7,i17i7,i18i7,i19i7,i20i7&
,m1m21,m2m21,m3m21,m4m21,m5m21,m6m21,m7m21,m8m21,m9m21,m10m21,m11m21,m12m21,m13m21,m14m21,m15m21,m16m21&
,m17m21,m18m21,m19m21,m20m21,totstr,ifail,bqlty,sqlty,ttqlty1,ttqlty0,ttqlty2,ttqlty3,ttqlty,hqlty
integer::n19,l19,o19,j17,j27,j37,j47,m,mm121,mm221,mm321,mm421,x,y,det_inv,detc(100),detc1(100),set_num(100),u1,max_set,mns
integer::str3(15000,20),q_fac2(15000),finalvec(15000),strno(15000),sigsym(15000),tnqs_sig&
,ffvec2(15000,1000),bondq(150000),overlap(15000),qstrn(50),qqstrn(50),vec(15000,1000)&
,tndet,quality_fac(15000),str_quality_1(15000),str_quality_2(15000),tnqs,nssym,qulsym(15000)&
,symq(15000),col(1000),str2(2000,20),fvec(15000,1000),avg,bondc(100,50),numb,ct,bdpstr(100),sum1&
,bdset,str5(2000,20),nstr7,Rid,rumer(15000),rumer_rad(15000),iter_counter,nnn,nbd,bdet(50)&
,pref_radical(15000),mbondq(15000)
real*8::ovlp,std,var
real::bnd_std
Double Precision::D(1000),bond_det
character(len=10)::inact
character(len=6)::a
character(len=100)::outfile

integer::qq1(5000),qq2(5000),qq(5000),bondq4(5000),rumset
print*,'enter write_xmi_new_2',niao

mns=0
u1=1
max_set=75000

write(35,'(a)')'********** All the structures arranged serialy according to their qualities ********'
write(35,'(a)')'************************************************************************************'
if(nl.ne.0)write(35,122)'Structures in lone pair set ',nl,'is given below'
122 format(a,1x,I3,1x,a)
write(35,123)'sl no.','srtuctures','IAB','NN','SB','UDB','UDR','Tot'
if(radical.ne.1.and.prad.ne.0.and.nlast.ne.0.or.flg1.eq.1) call prio_rad_str(nl,str3,ncqs,pref_radical)
if(mnbond.ne.1.and.imbd.ne.0.or.flg1.eq.1) call main_bond_cal(nl,str3,ncqs,mbondq)
if(niao.eq.0)inact=''
if(niao.eq.1)inact='1  1'
if(niao.gt.1)write (inact, "(A2,I2)") "1:", niao
do i=1,ncqs
123 format(a,6x,a,8x,a,2x,a,2x,a,2x,a,2x,a,2x,a)
write(35,124),i,')',trim(inact),(str3(i,j),j=1,nae),str_quality_1(i),bondq(i),str_quality_2(i),mbondq(i),pref_radical(i),q_fac2(i)
enddo
124 format(I2,1x,a,2x,a,1x,30I3)
nbd=0
do i=1,50
bdet(i)=0
enddo

!!! 'check_str_bond' is necessary if we are checking independency with the bond
!!! slabe
 if(flg_ion.eq.0.and.vacorb.le.0)call check_str_bond(nl,strn,str3,ncqs)

iter_counter=0
if(nfset.eq.3.or.nfset.eq.5)then
rumset=0
call rumer_structures(nl,str3,ncqs,rumer,rumer_rad)
call write_rumer_xmi(nl,str3,ncqs,rumer,rumer_rad,quality_fac)
endif
ct=0
numb=0
std=0.0
do i=1,100
detc(i)=0
detc1(i)=0
enddo
avg=0
var=0.0

!do i=1,ncqs
!print*,'q_fac2:write_xmi_new_2',q_fac2(i)
!enddo

if(noq0.gt.strn)then
ttqlty0=noq0
else
ttqlty0=strn+noq0
endif
ttqlty1=strn+noq1
ttqlty2=strn+noq2
ttqlty3=strn+noq3

!print*,'nfset',nfset,ovopt
write(*,*)'ttqlty1,ttqlty2,ttqlty3',ttqlty1,ttqlty2,ttqlty3,ttqlty0,noq1,noq2,noq3,noq0,nfset
!
!print*,'ttqlty.le.ttqlty0',ttqlty,ttqlty0

!ovlpval=0.985

set_number=0
ttqlty=0
bqlty=0
tqlty=0
sqlty=0

jj=1
do m19=1,ncqs
if(m19.eq.1)qul(1)=q_fac2(1)
j=jj
do i=1,j
if(qul(i).eq.q_fac2(m19))goto 373
enddo
jj=jj+1
qul(i)=q_fac2(m19)
!print*,qul(i)
373 enddo
nqul=jj

do i=1,nqul
qsn=0
do m19=1,ncqs
if(qul(i).ne.q_fac2(m19))goto 374
qsn=qsn+1
374 enddo
qqstrn(i)=qsn
enddo
qstrn(1)=0
j=1
do i=1,nqul
j=j+1
s=qqstrn(i)
qstrn(j)=qstrn(j-1)+s
enddo


!print*,'nqul',nqul
!print*,'last_sourav'
do m19=1,ncqs
!!!!print*,m19
write(*,231)(str3(m19,i4),i4=1,nae)
!print*,'q_fac2',q_fac2(m19)
!print*,'bondq',bondq(m19)
!print*,'qul',qul(m19)
!!print*,'niao',niao,strn
!!write(*,231)(ffvec2(m19,i4),i4=1,ndet)
!!write(*,231)(bond_count(m19,i4),i4=1,nmbond)
!!!!write(*,231)(ffvec2(m19,i4),i4=1,ndet)
enddo
!uosn=uoptstr
!endif


434 format (40I3)

do m19=1,ncqs

!if(max_set.eq.mns)then
!print*,'mns',mns
!u1=u1+1
!write(a,'(I4)')u1
!outfile=trim('structure_set_')//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif

!!!! quality 1 structures !!!!!!!
!write(*,*)'111111111111111111111',m19,ncqs
totstr=0
i7=0
m21=0

do m20=1,10000
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo



totstr=totstr+1
strno(totstr)=m19
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifail)
if(Ifail.eq.1)then
!iter_counter=iter_counter+1
!print*,'iter_counter',iter_counter,Ifail
goto 200
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!
if(totstr.gt.1.and.ovopt.eq.vpt) then
call MatLDR('str',strno,totstr,D)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 200
endif
m21=m21+1
if(m21.gt.strn) goto 316
i7=i7+1
do i3=1,nae
str2(i7,i3)=str3(m19,i3)
enddo
col(i7)=m19
!print*,'i7',i7,m19
!print*,'sourav1',q_fac2(m19)
qq(i7)=q_fac2(m19)
!print*,'sourav2'
qq1(i7)=str_quality_1(m19)
qq2(i7)=str_quality_2(m19)
bondq4(i7)=bondq(m19)

!print*,'nmbond',nmbond
!do i3=1,nmbond
!bondc(i7,i3)=bond_count(m19,i3)
!enddo
!print*,'bondq4(i7)',bondq4(i7),m19

if(i7.eq.strn) then
ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo
!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
endif

do m119=1,i7
if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(bondc(m119,i4),i4=1,nmbond)
!do i4=1,nmbond
!detc(i4)=detc(i4)+bondc(m119,i4)
!enddo
!do i4=1,nmbond
!bdpstr(m119)=bdpstr(m119)+bondc(m119,i4)
!enddo

enddo
if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif
if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif
if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
bqlty=0
write(9,*),'Set_number=',set_number
write(9,*),'    '
endif
if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
goto 200
endif


i1i7=i7
m1m21=m21


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!loop 2 start
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
do m18=m19+1,ncqs
!write(*,*)'222222222222222222222222222',m18,ncqs

do m20=i1i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo
i7=i1i7
totstr=i1i7
m21=m1m21

totstr=totstr+1
strno(totstr)=m18
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifail)
if(Ifail.eq.1)then
goto 201
endif
!!!!!!!!!!!!!!!!!!
if(totstr.gt.1.and.ovopt.eq.vpt) then
call MatLDR('str',strno,totstr,D)
ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 201
endif
m21=m21+1
if(m21.gt.strn) goto 316

i7=i7+1
do i3=1,nae
str2(i7,i3)=str3(m18,i3)
enddo
col(i7)=m18
!print*,'i7',i7,m18
qq(i7)=q_fac2(m18)
qq1(i7)=str_quality_1(m18)
qq2(i7)=str_quality_2(m18)
bondq4(i7)=bondq(m18)

!do i3=1,nmbond
!bondc(i7,i3)=bond_count(m18,i3)
!enddo

if(i7.eq.strn) then
ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo
!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
endif

do i4=1,100
detc(i4)=0
detc1(i4)=0
bdpstr(i4)=0
enddo
do m119=1,i7

if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(bondc(m119,i4),i4=1,nmbond)
!do i4=1,nmbond
!detc(i4)=detc(i4)+bondc(m119,i4)
!enddo
!do i4=1,nmbond
!bdpstr(m119)=bdpstr(m119)+bondc(m119,i4)
!enddo


enddo


if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif
if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif
if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

!bdset=0
!do i=1,i7
!if(bdpstr(i).ne.0)then
!bdset=bdset+1
!endif
!enddo
!numb=nmbond
!write(9,232)'bond',(detc(i),i=1,numb)
!ct=0
!do i=1,numb
!ct=ct+1
!detc1(ct)=detc(i)
!enddo
!numb=ct
!sum1=0
!do i=1,numb
!avg=avg+detc1(i)
!sum1=sum1+detc1(i)
!enddo
!avg=avg/(numb)
!do i=1,numb
!var=var+(detc1(i)-avg)**2
!enddo
!var=var/(numb)
!std=sqrt(var)
!write(9,233)'STD_BOND',',',set_number,',',std,',',(detc(i),i=1,numb),',',sum1,',',(bdpstr(i),i=1,i7)&
!,',',bdset
!233 format(a,a,I5,a,F10.3,a,6I3,a,I3,a,2I3,a,I3)
!avg=0
!var=0.0

bqlty=0
write(9,*),'Set_number=',set_number
write(9,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!if(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif


!if(nfset.eq.1) write(9,*),'ovval',1.0-ovlp
!if(nfset.eq.1) goto 316
!if(m18.eq.ncqs)goto 200

goto 201
endif



i5up2=i5
i2i7=i7
m2m21=m21


!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!! loop 3 start
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
do m17=m18+1,ncqs

!!!! quality 3 structures !!!!!!!
!write(*,*)'333333333333333333333333333',m17,ncqs

do m20=i2i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo
i7=i2i7
totstr=i2i7
m21=m2m21

totstr=totstr+1
strno(totstr)=m17
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)

!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn
!call check_ind(str3,totstr,nl,ncqs,strno,Ifail)

if(Ifail.eq.1)then

!iter_counter=iter_counter+1
!print*,'iter_counter',iter_counter,Ifail
!call bond_det_vec(strno,totstr,bond_det)

goto 202
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
if(totstr.gt.1.and.ovopt.eq.vpt) then
call MatLDR('str',strno,totstr,D)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo

!print*,'ovval',1.0-ovlp,ovlp

if(1.0-ovlp.gt.ovval)goto 202
endif
m21=m21+1
if(m21.gt.strn) goto 316

i7=i7+1
do i3=1,nae
str2(i7,i3)=str3(m17,i3)
enddo
col(i7)=m17
!print*,'i7',i7,m17
qq(i7)=q_fac2(m17)
qq1(i7)=str_quality_1(m17)
qq2(i7)=str_quality_2(m17)
bondq4(i7)=bondq(m17)

!do i3=1,nmbond
!fvec(i7,i3)=ffvec2(m17,i3)
!bondc(i7,i3)=bond_count(m17,i3)
!enddo

if(i7.eq.strn) then
ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo
!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
mns=mns+1
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
endif

do m119=1,i7


if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

enddo

if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif

!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then
!print*,'ovopt',ovopt

if(ovopt.eq.1) then

!print*,'MatLDR3'
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'

if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
bqlty=0
write(9,*),'Set_number=',set_number
write(9,*),'    '
endif
if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif

!if(m17.eq.ncqs)goto 201

goto 202
endif


i5up3=i5
i3i7=i7
m3m21=m21

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!! loop 4 start
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
do m16=m17+1,ncqs

!!!! quality 4 structures !!!!!!!
!write(*,*)'4444444444444444444444444',m16,ncqs


do m20=i3i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i3i7
totstr=i3i7
m21=m3m21



totstr=totstr+1
strno(totstr)=m16
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)

!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn

if(Ifail.eq.1)then

!iter_counter=iter_counter+1
!print*,'iter_counter',iter_counter,Ifail
!call bond_det_vec(strno,totstr,bond_det)

goto 203
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
if(totstr.gt.1.and.ovopt.eq.vpt) then
call MatLDR('str',strno,totstr,D)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 203
endif
m21=m21+1
if(m21.gt.strn) goto 316

i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m16,i3)
enddo
col(i7)=m16

!print*,'i7',i7,m16

qq(i7)=q_fac2(m16)
qq1(i7)=str_quality_1(m16)
qq2(i7)=str_quality_2(m16)
bondq4(i7)=bondq(m16)

!do i3=1,nmbond
!!fvec(i7,i3)=ffvec2(m16,i3)
!bondc(i7,i3)=bond_count(m16,i3)
!enddo

if(i7.eq.strn)then
ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo
!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
mns=mns+1
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
endif

do m119=1,i7

if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(fvec(m119,i4),i4=1,ndet)
!do i4=1,ndet
!detc(fvec(m119,i4))=detc(fvec(m119,i4))+1
!enddo



enddo

if(flgst.eq.1.or.flgst.eq.3) then
call ion_struc
endif
!if(nfset.eq.3)call Rumer_set_id(str2,i7,nl,Rid,set_num)
if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif

!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then
!print*,'ovopt',ovopt

if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'

if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

!write(9,232)'det',(detc(i),i=1,tot_ndet-1)
!do i=1,tot_ndet-1
!avg=avg+detc(i)
!enddo
!avg=avg/(tot_ndet-1)
!do i=1,tot_ndet-1
!var=var+(detc(i)-avg)**2
!enddo
!var=var/(tot_ndet-1)
!std=sqrt(var)
!write(9,233)'STD_DET',std
!do i=1,1000
!detc(i)=0
!enddo
!avg=0
!var=0.0
!write(9,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty
!write(9,911),tqlty,sqlty,bqlty
!write(9,*),'Total Quality = ',tqlty,bqlty

bqlty=0

write(9,*),'Set_number=',set_number
write(9,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!if(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif

!if(nfset.eq.1) write(9,*),'ovval',1.0-ovlp
!if(nfset.eq.1) goto 316
!if(m16.eq.ncqs)goto 202

goto 203
endif


!152 enddo

!if(noq.eq.4)goto 203

i4i7=i7
m4m21=m21

do m15=m16+1,ncqs

!!! quality 5 structures !!!!!!!
!write(*,*)'55555555555555555555555555',m15,ncqs
!iter_counter=iter_counter+1
!print*,'iter_counter',iter_counter
!if(max_set.eq.mns)then
!print*,'mns',mns
!u1=u1+1
!write(a,'(I4)')u1
!outfile=trim('structure_set_')//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif

do m20=i4i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i4i7
totstr=i4i7
m21=m4m21



!do m19=m14,ncqs


!if(q_fac2(m19).ne.q_fac2(m14))goto 142

totstr=totstr+1
strno(totstr)=m15
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)

!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn

if(Ifail.eq.1)then
!!iter_counter=iter_counter+1
goto 204
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!if(nfset.eq.1.and.totstr.gt.1) then

if(totstr.gt.1.and.ovopt.eq.vpt) then

!print*,'MatLDR_write_xmi',totstr
!print*,'MatLDR1'

call MatLDR('str',strno,totstr,D)

!print*,'DDD',(D(i),i=1,totstr)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 204
endif
m21=m21+1
if(m21.gt.strn) goto 316

i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m15,i3)
enddo
col(i7)=m15
!print*,'i7',i7,m15

qq(i7)=q_fac2(m15)
qq1(i7)=str_quality_1(m15)
qq2(i7)=str_quality_2(m15)
bondq4(i7)=bondq(m15)

!do i3=1,nmbond
!bondc(i7,i3)=bond_count(m15,i3)
!!fvec(i7,i3)=ffvec2(m15,i3)
!enddo

if(i7.eq.strn)then

!write(9,*),'srt',(strno(m119),m119=1,i7)
!ttqlty=0
!if(nfset.gt.0)then

ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo

!endif
!if(set_number.eq.1)hqlty=ttqlty
!if(set_number.eq.1.and.nfset.eq.3)hqlty=ttqlty+noq
!write(*,*)'hqlty,ttqlty',hqlty,ttqlty
!if(ttqlty.le.hqlty)then
!if(ttqlty1.ge.tqlty.and.ttqlty2.ge.bqlty.and.ttqlty3.ge.sqlty.or.nfset.eq.0)then
!print*,'tqlty,bqlty,sqlty,ttqlty',tqlty,bqlty,sqlty,ttqlty
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0

!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
mns=mns+1
set_number=set_number+1
mns=mns+1
iter_counter=iter_counter+1
print*,'iter_counter',iter_counter,Ifail
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
endif

do i4=1,100
detc(i4)=0
detc1(i4)=0
bdpstr(i4)=0
enddo


do m119=1,i7

if(niao.eq.0)then
write(9+u1,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9+u1,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
!write(*,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9+u1,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(bondc(m119,i4),i4=1,nmbond)
!do i4=1,nmbond
!detc(i4)=detc(i4)+bondc(m119,i4)
!enddo
!do i4=1,nmbond
!bdpstr(m119)=bdpstr(m119)+bondc(m119,i4)
!enddo
!print*,'bond',(detc(i4),i4=1,nmbond)

enddo
!stop


call bond_det_vec(nl,i7,str2,bnd_std)

!!do i=1,nbd
!!if(bdet(i).eq.int(bond_det))goto 777
!!enddo
!!nbd=nbd+1
!!bdet(nbd)=int(bond_det)
!!777 write(9,913)'bond_vec_det =',bond_det,Ifail,Ifailn
!write(9,*),'Ifail_test_check_ind',Ifail,Ifailn
!if(nfset.eq.3)call Rumer_set_id(str2,i7,nl,Rid,set_num)

if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif

!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then

if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
endif
!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'

if(Rid.eq.0)write(9+u1,921)'quality value',ttqlty,'bnd_std',bnd_std
if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

!numb=tot_ndet-1
!bdset=0
!do i=1,i7
!if(bdpstr(i).ne.0)then
!bdset=bdset+1
!endif
!enddo
!!numb=nmbond
!!write(9,232)'bond',(detc(i),i=1,numb)
!ct=0
!do i=1,numb
!!if(detc(i).eq.0)goto 333
!ct=ct+1
!detc1(ct)=detc(i)
!!endif
!333 enddo
!numb=ct
!!print*,'ct',ct,(detc1(i),i=1,ct)
!sum1=0
!do i=1,numb
!avg=avg+detc1(i)
!sum1=sum1+detc1(i)
!enddo
!avg=avg/(numb)
!do i=1,numb
!var=var+(detc1(i)-avg)**2
!enddo
!var=var/(numb)
!std=sqrt(var)
!!write(9,233)'STD_BOND',',',set_number,',',std,',',(detc(i),i=1,numb),',',sum1,',',(bdpstr(i),i=1,i7)&
!!,',',bdset
!avg=0
!var=0.0
!stop
!write(9,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty
!write(9,911),tqlty,sqlty,bqlty
!write(9,*),'Total Quality = ',tqlty,bqlty

bqlty=0

!set_number=set_number+1
!write(9,*),'Set_number=',set_number,iter_counter,Ifail

write(9+u1,*),'Set_number=',set_number
write(9+u1,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!if(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif

!if(nfset.eq.1) write(9,*),'ovlpval',1.0-ovlp
!if(nfset.eq.1) goto 316
!if(m15.eq.ncqs)goto 203

if(mns.eq.max_set)then
!print*,'mns',mns
!print*,'u1',u1
close(9+u1)
mns=0
u1=u1+1
!write(a,'(I1)')u1
!a=trim(a)
!print*,'a',a
outfile='structure_set_'//trim(int_num(u1))//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif

goto 204
endif

!142 enddo
!if(noq.eq.5)goto 204

i5i7=i7
m5m21=m21

!do m13=1+qstrn(6),qstrn(7)
do m14=m15+1,ncqs

!!!! quality 6 structures !!!!!!!
!write(*,*)'66666666666666666666666666'


do m20=i5i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i5i7
totstr=i5i7
m21=m5m21



!do m19=m13,ncqs
!if(q_fac2(m19).ne.q_fac2(m13))goto 132

totstr=totstr+1
strno(totstr)=m14
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)

!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn
!write(9,*),'ifail',ifail,det_inv
!print*,'ifail6',ifail

if(Ifail.eq.1)then
!strno(totstr)=0
!totstr=totstr-1
goto 205
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!if(nfset.eq.1.and.totstr.gt.1) then

if(totstr.gt.1.and.ovopt.eq.vpt) then

!print*,'MatLDR_write_xmi',totstr
!print*,'MatLDR1'

call MatLDR('str',strno,totstr,D)
!print*,'DDD',(D(i),i=1,totstr)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 205
endif
m21=m21+1

if(m21.gt.strn) goto 316

i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m14,i3)
enddo
col(i7)=m14

!print*,'i7',i7,m14

qq(i7)=q_fac2(m14)
qq1(i7)=str_quality_1(m14)
qq2(i7)=str_quality_2(m14)
bondq4(i7)=bondq(m14)

!do i3=1,nmbond
!bondc(i7,i3)=bond_count(m14,i3)
!enddo
!do i3=1,ndet
!fvec(i7,i3)=ffvec2(m14,i3)
!enddo

if(i7.eq.strn)then

!write(9,*),'srt',(strno(m119),m119=1,i7)
!ttqlty=0
!if(nfset.gt.0)then

ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo

!endif
!if(set_number.eq.1)hqlty=ttqlty
!if(set_number.eq.1.and.nfset.eq.3)hqlty=ttqlty+noq
!write(*,*)'hqlty,ttqlty',hqlty,ttqlty
!if(ttqlty.le.hqlty)then
!if(ttqlty1.ge.tqlty.and.ttqlty2.ge.bqlty.and.ttqlty3.ge.sqlty.or.nfset.eq.0)then
!print*,'tqlty,bqlty,sqlty,ttqlty',tqlty,bqlty,sqlty,ttqlty
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0

!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty

!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0

if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty

!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0

endif

do m119=1,i7

if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(fvec(m119,i4),i4=1,ndet)
!do i4=1,ndet
!detc(fvec(m119,i4))=detc(fvec(m119,i4))+1
!enddo


enddo

!if(nfset.eq.3)call Rumer_set_id(str2,i7,nl,Rid,set_num)

if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif

!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then

if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'

if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

!write(9,232)'det',(detc(i),i=1,tot_ndet-1)
!do i=1,tot_ndet-1
!avg=avg+detc(i)
!enddo
!avg=avg/(tot_ndet-1)
!do i=1,tot_ndet-1
!var=var+(detc(i)-avg)**2
!enddo
!var=var/(tot_ndet-1)
!std=sqrt(var)
!write(9,233)'STD_DET',std
!do i=1,1000
!detc(i)=0
!enddo
!avg=0
!var=0.0
!write(9,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty
!write(9,911),tqlty,sqlty,bqlty
!write(9,*),'Total Quality = ',tqlty,bqlty

bqlty=0
write(9,*),'Set_number=',set_number
write(9,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!if(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif

!if(nfset.eq.1) write(9,*),'ovlpval',1.0-ovlp
!if(nfset.eq.1) goto 316

goto 205
endif

!132 enddo

!if(noq.eq.6)goto 205

i6i7=i7
m6m21=m21

do m13=m14+1,ncqs

!!!! quality 7 structures !!!!!!!
!write(*,*)'7777777777777777777777777777'


do m20=i6i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i6i7
totstr=i6i7
m21=m6m21


!if(q_fac2(m19).ne.q_fac2(m12))goto 122

totstr=totstr+1
strno(totstr)=m13
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)

!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn
!write(9,*),'ifail',ifail,det_inv
!print*,'ifail7',ifail

if(Ifail.eq.1)then
!strno(totstr)=0
!totstr=totstr-1
goto 206
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!if(nfset.eq.1.and.totstr.gt.1) then

if(totstr.gt.1.and.ovopt.eq.vpt) then

!print*,'MatLDR_write_xmi',totstr
!print*,'MatLDR1'

call MatLDR('str',strno,totstr,D)
!print*,'DDD',(D(i),i=1,totstr)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 206
endif
m21=m21+1

if(m21.gt.strn) goto 316


i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m13,i3)
enddo
col(i7)=m13
!print*,'i7',i7,m13

qq(i7)=q_fac2(m13)
qq1(i7)=str_quality_1(m13)
qq2(i7)=str_quality_2(m13)
bondq4(i7)=bondq(m13)

!do i3=1,nmbond
!bondc(i7,i3)=bond_count(m13,i3)
!enddo
!do i3=1,ndet
!fvec(i7,i3)=ffvec2(m13,i3)
!enddo

if(i7.eq.strn)then

!write(9,*),'srt',(strno(m119),m119=1,i7)
!ttqlty=0
!if(nfset.gt.0)then

ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo

!endif
!if(set_number.eq.1)hqlty=ttqlty
!if(set_number.eq.1.and.nfset.eq.3)hqlty=ttqlty+noq
!write(*,*)'hqlty,ttqlty',hqlty,ttqlty
!if(ttqlty.le.hqlty)then
!if(ttqlty1.ge.tqlty.and.ttqlty2.ge.bqlty.and.ttqlty3.ge.sqlty.or.nfset.eq.0)then
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0

!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
endif

do m119=1,i7

if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(fvec(m119,i4),i4=1,ndet)
!do i4=1,ndet
!detc(fvec(m119,i4))=detc(fvec(m119,i4))+1
!enddo


enddo

!if(nfset.eq.3)call Rumer_set_id(str2,i7,nl,Rid,set_num)

if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif

!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then

if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'

if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

!write(9,232)'det',(detc(i),i=1,tot_ndet-1)
!do i=1,tot_ndet-1
!avg=avg+detc(i)
!enddo
!avg=avg/(tot_ndet-1)
!do i=1,tot_ndet-1
!var=var+(detc(i)-avg)**2
!enddo
!var=var/(tot_ndet-1)
!std=sqrt(var)
!write(9,233)'STD_DET',std
!do i=1,1000
!detc(i)=0
!enddo
!avg=0
!var=0.0
!write(9,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty
!write(9,911),tqlty,sqlty,bqlty
!write(9,*),'Total Quality = ',tqlty,bqlty

bqlty=0

write(9,*),'Set_number=',set_number
write(9,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!if(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif

!if(nfset.eq.1) write(9,*),'ovlpval',1.0-ovlp
!if(nfset.eq.1) goto 316
goto 206
endif


!if(noq.eq.7)goto 206

i7i7=i7
m7m21=m21

do m12=m13+1,ncqs

!!!! quality 8 structures !!!!!!!
!write(*,*)'8888888888888888888888888888888'


do m20=i7i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i7i7
totstr=i7i7
m21=m7m21

!if(q_fac2(m19).ne.q_fac2(m11))goto 112

totstr=totstr+1
strno(totstr)=m12
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)

!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn
!write(9,*),'ifail',ifail,det_inv
!print*,'ifail8',ifail,(strno(i),i=1,totstr)

if(Ifail.eq.1)then
!strno(totstr)=0
!totstr=totstr-1
goto 207
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!if(nfset.eq.1.and.totstr.gt.1) then

if(totstr.gt.1.and.ovopt.eq.vpt) then
!print*,'MatLDR_write_xmi',totstr
!print*,'MatLDR1'
call MatLDR('str',strno,totstr,D)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 207
endif
m21=m21+1

if(m21.gt.strn) goto 316

i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m12,i3)
enddo
col(i7)=m12
!print*,'i7',i7,m12

qq(i7)=q_fac2(m12)
qq1(i7)=str_quality_1(m12)
qq2(i7)=str_quality_2(m12)
bondq4(i7)=bondq(m12)

!do i3=1,nmbond
!bondc(i7,i3)=bond_count(m12,i3)
!enddo
!do i3=1,ndet
!fvec(i7,i3)=ffvec2(m12,i3)
!enddo

if(i7.eq.strn)then

!write(9,*),'srt',(strno(m119),m119=1,i7)
!ttqlty=0
!hqlty=0
!if(nfset.gt.0)then

ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo

!endif
!if(set_number.eq.1)hqlty=ttqlty
!if(set_number.eq.1.and.nfset.eq.3)hqlty=ttqlty+noq
!if(ttqlty.le.hqlty)then
!if(ttqlty1.ge.tqlty.and.ttqlty2.ge.bqlty.and.ttqlty3.ge.sqlty.or.nfset.eq.0)then
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0

!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
endif

do m119=1,i7

if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(fvec(m119,i4),i4=1,ndet)
!do i4=1,ndet
!detc(fvec(m119,i4))=detc(fvec(m119,i4))+1
!enddo



enddo

!if(nfset.eq.3)call Rumer_set_id(str2,i7,nl,Rid,set_num)

if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif

!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then

if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'

if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

!write(9,232)'det',(detc(i),i=1,tot_ndet-1)
!do i=1,tot_ndet-1
!avg=avg+detc(i)
!enddo
!avg=avg/(tot_ndet-1)
!do i=1,tot_ndet-1
!var=var+(detc(i)-avg)**2
!enddo
!var=var/(tot_ndet-1)
!std=sqrt(var)
!write(9,233)'STD_DET',std
!do i=1,1000
!detc(i)=0
!enddo
!avg=0
!var=0.0
!write(9,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty
!write(9,911),tqlty,sqlty,bqlty
!write(9,*),'Total Quality = ',tqlty,bqlty

bqlty=0
write(9,*),'Set_number=',set_number
write(9,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!if(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif

!if(nfset.eq.1) write(9,*),'ovlpval',1.0-ovlp
!if(nfset.eq.1) goto 316

goto 207
endif


!if(noq.eq.8)goto 207

i8i7=i7
m8m21=m21

do m11=m12+1,ncqs

!!!! quality 9 structures !!!!!!!
!write(*,*)'99999999999999999999999999'


do m20=i8i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i8i7
totstr=i8i7
m21=m8m21



!do m19=m10,ncqs
!if(q_fac2(m19).ne.q_fac2(m10))goto 102

totstr=totstr+1
strno(totstr)=m11
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)

!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn
!write(9,*),'ifail',ifail,det_inv
!print*,'ifail9',ifail,(strno(i),i=1,totstr)

if(Ifail.eq.1)then
!strno(totstr)=0
!totstr=totstr-1
goto 208
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

if(totstr.gt.1.and.ovopt.eq.vpt) then
!print*,'MatLDR_write_xmi',totstr
!print*,'MatLDR1'

call MatLDR('str',strno,totstr,D)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 208
endif
m21=m21+1

if(m21.gt.strn) goto 316


i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m11,i3)
enddo
col(i7)=m11
!print*,'i7',i7,m11

qq(i7)=q_fac2(m11)
qq1(i7)=str_quality_1(m11)
qq2(i7)=str_quality_2(m11)
bondq4(i7)=bondq(m11)

!do i3=1,nmbond
!bondc(i7,i3)=bond_count(m11,i3)
!enddo
!do i3=1,ndet
!fvec(i7,i3)=ffvec2(m11,i3)
!enddo

if(i7.eq.strn)then

!write(9,*),'srt',(strno(m119),m119=1,i7)
!ttqlty=0
!hqlty=0
!if(nfset.gt.0)then

ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo

!endif
!if(set_number.eq.1)hqlty=ttqlty
!if(set_number.eq.1.and.nfset.eq.3)hqlty=ttqlty+noq
!if(ttqlty.le.hqlty)then
!if(ttqlty1.ge.tqlty.and.ttqlty2.ge.bqlty.and.ttqlty3.ge.sqlty.or.nfset.eq.0)then
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0

!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
endif

do m119=1,i7

if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(fvec(m119,i4),i4=1,ndet)
!do i4=1,ndet
!detc(fvec(m119,i4))=detc(fvec(m119,i4))+1
!enddo



enddo

if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif

!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then

if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'

if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

!write(9,232)'det',(detc(i),i=1,tot_ndet-1)
!do i=1,tot_ndet-1
!avg=avg+detc(i)
!enddo
!avg=avg/(tot_ndet-1)
!do i=1,tot_ndet-1
!var=var+(detc(i)-avg)**2
!enddo
!var=var/(tot_ndet-1)
!std=sqrt(var)
!write(9,233)'STD_DET',std
!do i=1,1000
!detc(i)=0
!enddo
!avg=0
!var=0.0
!write(9,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty
!write(9,911),tqlty,sqlty,bqlty
!write(9,*),'Total Quality = ',tqlty,bqlty

bqlty=0
write(9,*),'Set_number=',set_number
write(9,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!if(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif
!if(nfset.eq.1) write(9,*),'ovval',1.0-ovlp
!if(nfset.eq.1) goto 316
goto 208
endif


i9i7=i7
m9m21=m21

do m10=m11+1,ncqs

!!!! quality 10 structures !!!!!!!
!write(*,*)'1010101010101010101010'


do m20=i9i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i9i7
totstr=i9i7
m21=m9m21

totstr=totstr+1
strno(totstr)=m10
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)

!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn
!write(9,*),'ifail',ifail,det_inv
!print*,'ifail10',ifail,(strno(i),i=1,totstr)

if(Ifail.eq.1)then
!strno(totstr)=0
!totstr=totstr-1
goto 209
endif

!if(nfset.eq.1.and.totstr.gt.1) then
if(totstr.gt.1.and.ovopt.eq.vpt) then
!print*,'MatLDR_write_xmi',totstr
!print*,'MatLDR1'
call MatLDR('str',strno,totstr,D)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 209
endif
m21=m21+1

if(m21.gt.strn) goto 316


i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m10,i3)
enddo
col(i7)=m10
!print*,'i7',i7,m10

qq(i7)=q_fac2(m10)
qq1(i7)=str_quality_1(m10)
qq2(i7)=str_quality_2(m10)
bondq4(i7)=bondq(m10)

!do i3=1,nmbond
!bondc(i7,i3)=bond_count(m10,i3)
!enddo
!do i3=1,ndet
!fvec(i7,i3)=ffvec2(m10,i3)
!enddo

if(i7.eq.strn)then

!write(9,*),'srt',(strno(m119),m119=1,i7)
!ttqlty=0
!hqlty=0
!if(nfset.gt.0)then

ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo

!endif
!if(set_number.eq.1)hqlty=ttqlty
!if(set_number.eq.1.and.nfset.eq.3)hqlty=ttqlty+noq
!if(ttqlty.le.hqlty)then
!if(ttqlty1.ge.tqlty.and.ttqlty2.ge.bqlty.and.ttqlty3.ge.sqlty.or.nfset.eq.0)then
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0

!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
endif

do m119=1,i7

if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(fvec(m119,i4),i4=1,ndet)
!do i4=1,ndet
!detc(fvec(m119,i4))=detc(fvec(m119,i4))+1
!enddo



enddo

if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif

!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then

if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'

if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

!write(9,232)'det',(detc(i),i=1,tot_ndet-1)
!do i=1,tot_ndet-1
!avg=avg+detc(i)
!enddo
!avg=avg/(tot_ndet-1)
!do i=1,tot_ndet-1
!var=var+(detc(i)-avg)**2
!enddo
!var=var/(tot_ndet-1)
!std=sqrt(var)
!write(9,233)'STD_DET',std
!do i=1,1000
!detc(i)=0
!enddo
!avg=0
!var=0.0
!write(9,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty
!write(9,911),tqlty,sqlty,bqlty
!write(9,*),'Total Quality = ',tqlty,bqlty

bqlty=0
write(9,*),'Set_number=',set_number
write(9,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!if(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif

!if(nfset.eq.1) write(9,*),'ovval',1.0-ovlp
!if(nfset.eq.1) goto 316
goto 209
endif


i10i7=i7
m10m21=m21

do m9=m10+1,ncqs

!!!! quality 11 structures !!!!!!!
!write(*,*)'11 11 11 11 11 11 11'


do m20=i10i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i10i7
totstr=i10i7
m21=m10m21

totstr=totstr+1
strno(totstr)=m9
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)

!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn
!write(9,*),'ifail',ifail,det_inv
!print*,'ifail11',ifail,(strno(i),i=1,totstr)

if(Ifail.eq.1)then
!strno(totstr)=0
!totstr=totstr-1
goto 210
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!11

if(totstr.gt.1.and.ovopt.eq.vpt) then
!print*,'MatLDR_write_xmi',totstr
!print*,'MatLDR1'
call MatLDR('str',strno,totstr,D)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 210
endif
m21=m21+1

if(m21.gt.strn) goto 316

i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m9,i3)
enddo
col(i7)=m9

!print*,'i7*****',i7,m9

qq(i7)=q_fac2(m9)
qq1(i7)=quality_fac(m9)
qq1(i7)=str_quality_1(m9)
qq2(i7)=str_quality_2(m9)
bondq4(i7)=bondq(m9)

!do i3=1,nmbond
!bondc(i7,i3)=bond_count(m9,i3)
!enddo
!do i3=1,ndet
!fvec(i7,i3)=ffvec2(m9,i3)
!enddo

if(i7.eq.strn)then

!write(9,*),'srt',(strno(m119),m119=1,i7)
!ttqlty=0
!hqlty=0
!if(nfset.gt.0)then

ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo

!if(set_number.eq.1)hqlty=ttqlty
!if(set_number.eq.1.and.nfset.eq.3)hqlty=ttqlty+noq
!if(ttqlty.le.hqlty)then
!if(ttqlty1.ge.tqlty.and.ttqlty2.ge.bqlty.and.ttqlty3.ge.sqlty.or.nfset.eq.0)then
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0

!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
endif

do m119=1,i7

if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(fvec(m119,i4),i4=1,ndet)
!do i4=1,ndet
!detc(fvec(m119,i4))=detc(fvec(m119,i4))+1
!enddo

enddo

!strno(totstr)=0
!totstr=totstr-1
if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif

!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then
if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'

if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

!write(9,232)'det',(detc(i),i=1,tot_ndet-1)
!do i=1,tot_ndet-1
!avg=avg+detc(i)
!enddo
!avg=avg/(tot_ndet-1)
!do i=1,tot_ndet-1
!var=var+(detc(i)-avg)**2
!enddo
!var=var/(tot_ndet-1)
!std=sqrt(var)
!write(9,233)'STD_DET',std
!do i=1,1000
!detc(i)=0
!enddo
!avg=0
!var=0.0
!write(9,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty
!write(9,911),tqlty,sqlty,bqlty
!write(9,*),'Total Quality = ',tqlty,bqlty

bqlty=0
write(9,*),'Set_number=',set_number
write(9,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!if(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif

!if(nfset.eq.1) write(9,*),'ovval',1.0-ovlp
!if(nfset.eq.1) goto 316

goto 210
endif

i11i7=i7
m11m21=m21

do m8=m9+1,ncqs

!!!! quality 10 structures !!!!!!!
!write(*,*)'12 12 12 12 12 12'


do m20=i11i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i11i7
totstr=i11i7
m21=m11m21


totstr=totstr+1
strno(totstr)=m8
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn
!write(9,*),'ifail',ifail,det_inv
!print*,'ifail10',ifail,(strno(i),i=1,totstr)

if(Ifail.eq.1)then

!strno(totstr)=0
!totstr=totstr-1
goto 211
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!11
if(totstr.gt.1.and.ovopt.eq.vpt) then

!print*,'MatLDR_write_xmi',totstr
!print*,'MatLDR1'
call MatLDR('str',strno,totstr,D)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 211
endif
m21=m21+1

if(m21.gt.strn) goto 316


i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m8,i3)
enddo
col(i7)=m8
!print*,'i7',i7,m8

qq(i7)=q_fac2(m8)
qq1(i7)=str_quality_1(m8)
qq2(i7)=str_quality_2(m8)
bondq4(i7)=bondq(m8)

!do i3=1,nmbond
!bondc(i7,i3)=bond_count(m8,i3)
!enddo
!do i3=1,ndet
!fvec(i7,i3)=ffvec2(m8,i3)
!enddo

if(i7.eq.strn)then

!write(9,*),'srt',(strno(m119),m119=1,i7)
!ttqlty=0
!hqlty=0
!if(nfset.gt.0)then

ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo

!endif
!if(set_number.eq.1)hqlty=ttqlty
!if(set_number.eq.1.and.nfset.eq.3)hqlty=ttqlty+noq
!!if(ttqlty.le.hqlty)then
!if(ttqlty1.ge.tqlty.and.ttqlty2.ge.bqlty.and.ttqlty3.ge.sqlty.or.nfset.eq.0)then
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0

!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
endif

do m119=1,i7

if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(fvec(m119,i4),i4=1,ndet)
!do i4=1,ndet
!detc(fvec(m119,i4))=detc(fvec(m119,i4))+1
!enddo



enddo

if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif

!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then
if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'

if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

!write(9,232)'det',(detc(i),i=1,tot_ndet-1)
!do i=1,tot_ndet-1
!avg=avg+detc(i)
!enddo
!avg=avg/(tot_ndet-1)
!do i=1,tot_ndet-1
!var=var+(detc(i)-avg)**2
!enddo
!var=var/(tot_ndet-1)
!std=sqrt(var)
!write(9,233)'STD_DET',std
!do i=1,1000
!detc(i)=0
!enddo
!avg=0
!var=0.0
!write(9,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty
!write(9,911),tqlty,sqlty,bqlty
!write(9,*),'Total Quality = ',tqlty,bqlty

bqlty=0
write(9,*),'Set_number=',set_number
write(9,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!if(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif

!if(nfset.eq.1) write(9,*),'ovval',1.0-ovlp
!if(nfset.eq.1) goto 316

goto 211
endif

i12i7=i7
m12m21=m21

do m7=m8+1,ncqs

!!!! quality 10 structures !!!!!!!
!write(*,*)'13 13 13 13 13 13'


do m20=i12i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i12i7
totstr=i12i7
m21=m12m21



totstr=totstr+1
strno(totstr)=m7
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)

!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn
!write(9,*),'ifail',ifail,det_inv
!print*,'ifail10',ifail,(strno(i),i=1,totstr)

if(Ifail.eq.1)then
!strno(totstr)=0
!totstr=totstr-1
goto 212
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
if(totstr.gt.1.and.ovopt.eq.vpt) then
!print*,'MatLDR_write_xmi',totstr
!print*,'MatLDR1'
call MatLDR('str',strno,totstr,D)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 212
endif
m21=m21+1

if(m21.gt.strn) goto 316


i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m7,i3)
enddo
col(i7)=m7
!print*,'i7',i7,m7

qq(i7)=q_fac2(m7)
qq1(i7)=str_quality_1(m7)
qq2(i7)=str_quality_2(m7)
bondq4(i7)=bondq(m7)

!do i3=1,nmbond
!bondc(i7,i3)=bond_count(m7,i3)
!enddo
!do i3=1,ndet
!fvec(i7,i3)=ffvec2(m7,i3)
!enddo

if(i7.eq.strn)then

!write(9,*),'srt',(strno(m119),m119=1,i7)
!ttqlty=0
!hqlty=0

ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo

!if(set_number.eq.1)hqlty=ttqlty
!if(set_number.eq.1.and.nfset.eq.3)hqlty=ttqlty+noq
!if(ttqlty.le.hqlty)then
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!if(ttqlty1.ge.tqlty.and.ttqlty2.ge.bqlty.and.ttqlty3.ge.sqlty.or.nfset.eq.0)then

!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
endif

do m119=1,i7

if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(fvec(m119,i4),i4=1,ndet)
!do i4=1,ndet
!detc(fvec(m119,i4))=detc(fvec(m119,i4))+1
!enddo



enddo

if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif
!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then
if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'

if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

!write(9,232)'det',(detc(i),i=1,tot_ndet-1)
!do i=1,tot_ndet-1
!avg=avg+detc(i)
!enddo
!avg=avg/(tot_ndet-1)
!do i=1,tot_ndet-1
!var=var+(detc(i)-avg)**2
!enddo
!var=var/(tot_ndet-1)
!std=sqrt(var)
!write(9,233)'STD_DET',std
!do i=1,1000
!detc(i)=0
!enddo
!avg=0
!var=0.0
!write(9,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty
!write(9,911),tqlty,sqlty,bqlty
!write(9,*),'Total Quality = ',tqlty,bqlty

bqlty=0
write(9,*),'Set_number=',set_number
write(9,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!if(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif
!if(nfset.eq.1) write(9,*),'ovval',1.0-ovlp
!if(nfset.eq.1) goto 316
goto 212
endif

i13i7=i7
m13m21=m21

do m6=m7+1,ncqs

!!!! quality 10 structures !!!!!!!
!write(*,*)'14 14 14 14 14 14'


do m20=i13i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i13i7
totstr=i13i7
m21=m13m21

totstr=totstr+1
strno(totstr)=m6
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)

!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn
!write(9,*),'ifail',ifail,det_inv
!print*,'ifail10',ifail,(strno(i),i=1,totstr)

if(Ifail.eq.1)then
!strno(totstr)=0
!totstr=totstr-1
goto 213
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
if(totstr.gt.1.and.ovopt.eq.vpt) then
!print*,'MatLDR_write_xmi',totstr
!print*,'MatLDR1'
call MatLDR('str',strno,totstr,D)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 213
endif
m21=m21+1

if(m21.gt.strn) goto 316


i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m6,i3)
enddo
col(i7)=m6
!print*,'i7',i7,m6

qq(i7)=q_fac2(m6)
qq1(i7)=str_quality_1(m6)
qq2(i7)=str_quality_2(m6)
bondq4(i7)=bondq(m6)

!do i3=1,nmbond
!bondc(i7,i3)=bond_count(m6,i3)
!enddo
!do i3=1,ndet
!fvec(i7,i3)=ffvec2(m6,i3)
!enddo

if(i7.eq.strn)then

!write(9,*),'srt',(strno(m119),m119=1,i7)
!ttqlty=0
!hqlty=0
!if(nfset.gt.0)then

ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo

!if(set_number.eq.1)hqlty=ttqlty
!if(set_number.eq.1.and.nfset.eq.3)hqlty=ttqlty+noq
!print*,'hqlty=ttqlty',hqlty,ttqlty
!if(ttqlty.le.hqlty)then
!if(ttqlty1.ge.tqlty.and.ttqlty2.ge.bqlty.and.ttqlty3.ge.sqlty.or.nfset.eq.0)then
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0

!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
mns=mns+1
set_number=set_number+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
endif

do i4=1,100
detc(i4)=0
detc1(i4)=0
bdpstr(i4)=0
enddo

!do m119=1,i7
!do i4=1,nmbond
!detc(i4)=detc(i4)+bondc(m119,i4)
!enddo
!do i4=1,nmbond
!bdpstr(m119)=bdpstr(m119)+bondc(m119,i4)
!enddo
!enddo
!
!do i=1,nmbond
!if(detc(i).lt.6)then
!nnn=nnn+1
!endif
!enddo
!if(Ifail.eq.1.and.nnn.eq.nmbond)goto 5117
!goto 213

5117 do m119=1,i7

if(niao.eq.0)then
write(9+u1,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9+u1,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9+u1,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(bondc(m119,i4),i4=1,nmbond)
!write(9,231)(fvec(m119,i4),i4=1,ndet)
!do i4=1,ndet
!detc(fvec(m119,i4))=detc(fvec(m119,i4))+1
!enddo

!do i4=1,nmbond
!detc(i4)=detc(i4)+bondc(m119,i4)
!enddo
!do i4=1,nmbond
!bdpstr(m119)=bdpstr(m119)+bondc(m119,i4)
!enddo


enddo

!stop
!call check_ind(detc,str2,i7,nlp,nmbond,bondc)
!stop

!print*,'sourav1'
!call bond_det_vec(strno,totstr,bond_det)

call bond_det_vec(nl,i7,str2,bnd_std)

!print*,'sourav2'
!do i=1,nbd
!if(bdet(i).eq.int(bond_det))goto 778
!enddo
!nbd=nbd+1
!bdet(nbd)=int(bond_det)
!778 write(9,913)'bond_vec_det =',bond_det,Ifail,Ifailn

!if(nfset.eq.3)call Rumer_set_id(str2,i7,nl,Rid,set_num)

if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif

!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then
if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

if(Rid.eq.0)write(9+u1,921)'quality value',ttqlty,'bnd_std',bnd_std
if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
numb=nmbond

!write(9,232)'bond',(detc(i),i=1,numb)
!write(9,232)'det',(detc(i),i=1,tot_ndet-1)
!do i=1,tot_ndet-1
!avg=avg+detc(i)
!enddo
!avg=avg/(tot_ndet-1)
!do i=1,tot_ndet-1
!var=var+(detc(i)-avg)**2
!enddo
!var=var/(tot_ndet-1)
!std=sqrt(var)
!write(9,233)'STD_DET',std
!do i=1,1000
!detc(i)=0
!enddo
!avg=0
!var=0.0
!write(9,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty
!write(9,911),tqlty,sqlty,bqlty
!write(9,*),'Total Quality = ',tqlty,bqlty

bqlty=0
write(9+u1,*),'Set_number=',set_number
write(9+u1,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!if(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif

!if(nfset.eq.1) write(9,*),'ovval',1.0-ovlp
!if(nfset.eq.1) goto 316
!if(set_number.eq.5000) goto 316
if(mns.eq.max_set)then
!print*,'mns',mns
!print*,'u1',u1
close(9+u1)
mns=0
u1=u1+1
!write(a,'(I1)')u1
!a=trim(a)
!print*,'a',a
outfile='structure_set_'//trim(int_num(u1))//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif
goto 213
endif

i14i7=i7
m14m21=m21

do m5=m6+1,ncqs

!!!! quality 10 structures !!!!!!!
!write(*,*)'15 15 15 15 15 15'


do m20=i14i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i14i7
totstr=i14i7
m21=m14m21

totstr=totstr+1
strno(totstr)=m5
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!print*,'Ifail_test_check_ind',Ifail
call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn
!write(9,*),'ifail',ifail,det_inv
!print*,'ifail10',ifail,(strno(i),i=1,totstr)

if(Ifail.eq.1)then
!strno(totstr)=0
!totstr=totstr-1
goto 214
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!11
!if(nfset.eq.1.and.totstr.gt.1) then
if(totstr.gt.1.and.ovopt.eq.vpt) then
!print*,'MatLDR_write_xmi',totstr
!print*,'MatLDR1'
call MatLDR('str',strno,totstr,D)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 214
endif
m21=m21+1

if(m21.gt.strn) goto 316


i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m5,i3)
enddo
col(i7)=m5
!print*,'i7',i7,m5

qq(i7)=q_fac2(m5)
qq1(i7)=str_quality_1(m5)
qq2(i7)=str_quality_2(m5)
bondq4(i7)=bondq(m5)

!do i3=1,ndet
!fvec(i7,i3)=ffvec2(m5,i3)
!enddo

if(i7.eq.strn)then

!write(9,*),'srt',(strno(m119),m119=1,i7)
!ttqlty=0
!hqlty=0
!if(nfset.gt.0)then

ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo

!endif
!if(set_number.eq.1)hqlty=ttqlty
!if(set_number.eq.1.and.nfset.eq.3)hqlty=ttqlty+noq
!if(ttqlty.le.hqlty)then
!if(ttqlty1.ge.tqlty.and.ttqlty2.ge.bqlty.and.ttqlty3.ge.sqlty.or.nfset.eq.2)then
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0

!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
endif

do m119=1,i7

if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(fvec(m119,i4),i4=1,ndet)
!do i4=1,ndet
!detc(fvec(m119,i4))=detc(fvec(m119,i4))+1
!enddo



enddo

if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif
!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then
if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'

if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

!write(9,232)'det',(detc(i),i=1,tot_ndet-1)
!do i=1,tot_ndet-1
!avg=avg+detc(i)
!enddo
!avg=avg/(tot_ndet-1)
!do i=1,tot_ndet-1
!var=var+(detc(i)-avg)**2
!enddo
!var=var/(tot_ndet-1)
!std=sqrt(var)
!write(9,233)'STD_DET',std
!do i=1,1000
!detc(i)=0
!enddo
!avg=0
!var=0.0
!write(9,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty
!write(9,911),tqlty,sqlty,bqlty
!write(9,*),'Total Quality = ',tqlty,bqlty

bqlty=0
write(9,*),'Set_number=',set_number
write(9,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!if(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif
!if(nfset.eq.1) write(9,*),'ovval',1.0-ovlp
!if(nfset.eq.1) goto 316
goto 214
endif
i15i7=i7
m15m21=m21

do m4=m5+1,ncqs

!!!! quality 10 structures !!!!!!!
!write(*,*)'16 16 16 16 16 16'


do m20=i15i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i15i7
totstr=i15i7
m21=m15m21

totstr=totstr+1
strno(totstr)=m4
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)

!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn
!write(9,*),'ifail',ifail,det_inv
!print*,'ifail10',ifail,(strno(i),i=1,totstr)

if(Ifail.eq.1)then
!strno(totstr)=0
!totstr=totstr-1
goto 215
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
if(totstr.gt.1.and.ovopt.eq.vpt) then
!print*,'MatLDR_write_xmi',totstr
!print*,'MatLDR1'
call MatLDR('str',strno,totstr,D)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 215
endif
m21=m21+1

if(m21.gt.strn) goto 316


i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m4,i3)
enddo
col(i7)=m4
print*,'i7',i7,m4

qq(i7)=q_fac2(m4)
qq1(i7)=str_quality_1(m4)
qq2(i7)=str_quality_2(m4)
bondq4(i7)=bondq(m4)

!do i3=1,ndet
!fvec(i7,i3)=ffvec2(m4,i3)
!enddo

if(i7.eq.strn)then

!write(9,*),'srt',(strno(m119),m119=1,i7)
!ttqlty=0
!hqlty=0
!if(nfset.gt.0)then

ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo

!endif
!if(set_number.eq.1)hqlty=ttqlty
!if(set_number.eq.1.and.nfset.eq.3)hqlty=ttqlty+noq
!if(ttqlty.le.hqlty)then
!if(ttqlty1.ge.tqlty.and.ttqlty2.ge.bqlty.and.ttqlty3.ge.sqlty.or.nfset.eq.0)then
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0

!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
endif

do m119=1,i7

if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(fvec(m119,i4),i4=1,ndet)
!do i4=1,ndet
!detc(fvec(m119,i4))=detc(fvec(m119,i4))+1
!enddo



enddo

if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif
!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then
if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'

if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

!write(9,232)'det',(detc(i),i=1,tot_ndet-1)
!do i=1,tot_ndet-1
!avg=avg+detc(i)
!enddo
!avg=avg/(tot_ndet-1)
!do i=1,tot_ndet-1
!var=var+(detc(i)-avg)**2
!enddo
!var=var/(tot_ndet-1)
!std=sqrt(var)
!write(9,233)'STD_DET',std
!do i=1,1000
!detc(i)=0
!enddo
!avg=0
!var=0.0
!write(9,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty
!write(9,911),tqlty,sqlty,bqlty
!write(9,*),'Total Quality = ',tqlty,bqlty

bqlty=0
write(9,*),'Set_number=',set_number
write(9,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!if(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif

!if(nfset.eq.1) write(9,*),'ovval',1.0-ovlp
!if(nfset.eq.1) goto 316
goto 215
endif
i16i7=i7
m16m21=m21

!do m9=1+qstrn(10),qstrn(11)
do m3=m4+1,ncqs

!!!! quality 10 structures !!!!!!!
!write(*,*)'17 17 17 17 17 17'


do m20=i16i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i16i7
totstr=i16i7
m21=m16m21

totstr=totstr+1
strno(totstr)=m3
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)

!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn
!write(9,*),'ifail',ifail,det_inv
!print*,'ifail10',ifail,(strno(i),i=1,totstr)

if(Ifail.eq.1)then
!strno(totstr)=0
!totstr=totstr-1
goto 216
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!
if(totstr.gt.1.and.ovopt.eq.vpt) then
!print*,'MatLDR_write_xmi',totstr
!print*,'MatLDR1'
call MatLDR('str',strno,totstr,D)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 216
endif
m21=m21+1

if(m21.gt.strn) goto 316


i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m3,i3)
enddo
col(i7)=m3
!print*,'i7',i7,m3

qq(i7)=q_fac2(m3)
qq1(i7)=str_quality_1(m3)
qq2(i7)=str_quality_2(m3)
bondq4(i7)=bondq(m3)

!do i3=1,ndet
!fvec(i7,i3)=ffvec2(m3,i3)
!enddo

if(i7.eq.strn)then

!write(9,*),'srt',(strno(m119),m119=1,i7)
!ttqlty=0
!hqlty=0
!if(nfset.gt.0)then

ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo

!endif
!if(set_number.eq.1)hqlty=ttqlty
!if(set_number.eq.1.and.nfset.eq.3)hqlty=ttqlty+noq
!if(ttqlty.le.hqlty)then
!if(ttqlty1.ge.tqlty.and.ttqlty2.ge.bqlty.and.ttqlty3.ge.sqlty.or.nfset.eq.0)then
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0

!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
endif

do m119=1,i7

if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(fvec(m119,i4),i4=1,ndet)
!do i4=1,ndet
!detc(fvec(m119,i4))=detc(fvec(m119,i4))+1
!enddo

enddo

if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif

!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then
if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'

if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

!write(9,232)'det',(detc(i),i=1,tot_ndet-1)
!do i=1,tot_ndet-1
!avg=avg+detc(i)
!enddo
!avg=avg/(tot_ndet-1)
!do i=1,tot_ndet-1
!var=var+(detc(i)-avg)**2
!enddo
!var=var/(tot_ndet-1)
!std=sqrt(var)
!write(9,233)'STD_DET',std
!do i=1,1000
!detc(i)=0
!enddo
!avg=0
!var=0.0
!write(9,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty
!write(9,911),tqlty,sqlty,bqlty
!write(9,*),'Total Quality = ',tqlty,bqlty

bqlty=0
write(9,*),'Set_number=',set_number
write(9,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!f(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif
!if(nfset.eq.1) write(9,*),'ovval',1.0-ovlp
!if(nfset.eq.1) goto 316
goto 216
endif
i17i7=i7
m17m21=m21

do m2=m3+1,ncqs

!!!! quality 10 structures !!!!!!!
!write(*,*)'18 18 18 18 18 18'


do m20=i17i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i17i7
totstr=i17i7
m21=m17m21

totstr=totstr+1
strno(totstr)=m2
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)

!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn
!write(9,*),'ifail',ifail,det_inv
!print*,'ifail10',ifail,(strno(i),i=1,totstr)

if(Ifail.eq.1)then
!strno(totstr)=0
!totstr=totstr-1
goto 217
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
if(totstr.gt.1.and.ovopt.eq.vpt) then
!print*,'MatLDR_write_xmi',totstr
!print*,'MatLDR1'
call MatLDR('str',strno,totstr,D)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 217
endif
m21=m21+1

if(m21.gt.strn) goto 316


i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m2,i3)
enddo
col(i7)=m2
!print*,'i7',i7,m2

qq(i7)=q_fac2(m2)
qq1(i7)=str_quality_1(m2)
qq2(i7)=str_quality_2(m2)
bondq4(i7)=bondq(m2)

!do i3=1,ndet
!fvec(i7,i3)=ffvec2(m2,i3)
!enddo

if(i7.eq.strn)then

!write(9,*),'srt',(strno(m119),m119=1,i7)
!ttqlty=0
!hqlty=0
!if(nfset.gt.0)then

ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo

!endif
!if(set_number.eq.1)hqlty=ttqlty
!if(set_number.eq.1.and.nfset.eq.3)hqlty=ttqlty+noq
!if(ttqlty.le.hqlty)then
!if(ttqlty1.le.tqlty.and.ttqlty2.le.bqlty.and.ttqlty3.le.sqlty.or.nfset.eq.0)then
!if(ttqlty1.le.tqlty.and.ttqlty2.le.bqlty.and.ttqlty3.le.sqlty)then
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0

!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
endif

do m119=1,i7

if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif

!write(9,231)(fvec(m119,i4),i4=1,ndet)
!do i4=1,ndet
!detc(fvec(m119,i4))=detc(fvec(m119,i4))+1
!enddo

enddo

if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif
!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.gt.0.and.ovopt.eq.1) then
if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'

if(Rid.eq.0)write(9,910)'quality value',ttqlty
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

!write(9,232)'det',(detc(i),i=1,tot_ndet-1)
!do i=1,tot_ndet-1
!avg=avg+detc(i)
!enddo
!avg=avg/(tot_ndet-1)
!do i=1,tot_ndet-1
!var=var+(detc(i)-avg)**2
!enddo
!var=var/(tot_ndet-1)
!std=sqrt(var)
!write(9,233)'STD_DET',std
!do i=1,1000
!detc(i)=0
!enddo
!avg=0
!var=0.0
!write(9,910)'qualities:',' intra_bond =',tqlty,'nn_bond =',bqlty,'sym_break=',sqlty
!write(9,911),tqlty,sqlty,bqlty
!write(9,*),'Total Quality = ',tqlty,bqlty

bqlty=0
write(9,*),'Set_number=',set_number
write(9,*),'    '
endif

!if(nfset.eq.0.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp
!if(ovopt.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3) write(9,*),&
!'ovval',1.0-ovlp

if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif

!if(nfset.eq.1) write(9,*),'ovlpval',1.0-ovlp
!if(nfset.eq.1) goto 316
goto 217
endif
i18i7=i7
m18m21=m21

do m1=m2+1,ncqs

!!!! quality 10 structures !!!!!!!
!write(*,*)'19 19 19 19 19 19',ifail

!print*,'i18i7,i7,m18m21,m21',i18i7,i7,m18m21,m21
if(ifail.eq.1)then
!print*,'i18i7,i7,m18m21,m21',i18i7,i7,m18m21,m21
do m20=i18i7+1,i7
strno(m20)=0
do i8=1,15
str2(m20,i8)=0
enddo
enddo

i7=i18i7
totstr=i18i7
m21=m18m21
endif

totstr=totstr+1
strno(totstr)=m1
call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!print*,'Ifail_test_check_ind',Ifail
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!print*,'Ifail_test_check_ind',Ifail,Ifailn
if(Ifail.eq.1)then
goto 218
endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
if(totstr.gt.1.and.ovopt.eq.vpt) then
call MatLDR('str',strno,totstr,D)

ovlp=1.0
do i=1,totstr
ovlp=ovlp*D(i)
enddo
if(1.0-ovlp.gt.ovval)goto 218
endif
m21=m21+1

if(m21.gt.strn) goto 316


i7=i7+1

do i3=1,nae
str2(i7,i3)=str3(m1,i3)
enddo
col(i7)=m1
!print*,'i7',i7,m10

qq(i7)=q_fac2(m1)
qq1(i7)=str_quality_1(m1)
qq2(i7)=str_quality_2(m1)
bondq4(i7)=bondq(m1)


i18i7=i7
m18m21=m21
if(i7.eq.strn)then
ttqlty=0
tqlty=0
bqlty=0
sqlty=0
do m119=1,i7
ttqlty=ttqlty+qq(m119)
tqlty=tqlty+qq1(m119)
bqlty=bqlty+bondq4(m119)
sqlty=sqlty+qq2(m119)
enddo
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
if(ttqlty.le.ttqlty0)then
set_number=set_number+1
mns=mns+1
if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
if(nfset.eq.1.and.set_number.gt.1)then
if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
endif



do m119=1,i7

if(niao.eq.0)then
write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
if(niao.gt.1)then
write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
if(niao.eq.1)then
write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif



enddo

call bond_det_vec(nl,i7,str2,bnd_std)

!do i=1,nbd
!if(bdet(i).eq.int(bond_det))goto 779
!enddo
!nbd=nbd+1
!bdet(nbd)=int(bond_det)
!779 write(9,913)'bond_vec_det =',bond_det,Ifail,Ifailn
!if(nfset.eq.3)call Rumer_set_id(str2,i7,nl,Rid,set_num)

if(nfset.eq.3)then
Rumwrite=1
call Rumer_set_id(str2,i7,nl,Rid,set_num)
endif
if(ovopt.eq.1) then
call MatLDR('str',col,i7,D)

ovlp=1.0
do i=1,i7
ovlp=ovlp*D(i)
enddo
write(9,912)'Overlap of this set of the structures =',1.0-ovlp
endif

!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)

if(Rid.eq.0)write(9,921)'quality value',ttqlty,'bnd_std',bnd_std
if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
bqlty=0
write(9,*),'Set_number=',set_number
write(9,*),'    '
endif
if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
if(mns.eq.max_set)then
if(u1.eq.mset-1) goto 316
close(9+u1)
mns=0
u1=u1+1
if(u1.le.9)then
write(a,'(I1)')u1
endif
if(u1.gt.9.and.u1.lt.100)then
write(a,'(I2)')u1
endif
if(u1.gt.99.and.u1.lt.1000)then
write(a,'(I3)')u1
endif
if(u1.eq.1000)then
write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
sets. Please increase the limit'
goto 316
endif
outfile='structure_set_'//trim(a)//trim('.dat')
open(unit=9+u1,file=outfile,status='unknown')
endif

!do m20=i18i7+1,i7
!strno(m20)=0
!do i8=1,15
!str2(m20,i8)=0
!enddo
!enddo
!
!i7=i18i7
!totstr=i18i7
!m21=m18m21

goto 218
endif

!i19i7=i7
!m19m21=m21
!
!!do m9=1+qstrn(10),qstrn(11)
!do mn1=m1+1,ncqs
!
!!!!! quality 10 structures !!!!!!!
!write(*,*)'20 20 20 20 20 20'
!
!
!do m20=i19i7+1,i7
!strno(m20)=0
!do i8=1,15
!str2(m20,i8)=0
!enddo
!enddo
!
!i7=i19i7
!totstr=i19i7
!m21=m19m21
!
!
!
!!do m19=m9,ncqs
!
!
!!if(q_fac2(m19).ne.q_fac2(m9))goto 92
!totstr=totstr+1
!strno(totstr)=mn1
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!if(Ifail.eq.1)then
!goto 219
!endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!call MatLDR('str',strno,totstr,D)
!
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!if(1.0-ovlp.gt.ovval)goto 219
!endif
!m21=m21+1
!
!if(m21.gt.strn) goto 316
!
!
!i7=i7+1
!
!do i3=1,nae
!str2(i7,i3)=str3(mn1,i3)
!enddo
!col(i7)=mn1
!!print*,'i7',i7,m10
!
!qq(i7)=q_fac2(mn1)
!qq1(i7)=str_quality_1(mn1)
!qq2(i7)=str_quality_2(mn1)
!bondq4(i7)=bondq(mn1)
!
!if(i7.eq.strn)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!tqlty=tqlty+qq1(m119)
!bqlty=bqlty+bondq4(m119)
!sqlty=sqlty+qq2(m119)
!enddo
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!endif
!
!do m119=1,i7
!
!if(niao.eq.0)then
!write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
!endif
!if(niao.gt.1)then
!write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
!endif
!if(niao.eq.1)then
!write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
!endif
!
!
!
!enddo
!
!if(nfset.eq.3)call Rumer_set_id(str2,i7,nl,Rid,set_num)
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!bqlty=0
!write(9,*),'Set_number=',set_number
!write(9,*),'    '
!endif
!if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
!goto 219
!endif
!
!i20i7=i7
!m20m21=m21
!
!!do m9=1+qstrn(10),qstrn(11)
!do mn2=mn1+1,ncqs
!
!!!!! quality 10 structures !!!!!!!
!write(*,*)'21 21 21 21 21 21 21 '
!
!
!!do m20=i20i7+1,i7
!!strno(m20)=0
!!do i8=1,15
!!str2(m20,i8)=0
!!enddo
!!enddo
!!
!!i7=i20i7
!!totstr=i20i7
!!m21=m20m21
!
!
!
!!do m19=m9,ncqs
!
!
!!if(q_fac2(m19).ne.q_fac2(m9))goto 92
!totstr=totstr+1
!strno(totstr)=mn2
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!call check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!if(Ifail.eq.1)then
!goto 220
!endif
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!1
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!call MatLDR('str',strno,totstr,D)
!
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!if(1.0-ovlp.gt.ovval)goto 220
!endif
!m21=m21+1
!
!if(m21.gt.strn) goto 316
!
!
!i7=i7+1
!
!do i3=1,nae
!str2(i7,i3)=str3(mn2,i3)
!enddo
!col(i7)=mn2
!!print*,'i7',i7,m10
!
!qq(i7)=q_fac2(mn2)
!qq1(i7)=str_quality_1(mn2)
!qq2(i7)=str_quality_2(mn2)
!bondq4(i7)=bondq(mn2)
!
!if(i7.eq.strn)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!tqlty=tqlty+qq1(m119)
!bqlty=bqlty+bondq4(m119)
!sqlty=sqlty+qq2(m119)
!enddo
!write(*,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!endif
!
!do m119=1,i7
!
!if(niao.eq.0)then
!write(9,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
!endif
!if(niao.gt.1)then
!write(9,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
!endif
!if(niao.eq.1)then
!write(9,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
!endif
!
!
!
!enddo
!
!if(nfset.eq.3)call Rumer_set_id(str2,i7,nl,Rid,set_num)
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!if(Rid.eq.0)write(9,910)'quality value',ttqlty
!if(Rid.eq.1)write(9,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!bqlty=0
!write(9,*),'Set_number=',set_number
!write(9,*),'    '
!endif
!if(set_number.eq.1000)goto 316
!if(nfset.eq.0.and.ttqlty.le.ttqlty0) goto 316
!goto 220
!
!do m20=i20i7+1,i7
!strno(m20)=0
!do i8=1,15
!str2(m20,i8)=0
!enddo
!enddo
!
!i7=i20i7
!totstr=i20i7
!m21=m20m21
!
!endif
!
!
!!if(noq.eq.11)goto 210
!220 enddo
!219 enddo
218 enddo
217 enddo
216 enddo
215 enddo
214 enddo
213 enddo
212 enddo
211 enddo
210 enddo
209 enddo
208 enddo
207 enddo
206 enddo
205 enddo
204 enddo
203 enddo
202 enddo
201 enddo
200 enddo


!900 format(25I4)
!901 format(I3,x,I1,a,I1,x,25I4)
!909 format(I3,x,I1,a,I1,x,25I4)


900 format(I3,2x,I3,2x,I3,2x,I3,x,a,x,25I4)
901 format(I3,2x,I3,2x,I3,2x,I3,x,a,x,I2,a,I2,x,25I4)
909 format(I3,2x,I3,2x,I3,2x,I3,x,a,x,I3,I3,x,25I4)
910 format(a,2x,I5)
920 format(a,2x,I5,2x,a,2x,100I5)
921 format(a,2x,I5,2x,a,2x,F10.3)
911 format(15x,I3,7x,I3,7x,I3)
912 format(a,3x,F10.3)
913 format(a,3x,F10.3,2X,2I3)

231 format(50I5)
232 format(a,300I3)

close(21)

open(unit=121,file='script10',status='unknown')
write(121,111)'rm -rf','Rumer_Sets.dat'
close(121)
CALL SYSTEM ("chmod +x script10 ")
CALL SYSTEM ("./script10 ")
CALL SYSTEM ("rm script10 ")
111 format(a,x,a)

print*,'exit write_xmi_new_2',iter_counter
!316 write(9,231)(bdet(i),i=1,nbd)
316 if(nfset.eq.0)then
do i=1,i7
nstr7=nstr7+1
do j=1,nae
str5(nstr7,j)=str2(i,j)
enddo
enddo
endif
return

end subroutine write_xmi_new_2
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

subroutine bond_det_vec(nl,str_num,str3,bnd_std)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::i,i1,i2,i3,l,ll,j,nl,totbnd,totseorb,str_bnd(15000,1000),str_rad(500,20)&
,bond_sl(10000,2),num_orb(20),strno(15000),totstr,str3(2000,20),str_num,bnd_str(1000),&
avg
Double Precision::bond_vec_mat(150,150),Eig(150),bond_det
real::bnd_std,var
common /chek/totbnd,totseorb,str_bnd,str_rad,bond_sl,num_orb
common /bnd_mat/bond_vec_mat

!print*,'totstr',str_num
!do i=1,str_num
!write(9,111),'str_bnd',(str3(i,j))
!enddo
111 format (a,2x,30I3)

do i=1,totbnd
!print*,'bond_sl',(bond_sl(i,i1),i1=1,2)
ll=0
do j=1,str_num
!write(*,111),'str',(str3(j,i1),i1=1,nae)
do i2=nl*2+1,nae-nlast,2
l=0
do i1=1,2
do i3=i2,i2+1
!print*,'str3(j,i3).eq.bond_sl(i,i1)',str3(j,i3),bond_sl(i,i1)
if(str3(j,i3).eq.bond_sl(i,i1))then
l=l+1
!print*,l
goto 300
endif
enddo
300 enddo
!print*,'l',l
if(l.eq.2)then
ll=ll+1
!print*,'ll*',ll
endif
enddo
enddo
!print*,'ll',ll
bnd_str(i)=ll
enddo

avg=0
do i=1,totbnd
avg=avg+bnd_str(i)
enddo
avg=avg/totbnd

var=0
do i=1,totbnd
var=var+(bnd_str(i)-avg)**2
enddo

bnd_std=sqrt(var/totbnd)

!write(9,*)(bnd_str(i),i=1,totbnd)
!write(*,*),'bnd_str',bnd_std

!stop

!do i=1,str_num
!write(*,111),'str',(str3(i,j),j=1,nae)
!enddo
!do i=1,totbnd
!write(*,111),'bond_sl',(bond_sl(i,i1),i1=1,2)
!enddo
!
!stop

!do i=1,150
!do i1=1,150
!bond_vec_mat(i,i1)=0.0
!enddo
!enddo

!do i=1,totstr
!do i2=1,totbnd
!str_bnd(strno(i),i2)=str_bnd(strno(i),i2)+1
!enddo
!enddo

!do i=1,totstr
!do i1=i,totstr
!do i2=1,totbnd
!bond_vec_mat(i,i1)=bond_vec_mat(i,i1)+str_bnd(strno(i),i2)*str_bnd(strno(i1),i2)
!
!enddo
!enddo
!enddo
!
!
!do i=1,totstr
!do i1=i,totstr
!bond_vec_mat(i1,i)=bond_vec_mat(i,i1)
!
!enddo
!enddo
!
!!do i=1,totstr
!!write(9,111),'bond_vec_mat',(int(bond_vec_mat(i,i1)),i1=1,totstr)
!!enddo 
!
!call MatLDR('bnv',strno,totstr,Eig)
!
!!write(9,*)(Eig(i),i=1,totstr)
!
!bond_det=1.0
!do i=1,totstr
!bond_det=bond_det*Eig(i)
!enddo
!write(9,*),'bond_det',bond_det

!stop
return
end subroutine bond_det_vec
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine eq_dstr_set(tns,lnp,npstr,str2)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::i,i1,i2,i3,i4,i5,i6,i7,i8,i9,i10,i11,i12,i13,i14,i15,i16,i17,i18,i19,&
l1,l2,l3,l4,l5,l6,l7,l8,l9,l10,l11,l12,l13,l14,l15,l16,l17,l18,l19,l20,j
integer::tns,lnp,npstr,fail,strsln(1000),str2(15000,20),num_str,numpstr
common/nst/num_str,numpstr

numpstr=npstr
num_str=0

print*,'enter eq_dstr_set'
!write(9,*),'tns,lnp,npstr',tns,lnp,npstr
!call check_str_bond(lnp,tns,str2,npstr)

do i=1,tns
write(*,200)i,(str2(i,i1),i1=1,nae)
enddo
200 format (30I5)

!stop
do i1=1,tns
do i=1,200
strsln(i)=0
enddo
j=0
j=j+1
strsln(j)=i1

l1=j
do i2=i1+1,tns
do i=l1+1,j
strsln(i)=0
enddo
j=l1
j=j+1
strsln(j)=i2
call eq_dst_check(j,strsln,fail,lnp,str2)
if (fail.eq.1) goto 102

l2=j

do i3=i2+1,tns
do i=l2+1,j
strsln(i)=0
enddo
j=l2
j=j+1
strsln(j)=i3
call eq_dst_check(j,strsln,fail,lnp,str2)
if (fail.eq.1) goto 103

l3=j


do i4=i3+1,tns
do i=l3+1,j
strsln(i)=0
enddo
j=l3
j=j+1
strsln(j)=i4
call eq_dst_check(j,strsln,fail,lnp,str2)
if (fail.eq.1) goto 104

l4=j


do i5=i4+1,tns
do i=l4+1,j
strsln(i)=0
enddo
j=l4
j=j+1
strsln(j)=i5 
call eq_dst_check(j,strsln,fail,lnp,str2)
if (fail.eq.1) goto 105

l5=j


do i6=i5+1,tns
do i=l5+1,j
strsln(i)=0
enddo
j=l5
j=j+1
strsln(j)=i6
call eq_dst_check(j,strsln,fail,lnp,str2)
if (fail.eq.1) goto 106

l6=j


do i7=i6+1,tns
do i=l6+1,j
strsln(i)=0
enddo
j=l6
j=j+1
strsln(j)=i7
call eq_dst_check(j,strsln,fail,lnp,str2)
if (fail.eq.1) goto 107

l7=j

do i8=i7+1,tns
do i=l7+1,j
strsln(i)=0
enddo
j=l7
j=j+1
strsln(j)=i8
call eq_dst_check(j,strsln,fail,lnp,str2)
if (fail.eq.1) goto 108

l8=j

do i9=i8+1,tns
do i=l8+1,j
strsln(i)=0
enddo
j=l8
j=j+1
strsln(j)=i9
call eq_dst_check(j,strsln,fail,lnp,str2)
if (fail.eq.1) goto 109

l9=j

do i10=i9+1,tns
do i=l9+1,j
strsln(i)=0
enddo
j=l9
j=j+1
strsln(j)=i10
call eq_dst_check(j,strsln,fail,lnp,str2)
if (fail.eq.1) goto 110

l10=j

do i11=i10+1,tns
do i=l10+1,j
strsln(i)=0
enddo
j=l10
j=j+1
strsln(j)=i11
call eq_dst_check(j,strsln,fail,lnp,str2)
if (fail.eq.1) goto 111

l11=j

do i12=i11+1,tns
do i=l11+1,j
strsln(i)=0
enddo
j=l11
j=j+1
strsln(j)=i12
call eq_dst_check(j,strsln,fail,lnp,str2)
if (fail.eq.1) goto 112

l12=j

do i13=i12+1,tns
do i=l12+1,j
strsln(i)=0
enddo
j=l12
j=j+1
strsln(j)=i13
call eq_dst_check(j,strsln,fail,lnp,str2)
if (fail.eq.1) goto 113

l13=j

do i14=i13+1,tns
do i=l13+1,j
strsln(i)=0
enddo
j=l13
j=j+1
strsln(j)=i14
call eq_dst_check(j,strsln,fail,lnp,str2)
if (fail.eq.1) goto 114

l14=j

do i15=i14+1,tns
do i=l14+1,j
strsln(i)=0
enddo
j=l14
j=j+1
strsln(j)=i15
call eq_dst_check(j,strsln,fail,lnp,str2)
if (fail.eq.1) goto 115

l15=j

do i16=i15+1,tns
do i=l15+1,j
strsln(i)=0
enddo
j=l15
j=j+1
strsln(j)=i16
call eq_dst_check(j,strsln,fail,lnp,str2)
if (fail.eq.1) goto 116

l16=j

116 enddo
115 enddo
114 enddo
113 enddo
112 enddo
111 enddo
110 enddo
109 enddo
108 enddo
107 enddo
106 enddo
105 enddo
104 enddo
103 enddo
102 enddo
enddo


print*,'exit eq_dstr_set'
return
end subroutine eq_dstr_set
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine eq_dst_check(nts,strsln,fail,nl,str2)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none
integer::totbnd,totseorb,str_bnd(15000,1000),str_rad(500,20),bond_sl(10000,2),num_orb(20)
integer::i,i1,j,m,m1,l,add_edst(500),n1,n2,n3,quality_fac(15000),str_quality_1(15000),&
str_quality_2(15000),nssym,qulsym(15000),symq(15000),tqlty,bqlty,sqlty,tnqs,sigsym(15000)&
,tnqs_sig,fail,strsln(1000),nl,tnbd,nts,nbd,str2(15000,20),bondq(150000),strflg,num_str,numpstr,det_inv
integer::str3(15000,20),fvec(15000,1000),strsln1(1000)
real*8::factorial
common /chek/totbnd,totseorb,str_bnd,str_rad,bond_sl,num_orb
common/quality/str_quality_1,str_quality_2,bondq,tqlty,bqlty,sqlty,tnqs,nssym,qulsym,symq,&
sigsym,tnqs_sig
common/nst/num_str,numpstr


!write(9,*),'**********************************'
!do i=1,nts
!write(*,231),'str',(str2(i,j),j=1,nae)
!enddo
!print*,'totbnd',totbnd
!print*,'enter eq_dstr_set'
!if(strflg.eq.0)num_str=0
!print*,'strsln',(strsln(i),i=1,nts)
!do i=1,nts
!write(9,231),'str_bnd',(str_bnd(strsln(i),j),j=1,totbnd)
!enddo

!do i=1,500
!add_edst(i)=0
!enddo



fail=0
do l=1,totbnd
add_edst(l)=0
do i=1,nts
!write(9,*),'i',i,str_bnd(strsln(i),l)
add_edst(l)=add_edst(l)+str_bnd(strsln(i),l)
enddo
!write(9,*),'add_edst',l,add_edst(l)
enddo
!write(9,231),'strsln',(strsln(i),i=1,nts)
!write(9,231),'add_edst',(add_edst(i),i=1,totbnd)

nbd=((nao-nl-nlast)/2)*numpstr
n1=nao-nl
n2=nao-nl-2
!print*,'n1,n2',n1,n2
tnbd=(int(factorial(n1)/(factorial(n2)))/2)
!print*,'tnbd',tnbd,nbd
if(nbd.gt.tnbd)n3=nbd/tnbd
if(nbd.le.tnbd)n3=tnbd/nbd
do i=1,totbnd
if(add_edst(i).gt.n3)fail=1
enddo

!print*,'nbd,n1,n2,tnbd,n3,nao',nbd,n1,n2,tnbd,n3,nao,fail,j,numpstr
if(nts.eq.numpstr.and.fail.eq.0)then
do i=1,numpstr
strsln1(i)=i
do i1=1,nae
str3(i,i1)=str2(strsln(i),i1)
enddo
enddo

!do i=1,numpstr
!write(9,102)(str3(i,i1),i1=1,nae)
!enddo
102 format (50I5)

!write(9,*)'calling vector_rep'
call vector_rep(nl,str3,numpstr,fvec)
!write(9,*)'ending vector_rep'
!write(9,*),'tnbd,nbd',tnbd,nbd
if(tnbd.ne.nbd)call mat_ind(nl,nts,numpstr,strsln1,fail,det_inv)
!call mat_ind(nl,nts,numpstr,strsln,fail,det_inv)
if(fail.eq.0)then
!write(9,*),'nbd,n1,n2,tnbd,n3,nao',nbd,n1,n2,tnbd,n3,nao,fail,j,numpstr
!do i=1,nts
!write(9,231),'str',(str2(i,j),j=1,nae)
!enddo
num_str=num_str+1
!print*,'j,numpstr,num_str',j,numpstr,num_str
!write(9,231),'j,numpstr,num_str',j,numpstr,num_str
do m=1,numpstr
if(niao.eq.0)then
write(9,900),str_quality_1(strsln(m)),bondq(strsln(m)),str_quality_2(strsln(m)),'|',(str2(strsln(m),m1),m1=1,nae)
endif
if(niao.gt.1)then
write(9,901),str_quality_1(strsln(m)),bondq(strsln(m)),str_quality_2(strsln(m)),'|',1,':',niao,(str2(strsln(m),m1),m1=1,nae)
endif
if(niao.eq.1)then
write(9,909),str_quality_1(strsln(m)),bondq(strsln(m)),str_quality_2(strsln(m)),'|',1,1,(str2(strsln(m),m1),m1=1,nae)
endif
enddo

fail=1
write(9,*),''
write(9,*),'set number',num_str

write(9,*),''
write(9,*),''
endif
endif
if(num_str.eq.1000)stop
900 format(I3,2x,I3,2x,I3,2x,a,x,25I4)
901 format(I3,2x,I3,2x,I3,2x,a,x,I2,a,I2,x,25I4)
909 format(I3,2x,I3,2x,I3,2x,a,x,I3,I3,x,25I4)
231 format(a,2x,50I3)
print*,'exit eq_dstr_set'
return
end subroutine eq_dst_check
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine check_ind(str3,totstr,nl,ncqs,strno,Ifailn,ffvec2)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::j,i,ii,iii,str3(15000,20),d,e,elporb,str_rad_1(100),str_rad_2(100),ffvec2(15000,1000),&
Ifailn,i7,wig2,na,i1,i2,i3,totstr,ncqs,strno(15000),str_bnd_1(1000),str_bnd_2(1000),sing(1000,100),&
str_sl(1000),new_mult,nl,totbnd,totseorb,str_bnd(15000,1000),str_rad(500,20),bond_sl(10000,2),&
npstr,num_orb(20),val(20),val1(20),i4,i5,i6,l,l1,rul,bdsl(20),perm(20),Ifailn1
real*8::factorial
character(9)::sbrtn

common /chek/totbnd,totseorb,str_bnd,str_rad,bond_sl,num_orb
!character(5)::a

Ifailn=0

!do i=1,totbnd
!print*,(bond_sl(i,i1),i1=1,2)
!enddo

e=nae-nl*2
call wigner(e,wig2)
npstr=wig2

!print*,'totbnd',totbnd
iii=0

!do i=1,totstr
!write(*,100),'str3',(str3(strno(i),ii),ii=1,nae),strno(i)
!!write(*,100),'fvec',(ffvec2(strno(i),ii)*sing(i,ii),ii=1,32)
!enddo

if(nlast.ne.0)then
do ii=1,totseorb
do i=1,totstr
str_rad_1(ii)=str_rad_1(ii)+str_rad(strno(i),ii)
enddo
enddo
d=0
do ii=1,totseorb
if(str_rad_1(ii).gt.d)d=str_rad_1(ii)
enddo
if(d.lt.3) goto 121
new_mult=mult
e=nae-1-nl*2
mult=mult-1
call wigner(e,wig2)
mult=new_mult
do ii=1,totseorb
if(str_rad_1(ii).gt.wig2)then
Ifailn=1
goto 121
endif
enddo

do ii=3,d-1
do i=1,totseorb
if(ii.eq.str_rad_1(i))then
do i1=1,totstr
if(str_rad(strno(i1),i).eq.1)then
iii=iii+1
str_sl(iii)=strno(i1)
endif
enddo

do i2=1,totseorb
do i1=1,iii
str_rad_2(i2)=str_rad_2(i2)+str_rad(str_sl(i1),i2)
enddo
enddo

i3=0
do i2=1,totseorb
if(str_rad_2(i2).eq.ii)then
i3=i3+1
endif
enddo

new_mult=mult
e=nae-nl*2-i3
mult=(nlast-i3)+1
call wigner(e,wig2)
mult=new_mult
if(ii.gt.wig2)then
Ifailn=1
goto 121
endif
endif
enddo
enddo


endif



do ii=1,totbnd
!print*,'ii',ii
str_bnd_1(ii)=0
do i=1,totstr
str_bnd_1(ii)=str_bnd_1(ii)+str_bnd(strno(i),ii)
enddo
!print*,'str_bnd',str_bnd_1(ii),ii
enddo

d=0
do ii=1,totbnd
if(str_bnd_1(ii).gt.d)d=str_bnd_1(ii)
enddo

!if(totstr.lt.0)then
!do i1=1,nae-nl*2
!do i2=i1+1,nae-nl*2
!do i3=i2+1,nae-nl*2
!val(1)=num_orb(i1)
!val(2)=num_orb(i2)
!val(3)=num_orb(i3)
!
!print*,'orbs',(val(i6),i6=1,3)
!l1=0
!do i4=1,totbnd
!l=0
!do i5=1,2
!do i6=1,3
!if(bond_sl(i4,i5).eq.val(i6))then
!l=l+1
!endif
!enddo
!if(l.eq.2)then
!l1=l1+1
!val1(l1)=i4
!endif
!enddo
!enddo
!
!!print*,'orbnum',(val1(i6),i6=1,l1)
!l=0
!do i4=1,l1
!l=l+str_bnd_1(val1(i4))
!enddo
!rul=int(totstr/3)
!!print*,'lllll',l
!if(l.gt.rul*2)then
!Ifailn=1
!
!print*,'orbnum',rul,l,'>',(val1(i6),i6=1,l1)
!goto 121
!endif
!enddo
!enddo
!enddo
!
!!stop
!
!endif
!!l1=npstr/3



do ii=1,totstr
!write(*,100),'str',(str3(strno(ii),i),i=1,nae)
write(*,100),'str_bnd',strno(ii),(str_bnd(strno(ii),i),i=1,totbnd)
enddo
write(*,100),'add_val',(str_bnd_1(i),i=1,totbnd)
print*,'ddd',d,totbnd
100 format(a,50I3)

if(d.lt.3) goto 121
e=nae-2-nl*2
call wigner(e,wig2)
!print*,'wig2',wig2
do ii=1,totbnd
if(str_bnd_1(ii).gt.wig2)then
Ifailn=1
goto 121
endif
enddo



do i=1,totbnd
if(str_bnd_1(i).gt.2.and.str_bnd(strno(totstr),i).eq.1)then
iii=0
do i1=1,totstr
if(str_bnd(strno(i1),i).eq.1)then
iii=iii+1
str_sl(iii)=strno(i1)
print*,'str_sl',i,'>',iii,str_sl(iii)
endif
enddo

call all_set_gen(str_sl,iii,nl,i,Ifailn)
if(Ifailn.eq.1)goto 121
endif
enddo

!stop

ii=0
do i=1,totbnd
if(str_bnd(strno(totstr),i).eq.1)then
ii=ii+1
bdsl(ii)=i
endif
enddo

sbrtn='check_ind'
do j=2,int(ii/2)

do i1=1,ii
perm(1)=bdsl(i1)

do i2=i1+1,ii
perm(2)=bdsl(i2)
if(j.eq.2)then
print*,(perm(i),i=1,j),j
!stop
call check3(j,perm,strno,totstr,nl,Ifailn1,sbrtn)
if(Ifailn1.eq.1)goto 122
goto 101
endif

do i3=i2+1,ii
perm(3)=bdsl(i3)
if(j.eq.3)then
call check3(j,perm,strno,totstr,nl,Ifailn1,sbrtn)
if(Ifailn1.eq.1)goto 122
goto 102
endif

do i4=i3+1,ii
perm(4)=bdsl(i4)
if(j.eq.4)then
call check3(j,perm,strno,totstr,nl,Ifailn1,sbrtn)
if(Ifailn1.eq.1)goto 122
goto 103
endif

do i5=i4+1,ii
perm(5)=bdsl(i5)
if(j.eq.5)then
call check3(j,perm,strno,totstr,nl,Ifailn1,sbrtn)
if(Ifailn1.eq.1)goto 122
goto 104
endif

do i6=i5+1,ii
perm(6)=bdsl(i6)
if(j.eq.6)then
call check3(j,perm,strno,totstr,nl,Ifailn1,sbrtn)
if(Ifailn1.eq.1)goto 122
goto 105
endif

do i7=i6+1,ii
perm(7)=bdsl(i7)
if(j.eq.7)then
call check3(j,perm,strno,totstr,nl,Ifailn1,sbrtn)
if(Ifailn1.eq.1)goto 122
goto 106
endif

106 enddo
105 enddo
104 enddo
103 enddo
102 enddo
101 enddo
    enddo
 enddo

122 Ifailn=Ifailn1



121 print*,'Ifailn',Ifailn
print*,'ssssssssssssssssssssssssssssssssssssssssssssssssssssss'
!if(Ifailn.eq.1)stop
return
end subroutine check_ind
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine check3(e,perm,str_sl,totstr,nl,ifailn1,sbrtn)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::i,i1,i2,i3,i4,i5,i6,i7,i8,i9,i10,e,a,nnstr,ifailn1,perm(20),wig2,nl,str_sl(1000),&
totbnd,totseorb,str_bnd(15000,1000),str_rad(500,20),bond_sl(10000,2),wig3,e2,e1,bnd(20),new_bd(100,2)
integer::totstr,bd_sl(20),num_orb(20)
character(9)::sbrtn

common /chek/totbnd,totseorb,str_bnd,str_rad,bond_sl,num_orb

print*,'***',sbrtn,'***'
do i=1,totstr
write(*,115),'check3',(str_bnd(str_sl(i),i1),i1=1,totbnd)
enddo
print*,'perm',(perm(i),i=1,e)
print*,'sl_num',(str_sl(i),i=1,totstr)
115 format(a,x,50I3)
ifailn1=0
i2=0
do i=1,e
do i1=1,2
i2=i2+1
bnd(i2)=bond_sl(perm(i),i1)
enddo
enddo
print*,'bnd',(bnd(i),i=1,i2)

a=0
do i=1,i2
!new_bd(1)=bnd(i)
do i1=i+1,i2
a=a+1
new_bd(a,1)=bnd(i)
new_bd(a,2)=bnd(i1)
enddo
enddo

do i=1,a
print*,'new_bd',(new_bd(i,i1),i1=1,2)
enddo

do i=1,a
do i3=1,totbnd
i6=0
do i4=1,2
do i5=1,2
if(new_bd(i,i4).eq.bond_sl(i3,i5))then
i6=i6+1
endif
enddo
enddo
if(i6.eq.2)then
bd_sl(i)=i3
goto 120
endif
enddo
120 enddo
print*,'bd_sl',(bd_sl(i),i=1,a)


i8=0
do i=1,totstr
i7=0
do i5=1,a
if(str_bnd(str_sl(i),bd_sl(i5)).eq.1)then
print*,'bd_sl(i5)',bd_sl(i5),i,i5
i7=i7+1
endif
enddo
if(i7.eq.e)then
print*,'i',i
i8=i8+1
endif
enddo

if(sbrtn.eq.'all_set'.or.sbrtn.eq.'check_2')then
e1=nae-nl*2-e*2-2
else
e1=nae-nl*2-e*2
endif
e2=e*2
print*,'e1,e2',e1,e2
call wigner(e1,wig2)
call wigner(e2,wig3)
if(i8.gt.wig3*wig2)ifailn1=1
print*,'ifailn1',ifailn1,nl,nae,e,wig2,wig3,i8
!stop

print*,'exit check3'
return
end subroutine check3
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine check_ind_2(permut,nnstr,nl,n,Ifailn)

use commondat
implicit none

integer::i,i1,i2,i3,i4,i5,i6,i7,i8,i9,i10,e,a,nnstr,Ifailn,permut(100),num_orb(20),wig2,nl
integer::str_bnd_2(1000),totbnd,totseorb,str_bnd(15000,1000),str_rad(500,20),bond_sl(10000,2)
integer::bdsl(20),perm(20),n,ii,e1,e2,wig3,j,Ifailn1
character(9)::sbrtn

common /chek/totbnd,totseorb,str_bnd,str_rad,bond_sl,num_orb

print*,'enter check_ind_2'
print*,'permut',(permut(i),i=1,nnstr)
Ifailn=0

do i2=1,totbnd
str_bnd_2(i2)=0
do i1=1,nnstr
str_bnd_2(i2)=str_bnd_2(i2)+str_bnd(permut(i1),i2)
enddo
enddo
!
!do i2=1,iii
!!write(*,100),'str',(str3(strno(ii),i),i=1,nae)
!write(*,100),'str_bnd_2',(str_bnd(str_sl(i2),i1),i1=1,totbnd)
!enddo
!write(*,100),'add_val_2',(str_bnd_2(i1),i1=1,totbnd)
!
i3=0
do i2=1,totbnd
if(str_bnd_2(i2).eq.nnstr)then
i3=i3+1
endif
enddo

e=nae-nl*2-i3*2
call wigner(e,wig2)
!print*,'wig2ll',wig2,i3
if(nnstr.gt.wig2)then
Ifailn=1
endif
print*,'Ifailn',Ifailn
if(Ifailn.eq.1)goto 100

!ii=0
!do i=1,totbnd
!if(i.eq.n)goto 400
!if(str_bnd(permut(nnstr),i).eq.1)then
!ii=ii+1
!bdsl(ii)=i
!endif
!400 enddo
!print*,(bdsl(i),i=1,ii)
!!stop
!sbrtn='check_2'
!!if(ii)
!do j=2,int(ii/2)
!e1=nae-nl*2-j*2-2
!e2=j*2
!print*,'e1,e2',e1,e2
!call wigner2(e1,wig2)
!call wigner2(e2,wig3)
!
!print*,wig2*wig3,nnstr
!if(wig2*wig3.gt.nnstr)goto 300
!
!do i1=1,ii
!perm(1)=bdsl(i1)
!
!do i2=i1+1,ii
!perm(2)=bdsl(i2)
!if(j.eq.2)then
!!print*,(perm(i),i=1,j),j
!!stop
!call check3(j,perm,permut,nnstr,nl,Ifailn1,sbrtn)
!if(Ifailn1.eq.1)goto 122
!goto 201
!endif
!
!do i3=i2+1,ii
!perm(3)=bdsl(i3)
!if(j.eq.3)then
!call check3(j,perm,permut,nnstr,nl,Ifailn1,sbrtn)
!if(Ifailn1.eq.1)goto 122
!goto 202
!endif
!
!do i4=i3+1,ii
!perm(4)=bdsl(i4)
!if(j.eq.4)then
!call check3(j,perm,permut,nnstr,nl,Ifailn1,sbrtn)
!if(Ifailn1.eq.1)goto 122
!goto 203
!endif
!
!do i5=i4+1,ii
!perm(5)=bdsl(i5)
!if(j.eq.5)then
!call check3(j,perm,permut,nnstr,nl,Ifailn1,sbrtn)
!if(Ifailn1.eq.1)goto 122
!goto 204
!endif
!
!do i6=i5+1,ii
!perm(6)=bdsl(i6)
!if(j.eq.6)then
!call check3(j,perm,permut,nnstr,nl,Ifailn1,sbrtn)
!if(Ifailn1.eq.1)goto 122
!goto 205
!endif
!
!do i7=i6+1,ii
!perm(7)=bdsl(i7)
!if(j.eq.7)then
!call check3(j,perm,permut,nnstr,nl,Ifailn1,sbrtn)
!if(Ifailn1.eq.1)goto 122
!goto 206
!endif
!
!206 enddo
!205 enddo
!204 enddo
!203 enddo
!202 enddo
!201 enddo
!    enddo
!300 enddo
!
!122 Ifailn=Ifailn1

!print*,'Ifailn',Ifailn,wig2,i3
100 print*,'exit check_ind_2'
return
end subroutine check_ind_2
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine all_set_gen(str_sl,nnstr,nl,n,Ifailn)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::i,i1,i2,i3,i4,i5,i6,i7,i8,i9,i10,i11,ii,elporb,nl,a,nnstr,Ifailn,permut(100),&
str_sl(1000),wig2,l,k,bdsl(20),perm(20),j,n
integer::e1,e2,wig3,Ifailn1
character(9)::sbrtn
integer::totbnd,totseorb,str_bnd(15000,1000),str_rad(500,20),bond_sl(10000,2),num_orb(20)

common /chek/totbnd,totseorb,str_bnd,str_rad,bond_sl,num_orb
print*,'enter all_set_gen'
print*,'str_sl',(str_sl(i),i=1,nnstr)



ii=0
do i=1,totbnd
if(i.eq.n)goto 400
if(str_bnd(str_sl(nnstr),i).eq.1)then
ii=ii+1
bdsl(ii)=i
endif
400 enddo
print*,(bdsl(i),i=1,ii)
!stop
sbrtn='all_set'
!if(ii)
do j=2,int(ii/2)
e1=nae-nl*2-j*2-2
e2=j*2
print*,'e1,e2',e1,e2
call wigner(e1,wig2)
call wigner(e2,wig3)

print*,wig2*wig3,nnstr
if(wig2*wig3.gt.nnstr)goto 300

do i1=1,ii
perm(1)=bdsl(i1)

do i2=i1+1,ii
perm(2)=bdsl(i2)
if(j.eq.2)then
!print*,(perm(i),i=1,j),j
!stop
call check3(j,perm,str_sl,nnstr,nl,Ifailn1,sbrtn)
if(Ifailn1.eq.1)goto 500
goto 201
endif

do i3=i2+1,ii
perm(3)=bdsl(i3)
if(j.eq.3)then
call check3(j,perm,str_sl,nnstr,nl,Ifailn1,sbrtn)
if(Ifailn1.eq.1)goto 500
goto 202
endif

do i4=i3+1,ii
perm(4)=bdsl(i4)
if(j.eq.4)then
call check3(j,perm,str_sl,nnstr,nl,Ifailn1,sbrtn)
if(Ifailn1.eq.1)goto 500
goto 203
endif

do i5=i4+1,ii
perm(5)=bdsl(i5)
if(j.eq.5)then
call check3(j,perm,str_sl,nnstr,nl,Ifailn1,sbrtn)
if(Ifailn1.eq.1)goto 500
goto 204
endif

do i6=i5+1,ii
perm(6)=bdsl(i6)
if(j.eq.6)then
call check3(j,perm,str_sl,nnstr,nl,Ifailn1,sbrtn)
if(Ifailn1.eq.1)goto 500
goto 205
endif

do i7=i6+1,ii
perm(7)=bdsl(i7)
if(j.eq.7)then
call check3(j,perm,str_sl,nnstr,nl,Ifailn1,sbrtn)
if(Ifailn1.eq.1)goto 500
goto 206
endif

206 enddo
205 enddo
204 enddo
203 enddo
202 enddo
201 enddo
    enddo
300 enddo









a=((nae-nl*2)-mod(nae-nl*2,2))/2
!print*,'aa',a,nae,mod(nae-nl*2,2)
    
do i=1,a-2
elporb=nae-nl*2-i*2
!print*,'elporb',elporb
call wigner(elporb,wig2)
!print*,'wig2',wig2,elporb,nnstr
if(wig2.lt.nnstr+1)then

!print*,'sourav'
do i1=1,nnstr-1
permut(1)=str_sl(i1)
if(wig2.eq.1)then
permut(2)=str_sl(nnstr)
l=2
call check_ind_2(permut,l,nl,n,Ifailn)
if(Ifailn.eq.1)goto 600
goto 100
endif

do i2=i1+1,nnstr-1
permut(2)=str_sl(i2)
if(wig2.eq.2)then
permut(3)=str_sl(nnstr)
l=3
!print*,'permut',(permut(k),k=1,3)
call check_ind_2(permut,l,nl,n,Ifailn)
if(Ifailn.eq.1)goto 600
goto 101
endif


do i3=i2+1,nnstr-1
permut(3)=str_sl(i3)
if(wig2.eq.3)then
permut(4)=str_sl(nnstr)
l=4
call check_ind_2(permut,l,nl,n,Ifailn)
if(Ifailn.eq.1)goto 600
goto 102
endif

do i4=i3+1,nnstr-1
permut(4)=str_sl(i4)
if(wig2.eq.4)then
permut(5)=str_sl(nnstr)
l=5
call check_ind_2(permut,l,nl,n,Ifailn)
if(Ifailn.eq.1)goto 600
goto 103
endif

do i5=i4+1,nnstr-1
permut(5)=str_sl(i5)
if(wig2.eq.5)then
permut(6)=str_sl(nnstr)
l=6
call check_ind_2(permut,l,nl,n,Ifailn)
if(Ifailn.eq.1)goto 600
goto 104
endif

do i6=i5+1,nnstr-1
permut(6)=str_sl(i6)
if(wig2.eq.6)then
permut(7)=str_sl(nnstr)
l=7
call check_ind_2(permut,l,nl,n,Ifailn)
if(Ifailn.eq.1)goto 600
goto 105
endif

do i7=i6+1,nnstr-1
permut(7)=str_sl(i7)
if(wig2.eq.7)then
permut(8)=str_sl(nnstr)
l=8
call check_ind_2(permut,l,nl,n,Ifailn)
if(Ifailn.eq.1)goto 600
goto 106
endif

do i8=i7+1,nnstr-1
permut(8)=str_sl(i8)
if(wig2.eq.8)then
permut(9)=str_sl(nnstr)
l=9
call check_ind_2(permut,l,nl,n,Ifailn)
if(Ifailn.eq.1)goto 600
goto 107
endif

do i9=i8+1,nnstr-1
permut(9)=str_sl(i9)
if(wig2.eq.9)then
permut(10)=str_sl(nnstr)
l=10
call check_ind_2(permut,l,nl,n,Ifailn)
if(Ifailn.eq.1)goto 600
goto 108
endif

do i10=i9+1,nnstr-1
permut(10)=str_sl(i10)
if(wig2.eq.10)then
permut(11)=str_sl(nnstr)
l=11
call check_ind_2(permut,l,nl,n,Ifailn)
if(Ifailn.eq.1)goto 600
goto 109
endif

do i11=i10+1,nnstr-1
permut(11)=str_sl(i11)
if(wig2.eq.11)then
permut(12)=str_sl(nnstr)
l=12
call check_ind_2(permut,l,nl,n,Ifailn)
if(Ifailn.eq.1)goto 600
goto 110
endif

110 enddo
109 enddo
108 enddo
107 enddo
106 enddo
105 enddo
104 enddo
103 enddo
102 enddo
101 enddo
100 enddo


endif
enddo
!500 stop
500 Ifailn=Ifailn1
print*,'exit all_set_gen'
600 return
end subroutine all_set_gen
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine Rumer_set_id(str2,i7,lonep,Rid,set_num)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

common/qfacRumid/qq1,bondq4,qq2,qq,rumset

integer::i,ii,iii,iiii,i1,i2,i3,i4,i5,i6,i7,j,Rid,orb1,orb2,sc,orbs(500),str2(2000,20),lonep,rumstrset(500,20),set_num(100)
integer::qq1(5000),qq2(5000),qq(5000),bondq4(5000),m119,m20,rumset
character(5)::a


!print*,'totrum',totrum,lonep,i7
j=0
!do i=1,i7
!print*,(str2(i,i1),i1=1,nae)
!enddo
!write(23,*)nae,lonep,(perm(i),i=1,nae-lonep*2)
!write(*,*)nae,lonep,(perm(i),i=1,nae-lonep*2)
!stop

Rid=0
rewind(31)
do i=1,totrum
iiii=0
read(31,*)
 do i1=1,i7
read(31,*)(rumstrset(i1,i2),i2=1,nae)
!print*,'RUM',(rumstrset(i1,i2),i2=1,nae)
 enddo
  do i1=1,i7
   do i2=1,i7
iii=0
    do i3=lonep*2+1,nae-nlast,2
     do i4=lonep*2+1,nae-nlast,2
ii=0
      do i5=i3,i3+1
      do i6=i4,i4+1
!print*,str2(i1,i6),rumstrset(i2,i5)
if(rumstrset(i2,i5).eq.str2(i1,i6))then
ii=ii+1
goto 249
endif
      enddo
249   enddo
if(ii.eq.2)then
iii=iii+ii
goto 250
endif
     enddo
250 enddo
if(iii.eq.nae-lonep*2-nlast)then
iiii=iiii+1
goto 251
endif
   enddo
251 enddo
if(iiii.eq.i7)then
j=j+1
Rid=1
set_num(j)=i
endif
252 enddo

nrs=j

if(Rid.eq.1.and.Rumwrite.eq.1)then
rumset=rumset+1
!write(*,*)'set number',rumset,(perm(i),i=1,nae-lonep*2)
!stop
do m119=1,i7

if(niao.eq.0)then
write(23,900),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',(str2(m119,m20),m20=1,nae)
endif
if(niao.gt.1)then
write(23,901),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,':',niao,(str2(m119,m20),m20=1,nae)
endif
if(niao.eq.1)then
write(23,909),qq1(m119),bondq4(m119),qq2(m119),qq(m119),'|',1,1,(str2(m119,m20),m20=1,nae)
endif
enddo
write(23,*),'Set_number=',rumset
write(23,*)
endif


900 format(I3,2x,I3,2x,I3,2x,I3,x,a,x,25I4)
901 format(I3,2x,I3,2x,I3,2x,I3,x,a,x,I2,a,I2,x,25I4)
909 format(I3,2x,I3,2x,I3,2x,I3,x,a,x,I3,I3,x,25I4)

!300 rewind(31)
300 return
end subroutine Rumer_set_id

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine charge_cntr(str2,nl,strnum)
use commondat
implicit none

integer::i,i1,i2,i3,i4,iii,j,j1,nl,str2(15000,20),strnum,nn(10)
real*8::cent_coord(5000,3),coordx(100),coordy(100),coordz(100),chrg_cntrx,chrg_cntry,chrg_cntrz,charge_p_cntr(50),&
chrg_cntr(1000,3)

common/coordinate/coordx,coordy,coordz

!i4=0

do i=1,atom
print*,'coord',coordx(i),coordy(i),coordz(i)
enddo
do i=1,strnum
j1=0
print*,'str2',(str2(i,i1),i1=1,nae)
do i1=1+nl*2,(nae-nlast),2
iii=0
nn(1)=0
nn(2)=0
do i2=i1,i1+1
do i3=1,atom
do i4=1,atn(active_atoms(i3))
if(str2(i,i2).eq.atoset(active_atoms(i3),i4))then
iii=iii+1
if(mod(i2,2).eq.0)nn(2)=active_atoms(i3)
if(mod(i2,2).eq.1)nn(1)=active_atoms(i3)
goto 101
endif
enddo
enddo
101 enddo
!if(nn(2).eq.nn(1))goto 202
if(iii.ne.2) goto 202
print*,'nn(1),nn(2)',i,nn(1),nn(2)

j1=j1+1
cent_coord(j1,1)=(coordx(nn(1))+coordx(nn(2)))/2.0
cent_coord(j1,2)=(coordy(nn(1))+coordy(nn(2)))/2.0
cent_coord(j1,3)=(coordz(nn(1))+coordz(nn(2)))/2.0
charge_p_cntr(j1)=2.0

202 enddo
!if (nlast.ne.0)then
!do i1=nae-nlast+1,nae
!do i3=1,atom
!do i4=1,atn(active_atoms(i3))
!if(str2(i,i1).eq.atoset(active_atoms(i3),i4))then
!nn(1)=active_atoms(i3)
!print*,'radical_atom',nn(1)
!j1=j1+1
!cent_coord(j1,1)=coordx(nn(1))
!cent_coord(j1,2)=coordy(nn(1))
!cent_coord(j1,3)=coordz(nn(1))
!charge_p_cntr(j1)=1.0
!endif
!enddo
!enddo
!enddo
!endif

do i1=1,j1
print*,'cent_coord',(cent_coord(i1,i2),i2=1,3)
enddo
chrg_cntrx=0
chrg_cntry=0
chrg_cntrz=0
do i1=1,j1
chrg_cntrx=chrg_cntrx+charge_p_cntr(i1)*cent_coord(i1,1)
chrg_cntry=chrg_cntry+charge_p_cntr(i1)*cent_coord(i1,2)
chrg_cntrz=chrg_cntrz+charge_p_cntr(i1)*cent_coord(i1,3)
enddo
chrg_cntr(i,1)=chrg_cntrx/(nae-nl*2)
chrg_cntr(i,2)=chrg_cntry/(nae-nl*2)
chrg_cntr(i,3)=chrg_cntrz/(nae-nl*2)
print*,'chrg_cntr',(chrg_cntr(i,j),j=1,3)
enddo


!stop

return
end subroutine charge_cntr
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine str_selection(astr,nl,m4,perm_nstr)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

common/quality/str_quality_1,str_quality_2,bondq,tqlty,bqlty,sqlty,tnqs,nssym,qulsym,symq,&
sigsym,tnqs_sig

integer::i,j,i1,i2,i3,i4,i5,i6,i7,ii,nl,str1_cnt,cnt,m4,m8,m9,m10,lp_cnt,tnqs,&
wig2,elporb,perm_nstr,total_str,mbondq(15000),q_fac(15000),q_fac1(15000),ijk,n,nssym,rep
integer::str_cnt(15000),astr(15000,20),str1(15000,20),str2(15000,20),lps(50),sigsym(15000),tnqs_sig&
,quality_fac(15000),str_quality_1(15000),str_quality_2(15000),strno(1000)&
,rumer(15000),rumer_rad(15000),bondq(150000),fvec(15000,1000),qulsymm(15000),&
symq(15000),symqq(15000),&
tndet,tqlty,tqlty1,bqlty,sqlty,bqlty1,sqlty1,qulsym(15000)
real*8::factorial,dfactorial,symsc(15000)
character(5)::rumstr


print*,'enter str_selection'
print*,'ovopt',ovopt,nfset
tqlty1=0
bqlty1=0
sqlty1=0
!do i1=1,m4
!write(*,305),i1,(astr(i1,i2),i2=1,nae)
!enddo
!print*,perm_nstr,nl,m4

!**********************************************************************************************************
!!!!!!!!!!!!!!!! If number of permisible structures and available structures are same START !!!!!!!!!!!!!!!
!**********************************************************************************************************

if(perm_nstr.eq.m4)then
call rumer_structures(nl,astr,m4,rumer,rumer_rad)
call quality_factor(nl,astr,m4,quality_fac,str_quality_1,str_quality_2,bondq)
!call intra_bond_factor(nl,astr,m4,str_quality_1)
!call symm_break_factor(nl,astr,m4,str_quality_2)
!call symmetry_cal(nl,str1,str1_cnt,symsc,symq,nssym)


write(7,*),'all',m4,' structures are permisible among below '
!n=0
!do ijk=nssym,1,-1
do m8=1,m4
!if(symq(m8).eq.ijk)then
!n=n+1
if(rumer(m8)*rumer_rad(m8).eq.1)rumstr='R'
if(rumer(m8)*rumer_rad(m8).eq.0)rumstr='-'
write(7,301),'str',m8,')','[',str_quality_1(m8),',',str_quality_2(m8),']','{',quality_fac(m8),'}',&
rumstr,(astr(m8,m9),m9=1,nae)
!write(7,305)(fvec(m8,m9),m9=1,ndet)
!write(*,305)(str1(m8,m9),m9=1,nae)
!endif
enddo
!enddo

301 format(a,x,I5,a,x,a,I3,a,I3,x,a,a,I3,x,a,x,a,x,30I5)
305 format(30I5)

!if(nnnatom.ne.0)then
if(input_flg.eq.1)call nnat_bond_cal(nl,astr,m4,bondq)
if(input_flg.eq.0)call nnat_bond_cal_2(nl,astr,m4,bondq)
!endif
tqlty=0
bqlty=0
sqlty=0
do m8=1,m4
if(niao.eq.0)then
write(9,900),str_quality_1(m8),bondq(m8),str_quality_2(m8),'|',(astr(m8,m9),m9=1,nae)
endif
!if(niao.gt.1.and.nnnatom.ne.0)then
if(niao.gt.1)then
write(9,901),str_quality_1(m8),bondq(m8),str_quality_2(m8),'|',1,':',niao,(astr(m8,m9),m9=1,nae)
endif
!if(niao.eq.1.and.nnnatom.ne.0)then
if(niao.eq.1)then
write(9,901),str_quality_1(m8),bondq(m8),str_quality_2(m8),'|',1,1,(astr(m8,m9),m9=1,nae)
endif
!if(niao.ne.0.and.nnnatom.eq.0)then
!write(9,909),quality_fac(m8),1,':',niao,(astr(m8,m9),m9=1,nae)
!endif
tqlty=tqlty+str_quality_1(m8)
bqlty=bqlty+bondq(m8)
sqlty=sqlty+str_quality_2(m8)
enddo
write(9,914)'qualities:','intra_bond','sym_break','nn_bond'
write(9,915),tqlty,sqlty,bqlty

900 format(I3,x,I3,x,I3,x,a,3x,25I4)
901 format(I3,x,I3,x,I3,x,a,3x,I1,a,I2,x,25I4)
909 format(I3,x,I1,a,I1,x,25I4)
914 format(a,x,a,x,a,x,a)
915 format(15x,I3,7x,I3,7x,I3)
goto 374
endif
!**********************************************************************************************************
!!!!!!!!!!!!!!!! If number of permisible structures and available structures are same END !!!!!!!!!!!!!!!
!**********************************************************************************************************

cnt=0
do i5=1,10000
str_cnt(i5)=0
enddo

do i1=1,m4
do m8=1,10000
do m9=1,nae
str1(m8,m9)=0
enddo
enddo

if(repl.ne.0)then
do i4=1,repl
rep=0
do i3=1,nae
if(repl_struc(i4,i3).eq.astr(i1,i3))then
rep=rep+1
endif
enddo 
if(rep.eq.nae)goto 373
enddo
endif


str1_cnt=0

do i5=1,cnt
if(str_cnt(i5).eq.i1)goto 373
enddo

cnt=cnt+1
str1_cnt=str1_cnt+1

do i3=1,nae
str1(str1_cnt,i3)=astr(i1,i3)
enddo 

!print*,'sourav r',str1_cnt,i1
symqq(str1_cnt)=symq(i1)
qulsymm(str1_cnt)=qulsym(i1)
!print*,'symqq(str1_cnt),qulsymm(str1_cnt)',symqq(str1_cnt),qulsymm(str1_cnt)
!print*,symqq(str1_cnt)

lp_cnt=0

do i3=1,nl*2,2
lp_cnt=lp_cnt+1
lps(lp_cnt)=astr(i1,i3)
enddo

!write(*,305),str1_cnt,str1_cnt,(str1(str1_cnt,m9),m9=1,nae)
str_cnt(cnt)=i1

do i2=i1,m4

if(repl.ne.0)then
do i4=1,repl
rep=0
!print*,(repl_struc(i4,i3),i3=1,nae)
do i3=1,nae
if(repl_struc(i4,i3).eq.astr(i2,i3))then
rep=rep+1
endif
enddo 
if(rep.eq.nae)goto 372
enddo
endif

do i5=1,cnt
if(str_cnt(i5).eq.i2)goto 372
enddo
!write(*,305),i2,(astr(i2,m9),m9=1,nae)


if(nl.ne.0)then
ii=0
do i6=1,nl*2,2
do i7=1,nl*2,2
if(astr(i1,i6).eq.astr(i2,i7))then
ii=ii+1
endif
enddo
enddo
if(ii.ne.nl)goto 372
endif


do i3=nl*2+1,nae
do i4=nl*2+1,nae
if(astr(i1,i3).eq.astr(i2,i4))goto 371
enddo
goto 372
371 enddo

cnt=cnt+1
str1_cnt=str1_cnt+1

do i3=1,nae
str1(str1_cnt,i3)=astr(i2,i3)
enddo

symqq(str1_cnt)=symq(i2)
qulsymm(str1_cnt)=qulsym(i2)
!print*,'symqq(str1_cnt),qulsymm(str1_cnt)',symqq(str1_cnt),qulsymm(str1_cnt)

str_cnt(cnt)=i2

elporb=nae-nl*2
total_str=dfactorial(elporb-1-mod(elporb,2))
!print*,'total_str',total_str,elporb,nl,nae
!print*,'cnt',nl,total_str,elporb
if(flg_ion.eq.1)then
if(total_str.eq.cnt)goto 375
endif
if(flg_cov.eq.1)then
if(total_str*elporb.eq.cnt)goto 375
endif
372 enddo 

!elporb=nae-nl*2
375 call wigner(elporb,wig2)
write(7,*),wig2,' structures are permisible among below ',str1_cnt
if(nl.ne.0)write(7,*)'                 lone pair =',(lps(i3),i3=1,lp_cnt)

call rumer_structures(nl,str1,str1_cnt,rumer,rumer_rad)
call quality_factor(nl,str1,str1_cnt,quality_fac,str_quality_1,str_quality_2,bondq)
!call vector_rep(nl,str1,str1_cnt,fvec)

!call symmetry_cal(nl,str1,str1_cnt,symsc,symq,nssym)

!n=0
!do ijk=nssym,1,-1
do m8=1,str1_cnt
!if(symq(m8).eq.ijk)then
!n=n+1
!write(7,*),rumer(m8),rumer_rad(m8),rumer(m8)*rumer_rad(m8)
if(rumer(m8)*rumer_rad(m8).eq.1)rumstr='R'
if(rumer(m8)*rumer_rad(m8).eq.0)rumstr='-'
write(7,301),'str',m8,')','[',str_quality_1(m8),',',str_quality_2(m8),']','{',quality_fac(m8),'}',&
rumstr,(str1(m8,m9),m9=1,nae)
!write(7,305)(fvec(m8,m9),m9=1,ndet)
!write(*,305)(str1(m8,m9),m9=1,nae)
!endif
enddo
!write(7,*)
!enddo

!call mat_ind(nl,str1,str1_cnt)

!***********************************************************************
!!!!!!!!!!!!!!!! Rumer Structures selection  Start !!!!!!!!!!!!!!!!!!!!!
!***********************************************************************

if(flg1.eq.1)then

call quality_factor(nl,str1,str1_cnt,quality_fac,str_quality_1,str_quality_2,bondq)

!do i=1,str1_cnt
!write(*,231),(str1(i,j),j=1,nae),str_quality_1(i),str_quality_2(i),bondq(i),quality_fac(i)
!enddo


!do i=1,str1_cnt
!write(*,231),(str2(i,j),j=1,nae),rumer(i),rumer_rad(i)
!enddo

call qult_str_arrange(nl,str1,str1_cnt,quality_fac,str2,q_fac)
call rumer_structures(nl,str2,str1_cnt,rumer,rumer_rad)
!call vector_rep(nl,str2,str1_cnt,fvec)
call write_rumer_xmi(nl,str2,str1_cnt,rumer,rumer_rad,quality_fac)
endif
print*,'sourav1'
!***********************************************************************
!!!!!!!!!!!!!!!! Rumer Structures selection Ends !!!!!!!!!!!!!!!!!!!!!
!***********************************************************************
!***********************************************************************
!!!!!!!!!!!!!!!! Ionic Structures selection for CHEM. QUAL. Starts !!!!!!!!!!!!!!!!!!
!***********************************************************************

!print*,'******** flg_ion,flg_cov',flg_ion,flg_cov
if(flg1.eq.0.and.flg_ion.eq.1.and.flg_cov.eq.0.and.nfset.ne.0)then
call quality_factor(nl,str1,str1_cnt,quality_fac,str_quality_1,str_quality_2,bondq)

!do i=1,str1_cnt
!write(*,231),(str1(i,j),j=1,nae)
!enddo

!call vector_rep(nl,str1,str1_cnt,fvec)
call qult_str_arrange(nl,str1,str1_cnt,quality_fac,str2,q_fac)
!print*,'Ionic Structures selection'
call vector_rep(nl,str2,str1_cnt,fvec)
if(ovopt.eq.1)call overlap(nl,str2,str1_cnt)
call main_bond_cal(nl,str2,str1_cnt,mbondq)
call write_xmi_new_2(nl,wig2,str2,str1_cnt,q_fac,quality_fac,fvec)
!call write_xmi_new(nl,wig2,str2,str1_cnt,q_fac,tqlty)
!call write_xmi2(nl,wig2,str2,str1_cnt,q_fac,tqlty)
!print*,'tqlty',tqlty

endif

!***********************************************************************
!!!!!!!!!!!!!!!! Ionic Structures selection for CHEM. QUAL. Ends !!!!!!!!!!!!!!!!!!
!***********************************************************************

!***********************************************************************
!!!!!!!!!!!!!!!! Covalent Structures selection Starts !!!!!!!!!!!!!!!!!!
!***********************************************************************

!print*,' flg_ion,flg_cov',flg_ion,flg_cov
if(flg1.eq.0.and.flg_cov.eq.1.and.flg_ion.eq.0)then
print*,'symmetry',symm

if(symm.eq.1) then
call quality_factor(nl,str1,str1_cnt,quality_fac,str_quality_1,str_quality_2,bondq)


!call sym_qual(str1,str1_cnt,nl,qulsym,tnqs)
print*,'sourav',tnqs

if(sig_sym_flg.eq.1)call symmetry_cal_sig(nl,str1,str1_cnt,symsc,symq,nssym)
if(sig_sym_flg.ne.1)call symmetry_cal_pi(nl,str1,str1_cnt,symsc,symq,nssym)
!do i=1,str1_cnt
!write(*,231),i,bondq(i),quality_fac(i),qulsymm(i),symq(i),(str1(i,j),j=1,nae)
!enddo
!stop
!call sigma_symm(str1,str1_cnt,nl,sigsym,tnqs_sig)
!print*,'sourav'tnqs
!call vector_rep(nl,str1,str1_cnt,fvec)
call qult_str_arrange(nl,str1,str1_cnt,quality_fac,str2,q_fac)
!call symm_str_arrange(str1,str1_cnt,quality_fac,str2,symqq,nssym,qulsymm,tnqs,q_fac)
!print*,'Covalent Structures selection symm'
do i=1,str1_cnt
write(*,231),(str2(i,j),j=1,nae)
!print*,'str2',quality_fac(i),bondq(i),q_fac(i)
enddo

print*,'sourav is inside symm=1'
!stop
call vector_rep(nl,str2,str1_cnt,fvec)
if(ovopt.eq.1)call overlap(nl,str2,str1_cnt)
print*,'sourav is inside symmetry before enter write symm'
!call write_symm_xmi(nl,wig2,str2,str1_cnt,q_fac)
call write_symm_xmi_new(nl,wig2,str2,str1_cnt,q_fac)
!call write_xmi_new_2(nl,wig2,str2,str1_cnt,q_fac,quality_fac,fvec)

endif
print*,'symmetry1',symm
!stop
if(symm.eq.0)then
if(nfset.ne.4)then
print*,'sourav is inside symm=0'
!print*,'sourav3'
call quality_factor(nl,str1,str1_cnt,quality_fac,str_quality_1,str_quality_2,bondq)

!call vector_rep(nl,str1,str1_cnt,fvec)
call qult_str_arrange(nl,str1,str1_cnt,quality_fac,str2,q_fac)

!do i=1,str1_cnt
!write(*,231),(str2(i,j),j=1,nae),q_fac(i),str_quality_1(i),str_quality_2(i),bondq(i)
!print*,'str2',quality_fac(i),bondq(i),q_fac(i)
!enddo
!call charge_cntr(str2,nl,str1_cnt)
!print*,'Covalent Structures selection non_symm'
call vector_rep(nl,str2,str1_cnt,fvec)
!print*,'vector_rep_in'
!call vector_rep(nl,str1,str1_cnt,fvec)
!print*,'vector_rep_out'
!call write_xmi_new_2(nl,wig2,str1,str1_cnt,q_fac1,quality_fac,fvec)
print*,'ovopt',ovopt,niao
if(ovopt.eq.1)call overlap(nl,str2,str1_cnt)
call main_bond_cal(nl,str2,str1_cnt,mbondq)
print*,'niao:str_sel',niao
call write_xmi_new_2(nl,wig2,str2,str1_cnt,q_fac,quality_fac,fvec)

endif

if(nfset.eq.4)then
print*,'str1_cnt',str1_cnt
!stop
call quality_factor(nl,str1,str1_cnt,quality_fac,str_quality_1,str_quality_2,bondq)

!call vector_rep(nl,str1,str1_cnt,fvec)
call qult_str_arrange(nl,str1,str1_cnt,quality_fac,str2,q_fac)

!do i=1,str1_cnt
!write(*,231),(str2(i,j),j=1,nae),q_fac(i),str_quality_1(i),str_quality_2(i),bondq(i)
!print*,'str2',quality_fac(i),bondq(i),q_fac(i)
!enddo

!print*,'Covalent Structures selection non_symm'
!call vector_rep(nl,str2,str1_cnt,fvec)
!print*,'vector_rep_in'
!call vector_rep(nl,str1,str1_cnt,fvec)
!print*,'vector_rep_out'
!call write_xmi_new_2(nl,wig2,str1,str1_cnt,q_fac1,quality_fac,fvec)
print*,'ovopt',ovopt,niao
if(ovopt.eq.1)call overlap(nl,str2,str1_cnt)
call main_bond_cal(nl,str2,str1_cnt,mbondq)
call check_str_bond(nl,wig2,str2,str1_cnt)
print*,'niao:str_sel',niao
call eq_dstr_set(str1_cnt,nl,wig2,str2)
endif
endif

endif

!***********************************************************************
!!!!!!!!!!!!!!!! Covalent Structures selection Ends !!!!!!!!!!!!!!!!!!
!***********************************************************************
tqlty1=tqlty1+tqlty
bqlty1=bqlty1+bqlty
sqlty1=sqlty1+sqlty
!print*,'rajat',tqlty1,tqlty
373 enddo
231 format(30I3)

if(nfset.eq.1.or.flg1.eq.1) then
!write(9,910)'intra bond quality','sym break quality','nnbond quality'
write(9,910)'qualities:',' intra_bond','sym_break','nn_bond'
write(9,911),tqlty1,sqlty1,bqlty1
!write(9,*),'Total Quality = ',tqlty1
write(9,*),'    '
endif

910 format(a,x,a,x,a,x,a)
911 format(15x,I3,7x,I5,7x,I3)

print*,'exit str_selection'
374 return
end subroutine str_selection

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine mat_ind(nl,numstr,totstr,strno,Ifail,det_inv)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

use commondat
use commondat1
implicit none

!common/str/str5
common/fail/faiil
!common/sdt/strdet,detmnt,det_sign
integer::nl,str1(10000,15),Ifail,totstr,tndet,vec(10000,1000),numstr,strno(1000),detmnt1(10000,15)&
,i,j,k,l,m,n,i1,comdet(10000),mat(10000,10000),sdet(10000),mat_sign(10000,10000),S00(10000,10000)&
,det_sign1(10000),faiil,det_inv
!,strdet(100000),detmnt(100000,15),det_sign(100000)
integer::col(1000)
DOUBLE PRECISION :: SPL0,SPL,D1(100)
character(len=3)::ind

!write(9,*),'enter mat_ind'
!do l=1,totstr*ndet
!print*,'strdet(l)',l,'<',strdet(l)
!enddo
!totstr=6
!call vector_rep(nl,str1,totstr,vec,detmnt,strdet,det_sign,tndet)
tndet=0
!write(9,*),'totstr,numstr',totstr,numstr
!write(9,103),'mat_ind_strno',ndet*totstr,(strno(i),i=1,numstr)

!print*,'numstr',numstr,totstr,ndet
do i=1,numstr
j=strno(i)
!write(9,*),'structures',i,j,numstr
do l=1,totstr*ndet
!write(9,*),'lll',l
if(strdet(l).ne.j)goto 200
!write(9,*),'strdet(l)',strdet(l),j,totstr*ndet
tndet=tndet+1
do m=1,nae
detmnt1(tndet,m)=detmnt(l,m)
enddo
!write(9,103),'detmnt(l,m)',(detmnt(l,m),m=1,nae),det_sign(l)
det_sign1(tndet)=det_sign(l)
200 enddo
enddo
!do i=1,tndet
!write(9,103),'detmnt1***',(detmnt1(i,m),m=1,nae)
!enddo
!print*,'totstr*ndet,tndet',totstr,ndet,tndet

l=0
n=0
do i=1,tndet
!print*,'det',i,(detmnt(i,j),j=1,nae)
!print*,'lll',l
do i1=1,l
if(comdet(i1).eq.i)goto 101
enddo
n=n+1
m=0
do j=i,tndet
do k=1,nae
if(detmnt1(i,k).ne.detmnt1(j,k))goto 100
enddo
l=l+1
m=m+1
mat(n,m)=strdet(j)
mat_sign(n,m)=det_sign1(j)
comdet(l)=j
!print*,'iii',l,comdet(l),n,m,mat(n,m),mat_sign(n,m)
100 enddo
sdet(n)=m
!print*,'sdet(n)',n,sdet(n)
101 enddo

!do i=1,n
!print*,'**',i,sdet(i)
!write(*,102),(mat(i,j),j=1,sdet(i))
!enddo
!do i=1,n
!write(*,102),(mat_sign(i,j),j=1,sdet(i))
!enddo
102 format(50I5)
103 format(a,2x,50I5)

do i=1,totstr
do j=1,totstr
ind_mat(i,j)=0.0
enddo
enddo

do i=1,totstr
ind_mat(i,i)=ndet
!write(9,*),'mat_ind::ndet',ndet
enddo

do i=1,numstr
!print*,i,'****',i
do j=i+1,numstr
!print*,'j',j
do k=1,n
!print*,'k',k
do l=1,sdet(k)
!print*,'l,sdet(k),mat(k,l),i',l,sdet(k),mat(k,l),i
if(mat(k,l).eq.i)then
do m=1,sdet(k)
!print*,'m,sdet(k),mat(k,m),j',m,sdet(k),mat(k,m),j
if(mat(k,m).eq.j)then
ind_mat(i,j)=ind_mat(i,j)+mat_sign(k,m)*mat_sign(k,l)
!print*,'i,j,k,l,m,ind_mat(i,j)',i,j,k,l,m,ind_mat(i,j),mat_sign(k,m),mat_sign(k,l)
endif
enddo
endif
enddo
enddo
enddo
enddo
!      Do k=1,n
!print*,'sdet(k)',sdet(k)
!       Do i=1,sdet(k)
!        IIs=Nsd(Is,Jdet)
!        Spl0=Dble(mat_sign(k,i))
!print*,'Spl0',k,i,Spl0
!        Do j=i,sdet(k)
!         JJs=Nsd(Js,Jdet)
!         Spl=Spl0*Dble(mat_sign(k,j))
!         S00(j,i)=S00(j,i)+Spl
!        Enddo
!       Enddo
!      Enddo
      Do i=1,numstr
       Do j=i+1,numstr
        ind_mat(j,i)=ind_mat(i,j)
       Enddo
      Enddo

!Do i=1,numstr
!write(*,102),(ind_mat(i,j),j=1,numstr)
!
!!write(*,102),(S00(i,j),j=1,totstr)
!Enddo


!call MatLDR('ind',col,numstr,D1)
!det_inv=1.0
!do i=1,numstr
!if (dabs(D1(i)).lt.1.D-10)then
!Ifail=1
!goto 111
!endif
!
!det_inv=det_inv*D1(i)
!enddo
!print*,'mat_ind',(D1(i),i=1,numstr),'det_inv=',det_inv
!
!if (dabs(det_inv).lt.1.D-10)then
!Ifail=1
!else
!Ifail=0
!endif

call Invmat(numstr,Ifail)
111 faiil=Ifail
!if(numstr.eq.14.and.Ifail.eq.0)then
!print*,(strno(i),i=1,numstr)
!if(Ifail.eq.0)then
!write(9,*),'Ifail:invmat',Ifail
!do i=1,numstr
!write(9,103),'mat_ind_str',(str5(strno(i),j),j=1,nae)
!enddo
!Do i=1,numstr
!write(9,102),(ind_mat(i,j),j=1,numstr)
!!!!!
!!!!!!write(*,102),(S00(i,j),j=1,totstr)
!Enddo
!endif
!endif
!if(Ifail.eq.0.and.numstr.eq.5)serial=serial+1
!print*,'serial=',serial
!print*,'exit mat_ind'

!if(numstr.eq.7)stop
return
end subroutine mat_ind

!---------------------------------------------
      SUBROUTINE Invmat(Ndim,Ifail)
!---------------------------------------------
!
!
!
use commondat
use commondat1
      Implicit DOUBLE PRECISION(A-H,O-Z)
      Dimension A(1000,1000),B(1000,1000)




!print*,'enter Invmat'
do i=1,ndim
do j=1,ndim
A(i,j)=ind_mat(i,j)
!print*,A(i,j)
enddo
enddo
!do i=1,ndim
!write(9,111),'ind_mat',(int(A(i,j)),j=1,ndim)
!enddo
111 format(a,30I5)

      N=Ndim
      Ifail = 0
      Xdet = 1.D0
      Do I = 1,N
       Do J = 1,N
        B(J,I) = 0.D0
       Enddo
       B(I,I) = 1.D0
      Enddo
!do i=1,ndim
!print*,'A(i,j)',(A(i,j),j=1,ndim)
!enddo

      Do I = 1,N-1
!--Find the Max
       Amax = Dabs(A(I,I))
!print*,'AmaxII',I,Amax
       Nmax = I

       Do J = I+1,N
        Aij = Dabs(A(I,J))
!print*,'Aij',I,J,Aij
        If(Aij.Gt.Amax) Then
         Amax = Aij
         Nmax = J
        Endif
       Enddo

!print*,'Amaxij',Amax,Nmax
       If(Amax.Lt.1.D-11) Then
!       If(Amax.Lt.1.D-1) Then
        Ifail = 1
!print*,'Amax',Amax
        Xdet = 0.D0
        Return
       Endif

       If(Nmax.Ne.I) Then
        Xdet = -Xdet
        Do J = 1,N
         Atmp = A(J,I)
         A(J,I) = A(J,Nmax)
         A(J,Nmax) = Atmp
         Atmp = B(J,I)
         B(J,I) = B(J,Nmax)
         B(J,Nmax) = Atmp
        Enddo
       Endif

!-- Vanish Lower
       Do J = I+1,N
        Atmp = A(I,J)/A(I,I)
        Do K = 1,N
!print*,'A(K,J)',I,J,K,A(K,J),Atmp,A(K,I)
         A(K,J) = A(K,J)-Atmp*A(K,I)
         B(K,J) = B(K,J)-Atmp*B(K,I)
!print*,'A(K,J)**',I,J,K,A(K,J),Atmp,A(K,I)
!do i1=1,ndim
!print*,'A(i,j)',(A(i1,j1),j1=1,ndim)
!enddo
        Enddo
       Enddo
        Do K = 1,N
!print*,'A(K,J)',k,(A(K,J),J=1,N)
        Enddo
      Enddo
!do i=1,ndim
!print*,'A(i,j)',(A(i,j),j=1,ndim)
!enddo

      If(Dabs(A(N,N)).Lt.1.D-11) Then
!      If(Dabs(A(N,N)).lt.1.D-1) Then
       Ifail = 1
!print*,'Dabs(A(N,N))',N,Dabs(A(N,N))
       Xdet = 0.D0
       Return
      Endif

      Do I = 1,N
       Xdet = Xdet*A(I,I)
      Enddo

!-- Vanish Upper
      Do I = N,2,-1
       Do J = I-1,1,-1
        Atmp = A(I,J)/A(I,I)
        Do K = 1,N
         A(K,J) = A(K,J)-Atmp*A(K,I)
         B(K,J) = B(K,J)-Atmp*B(K,I)
!print*,'A(K,J)****',I,J,K,A(K,J),Atmp,A(K,I)
        Enddo
       Enddo
      Enddo

!do i=1,ndim
!print*,'A(i,j)',(A(i,j),j=1,ndim)
!enddo
!-- Normalized
      Do I = 1,N
       Atmp = A(I,I)
       Do J = 1,N
        B(J,I) = B(J,I)/Atmp
       Enddo
      Enddo
      End

!--------------------------------------------
      SUBROUTINE MatLDR1(name,col1,N,D)
!--------------------------------------------
!
!     A = U * D * VT**T
!     by two-sides Jacobi's method
!     U,VT::: left and right eigen value of A
!     right eigenvectors are stored in transpose form
!     D::: diagonal matrix stored in one dimension array
!     N::: the length of row/column of matrix A
!     Nlt::: is the Nulity of matrix A, which is equal to the number of zero eigenvalues 
!     Up::: upper main tridiagonal
!     Low::: lowwer main tridiagonal
!     Amax::: maximum off-diagonal matrix elements
!
      USE commondat1
      Implicit none
      Double Precision A(N,N),U(N,N),D(N),VT(N,N)
      Double Precision Amax,Anzo,Aii,Ajj,Aij,Aji,Aod,Adif,tmp
      integer N,Nlt,col1(2,1000)
      integer I,J,K,L,Iplus,faiil
      integer iter,Itmax,Dotri
      Double Precision Zer,One,Eps,ovlp
      INTEGER IW,IER
      character(len=3)::name
common/fail/faiil

      Data Zer,One,Eps/0.D0,1.D0,1.0D-20/

!print*,'name_gandu',name
if(name.eq.'orb')then
do i=1,N
do j=1,N
A(i,j)=orb_ovlp_mat1(col1(1,i),col1(2,j))
enddo
enddo
endif

!if(N.eq.5.and.faiil.eq.0)then
!print*,'col(i)_Mat',(col1(1,i),i=1,N),'col(j)',(col1(2,j),j=1,N)
!print*,'faiil',faiil
do i=1,N
print*,'orb_ovlp_mat1_MatL',(orb_ovlp_mat1(col1(1,i),col1(2,j)),j=1,N)
enddo
!endif
!
!do i=1,N
!print*,'A(i,j)',(A(i,j),j=1,N)
!enddo

!
!if(name.eq.'ind')then
!do i=1,N
!do j=1,N
!A(i,j)=ind_mat(i,j)
!enddo
!print*,'MatLDR:A',(A(i,j),j=1,N)
!enddo
!write(*,102),(ind_mat(i,j),j=1,numstr)
!endif
!      IW  = IVBF(1)
!      IER = IVBF(3)
!     write(0,*)"NDIM = ",Ndim
!     write(0,*)"Size = ",Size(VT,1),Size(VT,2),Size(VT)
!do i=1,N
!print*,'MatLDR:A',(A(i,j),j=1,N)
!enddo

!print*,'N',N,Zer

      do i = 1, N
        D(i) = Zer
        do j = 1, N
          U(j,i) = Zer
          VT(j,i) = Zer
        enddo
        U(i,i) = One
        VT(i,i) = One
      enddo
      Nlt = 0
      if(N.le.0) Return
      if(N.eq.1) then
          D(1) = A(1,1)
          if(dabs(D(1)) .lt. 1.d-12 ) Nlt = 1
          Return
      endif
      itmax = 200
      iter = 0
      Amax = One
      do while(Amax .gt. Eps)
!print*,'Eps',Eps,Amax
          iter = iter + 1
          Amax = Zer
          do i = 2, N
          do j = 1, i - 1
            Aii = A(i,i)
            Ajj = A(j,j)
            Aij = A(i,j)
            Aji = A(j,i)
            if(dabs(Aij) .gt. Amax) Amax = dabs(Aij)
            if(dabs(Aji) .gt. Amax) Amax = dabs(Aji)
            if(dabs(Aij) .lt. Eps .and. dabs(Aji) .lt. Eps) cycle
            Call TwoSideJacobi(i,j,Aii,Ajj,Aij,Aji,U,VT,A,N)
!print*,'Aij',i,j,Aii,Aij,Ajj,Aji
          end do
          end do
      end do
!print*,'Aij***',i,j,Aii,Aij,Ajj,Aji
!do i=1,3
!print*,'U',(U(i,j),j=1,3)
!enddo
!do i=1,3
!print*,'VT',(VT(i,j),j=1,3)
!enddo

      do i = 1,N
        D(i) = A(i,i)
      End do
      if((iter / N) .eq. itmax) then
        write(*,*)'fail in MatLDR'
        write(*,*)'Average number of sweep:::',iter / N
        Stop
      endif

!     bubble sort the eigenvalues and eigenvectors
      Do I = 1, N-1
        tmp = dabs(D(I))
        K = I
        Do J = I+1, N
          If(dabs(D(J)) .GT. tmp) then
            tmp = dabs(D(J))
            K = J
          Endif
        Enddo
        If( K .NE. I) Then
          tmp = D(I)
          D(I) = D(K)
          D(K) = tmp
          Do J = 1, N
            tmp = U(J,I)
            U(J,I) = U(J,K)
            U(J,K) = tmp
            tmp = VT(J,I)
            VT(J,I) = VT(J,K)
            VT(J,K) = tmp
          Enddo
        Endif
      Enddo
      Do I=N,1,-1
        If(Dabs(D(I)).LT.1.d-12) Then
          Nlt=Nlt+1
        Else  
          Exit
        Endif
      Enddo
      Call MatTran(VT,N)
ovlp=1.0
do i=1,N
ovlp=ovlp*D(i)
enddo
!print*,'MatDLR:D',(D(i),i=1,N),ovlp
      Return
      End

!--------------------------------------------
      SUBROUTINE MatLDR(name,col,N,D)
!--------------------------------------------
!
!     A = U * D * VT**T
!     by two-sides Jacobi's method
!     U,VT::: left and right eigen value of A
!     right eigenvectors are stored in transpose form
!     D::: diagonal matrix stored in one dimension array
!     N::: the length of row/column of matrix A
!     Nlt::: is the Nulity of matrix A, which is equal to the number of zero eigenvalues 
!     Up::: upper main tridiagonal
!     Low::: lowwer main tridiagonal
!     Amax::: maximum off-diagonal matrix elements
!
      USE commondat1
      Implicit none
      Double Precision A(N,N),U(N,N),D(N),VT(N,N),bond_vec_mat(150,150)
      Double Precision Amax,Anzo,Aii,Ajj,Aij,Aji,Aod,Adif,tmp
      integer N,Nlt,col(1000)
      integer I,J,K,L,Iplus,faiil
      integer iter,Itmax,Dotri
      Double Precision Zer,One,Eps,ovlp
      INTEGER IW,IER
      character(len=3)::name
common/fail/faiil
common /bnd_mat/bond_vec_mat

      Data Zer,One,Eps/0.D0,1.D0,1.0D-20/

!print*,'name_gandu',name
!if(name.eq.'orb')then
!do i=1,N
!do j=1,N
!A(i,j)=orb_ovlp_mat1(col1(1,i),col1(2,j))
!enddo
!enddo
!endif
!
!print*,'col(i)',(col1(1,i),i=1,N),'col(j)',(col1(2,j),j=1,N)

if(name.eq.'str')then
do i=1,N
do j=1,N
A(i,j)=ovlp_mat_norm(col(i),col(j))
enddo
enddo
endif

if(name.eq.'ind')then
do i=1,N
do j=1,N
A(i,j)=ind_mat(i,j)
enddo
!print*,'MatLDR:A',(A(i,j),j=1,N)
enddo
!write(*,102),(ind_mat(i,j),j=1,numstr)
endif
if(name.eq.'bnv')then
do i=1,N
do j=1,N
A(i,j)=bond_vec_mat(i,j)
enddo
enddo
endif
!if(N.eq.14.and.name.eq.'str'.and.faiil.eq.0)then
!print*,'col(i)',(col(i),i=1,N),'col(j)',(col(j),j=1,N)
!do i=1,N
!print*,'orb_ovlp_mat1_MatL',(ovlp_mat_norm(col(i),col(j)),j=1,N)
!enddo
!endif
!      IW  = IVBF(1)
!      IER = IVBF(3)
!     write(0,*)"NDIM = ",Ndim
!     write(0,*)"Size = ",Size(VT,1),Size(VT,2),Size(VT)
!do i=1,N
!print*,'MatLDR:A',(A(i,j),j=1,N)
!enddo

!print*,'N',N,Zer

      do i = 1, N
        D(i) = Zer
        do j = 1, N
          U(j,i) = Zer
          VT(j,i) = Zer
        enddo
        U(i,i) = One
        VT(i,i) = One
      enddo
      Nlt = 0
      if(N.le.0) Return
      if(N.eq.1) then
          D(1) = A(1,1)
          if(dabs(D(1)) .lt. 1.d-12 ) Nlt = 1
          Return
      endif
      itmax = 200
      iter = 0
      Amax = One
      do while(Amax .gt. Eps)
!print*,'Eps',Eps,Amax
          iter = iter + 1
          Amax = Zer
          do i = 2, N
          do j = 1, i - 1
            Aii = A(i,i)
            Ajj = A(j,j)
            Aij = A(i,j)
            Aji = A(j,i)
            if(dabs(Aij) .gt. Amax) Amax = dabs(Aij)
            if(dabs(Aji) .gt. Amax) Amax = dabs(Aji)
            if(dabs(Aij) .lt. Eps .and. dabs(Aji) .lt. Eps) cycle
            Call TwoSideJacobi(i,j,Aii,Ajj,Aij,Aji,U,VT,A,N)
!print*,'Aij',i,j,Aii,Aij,Ajj,Aji
          end do
          end do
      end do
!print*,'Aij***',i,j,Aii,Aij,Ajj,Aji
!do i=1,3
!print*,'U',(U(i,j),j=1,3)
!enddo
!do i=1,3
!print*,'VT',(VT(i,j),j=1,3)
!enddo

      do i = 1,N
        D(i) = A(i,i)
      End do
      if((iter / N) .eq. itmax) then
        write(*,*)'fail in MatLDR'
        write(*,*)'Average number of sweep:::',iter / N
        Stop
      endif

!     bubble sort the eigenvalues and eigenvectors
      Do I = 1, N-1
        tmp = dabs(D(I))
        K = I
        Do J = I+1, N
          If(dabs(D(J)) .GT. tmp) then
            tmp = dabs(D(J))
            K = J
          Endif
        Enddo
        If( K .NE. I) Then
          tmp = D(I)
          D(I) = D(K)
          D(K) = tmp
          Do J = 1, N
            tmp = U(J,I)
            U(J,I) = U(J,K)
            U(J,K) = tmp
            tmp = VT(J,I)
            VT(J,I) = VT(J,K)
            VT(J,K) = tmp
          Enddo
        Endif
      Enddo
      Do I=N,1,-1
        If(Dabs(D(I)).LT.1.d-12) Then
          Nlt=Nlt+1
        Else  
          Exit
        Endif
      Enddo
      Call MatTran(VT,N)
ovlp=1.0
do i=1,N
ovlp=ovlp*D(i)
enddo
!print*,'MatDLR:D',(D(i),i=1,N)!,1.0-ovlp
      Return
      End
!-------------------------------
      SUBROUTINE MatTran(A,N)
!-------------------------------
!
!
!
        implicit none
        integer N,I,J
        Double Precision A,x
        Dimension A(N,N)

        Do I=1,N-1
          Do J=I+1,N
            x=A(J,I)
            A(J,I)=A(I,J)
            A(I,J)=x
          Enddo
        Enddo

        Return
      End



!----------------------------------------------------------------
      SUBROUTINE TwoSideJacobi(i,j,Aii,Ajj,Aij,Aji,U,VT,A,N)
!----------------------------------------------------------------
!
!     This SUBROUTINE calculate two sides Jacobi rotation to following
!     matrix
!     | Aii Aij |       | Aii~  0  |
!     |         |  -->  |          |
!     | Aji Ajj |       |  0  Ajj~ |
!
      Implicit none
      Double Precision A(N,N),U(N,N),D(N),VT(N,N)
      Double Precision t1,c1,s1
      Double Precision t2,c2,s2
      Double Precision tp,cp,sp
      Double Precision tm,cm,sm
      Double Precision Aii,Ajj,Aij,Aji,tt,Aod,Adif,tmp
      integer N
      integer I,J,k
      Double Precision Zer,One,Eps
      Data Zer,One,Eps/0.D0,1.D0,1.0D-20/
!     write(0,*)"Size 2 = ",Size(VT,1),size(vt,2),size(vt)
!print*,'A11,A12,A21,A22',A(1,1),A(1,2),A(2,1),A(2,2)

!     angle alpha + beta
!     write(0,*)'I J = ',I,J
!     write(0,*)'aii = ',aii
!     write(0,*)'ajj = ',ajj
!     write(0,*)'aij = ',aij
!     write(0,*)'aji = ',aji
      Adif = Aii - Ajj
      Aod = Aij + Aji
      if(dabs(Adif) .lt. dabs(Aod)) then
!       tt is cot(2x)
!       if(tt > Zer) then
!         tp = dsqrt(One + tt*tt) - tt
!       else
!         tp =-dsqrt(One + tt*tt) - tt
!       endif
        tt = Adif / Aod
!       write(0,*)'alpha + beta adif < aod, tt = ',tt
        tp = dsqrt(One + tt*tt)
        if(tt .lt. Zer) tp = -tp
        tp = tp - tt
      else if (dabs(Adif).lt.Eps) then
        tp = Zer
      else
!       tt is tan(2x)
        tt = Aod / Adif
!       write(0,*)'alpha + beta adif >= aod, tt = ',tt
        if(dabs(tt) .gt. 1.d-7) then
          tp = (dsqrt(One + tt*tt) - One) / tt
        else
!         numerical stable:::Taylor expansion
          tp = 0.5d0*tt - 0.125d0*tt*tt + 0.0625d0*tt*tt*tt 
        endif
      endif
      cp = One / dsqrt(One + tp*tp)
      sp = tp * cp
!     angle alpha - beta
      Adif = Aii + Ajj
      Aod = Aji - Aij
      if(dabs(Adif) .lt. dabs(Aod)) then
        tt = Adif / Aod
!       write(0,*)'alpha - beta adif < aod, tt = ',tt
        tm = dsqrt(One + tt*tt)
        if(tt .lt. Zer) tm = -tm
        tm = tm - tt
      else if (dabs(Adif).lt.Eps) then
        tm = Zer
      else
        tt = Aod / Adif
!       write(0,*)'alpha - beta adif >= aod, tt = ',tt
        if(dabs(tt) .gt. 1.d-7) then
          tm = (dsqrt(One + tt*tt) - One) / tt
        else
!         numerical stable:::Taylor expansion
          tm = 0.5d0*tt - 0.125d0*tt*tt + 0.0625d0*tt*tt*tt 
        endif
      endif
      cm = One / dsqrt(One + tm*tm)
      sm = tm * cm
      c1 = cp*cm - sp*sm
      s1 = sp*cm + cp*sm
      c2 = cp*cm + sp*sm
      s2 = sp*cm - cp*sm
!     update U and A
      Do k = 1, N
        tmp=c1*U(k,j)-s1*U(k,i)
        U(k,i)=s1*U(k,j)+c1*U(k,i)
        U(k,j)=tmp
        tmp=c1*A(j,k)-s1*A(i,k)
!print*,A(i,k),A(j,k),s1,c1
        A(i,k)=s1*A(j,k)+c1*A(i,k)
        A(j,k)=tmp
!print*,'A_two',A(i,k),A(j,k),s1,c1,k
      enddo
!     update VT and A
      Do k = 1, N
        tmp=c2*VT(k,j)-s2*VT(k,i)
        VT(k,i)=s2*VT(k,j)+c2*VT(k,i)
        VT(k,j)=tmp
        tmp=c2*A(k,j)-s2*A(k,i)
        A(k,i)=s2*A(k,j)+c2*A(k,i)
        A(k,j)=tmp
!print*,'A_two_2',A(k,i),A(k,j)
      enddo

      A(j,i) = Zer
      A(i,j) = Zer

      return
      End
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!subroutine write_symm_xmi(nl,strn,str3,ncqs,q_fac2)
!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!use commondat
!implicit none
!common/quality/str_quality_1,str_quality_2,bondq,tqlty,bqlty,sqlty,tnqs,nssym,qulsym,symq,&
!sigsym,tnqs_sig
!common/str/str5,nstr7
!
!integer::nl,strn,ncqs,tostr,initstr,i,i1,i2,i3,i4,i5,i6,i7,i8,i9,m119,m18,m19,m20,m21,m23,m24,count&
!,qul(100),nqul,j,jj,jjj,fg,flg,ii5,m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,x,y,strs&
!,ymd,alstr
!integer::i5up16,i16i7,m16m21,i5up15,i15i7,m15m21,i5up14,i14i7,m14m21,i5up13,i13i7,m13m21,i5up12,i12i7,m12m21,&
!i5up11,i11i7,m11m21,i5up10,i10i7,m10m21,i5up9,i9i7,m9m21,i5up8,i8i7,m8m21,i5up7,i7i7,m7m21,i5up6,i6i7,m6m21,&
!i5up5,i5i7,m5m21,i5up4,i4i7,m4m21,i5up3,i3i7,m3m21,i5up2,i2i7,m2m21,i5up1,i1i7,m1m21,i5up17,i17i7,m17m21
!integer::str3(15000,20),q_fac2(15000),finalvec(15000),strset(1000),col(1000),sigsym(15000),tnqs_sig,&
!ffvec2(15000,1000),bondq(15000),bondq4(15000),nqset(15000),str5(2000,20),nstr7,&
!tndet,totstr,Ifail,indpnt,strno(1000),str_quality_1(15000),str_quality_2(15000),ttqlty0,ttqlty&
!,tqlty,bqlty,sqlty,hqlty,tnqs,nssym,qulsym(15000),symq(15000),set_number,ttqlty1,det_inv,ttqlty2,ttqlty3
!integer::rumer(15000),rumer_rad(15000),quality_fac(15000),rumset,u1,max_set,mns
!!integer,dimension(:),allocatable::qq1,qq2,qq
!integer::qq1(5000),qq2(5000),qq(5000),str2(2000,20),Rid,set_num(100)
!real*8::ovlp
!character(10)::dd,a
!Double Precision::D(1000)
!character(len=100)::outfile
!
!print*,'enter write_symm_xmi'
!mns=0
!u1=1
!max_set=75000
!
!if(nfset.eq.3.or.nfset.eq.5)then
!rumset=0
!call rumer_structures(nl,str3,ncqs,rumer,rumer_rad)
!call write_rumer_xmi(nl,str3,ncqs,rumer,rumer_rad,quality_fac)
!endif
!
!set_number=0
!bqlty=0
!tqlty=0
!sqlty=0
!hqlty=0
!indpnt=2
!!ovlpval=1.0
!if(noq0.gt.strn)then
!ttqlty0=noq0
!else
!ttqlty0=strn+noq0
!endif
!ttqlty1=strn+noq1
!ttqlty2=strn+noq2
!ttqlty3=strn+noq3
!
!do i=1,ncqs
!write(*,231),i,(str3(i,j),j=1,nae),q_fac2(i),str_quality_1(i),str_quality_2(i),bondq(i)
!enddo
!!if(indpnt.eq.1)then
!!call vector_rep(nl,str3,ncqs,ffvec2)
!!endif
!!print*,'sou1',strn,ndet,nl,ncqs
!!do i1=1,ncqs
!!print*,(ffvec2(i1,i),i=1,ndet)
!!enddo
!!call quality_factor(nl,str3,ncqs,q_fac2,q_1,q_2)
!jj=1
!do m19=1,ncqs
!!print*,'q_fac2',q_fac2(m19)
!if(m19.eq.1)qul(1)=q_fac2(1)
!j=jj
!do i=1,j
!if(qul(i).eq.q_fac2(m19))goto 373
!enddo
!jj=jj+1
!qul(i)=q_fac2(m19)
!!print*,qul(i)
!373 enddo
!nqul=jj
!!print*,'ncqs',ncqs
!
!!call date_and_time(dd)
!!read (dd,'(I8)') ymd
!!if(ymd.eq.20230516)stop
!
!do i=1,nqul
!jjj=0
!jj=0
!do m19=1,ncqs
!!print*,qul(i),q_fac2(m19)
!if(qul(i).eq.q_fac2(m19))then
!jjj=jjj+1
!jj=m19
!endif
!enddo
!nqset(i)=jjj
!strset(i)=jj
!print*,nqset(i),strset(i)
!enddo
!
!flg=0
!totstr=0
!i7=0
!m21=0
!i5=ndet
!do i8=1,1000
!finalvec(i8)=0
!enddo
!do m19=1,10000
!do m18=1,15
!str2(m19,m18)=0
!enddo
!enddo
!
!
!i5up1=i5
!i1i7=i7
!m1m21=m21
!
!
!do m1=1,nqul
!
!  do i=i5up1+1,i5
!  finalvec(i)=0
!  enddo
!
!  do m19=i1i7+1,i7
!  strno(m19)=0
!    do i8=1,15
!    str2(m19,i8)=0
!    enddo
!  enddo
!
!i7=i1i7
!totstr=i1i7
!m21=m1m21
!
!jj=0
!
!flg=0
!
!
!if(nqset(m1).gt.strn)goto 701
!
!
! if(m1.eq.1)then
!  do i=1,strset(m1)
!   totstr=totstr+1
!   strno(totstr)=i
!  enddo
! else
!  do i=strset(m1-1)+1,strset(m1)
!   totstr=totstr+1
!   strno(totstr)=i
!  enddo
! endif
!if(totstr.gt.strn)goto 701
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!
!if(Ifail.eq.1)goto 701
! if(totstr.gt.1.and.ovopt.eq.vpt) then
!   call MatLDR('str',strno,totstr,D)
!   ovlp=1.0
!  do i=1,totstr
!   ovlp=ovlp*D(i)
!  enddo
!  if(1.0-ovlp.gt.ovval)goto 701
! endif
!
!
!
! m21=m21+nqset(m1)
! if(m21.gt.strn) goto 701
!
!
! if(m1.eq.1)strs=0
!  if(m1.ne.1)strs=strset(m1-1)
!
! do m19=strs+1,strset(m1)
!   if(q_fac2(m19).ne.qul(m1))goto 601
!   i7=i7+1
! do i3=1,nae
!   str2(i7,i3)=str3(m19,i3)
! enddo
!  col(i7)=m19
!  qq(i7)=q_fac2(m19)
!  qq1(i7)=str_quality_1(m19)
!  qq2(i7)=str_quality_2(m19)
!  bondq4(i7)=bondq(m19)
!  flg=1
!  count=1
! 601 enddo
! if(i7.eq.strn) then
!   ttqlty=0
!   tqlty=0
!   bqlty=0
!   sqlty=0
! do m119=1,i7
!  ttqlty=ttqlty+qq(m119)
! enddo
! if(ttqlty.le.ttqlty0)then
!  mns=mns+1
!  set_number=set_number+1
!  if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!  if(nfset.eq.1.and.set_number.gt.1)then
!   if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!  endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.eq.3)then
!Rumwrite=1
!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!endif
!
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1) goto 379
!goto 701
!endif
!
!!endif
!
!i5up2=i5
!i2i7=i7
!m2m21=m21
!
!do m2=m1+1,nqul
!
!do i=i5up2+1,i5
!finalvec(i)=0
!enddo
!
!do m19=i2i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!
!i7=i2i7
!totstr=i2i7
!m21=m2m21
!
!jj=0
!
!flg=0
!!do m19=strset(m2-1)+1,strset(m2)
!
!if(nqset(m2).gt.strn)goto 702
!
!do i=strset(m2-1)+1,strset(m2)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!if(totstr.gt.strn)goto 702
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!
!if(Ifail.eq.1) goto 702
!!do i=strset(m2-1)+1,strset(m2)
!!strno(totstr)=0
!!totstr=totstr-1
!!enddo
!!goto 702
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 702
!endif
!m21=m21+nqset(m2)
!if(m21.gt.strn) goto 702
!!print*,'sourav_xmi_sym'
!
!
!do m19=strset(m2-1)+1,strset(m2)
!if(q_fac2(m19).ne.qul(m2))goto 602
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!count=2
!602 enddo
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(9+u1,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.eq.3)then
!Rumwrite=1
!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!endif
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!write(9,910)'qualities:','
!!intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!goto 702
!endif
!
!
!i5up3=i5
!i3i7=i7
!m3m21=m21
!
!
!do m3=m2+1,nqul
!
!do i=i5up3+1,i5
!finalvec(i)=0
!enddo
!
!do m19=i3i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!
!i7=i3i7
!totstr=i3i7
!m21=m3m21
!
!jj=0
!
!flg=0
!!do m19=strset(m3-1)+1,strset(m3)
!
!if(nqset(m3).gt.strn)goto 703
!
!do i=strset(m3-1)+1,strset(m3)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!if(totstr.gt.strn)goto 703
!do i=1,totstr
!enddo
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!
!if(Ifail.eq.1) goto 703
!!do i=strset(m3-1)+1,strset(m3)
!!strno(totstr)=0
!!totstr=totstr-1
!!enddo
!!goto 703
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!print*,'MatLDR_write_xmi',totstr
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 703
!endif
!
!m21=m21+nqset(m3)
!if(m21.gt.strn) goto 703
!!print*,'sourav_xmi_sym'
!
!!303 enddo
!
!
!do m19=strset(m3-1)+1,strset(m3)
!if(q_fac2(m19).ne.qul(m3))goto 603
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!count=3
!603 enddo
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(9+u1,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(ovopt.eq.vpt) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!write(9,910)'qualities:','
!!intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!goto 703
!endif
!
!i5up4=i5
!i4i7=i7
!m4m21=m21
!
!do m4=m3+1,nqul
!!print*,'m4m4m4',m4
!do i=i5up4+1,i5
!finalvec(i)=0
!enddo
!do m19=i4i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!i7=i4i7
!totstr=i4i7
!m21=m4m21
!
!jj=0
!flg=0
!!do m19=strset(m4-1)+1,strset(m4)
!
!if(nqset(m4).gt.strn)goto 704
!
!do i=strset(m4-1)+1,strset(m4)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!
!if(totstr.gt.strn)goto 704
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!!print*,'ifail4',ifail
!if(Ifail.eq.1) goto 704
!!strno(totstr)=0
!!totstr=totstr-1
!!goto 304
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!print*,'MatLDR_write_xmi',totstr
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 704
!endif
!
!
!m21=m21+nqset(m4)
!if(m21.gt.strn) goto 704
!!print*,'sourav_xmi_sym'
!
!!304 enddo
!
!
!do m19=strset(m4-1)+1,strset(m4)
!if(q_fac2(m19).ne.qul(m4))goto 604
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!count=4
!604 enddo
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(9+u1,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.ne.0)then
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.eq.0)then
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(ovopt.eq.vpt) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!write(9,910)'qualities:','
!!intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!goto 704
!endif
!
!i5up5=i5
!i5i7=i7
!m5m21=m21
!
!!!!!! loop 5 >>>
!do m5=m4+1,nqul
!!print*,'m5m5m5',m5
!do i=i5up5+1,i5
!finalvec(i)=0
!enddo
!do m19=i5i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!i7=i5i7
!totstr=i5i7
!!print*,'totstr5',totstr
!m21=m5m21
!jj=0
!
!flg=0
!!do m19=strset(m5-1)+1,strset(m5)
!
!if(nqset(m5).gt.strn)goto 705
!
!do i=strset(m5-1)+1,strset(m5)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!
!if(totstr.gt.strn)goto 705
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!if(Ifail.eq.1) goto 705
!
!!strno(totstr)=0
!!totstr=totstr-1
!!goto 305
!!endif
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!print*,'MatLDR_write_xmi',totstr
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 705
!endif
!
!
!m21=m21+nqset(m5)
!if(m21.gt.strn) goto 705
!!print*,'sourav_xmi_sym'
!
!!305 enddo
!
!!print*,'jj',jj,m5,nqul
!!print*,'******jj',jj
!
!do m19=strset(m5-1)+1,strset(m5)
!if(q_fac2(m19).ne.qul(m5))goto 605
!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!count=5
!605 enddo
!!print*,'i7 5',i7,m5
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(9+u1,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.ne.0)then
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.eq.0)then
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.eq.3)then
!Rumwrite=1
!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!endif
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!write(9,910)'qualities:','
!!intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!goto 705
!endif
!
!i5up6=i5
!i6i7=i7
!m6m21=m21
!
!do m6=m5+1,nqul
!
!!print*,'m6m6m6',m6
!do i=i5up6+1,i5
!finalvec(i)=0
!enddo
!do m19=i6i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!i7=i6i7
!totstr=i6i7
!!print*,'totstr6',totstr
!m21=m6m21
!
!jj=0
!
!flg=0
!!do m19=strset(m6-1)+1,strset(m6)
!
!if(nqset(m6).gt.strn)goto 706
!
!do i=strset(m6-1)+1,strset(m6)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!
!if(totstr.gt.strn)goto 706
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!!print*,'ifail6',ifail
!if(Ifail.eq.1)goto 706
!!!do i8=1,nae
!!!str4(totstr,i8)=0
!!!enddo
!!strno(totstr)=0
!!totstr=totstr-1
!!goto 306
!!endif
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!print*,'MatLDR_write_xmi',totstr
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 706
!endif
!
!
!m21=m21+nqset(m6)
!if(m21.gt.strn) goto 706
!!print*,'sourav_xmi_sym'
!
!!306 enddo
!
!!print*,'jj',jj,m6,nqul
!do m19=strset(m6-1)+1,strset(m6)
!if(q_fac2(m19).ne.qul(m6))goto 606
!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!count=6
!606 enddo
!!print*,'i7  6',i7,m6
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0,tqlty,ttqlty1,bqlty,ttqlty2,sqlty,ttqlty3
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(9+u1,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.ne.0)then
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.eq.0)then
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.eq.3)then
!Rumwrite=1
!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!endif
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'qualities:','
!!intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!goto 706
!endif
!
!i5up7=i5
!i7i7=i7
!m7m21=m21
!
!do m7=m6+1,nqul
!!print*,'m7m7m7',m7
!do i=i5up7+1,i5
!finalvec(i)=0
!enddo
!do m19=i7i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!i7=i7i7
!totstr=i7i7
!!print*,'totstr7',totstr
!m21=m7m21
!
!jj=0
!
!flg=0
!!do m19=strset(m7-1)+1,strset(m7)
!
!if(nqset(m7).gt.strn)goto 707
!do i=strset(m7-1)+1,strset(m7)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!if(totstr.gt.strn)goto 707
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!if(Ifail.eq.1)goto 707
!!!do i8=1,nae
!!!str4(totstr,i8)=0
!!!enddo
!!strno(totstr)=0
!!totstr=totstr-1
!!goto 307
!!endif
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!print*,'MatLDR_write_xmi',totstr
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 707
!endif
!
!
!m21=m21+nqset(m7)
!if(m21.gt.strn) goto 707
!!print*,'sourav_xmi_sym'
!
!!307 enddo
!
!!print*,'jj',jj,m7,nqul
!!407 if(jj.eq.nqset(m7))then
!!print*,'******jj',jj
!
!do m19=strset(m7-1)+1,strset(m7)
!if(q_fac2(m19).ne.qul(m7))goto 607
!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!count=7
!607 enddo
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(9+u1,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.ne.0)then
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.eq.0)then
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.eq.3)then
!Rumwrite=1
!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!endif
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!write(9,910)'qualities:','
!!intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!goto 707
!endif
!
!i5up8=i5
!i8i7=i7
!m8m21=m21
!
!do m8=m7+1,nqul
!!print*,'m8m8m8',m8
!do i=i5up8+1,i5
!finalvec(i)=0
!enddo
!do m19=i8i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!i7=i8i7
!totstr=i8i7
!!print*,'totstr8',totstr
!m21=m8m21
!
!jj=0
!
!flg=0
!!do m19=strset(m8-1)+1,strset(m8)
!
!if(nqset(m8).gt.strn)goto 708
!
!do i=strset(m8-1)+1,strset(m8)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!
!if(totstr.gt.strn)goto 708
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!if(Ifail.eq.1)goto 708
!
!!!do i8=1,nae
!!!str4(totstr,i8)=0
!!!enddo
!!strno(totstr)=0
!!totstr=totstr-1
!!goto 308
!!endif
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!print*,'MatLDR_write_xmi',totstr
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 708
!endif
!
!
!m21=m21+nqset(m8)
!if(m21.gt.strn) goto 708
!!print*,'sourav_xmi_sym'
!
!!308 enddo
!
!!print*,'jj',jj,m7,nqul
!!408 if(jj.eq.nqset(m8))then
!!print*,'******jj',jj
!
!do m19=strset(m8-1)+1,strset(m8)
!if(q_fac2(m19).ne.qul(m8))goto 608
!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!count=8
!608 enddo
!!print*,'i7 8',i7,m8
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(9+u1,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.ne.0)then
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.eq.0)then
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.eq.3)then
!Rumwrite=1
!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!endif
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!goto 708
!endif
!
!i5up9=i5
!i9i7=i7
!m9m21=m21
!
!do m9=m8+1,nqul
!!print*,'m9m9m9',m9
!do i=i5up9+1,i5
!finalvec(i)=0
!enddo
!do m19=i9i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!i7=i9i7
!totstr=i9i7
!!print*,'totstr9',totstr
!m21=m9m21
!
!jj=0
!
!flg=0
!!do m19=strset(m9-1)+1,strset(m9)
!
!if(nqset(m9).gt.strn)goto 709
!
!do i=strset(m9-1)+1,strset(m9)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!
!if(totstr.gt.strn)goto 709
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!!print*,'ifail9',ifail
!if(Ifail.eq.1)goto 709
!!!do i8=1,nae
!!!str4(totstr,i8)=0
!!!enddo
!!strno(totstr)=0
!!totstr=totstr-1
!!goto 309
!!endif
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!print*,'MatLDR_write_xmi',totstr
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 709
!endif
!
!
!m21=m21+nqset(m9)
!if(m21.gt.strn) goto 709
!!print*,'sourav_xmi_sym'
!
!!309 enddo
!
!!print*,'jj',jj,m9,nqul
!!409 if(jj.eq.nqset(m9))then
!!print*,'******jj',jj
!
!do m19=strset(m9-1)+1,strset(m9)
!if(q_fac2(m19).ne.qul(m9))goto 609
!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!count=9
!609 enddo
!!print*,'i7 9',i7,m9
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(9+u1,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.ne.0)then
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.eq.0)then
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.eq.3)then
!Rumwrite=1
!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!endif
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!goto 709
!endif
!
!i5up10=i5
!i10i7=i7
!m10m21=m21
!
!do m10=m9+1,nqul
!!print*,'m10m10m10',m10
!do i=i5up10+1,i5
!finalvec(i)=0
!enddo
!do m19=i10i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!i7=i10i7
!totstr=i10i7
!!print*,'totstr10',totstr
!m21=m10m21
!
!jj=0
!
!flg=0
!!do m19=strset(m10-1)+1,strset(m10)
!
!if(nqset(m10).gt.strn)goto 710
!
!do i=strset(m10-1)+1,strset(m10)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!
!if(totstr.gt.strn)goto 710
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!if(Ifail.eq.1)goto 710
!!!do i8=1,nae
!!!str4(totstr,i8)=0
!!!enddo
!!strno(totstr)=0
!!totstr=totstr-1
!!goto 310
!!endif
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!print*,'MatLDR_write_xmi',totstr
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 710
!endif
!
!
!m21=m21+nqset(m10)
!if(m21.gt.strn) goto 710
!!print*,'sourav_xmi_sym'
!
!!310 enddo
!
!!print*,'jj',jj,m10,nqul
!!410 if(jj.eq.nqset(m10))then
!!print*,'******jj',jj
!
!do m19=strset(m10-1)+1,strset(m10)
!if(q_fac2(m19).ne.qul(m10))goto 610
!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!count=10
!610 enddo
!!print*,'i7 10',i7,m10
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(9+u1,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.ne.0)then
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.eq.0)then
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.eq.3)then
!Rumwrite=1
!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!endif
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!goto 710
!endif
!
!i5up11=i5
!i11i7=i7
!m11m21=m21
!
!do m11=m10+1,nqul
!!print*,'m11m11m11',m11
!do i=i5up11+1,i5
!finalvec(i)=0
!enddo
!do m19=i11i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!i7=i11i7
!totstr=i11i7
!!print*,'totstr11',totstr
!m21=m11m21
!
!jj=0
!
!flg=0
!!do m19=strset(m11-1)+1,strset(m11)
!
!if(nqset(m11).gt.strn)goto 711
!
!do i=strset(m11-1)+1,strset(m11)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!
!if(totstr.gt.strn)goto 711
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!if(Ifail.eq.1)goto 711
!!!do i8=1,nae
!!!str4(totstr,i8)=0
!!!enddo
!!strno(totstr)=0
!!totstr=totstr-1
!!goto 311
!!endif
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!print*,'MatLDR_write_xmi',totstr
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 711
!endif
!
!
!m21=m21+nqset(m11)
!if(m21.gt.strn) goto 711
!!print*,'sourav_xmi_sym'
!
!!311 enddo
!
!!print*,'jj',jj,m11,nqul
!!411 if(jj.eq.nqset(m11))then
!!print*,'******jj',jj
!
!do m19=strset(m11-1)+1,strset(m11)
!if(q_fac2(m19).ne.qul(m11))goto 611
!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!count=11
!611 enddo
!!print*,'i7 11',i7,m11
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(9+u1,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.ne.0)then
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.eq.0)then
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.eq.3)then
!Rumwrite=1
!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!endif
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!goto 711
!endif
!
!i5up12=i5
!i12i7=i7
!m12m21=m21
!
!do m12=m11+1,nqul
!!print*,'m12m12m12',m12
!do i=i5up12+1,i5
!finalvec(i)=0
!enddo
!do m19=i12i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!i7=i12i7
!totstr=i12i7
!!print*,'totstr12',totstr
!m21=m12m21
!
!jj=0
!
!flg=0
!!do m19=strset(m12-1)+1,strset(m12)
!
!if(nqset(m12).gt.strn)goto 712
!
!do i=strset(m12-1)+1,strset(m12)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!
!if(totstr.gt.strn)goto 712
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!if(Ifail.eq.1)goto 712
!!!do i8=1,nae
!!!str4(totstr,i8)=0
!!!enddo
!!strno(totstr)=0
!!totstr=totstr-1
!!goto 312
!!endif
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!print*,'MatLDR_write_xmi',totstr
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 712
!endif
!
!
!m21=m21+nqset(m12)
!if(m21.gt.strn) goto 712
!!print*,'sourav_xmi_sym'
!
!
!!312 enddo
!
!!print*,'jj',jj,m12,nqul
!!412 if(jj.eq.nqset(m12))then
!!print*,'******jj',jj
!
!do m19=strset(m12-1)+1,strset(m12)
!if(q_fac2(m19).ne.qul(m12))goto 612
!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!count=12
!612 enddo
!!print*,'i7 12',i7,m12
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(9+u1,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.ne.0)then
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.eq.0)then
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.eq.3)then
!Rumwrite=1
!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!endif
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!goto 712
!endif
!
!i5up13=i5
!i13i7=i7
!m13m21=m21
!
!do m13=m12+1,nqul
!
!!print*,'m13m13m13',m13
!do i=i5up13+1,i5
!finalvec(i)=0
!enddo
!do m19=i13i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!i7=i13i7
!totstr=i13i7
!!print*,'totstr13',totstr
!m21=m13m21
!
!jj=0
!
!flg=0
!!do m19=strset(m13-1)+1,strset(m13)
!
!if(nqset(m13).gt.strn)goto 713
!
!do i=strset(m13-1)+1,strset(m13)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!
!if(totstr.gt.strn)goto 713
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!!print*,'ifail13',ifail
!if(Ifail.eq.1)goto 713
!!!do i8=1,nae
!!!str4(totstr,i8)=0
!!!enddo
!!strno(totstr)=0
!!totstr=totstr-1
!!goto 313
!!endif
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!print*,'MatLDR_write_xmi',totstr
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 713
!endif
!
!m21=m21+nqset(m13)
!if(m21.gt.strn) goto 713
!!print*,'sourav_xmi_sym'
!
!!313 enddo
!
!!print*,'jj',jj,m13,nqul
!!413 if(jj.eq.nqset(m13))then
!!print*,'******jj',jj
!
!do m19=strset(m13-1)+1,strset(m13)
!if(q_fac2(m19).ne.qul(m13))goto 613
!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!count=13
!613 enddo
!!print*,'i7 13',i7,m13
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.ne.0)then
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.eq.0)then
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.eq.3)then
!Rumwrite=1
!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!endif
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!goto 713
!endif
!
!i5up14=i5
!i14i7=i7
!m14m21=m21
!
!do m14=m13+1,nqul
!!print*,'m14m14m14',m14
!do i=i5up14+1,i5
!finalvec(i)=0
!enddo
!do m19=i14i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!i7=i14i7
!totstr=i14i7
!!print*,'totstr14',totstr
!m21=m14m21
!
!jj=0
!
!flg=0
!!do m19=strset(m14-1)+1,strset(m14)
!
!if(nqset(m14).gt.strn)goto 714
!
!do i=strset(m14-1)+1,strset(m14)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!
!if(totstr.gt.strn)goto 714
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!if(Ifail.eq.1)goto 714
!!!do i8=1,nae
!!!str4(totstr,i8)=0
!!!enddo
!!strno(totstr)=0
!!totstr=totstr-1
!!goto 314
!!endif
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!print*,'MatLDR_write_xmi',totstr
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 714
!endif
!
!
!m21=m21+nqset(m14)
!if(m21.gt.strn) goto 714
!!print*,'sourav_xmi_sym'
!
!!314 enddo
!
!!print*,'jj',jj,m14,nqul
!!414 if(jj.eq.nqset(m14))then
!!print*,'******jj',jj
!
!do m19=strset(m14-1)+1,strset(m14)
!if(q_fac2(m19).ne.qul(m14))goto 614
!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!count=14
!614 enddo
!!print*,'i7 14',i7,m14
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(9+u1,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.ne.0)then
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.eq.0)then
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.eq.3)then
!Rumwrite=1
!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!endif
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!goto 714
!endif
!
!i5up15=i5
!i15i7=i7
!m15m21=m21
!
!do m15=m14+1,nqul
!!print*,'m15m15m15',m15
!do i=i5up15+1,i5
!finalvec(i)=0
!enddo
!do m19=i15i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!i7=i15i7
!totstr=i15i7
!!print*,'totstr15',totstr
!m21=m15m21
!
!jj=0
!
!flg=0
!!do m19=strset(m15-1)+1,strset(m15)
!
!if(nqset(m15).gt.strn)goto 715
!
!do i=strset(m15-1)+1,strset(m15)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!
!if(totstr.gt.strn)goto 715
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!if(Ifail.eq.1)goto 715
!!!do i8=1,nae
!!!str4(totstr,i8)=0
!!!enddo
!!strno(totstr)=0
!!totstr=totstr-1
!!goto 315
!!endif
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!print*,'MatLDR_write_xmi',totstr
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 715
!endif
!
!
!m21=m21+nqset(m15)
!if(m21.gt.strn) goto 715
!!print*,'sourav_xmi_sym'
!
!!315 enddo
!
!!print*,'jj',jj,m15,nqul
!!415 if(jj.eq.nqset(m15))then
!!print*,'******jj',jj
!
!do m19=strset(m15-1)+1,strset(m15)
!if(q_fac2(m19).ne.qul(m15))goto 615
!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!count=15
!615 enddo
!!print*,'i7 15',i7,m15
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(9+u1,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.ne.0)then
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.eq.0)then
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.eq.3)then
!Rumwrite=1
!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!endif
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!goto 715
!endif
!
!i5up16=i5
!i16i7=i7
!m16m21=m21
!
!do m16=m15+1,nqul
!!print*,'m16m16m16',m16
!do i=i5up16+1,i5
!finalvec(i)=0
!enddo
!do m19=i16i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!i7=i16i7
!totstr=i16i7
!!print*,'totstr16',totstr
!m21=m16m21
!
!jj=0
!
!flg=0
!!do m19=strset(m16-1)+1,strset(m16)
!
!if(nqset(m16).gt.strn)goto 716
!
!do i=strset(m16-1)+1,strset(m16)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!if(totstr.gt.strn)goto 716
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!if(Ifail.eq.1)goto 716
!!!do i8=1,nae
!!!str4(totstr,i8)=0
!!!enddo
!!strno(totstr)=0
!!totstr=totstr-1
!!goto 316
!!endif
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!print*,'MatLDR_write_xmi',totstr
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 716
!endif
!
!
!m21=m21+nqset(m16)
!if(m21.gt.strn) goto 716
!!print*,'sourav_xmi_sym'
!
!!316 enddo
!
!!print*,'jj',jj,m16,nqul
!!416 if(jj.eq.nqset(m16))then
!!print*,'******jj',jj
!
!do m19=strset(m16-1)+1,strset(m16)
!if(q_fac2(m19).ne.qul(m16))goto 616
!!write(9,231),m19,(finalvec(i1),i1=1,i5)
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!count=16
!616 enddo
!!print*,'i7 16',i7,m16
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(9+u1,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.ne.0)then
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.eq.0)then
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.eq.3)then
!Rumwrite=1
!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!endif
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!goto 716
!endif
!
!
!i5up17=i5
!i17i7=i7
!m17m21=m21
!
!do m17=m16+1,nqul
!!print*,'m17m17m17',m17
!do i=i5up17+1,i5
!finalvec(i)=0
!enddo
!do m19=i17i7+1,i7
!strno(m19)=0
!do i8=1,15
!str2(m19,i8)=0
!enddo
!enddo
!i7=i17i7
!totstr=i17i7
!!print*,'totstr17',totstr
!m21=m17m21
!
!jj=0
!
!flg=0
!!do m19=strset(m17-1)+1,strset(m17)
!
!if(nqset(m17).gt.strn)goto 717
!
!do i=strset(m17-1)+1,strset(m17)
!totstr=totstr+1
!strno(totstr)=i
!enddo
!
!if(totstr.gt.strn)goto 717
!call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)
!!write(*,*),'ifail_xmi',ifail,totstr,det_inv
!!write(9,*),'ifail',ifail,det_inv
!if(Ifail.eq.1)goto 717
!!strno(totstr)=0
!!totstr=totstr-1
!!goto 317
!!endif
!!endif
!if(totstr.gt.1.and.ovopt.eq.vpt) then
!!print*,'MatLDR_write_xmi',totstr
!call MatLDR('str',strno,totstr,D)
!
!!print*,'DDD',(D(i),i=1,totstr)
!ovlp=1.0
!do i=1,totstr
!ovlp=ovlp*D(i)
!enddo
!!print*,'ovval',1.0-ovlp,ovlp
!if(1.0-ovlp.gt.ovval)goto 717
!endif
!
!
!m21=m21+nqset(m17)
!if(m21.gt.strn) goto 717
!!print*,'sourav_xmi_sym'
!
!!317 enddo
!
!!417 if(jj.eq.nqset(m17))then
!
!do m19=strset(m17-1)+1,strset(m17)
!if(q_fac2(m19).ne.qul(m17))goto 617
!i7=i7+1
!do i3=1,nae
!str2(i7,i3)=str3(m19,i3)
!enddo
!col(i7)=m19
!qq(i7)=q_fac2(m19)
!qq1(i7)=str_quality_1(m19)
!qq2(i7)=str_quality_2(m19)
!bondq4(i7)=bondq(m19)
!flg=1
!617 enddo
!!print*,'i7 16',i7,m17
!if(i7.eq.strn) then
!!if(nfset.gt.0)then
!ttqlty=0
!tqlty=0
!bqlty=0
!sqlty=0
!do m119=1,i7
!ttqlty=ttqlty+qq(m119)
!!tqlty=tqlty+qq1(m119)
!!bqlty=bqlty+bondq4(m119)
!!sqlty=sqlty+qq2(m119)
!enddo
!!endif
!!if(ttqlty.le.ttqlty0.or.nfset.eq.2)then
!if(ttqlty.le.ttqlty0)then
!mns=mns+1
!set_number=set_number+1
!if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
!if(nfset.eq.1.and.set_number.gt.1)then
!if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!write(9+u1,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
!endif
!
!do m19=1,i7
!if(niao.eq.0)then
!write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.ne.0)then
!if(niao.gt.1)then
!write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!endif
!!if(niao.ne.0.and.nnnatom.eq.0)then
!if(niao.eq.1)then
!write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!endif
!enddo
!!if(nfset.eq.0.or.nfset.gt.1) then
!if(nfset.eq.3)then
!Rumwrite=1
!call Rumer_set_id(str2,i7,nl,Rid,set_num)
!endif
!if(ovopt.eq.1) then
!call MatLDR('str',col,i7,D)
!
!ovlp=1.0
!do i=1,i7
!ovlp=ovlp*D(i)
!enddo
!write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
!endif
!!write(9,910)'quality value',ttqlty
!if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
!if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
!!write(9,910)'qualities:',' intra_bond=',tqlty,'nn_bond=',bqlty,'sym_break=',sqlty
!bqlty=0
!write(9+u1,*),'Set_number=',set_number
!write(9+u1,*),'    '
!endif
!!endif
!!if(nfset.eq.1.and.tqlty.le.ttqlty1.and.bqlty.le.ttqlty2.and.sqlty.le.ttqlty3)write(9,*),&
!!'ovval',1.0-ovlp
!if(nfset.eq.0.and.ttqlty.le.ttqlty0)goto 379
!if(mns.eq.max_set)then
!if(u1.eq.mset-1) goto 379
!close(9+u1)
!mns=0
!u1=u1+1
!if(u1.le.9)then
!write(a,'(I1)')u1
!endif
!if(u1.gt.9.and.u1.lt.100)then
!write(a,'(I2)')u1
!endif
!if(u1.gt.99.and.u1.lt.1000)then
!write(a,'(I3)')u1
!endif
!if(u1.eq.1000)then
!write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
!sets. Please increase the limit'
!goto 379
!endif
!outfile='structure_set_'//trim(a)//trim('.dat')
!open(unit=9+u1,file=outfile,status='unknown')
!endif
!!write(9,910)'intra bond quality','sym break quality','nnbond quality'
!!write(9,911),tqlty,sqlty,bqlty
!!bqlty=0
!!!set_number=set_number+1
!!write(9,*),'Set_number=',set_number
!!write(9,*),'    '
!!endif
!!endif
!!if(nfset.eq.1)goto 379
!endif
!
!717 enddo
!!print*,'count',count
!if(indpnt.eq.2)then
!if (count.eq.1)goto 702
!if (count.eq.2)goto 703
!if (count.eq.3)goto 704
!if (count.eq.4)goto 705
!if (count.eq.5)goto 706
!if (count.eq.6)goto 707
!if (count.eq.7)goto 708
!if (count.eq.8)goto 709
!if (count.eq.9)goto 710
!if (count.eq.10)goto 711
!if (count.eq.11)goto 712
!if (count.eq.12)goto 713
!if (count.eq.13)goto 714
!if (count.eq.14)goto 715
!if (count.eq.15)goto 716
!endif
!!if (count.eq.16)goto 717
!
!if(indpnt.eq.1)then
!if (count.eq.1)goto 701
!if (count.eq.2)goto 702
!if (count.eq.3)goto 703
!if (count.eq.4)goto 704
!if (count.eq.5)goto 705
!if (count.eq.6)goto 706
!if (count.eq.7)goto 707
!if (count.eq.8)goto 708
!if (count.eq.9)goto 709
!if (count.eq.10)goto 710
!if (count.eq.11)goto 711
!if (count.eq.12)goto 712
!if (count.eq.13)goto 713
!if (count.eq.14)goto 714
!if (count.eq.15)goto 715
!if (count.eq.16)goto 716
!endif
!
!716 enddo
!
!715 enddo
!
!714 enddo
!
!713 enddo
!
!712 enddo
!
!711 enddo
!
!710 enddo
!
!709 enddo
!
!708 enddo
!
!707 enddo
!
!706 enddo
!
!705 enddo
!
!704 enddo
!
!703 enddo
!
!702 enddo
!
!701 enddo
!!enddo
!
!
!!379 do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq(m19),(str2(m19,m20),m20=1,nae)
!!endif
!!if(niao.ne.0.and.nnnatom.ne.0)then
!!write(9,901),qq(m19),bondq4(m19),1,':',niao,(str2(m19,m20),m20=1,nae)
!!!write(9,901),m19,1,':',niao,(str2(m19,m20),m20=1,nae)
!!!write(*,900),m19,niao,(str2(m19,m20),m20=1,nae)
!!!write(9,*)qq(m19)
!!endif
!!if(niao.ne.0.and.nnnatom.eq.0)then
!!write(9,909),qq(m19),1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!
!
!!do m19=1,i7
!!if(niao.eq.0)then
!!write(9,900),qq1(m19),qq2(m19),bondq4(m19),'|',(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.ne.0)then
!!if(niao.gt.1)then
!!write(9,901),qq1(m19),qq2(m19),bondq4(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
!!endif
!!!if(niao.ne.0.and.nnnatom.eq.0)then
!!if(niao.eq.1)then
!!write(9,909),qq1(m19),qq2(m19),bondq4(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
!!endif
!!tqlty=tqlty+qq1(m19)
!!bqlty=bqlty+bondq4(m19)
!!sqlty=sqlty+qq2(m19)
!!enddo
!
!!900 format(25I4)
!!901 format(I3,x,I3,x,I1,a,I1,x,25I4)
!!909 format(I3,x,I1,a,I1,x,25I4)
!
!900 format(I3,x,I3,x,I3,x,I3,x,a,x,25I4)
!901 format(I3,x,I3,x,I3,x,I3,x,a,x,I1,a,I3,x,25I4)
!909 format(I3,x,I3,x,I3,x,I3,x,a,x,I3,I3,x,25I4)
!!910 format(a,x,a,x,a,x,a)
!!911 format(15x,I3,7x,I3,7x,I3)
!910 format(a,I3)
!920 format(a,2x,I5,2x,a,2x,100I5)
!911 format(15x,I3,7x,I3,7x,I3)
!912 format(a,3x,F10.3)
!
!close(21)
!
!open(unit=121,file='script10',status='unknown')
!write(121,111)'rm -rf','Rumer_Sets.dat'
!close(121)
!CALL SYSTEM ("chmod +x script10 ")
!CALL SYSTEM ("./script10 ")
!CALL SYSTEM ("rm script10 ")
!111 format(a,x,a)
!
!231 format(50I3)
!!deallocate(str2)
!!deallocate(qq)
!!deallocate(qq1)
!!deallocate(qq2)
!
!379 return
!end subroutine write_symm_xmi
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine write_symm_xmi_new(nl,strn,str3,ncqs,q_fac2)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

common/quality/str_quality_1,str_quality_2,bondq,tqlty,bqlty,sqlty,tnqs,nssym,qulsym,symq,&
sigsym,tnqs_sig
common/infosymm/set_number,hqlty,ttqlty0,ttqlty1,ttqlty2,ttqlty3,ncqss,qul,Rid&
,mns,u1,max_set,rumset,nqset,strset,strnn,totstr,strno,incmplt,mincmplt,mincmplt_set,group_num
common/str/str5,nstr7

integer::nl,strn,strnn,ncqs,ncqss,tostr,initstr,i,i1,i2,i3,i4,i5,i6,i7,i8,i9,m18,m19,m20,m21,m23,m24,count&
,qul(15000),nqul,j,jj,jjj,fg,flg,ii5,m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,x,y,strs
integer::i5up16,i16i7,m16m21,i5up15,i15i7,m15m21,i5up14,i14i7,m14m21,i5up13,i13i7,m13m21,i5up12,i12i7,m12m21,&
i5up11,i11i7,m11m21,i5up10,i10i7,m10m21,i5up9,i9i7,m9m21,i5up8,i8i7,m8m21,i5up7,i7i7,m7m21,i5up6,i6i7,m6m21,&
i5up5,i5i7,m5m21,i5up4,i4i7,m4m21,i5up3,i3i7,m3m21,i5up2,i2i7,m2m21,i5up1,i1i7,m1m21,i5up17,i17i7,m17m21,n21
integer::str3(15000,20),q_fac2(15000),finalvec(15000),strset(15000),col(15000),sigsym(15000),tnqs_sig,&
ffvec2(15000,1000),bondq(150000),bondq4(15000),nqset(15000),str5(2000,20),nstr7,qfac3(15000),group_num(15000)&
,tndet,totstr,Ifail,indpnt,strno(15000),str_quality_1(15000),str_quality_2(15000),ttqlty0,ttqlty&
,tqlty,bqlty,sqlty,hqlty,tnqs,nssym,qulsym(15000),symq(15000),set_number,ttqlty1,det_inv,ttqlty2,ttqlty3
integer::rumer(15000),rumer_rad(15000),quality_fac(15000),rumset,u1,max_set,mns,mincmplt,mincmplt_set(15000)
!integer,dimension(:),allocatable::qq1,qq2,qq
integer::qq1(15000),qq2(15000),qq(15000),str2(15000,20),Rid,set_num(1000),sf1,sf2,incmplt
real*8::ovlp
Double Precision::D(15000)
character(10)::dd,a
character(len=100)::outfile

integer::i18i7,m18m21,i19i7,m19m21,i20i7,m20m21
integer::i21i7,m21m21,m22,i22i7,m22m21,i23i7,m23m21,i24i7,m24m21,m25,i25i7,m25m21 &
,m26,i26i7,m26m21,m27,i27i7,m27m21,m28,i28i7,m28m21,m29,i29i7,m29m21,m30,i30i7,m30m21
integer::m31,i31i7,m31m21,m32,i32i7,m32m21,m33,i33i7,m33m21,m34,i34i7,m34m21,m35,i35i7,m35m21
integer::m41,i41i7,m41m21,m42,i42i7,m42m21,m43,i43i7,m43m21,m44,i44i7,m44m21,m45,i45i7,m45m21,m46,i46i7,m46m21,m47 &
,i47i7,m47m21,m48,i48i7,m48m21,m49,i49i7,m49m21,m50,i50i7,m50m21
integer::m51,i51i7,m51m21,m52,i52i7,m52m21,m53,i53i7,m53m21,m54,i54i7,m54m21,m55,i55i7,m55m21,m56,i56i7,m56m21,m57, &
i57i7,m57m21,m58,i58i7,m58m21,m59,i59i7,m59m21,m60,i60i7,m60m21
integer::m61,i61i7,m61m21,m62,i62i7,m62m21,m63,i63i7,m63m21,m64,i64i7,m64m21,m65,i65i7,m65m21,m66,i66i7,m66m21,m67, &
i67i7,m67m21,m68,i68i7,m68m21,m69,i69i7,m69m21,m70,i70i7,m70m21
integer::m71,i71i7,m71m21,m72,i72i7,m72m21,m73,i73i7,m73m21,m74,i74i7,m74m21,m75,i75i7,m75m21,m76,i76i7,m76m21,m77, &
i77i7,m77m21,m78,i78i7,m78m21,m79,i79i7,m79m21,m80,i80i7,m80m21
integer::m81,i81i7,m81m21,m82,i82i7,m82m21,m83,i83i7,m83m21,m84,i84i7,m84m21,m85,i85i7,m85m21,m86,i86i7,m86m21,m87, &
i87i7,m87m21,m88,i88i7,m88m21,m89,i89i7,m89m21,m90,i90i7,m90m21
integer::m91,i91i7,m91m21,m92,i92i7,m92m21,m93,i93i7,m93m21,m94,i94i7,m94m21,m95,i95i7,m95m21,m96,i96i7,m96m21,m97 &
,i97i7,m97m21,m98,i98i7,m98m21,m99,i99i7,m99m21,m100,i100i7,m100m21
integer::m101,i101i7,m101m21,m102,i102i7,m102m21,m103,i103i7,m103m21,m104,i104i7,m104m21,m105,i105i7,m105m21,m106 &
,i106i7,m106m21,m107,i107i7,m107m21,m108,i108i7,m108m21,m109,i109i7,m109m21,m110,i110i7,m110m21
integer::m111,i111i7,m111m21,m112,i112i7,m112m21,m113,i113i7,m113m21,m114,i114i7,m114m21,m115,i115i7,m115m21,m116,i116i7 &
,m116m21,m117,i117i7,m117m21,m118,i118i7,m118m21,m119,i119i7,m119m21,m120,i120i7,m120m21
integer::m121,i121i7,m121m21,m122,i122i7,m122m21,m123,i123i7,m123m21,m124,i124i7,m124m21,m125,i125i7,m125m21,m126,i126i7 &
,m126m21,m127,i127i7,m127m21,m128,i128i7,m128m21,m129,i129i7,m129m21,m130,i130i7,m130m21
integer::m131,i131i7,m131m21,m132,i132i7,m132m21,m133,i133i7,m133m21,m134,i134i7,m134m21,m135,i135i7,m135m21,m136,i136i7 &
,m136m21,m137,i137i7,m137m21,m138,i138i7,m138m21,m139,i139i7,m139m21,m140,i140i7,m140m21
integer::m141,i141i7,m141m21,m142,i142i7,m142m21,m143,i143i7,m143m21,m144,i144i7,m144m21,m145,i145i7,m145m21,m146,i146i7 &
,m146m21,m147,i147i7,m147m21,m148,i148i7,m148m21,m149,i149i7,m149m21,m150,i150i7,m150m21
integer::m151,i151i7,m151m21,m152,i152i7,m152m21,m153,i153i7,m153m21,m154,i154i7,m154m21,m155,i155i7,m155m21,m156,i156i7 &
,m156m21,m157,i157i7,m157m21,m158,i158i7,m158m21,m159,i159i7,m159m21,m160,i160i7,m160m21
integer::m161,i161i7,m161m21,m162,i162i7,m162m21,m163,i163i7,m163m21,m164,i164i7,m164m21,m165,i165i7,m165m21,m166,i166i7 &
,m166m21,m167,i167i7,m167m21,m168,i168i7,m168m21,m169,i169i7,m169m21,m170,i170i7,m170m21
integer::m171,i171i7,m171m21,m172,i172i7,m172m21,m173,i173i7,m173m21,m174,i174i7,m174m21,m175,i175i7,m175m21,m176,i176i7 &
,m176m21,m177,i177i7,m177m21,m178,i178i7,m178m21,m179,i179i7,m179m21,m180,i180i7,m180m21
integer::m181,i181i7,m181m21,m182,i182i7,m182m21,m183,i183i7,m183m21,m184,i184i7,m184m21,m185,i185i7,m185m21,m186,i186i7 &
,m186m21,m187,i187i7,m187m21,m188,i188i7,m188m21,m189,i189i7,m189m21,m190,i190i7,m190m21
integer::m191,i191i7,m191m21,m192,i192i7,m192m21,m193,i193i7,m193m21,m194,i194i7,m194m21,m195,i195i7,m195m21,m196,i196i7 &
,m196m21,m197,i197i7,m197m21,m198,i198i7,m198m21,m199,i199i7,m199m21,m200,i200i7,m200m21
integer::m201,i201i7,m201m21,m202,i202i7,m202m21,m203,i203i7,m203m21,m204,i204i7,m204m21,m205,i205i7,m205m21,m206,i206i7 &
,m206m21,m207,i207i7,m207m21,m208,i208i7,m208m21,m209,i209i7,m209m21,m210,i210i7,m210m21
integer::m211,i211i7,m211m21,m212,i212i7,m212m21,m213,i213i7,m213m21,m214,i214i7,m214m21,m215,i215i7,m215m21,m216,i216i7 &
,m216m21,m217,i217i7,m217m21,m218,i218i7,m218m21,m219,i219i7,m219m21,m220,i220i7,m220m21
integer::m221,i221i7,m221m21,m222,i222i7,m222m21,m223,i223i7,m223m21,m224,i224i7,m224m21m225,i225i7,m225m21,m226,i226i7 &
,m226m21,m227,i227i7,m227m21,m228,i228i7,m228m21,m229,i229i7,m229m21,m230,i230i7,m230m21
integer::m231,i231i7,m231m21,m232,i232i7,m232m21,m233,i233i7,m233m21,m234,i234i7,m234m21,m235,i235i7,m235m21,m236,i236i7 &
,m236m21,m237,i237i7,m237m21,m238,i238i7,m238m21,m239,i239i7,m239m21,m240,i240i7,m240m21
integer::m241,i241i7,m241m21,m242,i242i7,m242m21,m243,i243i7,m243m21,m244,i244i7,m244m21,m245,i245i7,m245m21,m246,i246i7 &
,m246m21,m247,i247i7,m247m21,m248,i248i7,m248m21,m249,i249i7,m249m21,m250,i250i7,m250m21
integer::m251,i251i7,m251m21,m252,i252i7,m252m21,m253,i253i7,m253m21,m254,i254i7,m254m21,m255,i255i7,m255m21,m256,i256i7 &
,m256m21,m257,i257i7,m257m21,m258,i258i7,m258m21,m259,i259i7,m259m21,m260,i260i7,m260m21
integer::m261,i261i7,m261m21,m262,i262i7,m262m21,m263,i263i7,m263m21,m264,i264i7,m264m21,m265,i265i7,m265m21,m266,i266i7 &
,m266m21,m267,i267i7,m267m21,m268,i268i7,m268m21,m269,i269i7,m269m21,m270,i270i7,m270m21
integer::m271,i271i7,m271m21,m272,i272i7,m272m21,m273,i273i7,m273m21,m274,i274i7,m274m21,m275,i275i7,m275m21,m276,i276i7 &
,m276m21,m277,i277i7,m277m21,m278,i278i7,m278m21,m279,i279i7,m279m21,m280,i280i7,m280m21
integer::m281,i281i7,m281m21,m282,i282i7,m282m21,m283,i283i7,m283m21,m284,i284i7,m284m21,m285,i285i7,m285m21,m286,i286i7 &
,m286m21,m287,i287i7,m287m21,m288,i288i7,m288m21,m289,i289i7,m289m21,m290,i290i7,m290m21
integer::m291,i291i7,m291m21,m292,i292i7,m292m21,m293,i293i7,m293m21,m294,i294i7,m294m21,m295,i295i7,m295m21,m296,i296i7 &
,m296m21,m297,i297i7,m297m21,m298,i298i7,m298m21,m299,i299i7,m299m21,m300,i300i7,m300m21
integer::m301,i301i7,m301m21,m302,i302i7,m302m21,m303,i303i7,m303m21,m304,i304i7,m304m21,m305,i305i7,m305m21,m306,i306i7 &
,m306m21,m307,i307i7,m307m21,m308,i308i7,m308m21,m309,i309i7,m309m21,m310,i310i7,m310m21
integer::m311,i311i7,m311m21,m312,i312i7,m312m21,m313,i313i7,m313m21,m314,i314i7,m314m21,m315,i315i7,m315m21,m316,i316i7 &
,m316m21,m317,i317i7,m317m21,m318,i318i7,m318m21,m319,i319i7,m319m21,m320,i320i7,m320m21
integer::m321,i321i7,m321m21,m322,i322i7,m322m21,m323,i323i7,m323m21,m324,i324i7,m324m21,m325,i325i7,m325m21,m326,i326i7 &
,m326m21,m327,i327i7,m327m21,m328,i328i7,m328m21,m329,i329i7,m329m21,m330,i330i7,m330m21
integer::m331,i331i7,m331m21,m332,i332i7,m332m21,m333,i333i7,m333m21,m334,i334i7,m334m21,m335,i335i7,m335m21,m336,i336i7 &
,m336m21,m337,i337i7,m337m21,m338,i338i7,m338m21,m339,i339i7,m339m21,m340,i340i7,m340m21
integer::m341,i341i7,m341m21,m342,i342i7,m342m21,m343,i343i7,m343m21,m344,i344i7,m344m21,m345,i345i7,m345m21,m346,i346i7 &
,m346m21,m347,i347i7,m347m21,m348,i348i7,m348m21,m349,i349i7,m349m21,m350,i350i7,m350m21
integer::m351,i351i7,m351m21,m352,i352i7,m352m21,m353,i353i7,m353m21,m354,i354i7,m354m21,m355,i355i7,m355m21,m356,i356i7 &
,m356m21,m357,i357i7,m357m21,m358,i358i7,m358m21,m359,i359i7,m359m21,m360,i360i7,m360m21
integer::m361,i361i7,m361m21,m362,i362i7,m362m21,m363,i363i7,m363m21,m364,i364i7,m364m21,m365,i365i7,m365m21,m366,i366i7 &
,m366m21,m367,i367i7,m367m21,m368,i368i7,m368m21,m369,i369i7,m369m21,m370,i370i7,m370m21
integer::m371,i371i7,m371m21,m372,i372i7,m372m21,m373,i373i7,m373m21,m374,i374i7,m374m21,m375,i375i7,m375m21,m376,i376i7 &
,m376m21,m377,i377i7,m377m21,m378,i378i7,m378m21,m379,i379i7,m379m21,m380,i380i7,m380m21
integer::m381,i381i7,m381m21,m382,i382i7,m382m21,m383,i383i7,m383m21,m384,i384i7,m384m21,m385,i385i7,m385m21,m386,i386i7 &
,m386m21,m387,i387i7,m387m21,m388,i388i7,m388m21,m389,i389i7,m389m21,m390,i390i7,m390m21
integer::m391,i391i7,m391m21,m392,i392i7,m392m21,m393,i393i7,m393m21,m394,i394i7,m394m21,m395,i395i7,m395m21,m396,i396i7 &
,m396m21,m397,i397i7,m397m21,m398,i398i7,m398m21,m399,i399i7,m399m21,m400,i400i7,m400m21
integer::m401,i401i7,m401m21,m402,i402i7,m402m21,m403,i403i7,m403m21,m404,i404i7,m404m21,m405,i405i7,m405m21,m406,i406i7 &
,m406m21,m407,i407i7,m407m21,m408,i408i7,m408m21,m409,i409i7,m409m21,m410,i410i7,m410m21
integer::m411,i411i7,m411m21,m412,i412i7,m412m21,m413,i413i7,m413m21,m414,i414i7,m414m21,m415,i415i7,m415m21,m416,i416i7 &
,m416m21,m417,i417i7,m417m21,m418,i418i7,m418m21,m419,i419i7,m419m21,m420,i420i7,m420m21
integer::m421,i421i7,m421m21,m422,i422i7,m422m21,m423,i423i7,m423m21,m424,i424i7,m424m21,m425,i425i7,m425m21,m426,i426i7 &
,m426m21,m427,i427i7,m427m21,m428,i428i7,m428m21,m429,i429i7,m429m21,m430,i430i7,m430m21
integer::m431,i431i7,m431m21,m432,i432i7,m432m21,m433,i433i7,m433m21,m434,i434i7,m434m21,m435,i435i7,m435m21,m436,i436i7 &
,m436m21,m437,i437i7,m437m21,m438,i438i7,m438m21,m439,i439i7,m439m21,m440,i440i7,m440m21
integer::m441,i441i7,m441m21,m442,i442i7,m442m21,m443,i443i7,m443m21,m444,i444i7,m444m21,m445,i445i7,m445m21,m446,i446i7 &
,m446m21,m447,i447i7,m447m21,m448,i448i7,m448m21,m449,i449i7,m449m21,m450,i450i7,m450m21
integer::m451,i451i7,m451m21,m452,i452i7,m452m21,m453,i453i7,m453m21,m454,i454i7,m454m21,m455,i455i7,m455m21,m456,i456i7 &
,m456m21,m457,i457i7,m457m21,m458,i458i7,m458m21,m459,i459i7,m459m21,m460,i460i7,m460m21
integer::m461,i461i7,m461m21,m462,i462i7,m462m21,m463,i463i7,m463m21,m464,i464i7,m464m21,m465,i465i7,m465m21,m466,i466i7 &
,m466m21,m467,i467i7,m467m21,m468,i468i7,m468m21,m469,i469i7,m469m21,m470,i470i7,m470m21
integer::m471,i471i7,m471m21,m472,i472i7,m472m21,m473,i473i7,m473m21,m474,i474i7,m474m21,m475,i475i7,m475m21,m476,i476i7 &
,m476m21,m477,i477i7,m477m21,m478,i478i7,m478m21,m479,i479i7,m479m21,m480,i480i7,m480m21
integer::m481,i481i7,m481m21,m482,i482i7,m482m21,m483,i483i7,m483m21,m484,i484i7,m484m21,m485,i485i7,m485m21,m486,i486i7 &
,m486m21,m487,i487i7,m487m21,m488,i488i7,m488m21,m489,i489i7,m489m21,m490,i490i7,m490m21
integer::m491,i491i7,m491m21,m492,i492i7,m492m21,m493,i493i7,m493m21,m494,i494i7,m494m21,m495,i495i7,m495m21,m496,i496i7 &
,m496m21,m497,i497i7,m497m21,m498,i498i7,m498m21,m499,i499i7,m499m21,m500,i500i7,m500m21
integer::m501,i501i7,m501m21,m502,i502i7,m502m21,m503,i503i7,m503m21,m504,i504i7,m504m21,m505,i505i7,m505m21,m506,i506i7 &
,m506m21,m507,i507i7,m507m21,m508,i508i7,m508m21,m509,i509i7,m509m21,m510,i510i7,m510m21
integer::m511,i511i7,m511m21,m512,i512i7,m512m21,m513,i513i7,m513m21,m514,i514i7,m514m21,m515,i515i7,m515m21,m516,i516i7 &
,m516m21,m517,i517i7,m517m21,m518,i518i7,m518m21,m519,i519i7,m519m21,m520,i520i7,m520m21
integer::m521,i521i7,m521m21,m522,i522i7,m522m21,m523,i523i7,m523m21,m524,i524i7,m524m21,m525,i525i7,m525m21,m526,i526i7 &
,m526m21,m527,i527i7,m527m21,m528,i528i7,m528m21,m529,i529i7,m529m21,m530,i530i7,m530m21
integer::m531,i531i7,m531m21,m532,i532i7,m532m21,m533,i533i7,m533m21,m534,i534i7,m534m21,m535,i535i7,m535m21,m536,i536i7 &
,m536m21,m537,i537i7,m537m21,m538,i538i7,m538m21,m539,i539i7,m539m21,m540,i540i7,m540m21
integer::m541,i541i7,m541m21,m542,i542i7,m542m21,m543,i543i7,m543m21,m544,i544i7,m544m21,m545,i545i7,m545m21,m546,i546i7 &
,m546m21,m547,i547i7,m547m21,m548,i548i7,m548m21,m549,i549i7,m549m21,m550,i550i7,m550m21
integer::m551,i551i7,m551m21,m552,i552i7,m552m21,m553,i553i7,m553m21,m554,i554i7,m554m21,m555,i555i7,m555m21,m556,i556i7 &
,m556m21,m557,i557i7,m557m21,m558,i558i7,m558m21,m559,i559i7,m559m21,m560,i560i7,m560m21
integer::m561,i561i7,m561m21,m562,i562i7,m562m21,m563,i563i7,m563m21,m564,i564i7,m564m21,m565,i565i7,m565m21,m566,i566i7 &
,m566m21,m567,i567i7,m567m21,m568,i568i7,m568m21,m569,i569i7,m569m21,m570,i570i7,m570m21
integer::m571,i571i7,m571m21,m572,i572i7,m572m21,m573,i573i7,m573m21,m574,i574i7,m574m21,m575,i575i7,m575m21,m576,i576i7 &
,m576m21,m577,i577i7,m577m21,m578,i578i7,m578m21,m579,i579i7,m579m21,m580,i580i7,m580m21
integer::m581,i581i7,m581m21,m582,i582i7,m582m21,m583,i583i7,m583m21,m584,i584i7,m584m21,m585,i585i7,m585m21,m586,i586i7 &
,m586m21,m587,i587i7,m587m21,m588,i588i7,m588m21,m589,i589i7,m589m21,m590,i590i7,m590m21
integer::m591,i591i7,m591m21,m592,i592i7,m592m21,m593,i593i7,m593m21,m594,i594i7,m594m21,m595,i595i7,m595m21,m596,i596i7 &
,m596m21,m597,i597i7,m597m21,m598,i598i7,m598m21,m599,i599i7,m599m21,m600,i600i7,m600m21
integer::m601,i601i7,m601m21,m602,i602i7,m602m21,m603,i603i7,m603m21,m604,i604i7,m604m21,m605,i605i7,m605m21,m606,i606i7 &
,m606m21,m607,i607i7,m607m21,m608,i608i7,m608m21,m609,i609i7,m609m21,m610,i610i7,m610m21
integer::m611,i611i7,m611m21,m612,i612i7,m612m21,m613,i613i7,m613m21,m614,i614i7,m614m21,m615,i615i7,m615m21,m616,i616i7 &
,m616m21,m617,i617i7,m617m21,m618,i618i7,m618m21,m619,i619i7,m619m21,m620,i620i7,m620m21
integer::m621,i621i7,m621m21,m622,i622i7,m622m21,m623,i623i7,m623m21,m624,i624i7,m624m21,m625,i625i7,m625m21,m626,i626i7 &
,m626m21,m627,i627i7,m627m21,m628,i628i7,m628m21,m629,i629i7,m629m21,m630,i630i7,m630m21
integer::m631,i631i7,m631m21,m632,i632i7,m632m21,m633,i633i7,m633m21,m634,i634i7,m634m21,m635,i635i7,m635m21,m636,i636i7 &
,m636m21,m637,i637i7,m637m21,m638,i638i7,m638m21,m639,i639i7,m639m21,m640,i640i7,m640m21
integer::m641,i641i7,m641m21,m642,i642i7,m642m21,m643,i643i7,m643m21,m644,i644i7,m644m21,m645,i645i7,m645m21,m646,i646i7 &
,m646m21,m647,i647i7,m647m21,m648,i648i7,m648m21,m649,i649i7,m649m21,m650,i650i7,m650m21
integer::m651,i651i7,m651m21,m652,i652i7,m652m21,m653,i653i7,m653m21,m654,i654i7,m654m21,m655,i655i7,m655m21,m656,i656i7 &
,m656m21,m657,i657i7,m657m21,m658,i658i7,m658m21,m659,i659i7,m659m21,m660,i660i7,m660m21
integer::m661,i661i7,m661m21,m662,i662i7,m662m21,m663,i663i7,m663m21,m664,i664i7,m664m21,m665,i665i7,m665m21,m666,i666i7 &
,m666m21,m667,i667i7,m667m21,m668,i668i7,m668m21,m669,i669i7,m669m21,m670,i670i7,m670m21
integer::m671,i671i7,m671m21,m672,i672i7,m672m21,m673,i673i7,m673m21,m674,i674i7,m674m21,m675,i675i7,m675m21,m676,i676i7 &
,m676m21,m677,i677i7,m677m21,m678,i678i7,m678m21,m679,i679i7,m679m21,m680,i680i7,m680m21
integer::m681,i681i7,m681m21,m682,i682i7,m682m21,m683,i683i7,m683m21,m684,i684i7,m684m21,m685,i685i7,m685m21,m686,i686i7 &
,m686m21,m687,i687i7,m687m21,m688,i688i7,m688m21,m689,i689i7,m689m21,m690,i690i7,m690m21
integer::m691,i691i7,m691m21,m692,i692i7,m692m21,m693,i693i7,m693m21,m694,i694i7,m694m21,m695,i695i7,m695m21,m696,i696i7 &
,m696m21,m697,i697i7,m697m21,m698,i698i7,m698m21,m699,i699i7,m699m21,m700,i700i7,m700m21
integer::m701,i701i7,m701m21,m702,i702i7,m702m21,m703,i703i7,m703m21,m704,i704i7,m704m21,m705,i705i7,m705m21,m706,i706i7 &
,m706m21,m707,i707i7,m707m21,m708,i708i7,m708m21,m709,i709i7,m709m21,m710,i710i7,m710m21
integer::m711,i711i7,m711m21,m712,i712i7,m712m21,m713,i713i7,m713m21,m714,i714i7,m714m21,m715,i715i7,m715m21,m716,i716i7 &
,m716m21,m717,i717i7,m717m21,m718,i718i7,m718m21,m719,i719i7,m719m21,m720,i720i7,m720m21
integer::m721,i721i7,m721m21,m722,i722i7,m722m21,m723,i723i7,m723m21,m724,i724i7,m724m21,m725,i725i7,m725m21,m726,i726i7 &
,m726m21,m727,i727i7,m727m21,m728,i728i7,m728m21,m729,i729i7,m729m21,m730,i730i7,m730m21
integer::m731,i731i7,m731m21,m732,i732i7,m732m21,m733,i733i7,m733m21,m734,i734i7,m734m21,m735,i735i7,m735m21,m736,i736i7 &
,m736m21,m737,i737i7,m737m21,m738,i738i7,m738m21,m739,i739i7,m739m21,m740,i740i7,m740m21
integer::m741,i741i7,m741m21,m742,i742i7,m742m21,m743,i743i7,m743m21,m744,i744i7,m744m21,m745,i745i7,m745m21,m746,i746i7 &
,m746m21,m747,i747i7,m747m21,m748,i748i7,m748m21,m749,i749i7,m749m21,m750,i750i7,m750m21
integer::m751,i751i7,m751m21,m752,i752i7,m752m21,m753,i753i7,m753m21,m754,i754i7,m754m21,m755,i755i7,m755m21,m756,i756i7 &
,m756m21,m757,i757i7,m757m21,m758,i758i7,m758m21,m759,i759i7,m759m21,m760,i760i7,m760m21
integer::m761,i761i7,m761m21,m762,i762i7,m762m21,m763,i763i7,m763m21,m764,i764i7,m764m21,m765,i765i7,m765m21,m766,i766i7 &
,m766m21,m767,i767i7,m767m21,m768,i768i7,m768m21,m769,i769i7,m769m21,m770,i770i7,m770m21
integer::m771,i771i7,m771m21,m772,i772i7,m772m21,m773,i773i7,m773m21,m774,i774i7,m774m21,m775,i775i7,m775m21,m776,i776i7 &
,m776m21,m777,i777i7,m777m21,m778,i778i7,m778m21,m779,i779i7,m779m21,m780,i780i7,m780m21
integer::m781,i781i7,m781m21,m782,i782i7,m782m21,m783,i783i7,m783m21,m784,i784i7,m784m21,m785,i785i7,m785m21,m786,i786i7 &
,m786m21,m787,i787i7,m787m21,m788,i788i7,m788m21,m789,i789i7,m789m21,m790,i790i7,m790m21
integer::m791,i791i7,m791m21,m792,i792i7,m792m21,m793,i793i7,m793m21,m794,i794i7,m794m21,m795,i795i7,m795m21,m796,i796i7 &
,m796m21,m797,i797i7,m797m21,m798,i798i7,m798m21,m799,i799i7,m799m21,m800,i800i7,m800m21
integer::m801,i801i7,m801m21,m802,i802i7,m802m21,m803,i803i7,m803m21,m804,i804i7,m804m21,m805,i805i7,m805m21,m806,i806i7 &
,m806m21,m807,i807i7,m807m21,m808,i808i7,m808m21,m809,i809i7,m809m21,m810,i810i7,m810m21
integer::m811,i811i7,m811m21,m812,i812i7,m812m21,m813,i813i7,m813m21,m814,i814i7,m814m21,m815,i815i7,m815m21,m816,i816i7 &
,m816m21,m817,i817i7,m817m21,m818,i818i7,m818m21,m819,i819i7,m819m21,m820,i820i7,m820m21
integer::m821,i821i7,m821m21,m822,i822i7,m822m21,m823,i823i7,m823m21,m824,i824i7,m824m21,m825,i825i7,m825m21,m826,i826i7 &
,m826m21,m827,i827i7,m827m21,m828,i828i7,m828m21,m829,i829i7,m829m21,m830,i830i7,m830m21
integer::m831,i831i7,m831m21,m832,i832i7,m832m21,m833,i833i7,m833m21,m834,i834i7,m834m21,m835,i835i7,m835m21,m836,i836i7 &
,m836m21,m837,i837i7,m837m21,m838,i838i7,m838m21,m839,i839i7,m839m21,m840,i840i7,m840m21
integer::m841,i841i7,m841m21,m842,i842i7,m842m21,m843,i843i7,m843m21,m844,i844i7,m844m21,m845,i845i7,m845m21,m846,i846i7 &
,m846m21,m847,i847i7,m847m21,m848,i848i7,m848m21,m849,i849i7,m849m21,m850,i850i7,m850m21
integer::m851,i851i7,m851m21,m852,i852i7,m852m21,m853,i853i7,m853m21,m854,i854i7,m854m21,m855,i855i7,m855m21,m856,i856i7 &
,m856m21,m857,i857i7,m857m21,m858,i858i7,m858m21,m859,i859i7,m859m21,m860,i860i7,m860m21
integer::m861,i861i7,m861m21,m862,i862i7,m862m21,m863,i863i7,m863m21,m864,i864i7,m864m21,m865,i865i7,m865m21,m866,i866i7 &
,m866m21,m867,i867i7,m867m21,m868,i868i7,m868m21,m869,i869i7,m869m21,m870,i870i7,m870m21
integer::m871,i871i7,m871m21,m872,i872i7,m872m21,m873,i873i7,m873m21,m874,i874i7,m874m21,m875,i875i7,m875m21,m876,i876i7 &
,m876m21,m877,i877i7,m877m21,m878,i878i7,m878m21,m879,i879i7,m879m21,m880,i880i7,m880m21
integer::m881,i881i7,m881m21,m882,i882i7,m882m21,m883,i883i7,m883m21,m884,i884i7,m884m21,m885,i885i7,m885m21,m886,i886i7 &
,m886m21,m887,i887i7,m887m21,m888,i888i7,m888m21,m889,i889i7,m889m21,m890,i890i7,m890m21
integer::m891,i891i7,m891m21,m892,i892i7,m892m21,m893,i893i7,m893m21,m894,i894i7,m894m21,m895,i895i7,m895m21,m896,i896i7 &
,m896m21,m897,i897i7,m897m21,m898,i898i7,m898m21,m899,i899i7,m899m21,m900,i900i7,m900m21
integer::m901,i901i7,m901m21,m902,i902i7,m902m21,m903,i903i7,m903m21,m904,i904i7,m904m21,m905,i905i7,m905m21,m906,i906i7 &
,m906m21,m907,i907i7,m907m21,m908,i908i7,m908m21,m909,i909i7,m909m21,m910,i910i7,m910m21
integer::m911,i911i7,m911m21,m912,i912i7,m912m21,m913,i913i7,m913m21,m914,i914i7,m914m21,m915,i915i7,m915m21,m916,i916i7 &
,m916m21,m917,i917i7,m917m21,m918,i918i7,m918m21,m919,i919i7,m919m21,m920,i920i7,m920m21
integer::m921,i921i7,m921m21,m922,i922i7,m922m21,m923,i923i7,m923m21,m924,i924i7,m924m21,m925,i925i7,m925m21,m926,i926i7 &
,m926m21,m927,i927i7,m927m21,m928,i928i7,m928m21,m929,i929i7,m929m21,m930,i930i7,m930m21
integer::m931,i931i7,m931m21,m932,i932i7,m932m21,m933,i933i7,m933m21,m934,i934i7,m934m21,m935,i935i7,m935m21,m936,i936i7 &
,m936m21,m937,i937i7,m937m21,m938,i938i7,m938m21,m939,i939i7,m939m21,m940,i940i7,m940m21
integer::m941,i941i7,m941m21,m942,i942i7,m942m21,m943,i943i7,m943m21,m944,i944i7,m944m21,m945,i945i7,m945m21,m946,i946i7 &
,m946m21,m947,i947i7,m947m21,m948,i948i7,m948m21,m949,i949i7,m949m21,m950,i950i7,m950m21
integer::m951,i951i7,m951m21,m952,i952i7,m952m21,m953,i953i7,m953m21,m954,i954i7,m954m21,m955,i955i7,m955m21,m956,i956i7 &
,m956m21,m957,i957i7,m957m21,m958,i958i7,m958m21,m959,i959i7,m959m21,m960,i960i7,m960m21
integer::m961,i961i7,m961m21,m962,i962i7,m962m21,m963,i963i7,m963m21,m964,i964i7,m964m21,m965,i965i7,m965m21,m966,i966i7 &
,m966m21,m967,i967i7,m967m21,m968,i968i7,m968m21,m969,i969i7,m969m21,m970,i970i7,m970m21
integer::m971,i971i7,m971m21,m972,i972i7,m972m21,m973,i973i7,m973m21,m974,i974i7,m974m21,m975,i975i7,m975m21,m976,i976i7 &
,m976m21,m977,i977i7,m977m21,m978,i978i7,m978m21,m979,i979i7,m979m21,m980,i980i7,m980m21
integer::m981,i981i7,m981m21,m982,i982i7,m982m21,m983,i983i7,m983m21,m984,i984i7,m984m21,m985,i985i7,m985m21,m986,i986i7 &
,m986m21,m987,i987i7,m987m21,m988,i988i7,m988m21,m989,i989i7,m989m21,m990,i990i7,m990m21
integer::m991,i991i7,m991m21,m992,i992i7,m992m21,m993,i993i7,m993m21,m994,i994i7,m994m21,m995,i995i7,m995m21,m996,i996i7 &
,m996m21,m997,i997i7,m997m21,m998,i998i7,m998m21,m999,i999i7,m999m21,m1000,i1000i7,m1000m21
integer::m1001,i1001i7,m1001m21,m1002,i1002i7,m1002m21,m1003,i1003i7,m1003m21,m1004,i1004i7,m1004m21,m1005,i1005i7,m1005m21 &
,m1006,i1006i7,m1006m21,m1007,i1007i7,m1007m21,m1008,i1008i7,m1008m21,m1009,i1009i7,m1009m21,m1010,i1010i7,m1010m21
integer::m1011,i1011i7,m1011m21,m1012,i1012i7,m1012m21,m1013,i1013i7,m1013m21,m1014,i1014i7,m1014m21,m1015,i1015i7,m1015m21 &
,m1016,i1016i7,m1016m21,m1017,i1017i7,m1017m21,m1018,i1018i7,m1018m21,m1019,i1019i7,m1019m21,m1020,i1020i7,m1020m21
integer::m1021,i1021i7,m1021m21,m1022,i1022i7,m1022m21,m1023,i1023i7,m1023m21,m1024,i1024i7,m1024m21,m1025,i1025i7,m1025m21 &
,m1026,i1026i7,m1026m21,m1027,i1027i7,m1027m21,m1028,i1028i7,m1028m21,m1029,i1029i7,m1029m21,m1030,i1030i7,m1030m21
integer::m1031,i1031i7,m1031m21,m1032,i1032i7,m1032m21,m1033,i1033i7,m1033m21,m1034,i1034i7,m1034m21,m1035,i1035i7,m1035m21 &
,m1036,i1036i7,m1036m21,m1037,i1037i7,m1037m21,m1038,i1038i7,m1038m21,m1039,i1039i7,m1039m21,m1040,i1040i7,m1040m21
integer::m1041,i1041i7,m1041m21,m1042,i1042i7,m1042m21,m1043,i1043i7,m1043m21,m1044,i1044i7,m1044m21,m1045,i1045i7,m1045m21 &
,m1046,i1046i7,m1046m21,m1047,i1047i7,m1047m21,m1048,i1048i7,m1048m21,m1049,i1049i7,m1049m21,m1050,i1050i7,m1050m21
integer::m1051,i1051i7,m1051m21,m1052,i1052i7,m1052m21,m1053,i1053i7,m1053m21,m1054,i1054i7,m1054m21,m1055,i1055i7,m1055m21 &
,m1056,i1056i7,m1056m21,m1057,i1057i7,m1057m21,m1058,i1058i7,m1058m21,m1059,i1059i7,m1059m21,m1060,i1060i7,m1060m21
integer::m1061,i1061i7,m1061m21,m1062,i1062i7,m1062m21,m1063,i1063i7,m1063m21,m1064,i1064i7,m1064m21,m1065,i1065i7,m1065m21 &
,m1066,i1066i7,m1066m21,m1067,i1067i7,m1067m21,m1068,i1068i7,m1068m21,m1069,i1069i7,m1069m21,m1070,i1070i7,m1070m21
integer::m1071,i1071i7,m1071m21,m1072,i1072i7,m1072m21,m1073,i1073i7,m1073m21,m1074,i1074i7,m1074m21,m1075,i1075i7,m1075m21 &
,m1076,i1076i7,m1076m21,m1077,i1077i7,m1077m21,m1078,i1078i7,m1078m21,m1079,i1079i7,m1079m21,m1080,i1080i7,m1080m21
integer::m1081,i1081i7,m1081m21,m1082,i1082i7,m1082m21,m1083,i1083i7,m1083m21,m1084,i1084i7,m1084m21,m1085,i1085i7,m1085m21 &
,m1086,i1086i7,m1086m21,m1087,i1087i7,m1087m21,m1088,i1088i7,m1088m21,m1089,i1089i7,m1089m21,m1090,i1090i7,m1090m21
integer::m1091,i1091i7,m1091m21,m1092,i1092i7,m1092m21,m1093,i1093i7,m1093m21,m1094,i1094i7,m1094m21,m1095,i1095i7,m1095m21 &
,m1096,i1096i7,m1096m21,m1097,i1097i7,m1097m21,m1098,i1098i7,m1098m21,m1099,i1099i7,m1099m21,m1100,i1100i7,m1100m21
integer::m1101,i1101i7,m1101m21,m1102,i1102i7,m1102m21,m1103,i1103i7,m1103m21,m1104,i1104i7,m1104m21,m1105,i1105i7,m1105m21 &
,m1106,i1106i7,m1106m21,m1107,i1107i7,m1107m21,m1108,i1108i7,m1108m21,m1109,i1109i7,m1109m21,m1110,i1110i7,m1110m21
integer::m1111,i1111i7,m1111m21,m1112,i1112i7,m1112m21,m1113,i1113i7,m1113m21,m1114,i1114i7,m1114m21,m1115,i1115i7,m1115m21 &
,m1116,i1116i7,m1116m21,m1117,i1117i7,m1117m21,m1118,i1118i7,m1118m21,m1119,i1119i7,m1119m21,m1120,i1120i7,m1120m21
integer::m1121,i1121i7,m1121m21,m1122,i1122i7,m1122m21,m1123,i1123i7,m1123m21,m1124,i1124i7,m1124m21,m1125,i1125i7,m1125m21 &
,m1126,i1126i7,m1126m21,m1127,i1127i7,m1127m21,m1128,i1128i7,m1128m21,m1129,i1129i7,m1129m21,m1130,i1130i7,m1130m21
integer::m1131,i1131i7,m1131m21,m1132,i1132i7,m1132m21,m1133,i1133i7,m1133m21,m1134,i1134i7,m1134m21,m1135,i1135i7,m1135m21 &
,m1136,i1136i7,m1136m21,m1137,i1137i7,m1137m21,m1138,i1138i7,m1138m21,m1139,i1139i7,m1139m21,m1140,i1140i7,m1140m21
integer::m1141,i1141i7,m1141m21,m1142,i1142i7,m1142m21,m1143,i1143i7,m1143m21,m1144,i1144i7,m1144m21,m1145,i1145i7,m1145m21 &
,m1146,i1146i7,m1146m21,m1147,i1147i7,m1147m21,m1148,i1148i7,m1148m21,m1149,i1149i7,m1149m21,m1150,i1150i7,m1150m21
integer::m1151,i1151i7,m1151m21,m1152,i1152i7,m1152m21,m1153,i1153i7,m1153m21,m1154,i1154i7,m1154m21,m1155,i1155i7,m1155m21 &
,m1156,i1156i7,m1156m21,m1157,i1157i7,m1157m21,m1158,i1158i7,m1158m21,m1159,i1159i7,m1159m21,m1160,i1160i7,m1160m21
integer::m1161,i1161i7,m1161m21,m1162,i1162i7,m1162m21,m1163,i1163i7,m1163m21,m1164,i1164i7,m1164m21,m1165,i1165i7,m1165m21 &
,m1166,i1166i7,m1166m21,m1167,i1167i7,m1167m21,m1168,i1168i7,m1168m21,m1169,i1169i7,m1169m21,m1170,i1170i7,m1170m21
integer::m1171,i1171i7,m1171m21,m1172,i1172i7,m1172m21,m1173,i1173i7,m1173m21,m1174,i1174i7,m1174m21,m1175,i1175i7,m1175m21 &
,m1176,i1176i7,m1176m21,m1177,i1177i7,m1177m21,m1178,i1178i7,m1178m21,m1179,i1179i7,m1179m21,m1180,i1180i7,m1180m21
integer::m1181,i1181i7,m1181m21,m1182,i1182i7,m1182m21,m1183,i1183i7,m1183m21,m1184,i1184i7,m1184m21,m1185,i1185i7,m1185m21 &
,m1186,i1186i7,m1186m21,m1187,i1187i7,m1187m21,m1188,i1188i7,m1188m21,m1189,i1189i7,m1189m21,m1190,i1190i7,m1190m21
integer::m1191,i1191i7,m1191m21,m1192,i1192i7,m1192m21,m1193,i1193i7,m1193m21,m1194,i1194i7,m1194m21,m1195,i1195i7,m1195m21 &
,m1196,i1196i7,m1196m21,m1197,i1197i7,m1197m21,m1198,i1198i7,m1198m21,m1199,i1199i7,m1199m21,m1200,i1200i7,m1200m21
integer::m1201,i1201i7,m1201m21,m1202,i1202i7,m1202m21,m1203,i1203i7,m1203m21,m1204,i1204i7,m1204m21,m1205,i1205i7,m1205m21 &
,m1206,i1206i7,m1206m21,m1207,i1207i7,m1207m21,m1208,i1208i7,m1208m21,m1209,i1209i7,m1209m21,m1210,i1210i7,m1210m21
integer::m1211,i1211i7,m1211m21,m1212,i1212i7,m1212m21,m1213,i1213i7,m1213m21,m1214,i1214i7,m1214m21,m1215,i1215i7,m1215m21 &
,m1216,i1216i7,m1216m21,m1217,i1217i7,m1217m21,m1218,i1218i7,m1218m21,m1219,i1219i7,m1219m21,m1220,i1220i7,m1220m21
integer::m1221,i1221i7,m1221m21,m1222,i1222i7,m1222m21,m1223,i1223i7,m1223m21,m1224,i1224i7,m1224m21,m1225,i1225i7,m1225m21 &
,m1226,i1226i7,m1226m21,m1227,i1227i7,m1227m21,m1228,i1228i7,m1228m21,m1229,i1229i7,m1229m21,m1230,i1230i7,m1230m21
integer::m1231,i1231i7,m1231m21,m1232,i1232i7,m1232m21,m1233,i1233i7,m1233m21,m1234,i1234i7,m1234m21,m1235,i1235i7,m1235m21 &
,m1236,i1236i7,m1236m21,m1237,i1237i7,m1237m21,m1238,i1238i7,m1238m21,m1239,i1239i7,m1239m21,m1240,i1240i7,m1240m21
integer::m1241,i1241i7,m1241m21,m1242,i1242i7,m1242m21,m1243,i1243i7,m1243m21,m1244,i1244i7,m1244m21,m1245,i1245i7,m1245m21 &
,m1246,i1246i7,m1246m21,m1247,i1247i7,m1247m21,m1248,i1248i7,m1248m21,m1249,i1249i7,m1249m21,m1250,i1250i7,m1250m21
integer::m1251,i1251i7,m1251m21,m1252,i1252i7,m1252m21,m1253,i1253i7,m1253m21,m1254,i1254i7,m1254m21,m1255,i1255i7,m1255m21 &
,m1256,i1256i7,m1256m21,m1257,i1257i7,m1257m21,m1258,i1258i7,m1258m21,m1259,i1259i7,m1259m21,m1260,i1260i7,m1260m21
integer::m1261,i1261i7,m1261m21,m1262,i1262i7,m1262m21,m1263,i1263i7,m1263m21,m1264,i1264i7,m1264m21,m1265,i1265i7,m1265m21 &
,m1266,i1266i7,m1266m21,m1267,i1267i7,m1267m21,m1268,i1268i7,m1268m21,m1269,i1269i7,m1269m21,m1270,i1270i7,m1270m21
integer::m1271,i1271i7,m1271m21,m1272,i1272i7,m1272m21,m1273,i1273i7,m1273m21,m1274,i1274i7,m1274m21,m1275,i1275i7,m1275m21 &
,m1276,i1276i7,m1276m21,m1277,i1277i7,m1277m21,m1278,i1278i7,m1278m21,m1279,i1279i7,m1279m21,m1280,i1280i7,m1280m21
integer::m1281,i1281i7,m1281m21,m1282,i1282i7,m1282m21,m1283,i1283i7,m1283m21,m1284,i1284i7,m1284m21,m1285,i1285i7,m1285m21 &
,m1286,i1286i7,m1286m21,m1287,i1287i7,m1287m21,m1288,i1288i7,m1288m21,m1289,i1289i7,m1289m21,m1290,i1290i7,m1290m21
integer::m1291,i1291i7,m1291m21,m1292,i1292i7,m1292m21,m1293,i1293i7,m1293m21,m1294,i1294i7,m1294m21,m1295,i1295i7,m1295m21 &
,m1296,i1296i7,m1296m21,m1297,i1297i7,m1297m21,m1298,i1298i7,m1298m21,m1299,i1299i7,m1299m21,m1300,i1300i7,m1300m21
integer::m1301,i1301i7,m1301m21,m1302,i1302i7,m1302m21,m1303,i1303i7,m1303m21,m1304,i1304i7,m1304m21,m1305,i1305i7,m1305m21 &
,m1306,i1306i7,m1306m21,m1307,i1307i7,m1307m21,m1308,i1308i7,m1308m21,m1309,i1309i7,m1309m21,m1310,i1310i7,m1310m21
integer::m1311,i1311i7,m1311m21,m1312,i1312i7,m1312m21,m1313,i1313i7,m1313m21,m1314,i1314i7,m1314m21,m1315,i1315i7,m1315m21 &
,m1316,i1316i7,m1316m21,m1317,i1317i7,m1317m21,m1318,i1318i7,m1318m21,m1319,i1319i7,m1319m21,m1320,i1320i7,m1320m21
integer::m1321,i1321i7,m1321m21,m1322,i1322i7,m1322m21,m1323,i1323i7,m1323m21,m1324,i1324i7,m1324m21,m1325,i1325i7,m1325m21 &
,m1326,i1326i7,m1326m21,m1327,i1327i7,m1327m21,m1328,i1328i7,m1328m21,m1329,i1329i7,m1329m21,m1330,i1330i7,m1330m21
integer::m1331,i1331i7,m1331m21,m1332,i1332i7,m1332m21,m1333,i1333i7,m1333m21,m1334,i1334i7,m1334m21,m1335,i1335i7,m1335m21 &
,m1336,i1336i7,m1336m21,m1337,i1337i7,m1337m21,m1338,i1338i7,m1338m21,m1339,i1339i7,m1339m21,m1340,i1340i7,m1340m21
integer::m1341,i1341i7,m1341m21,m1342,i1342i7,m1342m21,m1343,i1343i7,m1343m21,m1344,i1344i7,m1344m21,m1345,i1345i7,m1345m21 &
,m1346,i1346i7,m1346m21,m1347,i1347i7,m1347m21,m1348,i1348i7,m1348m21,m1349,i1349i7,m1349m21,m1350,i1350i7,m1350m21
integer::m1351,i1351i7,m1351m21,m1352,i1352i7,m1352m21,m1353,i1353i7,m1353m21,m1354,i1354i7,m1354m21,m1355,i1355i7,m1355m21 &
,m1356,i1356i7,m1356m21,m1357,i1357i7,m1357m21,m1358,i1358i7,m1358m21,m1359,i1359i7,m1359m21,m1360,i1360i7,m1360m21
integer::m1361,i1361i7,m1361m21,m1362,i1362i7,m1362m21,m1363,i1363i7,m1363m21,m1364,i1364i7,m1364m21,m1365,i1365i7,m1365m21 &
,m1366,i1366i7,m1366m21,m1367,i1367i7,m1367m21,m1368,i1368i7,m1368m21,m1369,i1369i7,m1369m21,m1370,i1370i7,m1370m21
integer::m1371,i1371i7,m1371m21,m1372,i1372i7,m1372m21,m1373,i1373i7,m1373m21,m1374,i1374i7,m1374m21,m1375,i1375i7,m1375m21 &
,m1376,i1376i7,m1376m21,m1377,i1377i7,m1377m21,m1378,i1378i7,m1378m21,m1379,i1379i7,m1379m21,m1380,i1380i7,m1380m21
integer::m1381,i1381i7,m1381m21,m1382,i1382i7,m1382m21,m1383,i1383i7,m1383m21,m1384,i1384i7,m1384m21,m1385,i1385i7,m1385m21 &
,m1386,i1386i7,m1386m21,m1387,i1387i7,m1387m21,m1388,i1388i7,m1388m21,m1389,i1389i7,m1389m21,m1390,i1390i7,m1390m21
integer::m1391,i1391i7,m1391m21,m1392,i1392i7,m1392m21,m1393,i1393i7,m1393m21,m1394,i1394i7,m1394m21,m1395,i1395i7,m1395m21 &
,m1396,i1396i7,m1396m21,m1397,i1397i7,m1397m21,m1398,i1398i7,m1398m21,m1399,i1399i7,m1399m21,m1400,i1400i7,m1400m21
integer::m1401,i1401i7,m1401m21,m1402,i1402i7,m1402m21,m1403,i1403i7,m1403m21,m1404,i1404i7,m1404m21,m1405,i1405i7,m1405m21 &
,m1406,i1406i7,m1406m21,m1407,i1407i7,m1407m21,m1408,i1408i7,m1408m21,m1409,i1409i7,m1409m21,m1410,i1410i7,m1410m21
integer::m1411,i1411i7,m1411m21,m1412,i1412i7,m1412m21,m1413,i1413i7,m1413m21,m1414,i1414i7,m1414m21,m1415,i1415i7,m1415m21 &
,m1416,i1416i7,m1416m21,m1417,i1417i7,m1417m21,m1418,i1418i7,m1418m21,m1419,i1419i7,m1419m21,m1420,i1420i7,m1420m21
integer::m1421,i1421i7,m1421m21,m1422,i1422i7,m1422m21,m1423,i1423i7,m1423m21,m1424,i1424i7,m1424m21,m1425,i1425i7,m1425m21 &
,m1426,i1426i7,m1426m21,m1427,i1427i7,m1427m21,m1428,i1428i7,m1428m21,m1429,i1429i7,m1429m21,m1430,i1430i7,m1430m21
integer::m1431,i1431i7,m1431m21,m1432,i1432i7,m1432m21,m1433,i1433i7,m1433m21,m1434,i1434i7,m1434m21,m1435,i1435i7,m1435m21 &
,m1436,i1436i7,m1436m21,m1437,i1437i7,m1437m21,m1438,i1438i7,m1438m21,m1439,i1439i7,m1439m21,m1440,i1440i7,m1440m21
integer::m1441,i1441i7,m1441m21,m1442,i1442i7,m1442m21,m1443,i1443i7,m1443m21,m1444,i1444i7,m1444m21,m1445,i1445i7,m1445m21 &
,m1446,i1446i7,m1446m21,m1447,i1447i7,m1447m21,m1448,i1448i7,m1448m21,m1449,i1449i7,m1449m21,m1450,i1450i7,m1450m21
integer::m1451,i1451i7,m1451m21,m1452,i1452i7,m1452m21,m1453,i1453i7,m1453m21,m1454,i1454i7,m1454m21,m1455,i1455i7,m1455m21 &
,m1456,i1456i7,m1456m21,m1457,i1457i7,m1457m21,m1458,i1458i7,m1458m21,m1459,i1459i7,m1459m21,m1460,i1460i7,m1460m21
integer::m1461,i1461i7,m1461m21,m1462,i1462i7,m1462m21,m1463,i1463i7,m1463m21,m1464,i1464i7,m1464m21,m1465,i1465i7,m1465m21 &
,m1466,i1466i7,m1466m21,m1467,i1467i7,m1467m21,m1468,i1468i7,m1468m21,m1469,i1469i7,m1469m21,m1470,i1470i7,m1470m21
integer::m1471,i1471i7,m1471m21,m1472,i1472i7,m1472m21,m1473,i1473i7,m1473m21,m1474,i1474i7,m1474m21,m1475,i1475i7,m1475m21 &
,m1476,i1476i7,m1476m21,m1477,i1477i7,m1477m21,m1478,i1478i7,m1478m21,m1479,i1479i7,m1479m21,m1480,i1480i7,m1480m21
integer::m1481,i1481i7,m1481m21,m1482,i1482i7,m1482m21,m1483,i1483i7,m1483m21,m1484,i1484i7,m1484m21,m1485,i1485i7,m1485m21 &
,m1486,i1486i7,m1486m21,m1487,i1487i7,m1487m21,m1488,i1488i7,m1488m21,m1489,i1489i7,m1489m21,m1490,i1490i7,m1490m21
integer::m1491,i1491i7,m1491m21,m1492,i1492i7,m1492m21,m1493,i1493i7,m1493m21,m1494,i1494i7,m1494m21,m1495,i1495i7,m1495m21 &
,m1496,i1496i7,m1496m21,m1497,i1497i7,m1497m21,m1498,i1498i7,m1498m21,m1499,i1499i7,m1499m21,m1500,i1500i7,m1500m21
integer::m1501,i1501i7,m1501m21,m1502,i1502i7,m1502m21,m1503,i1503i7,m1503m21,m1504,i1504i7,m1504m21,m1505,i1505i7,m1505m21 &
,m1506,i1506i7,m1506m21,m1507,i1507i7,m1507m21,m1508,i1508i7,m1508m21,m1509,i1509i7,m1509m21,m1510,i1510i7,m1510m21
integer::m1511,i1511i7,m1511m21,m1512,i1512i7,m1512m21,m1513,i1513i7,m1513m21,m1514,i1514i7,m1514m21,m1515,i1515i7,m1515m21 &
,m1516,i1516i7,m1516m21,m1517,i1517i7,m1517m21,m1518,i1518i7,m1518m21,m1519,i1519i7,m1519m21,m1520,i1520i7,m1520m21
integer::m1521,i1521i7,m1521m21,m1522,i1522i7,m1522m21,m1523,i1523i7,m1523m21,m1524,i1524i7,m1524m21,m1525,i1525i7,m1525m21 &
,m1526,i1526i7,m1526m21,m1527,i1527i7,m1527m21,m1528,i1528i7,m1528m21,m1529,i1529i7,m1529m21,m1530,i1530i7,m1530m21
integer::m1531,i1531i7,m1531m21,m1532,i1532i7,m1532m21,m1533,i1533i7,m1533m21,m1534,i1534i7,m1534m21,m1535,i1535i7,m1535m21 &
,m1536,i1536i7,m1536m21,m1537,i1537i7,m1537m21,m1538,i1538i7,m1538m21,m1539,i1539i7,m1539m21,m1540,i1540i7,m1540m21
integer::m1541,i1541i7,m1541m21,m1542,i1542i7,m1542m21,m1543,i1543i7,m1543m21,m1544,i1544i7,m1544m21,m1545,i1545i7,m1545m21 &
,m1546,i1546i7,m1546m21,m1547,i1547i7,m1547m21,m1548,i1548i7,m1548m21,m1549,i1549i7,m1549m21,m1550,i1550i7,m1550m21
integer::m1551,i1551i7,m1551m21,m1552,i1552i7,m1552m21,m1553,i1553i7,m1553m21,m1554,i1554i7,m1554m21,m1555,i1555i7,m1555m21 &
,m1556,i1556i7,m1556m21,m1557,i1557i7,m1557m21,m1558,i1558i7,m1558m21,m1559,i1559i7,m1559m21,m1560,i1560i7,m1560m21
integer::m1561,i1561i7,m1561m21,m1562,i1562i7,m1562m21,m1563,i1563i7,m1563m21,m1564,i1564i7,m1564m21,m1565,i1565i7,m1565m21 &
,m1566,i1566i7,m1566m21,m1567,i1567i7,m1567m21,m1568,i1568i7,m1568m21,m1569,i1569i7,m1569m21,m1570,i1570i7,m1570m21
integer::m1571,i1571i7,m1571m21,m1572,i1572i7,m1572m21,m1573,i1573i7,m1573m21,m1574,i1574i7,m1574m21,m1575,i1575i7,m1575m21 &
,m1576,i1576i7,m1576m21,m1577,i1577i7,m1577m21,m1578,i1578i7,m1578m21,m1579,i1579i7,m1579m21,m1580,i1580i7,m1580m21
integer::m1581,i1581i7,m1581m21,m1582,i1582i7,m1582m21,m1583,i1583i7,m1583m21,m1584,i1584i7,m1584m21,m1585,i1585i7,m1585m21 &
,m1586,i1586i7,m1586m21,m1587,i1587i7,m1587m21,m1588,i1588i7,m1588m21,m1589,i1589i7,m1589m21,m1590,i1590i7,m1590m21
integer::m1591,i1591i7,m1591m21,m1592,i1592i7,m1592m21,m1593,i1593i7,m1593m21,m1594,i1594i7,m1594m21,m1595,i1595i7,m1595m21 &
,m1596,i1596i7,m1596m21,m1597,i1597i7,m1597m21,m1598,i1598i7,m1598m21,m1599,i1599i7,m1599m21,m1600,i1600i7,m1600m21
integer::m1601,i1601i7,m1601m21,m1602,i1602i7,m1602m21,m1603,i1603i7,m1603m21,m1604,i1604i7,m1604m21,m1605,i1605i7,m1605m21 &
,m1606,i1606i7,m1606m21,m1607,i1607i7,m1607m21,m1608,i1608i7,m1608m21,m1609,i1609i7,m1609m21,m1610,i1610i7,m1610m21
integer::m1611,i1611i7,m1611m21,m1612,i1612i7,m1612m21,m1613,i1613i7,m1613m21,m1614,i1614i7,m1614m21,m1615,i1615i7,m1615m21 &
,m1616,i1616i7,m1616m21,m1617,i1617i7,m1617m21,m1618,i1618i7,m1618m21,m1619,i1619i7,m1619m21,m1620,i1620i7,m1620m21
integer::m1621,i1621i7,m1621m21,m1622,i1622i7,m1622m21,m1623,i1623i7,m1623m21,m1624,i1624i7,m1624m21,m1625,i1625i7,m1625m21 &
,m1626,i1626i7,m1626m21,m1627,i1627i7,m1627m21,m1628,i1628i7,m1628m21,m1629,i1629i7,m1629m21,m1630,i1630i7,m1630m21
integer::m1631,i1631i7,m1631m21,m1632,i1632i7,m1632m21,m1633,i1633i7,m1633m21,m1634,i1634i7,m1634m21,m1635,i1635i7,m1635m21 &
,m1636,i1636i7,m1636m21,m1637,i1637i7,m1637m21,m1638,i1638i7,m1638m21,m1639,i1639i7,m1639m21,m1640,i1640i7,m1640m21
integer::m1641,i1641i7,m1641m21,m1642,i1642i7,m1642m21,m1643,i1643i7,m1643m21,m1644,i1644i7,m1644m21,m1645,i1645i7,m1645m21 &
,m1646,i1646i7,m1646m21,m1647,i1647i7,m1647m21,m1648,i1648i7,m1648m21,m1649,i1649i7,m1649m21,m1650,i1650i7,m1650m21
integer::m1651,i1651i7,m1651m21,m1652,i1652i7,m1652m21,m1653,i1653i7,m1653m21,m1654,i1654i7,m1654m21,m1655,i1655i7,m1655m21 &
,m1656,i1656i7,m1656m21,m1657,i1657i7,m1657m21,m1658,i1658i7,m1658m21,m1659,i1659i7,m1659m21,m1660,i1660i7,m1660m21
integer::m1661,i1661i7,m1661m21,m1662,i1662i7,m1662m21,m1663,i1663i7,m1663m21,m1664,i1664i7,m1664m21,m1665,i1665i7,m1665m21 &
,m1666,i1666i7,m1666m21,m1667,i1667i7,m1667m21,m1668,i1668i7,m1668m21,m1669,i1669i7,m1669m21,m1670,i1670i7,m1670m21
integer::m1671,i1671i7,m1671m21,m1672,i1672i7,m1672m21,m1673,i1673i7,m1673m21,m1674,i1674i7,m1674m21,m1675,i1675i7,m1675m21 &
,m1676,i1676i7,m1676m21,m1677,i1677i7,m1677m21,m1678,i1678i7,m1678m21,m1679,i1679i7,m1679m21,m1680,i1680i7,m1680m21
integer::m1681,i1681i7,m1681m21,m1682,i1682i7,m1682m21,m1683,i1683i7,m1683m21,m1684,i1684i7,m1684m21,m1685,i1685i7,m1685m21 &
,m1686,i1686i7,m1686m21,m1687,i1687i7,m1687m21,m1688,i1688i7,m1688m21,m1689,i1689i7,m1689m21,m1690,i1690i7,m1690m21
integer::m1691,i1691i7,m1691m21,m1692,i1692i7,m1692m21,m1693,i1693i7,m1693m21,m1694,i1694i7,m1694m21,m1695,i1695i7,m1695m21 &
,m1696,i1696i7,m1696m21,m1697,i1697i7,m1697m21,m1698,i1698i7,m1698m21,m1699,i1699i7,m1699m21,m1700,i1700i7,m1700m21
integer::m1701,i1701i7,m1701m21,m1702,i1702i7,m1702m21,m1703,i1703i7,m1703m21,m1704,i1704i7,m1704m21,m1705,i1705i7,m1705m21 &
,m1706,i1706i7,m1706m21,m1707,i1707i7,m1707m21,m1708,i1708i7,m1708m21,m1709,i1709i7,m1709m21,m1710,i1710i7,m1710m21
integer::m1711,i1711i7,m1711m21,m1712,i1712i7,m1712m21,m1713,i1713i7,m1713m21,m1714,i1714i7,m1714m21,m1715,i1715i7,m1715m21 &
,m1716,i1716i7,m1716m21,m1717,i1717i7,m1717m21,m1718,i1718i7,m1718m21,m1719,i1719i7,m1719m21,m1720,i1720i7,m1720m21
integer::m1721,i1721i7,m1721m21,m1722,i1722i7,m1722m21,m1723,i1723i7,m1723m21,m1724,i1724i7,m1724m21,m1725,i1725i7,m1725m21 &
,m1726,i1726i7,m1726m21,m1727,i1727i7,m1727m21,m1728,i1728i7,m1728m21,m1729,i1729i7,m1729m21,m1730,i1730i7,m1730m21
integer::m1731,i1731i7,m1731m21,m1732,i1732i7,m1732m21,m1733,i1733i7,m1733m21,m1734,i1734i7,m1734m21,m1735,i1735i7,m1735m21 &
,m1736,i1736i7,m1736m21,m1737,i1737i7,m1737m21,m1738,i1738i7,m1738m21,m1739,i1739i7,m1739m21,m1740,i1740i7,m1740m21
integer::m1741,i1741i7,m1741m21,m1742,i1742i7,m1742m21,m1743,i1743i7,m1743m21,m1744,i1744i7,m1744m21,m1745,i1745i7,m1745m21 &
,m1746,i1746i7,m1746m21,m1747,i1747i7,m1747m21,m1748,i1748i7,m1748m21,m1749,i1749i7,m1749m21,m1750,i1750i7,m1750m21
integer::m1751,i1751i7,m1751m21,m1752,i1752i7,m1752m21,m1753,i1753i7,m1753m21,m1754,i1754i7,m1754m21,m1755,i1755i7,m1755m21 &
,m1756,i1756i7,m1756m21,m1757,i1757i7,m1757m21,m1758,i1758i7,m1758m21,m1759,i1759i7,m1759m21,m1760,i1760i7,m1760m21
integer::m1761,i1761i7,m1761m21,m1762,i1762i7,m1762m21,m1763,i1763i7,m1763m21,m1764,i1764i7,m1764m21,m1765,i1765i7,m1765m21 &
,m1766,i1766i7,m1766m21,m1767,i1767i7,m1767m21,m1768,i1768i7,m1768m21,m1769,i1769i7,m1769m21,m1770,i1770i7,m1770m21
integer::m1771,i1771i7,m1771m21,m1772,i1772i7,m1772m21,m1773,i1773i7,m1773m21,m1774,i1774i7,m1774m21,m1775,i1775i7,m1775m21 &
,m1776,i1776i7,m1776m21,m1777,i1777i7,m1777m21,m1778,i1778i7,m1778m21,m1779,i1779i7,m1779m21,m1780,i1780i7,m1780m21
integer::m1781,i1781i7,m1781m21,m1782,i1782i7,m1782m21,m1783,i1783i7,m1783m21,m1784,i1784i7,m1784m21,m1785,i1785i7,m1785m21 &
,m1786,i1786i7,m1786m21,m1787,i1787i7,m1787m21,m1788,i1788i7,m1788m21,m1789,i1789i7,m1789m21,m1790,i1790i7,m1790m21
integer::m1791,i1791i7,m1791m21,m1792,i1792i7,m1792m21,m1793,i1793i7,m1793m21,m1794,i1794i7,m1794m21,m1795,i1795i7,m1795m21 &
,m1796,i1796i7,m1796m21,m1797,i1797i7,m1797m21,m1798,i1798i7,m1798m21,m1799,i1799i7,m1799m21,m1800,i1800i7,m1800m21
integer::m1801,i1801i7,m1801m21,m1802,i1802i7,m1802m21,m1803,i1803i7,m1803m21,m1804,i1804i7,m1804m21,m1805,i1805i7,m1805m21 &
,m1806,i1806i7,m1806m21,m1807,i1807i7,m1807m21,m1808,i1808i7,m1808m21,m1809,i1809i7,m1809m21,m1810,i1810i7,m1810m21
integer::m1811,i1811i7,m1811m21,m1812,i1812i7,m1812m21,m1813,i1813i7,m1813m21,m1814,i1814i7,m1814m21,m1815,i1815i7,m1815m21 &
,m1816,i1816i7,m1816m21,m1817,i1817i7,m1817m21,m1818,i1818i7,m1818m21,m1819,i1819i7,m1819m21,m1820,i1820i7,m1820m21
integer::m1821,i1821i7,m1821m21,m1822,i1822i7,m1822m21,m1823,i1823i7,m1823m21,m1824,i1824i7,m1824m21,m1825,i1825i7,m1825m21 &
,m1826,i1826i7,m1826m21,m1827,i1827i7,m1827m21,m1828,i1828i7,m1828m21,m1829,i1829i7,m1829m21,m1830,i1830i7,m1830m21
integer::m1831,i1831i7,m1831m21,m1832,i1832i7,m1832m21,m1833,i1833i7,m1833m21,m1834,i1834i7,m1834m21,m1835,i1835i7,m1835m21 &
,m1836,i1836i7,m1836m21,m1837,i1837i7,m1837m21,m1838,i1838i7,m1838m21,m1839,i1839i7,m1839m21,m1840,i1840i7,m1840m21
integer::m1841,i1841i7,m1841m21,m1842,i1842i7,m1842m21,m1843,i1843i7,m1843m21,m1844,i1844i7,m1844m21,m1845,i1845i7,m1845m21 &
,m1846,i1846i7,m1846m21,m1847,i1847i7,m1847m21,m1848,i1848i7,m1848m21,m1849,i1849i7,m1849m21,m1850,i1850i7,m1850m21
integer::m1851,i1851i7,m1851m21,m1852,i1852i7,m1852m21,m1853,i1853i7,m1853m21,m1854,i1854i7,m1854m21,m1855,i1855i7,m1855m21 &
,m1856,i1856i7,m1856m21,m1857,i1857i7,m1857m21,m1858,i1858i7,m1858m21,m1859,i1859i7,m1859m21,m1860,i1860i7,m1860m21
integer::m1861,i1861i7,m1861m21,m1862,i1862i7,m1862m21,m1863,i1863i7,m1863m21,m1864,i1864i7,m1864m21,m1865,i1865i7,m1865m21 &
,m1866,i1866i7,m1866m21,m1867,i1867i7,m1867m21,m1868,i1868i7,m1868m21,m1869,i1869i7,m1869m21,m1870,i1870i7,m1870m21
integer::m1871,i1871i7,m1871m21,m1872,i1872i7,m1872m21,m1873,i1873i7,m1873m21,m1874,i1874i7,m1874m21,m1875,i1875i7,m1875m21 &
,m1876,i1876i7,m1876m21,m1877,i1877i7,m1877m21,m1878,i1878i7,m1878m21,m1879,i1879i7,m1879m21,m1880,i1880i7,m1880m21
integer::m1881,i1881i7,m1881m21,m1882,i1882i7,m1882m21,m1883,i1883i7,m1883m21,m1884,i1884i7,m1884m21,m1885,i1885i7,m1885m21 &
,m1886,i1886i7,m1886m21,m1887,i1887i7,m1887m21,m1888,i1888i7,m1888m21,m1889,i1889i7,m1889m21,m1890,i1890i7,m1890m21
integer::m1891,i1891i7,m1891m21,m1892,i1892i7,m1892m21,m1893,i1893i7,m1893m21,m1894,i1894i7,m1894m21,m1895,i1895i7,m1895m21 &
,m1896,i1896i7,m1896m21,m1897,i1897i7,m1897m21,m1898,i1898i7,m1898m21,m1899,i1899i7,m1899m21,m1900,i1900i7,m1900m21
integer::m1901,i1901i7,m1901m21,m1902,i1902i7,m1902m21,m1903,i1903i7,m1903m21,m1904,i1904i7,m1904m21,m1905,i1905i7,m1905m21 &
,m1906,i1906i7,m1906m21,m1907,i1907i7,m1907m21,m1908,i1908i7,m1908m21,m1909,i1909i7,m1909m21,m1910,i1910i7,m1910m21
integer::m1911,i1911i7,m1911m21,m1912,i1912i7,m1912m21,m1913,i1913i7,m1913m21,m1914,i1914i7,m1914m21,m1915,i1915i7,m1915m21 &
,m1916,i1916i7,m1916m21,m1917,i1917i7,m1917m21,m1918,i1918i7,m1918m21,m1919,i1919i7,m1919m21,m1920,i1920i7,m1920m21
integer::m1921,i1921i7,m1921m21,m1922,i1922i7,m1922m21,m1923,i1923i7,m1923m21,m1924,i1924i7,m1924m21,m1925,i1925i7,m1925m21 &
,m1926,i1926i7,m1926m21,m1927,i1927i7,m1927m21,m1928,i1928i7,m1928m21,m1929,i1929i7,m1929m21,m1930,i1930i7,m1930m21
integer::m1931,i1931i7,m1931m21,m1932,i1932i7,m1932m21,m1933,i1933i7,m1933m21,m1934,i1934i7,m1934m21,m1935,i1935i7,m1935m21 &
,m1936,i1936i7,m1936m21,m1937,i1937i7,m1937m21,m1938,i1938i7,m1938m21,m1939,i1939i7,m1939m21,m1940,i1940i7,m1940m21
integer::m1941,i1941i7,m1941m21,m1942,i1942i7,m1942m21,m1943,i1943i7,m1943m21,m1944,i1944i7,m1944m21,m1945,i1945i7,m1945m21 &
,m1946,i1946i7,m1946m21,m1947,i1947i7,m1947m21,m1948,i1948i7,m1948m21,m1949,i1949i7,m1949m21,m1950,i1950i7,m1950m21
integer::m1951,i1951i7,m1951m21,m1952,i1952i7,m1952m21,m1953,i1953i7,m1953m21,m1954,i1954i7,m1954m21,m1955,i1955i7,m1955m21 &
,m1956,i1956i7,m1956m21,m1957,i1957i7,m1957m21,m1958,i1958i7,m1958m21,m1959,i1959i7,m1959m21,m1960,i1960i7,m1960m21
integer::m1961,i1961i7,m1961m21,m1962,i1962i7,m1962m21,m1963,i1963i7,m1963m21,m1964,i1964i7,m1964m21,m1965,i1965i7,m1965m21 &
,m1966,i1966i7,m1966m21,m1967,i1967i7,m1967m21,m1968,i1968i7,m1968m21,m1969,i1969i7,m1969m21,m1970,i1970i7,m1970m21
integer::m1971,i1971i7,m1971m21,m1972,i1972i7,m1972m21,m1973,i1973i7,m1973m21,m1974,i1974i7,m1974m21,m1975,i1975i7,m1975m21 &
,m1976,i1976i7,m1976m21,m1977,i1977i7,m1977m21,m1978,i1978i7,m1978m21,m1979,i1979i7,m1979m21,m1980,i1980i7,m1980m21
integer::m1981,i1981i7,m1981m21,m1982,i1982i7,m1982m21,m1983,i1983i7,m1983m21,m1984,i1984i7,m1984m21,m1985,i1985i7,m1985m21 &
,m1986,i1986i7,m1986m21,m1987,i1987i7,m1987m21,m1988,i1988i7,m1988m21,m1989,i1989i7,m1989m21,m1990,i1990i7,m1990m21
integer::m1991,i1991i7,m1991m21,m1992,i1992i7,m1992m21,m1993,i1993i7,m1993m21,m1994,i1994i7,m1994m21,m1995,i1995i7,m1995m21 &
,m1996,i1996i7,m1996m21,m1997,i1997i7,m1997m21,m1998,i1998i7,m1998m21,m1999,i1999i7,m1999m21,m2000,i2000i7,m2000m21
integer::m2001,i2001i7,m2001m21,m2002,i2002i7,m2002m21,m2003,i2003i7,m2003m21,m2004,i2004i7,m2004m21,m2005,i2005i7,m2005m21 &
,m2006,i2006i7,m2006m21,m2007,i2007i7,m2007m21,m2008,i2008i7,m2008m21,m2009,i2009i7,m2009m21,m2010,i2010i7,m2010m21
integer::m2011,i2011i7,m2011m21,m2012,i2012i7,m2012m21,m2013,i2013i7,m2013m21,m2014,i2014i7,m2014m21,m2015,i2015i7,m2015m21 &
,m2016,i2016i7,m2016m21,m2017,i2017i7,m2017m21,m2018,i2018i7,m2018m21,m2019,i2019i7,m2019m21,m2020,i2020i7,m2020m21
integer::m2021,i2021i7,m2021m21,m2022,i2022i7,m2022m21,m2023,i2023i7,m2023m21,m2024,i2024i7,m2024m21,m2025,i2025i7,m2025m21 &
,m2026,i2026i7,m2026m21,m2027,i2027i7,m2027m21,m2028,i2028i7,m2028m21,m2029,i2029i7,m2029m21,m2030,i2030i7,m2030m21
integer::m2031,i2031i7,m2031m21,m2032,i2032i7,m2032m21,m2033,i2033i7,m2033m21,m2034,i2034i7,m2034m21,m2035,i2035i7,m2035m21 &
,m2036,i2036i7,m2036m21,m2037,i2037i7,m2037m21,m2038,i2038i7,m2038m21,m2039,i2039i7,m2039m21,m2040,i2040i7,m2040m21
integer::m2041,i2041i7,m2041m21,m2042,i2042i7,m2042m21,m2043,i2043i7,m2043m21,m2044,i2044i7,m2044m21,m2045,i2045i7,m2045m21 &
,m2046,i2046i7,m2046m21,m2047,i2047i7,m2047m21,m2048,i2048i7,m2048m21,m2049,i2049i7,m2049m21,m2050,i2050i7,m2050m21
integer::m2051,i2051i7,m2051m21,m2052,i2052i7,m2052m21,m2053,i2053i7,m2053m21,m2054,i2054i7,m2054m21,m2055,i2055i7,m2055m21 &
,m2056,i2056i7,m2056m21,m2057,i2057i7,m2057m21,m2058,i2058i7,m2058m21,m2059,i2059i7,m2059m21,m2060,i2060i7,m2060m21
integer::m2061,i2061i7,m2061m21,m2062,i2062i7,m2062m21,m2063,i2063i7,m2063m21,m2064,i2064i7,m2064m21,m2065,i2065i7,m2065m21 &
,m2066,i2066i7,m2066m21,m2067,i2067i7,m2067m21,m2068,i2068i7,m2068m21,m2069,i2069i7,m2069m21,m2070,i2070i7,m2070m21
integer::m2071,i2071i7,m2071m21,m2072,i2072i7,m2072m21,m2073,i2073i7,m2073m21,m2074,i2074i7,m2074m21,m2075,i2075i7,m2075m21 &
,m2076,i2076i7,m2076m21,m2077,i2077i7,m2077m21,m2078,i2078i7,m2078m21,m2079,i2079i7,m2079m21,m2080,i2080i7,m2080m21
integer::m2081,i2081i7,m2081m21,m2082,i2082i7,m2082m21,m2083,i2083i7,m2083m21,m2084,i2084i7,m2084m21,m2085,i2085i7,m2085m21 &
,m2086,i2086i7,m2086m21,m2087,i2087i7,m2087m21,m2088,i2088i7,m2088m21,m2089,i2089i7,m2089m21,m2090,i2090i7,m2090m21
integer::m2091,i2091i7,m2091m21,m2092,i2092i7,m2092m21,m2093,i2093i7,m2093m21,m2094,i2094i7,m2094m21,m2095,i2095i7,m2095m21 &
,m2096,i2096i7,m2096m21,m2097,i2097i7,m2097m21,m2098,i2098i7,m2098m21,m2099,i2099i7,m2099m21,m2100,i2100i7,m2100m21
integer::m2101,i2101i7,m2101m21,m2102,i2102i7,m2102m21,m2103,i2103i7,m2103m21,m2104,i2104i7,m2104m21,m2105,i2105i7,m2105m21 &
,m2106,i2106i7,m2106m21,m2107,i2107i7,m2107m21,m2108,i2108i7,m2108m21,m2109,i2109i7,m2109m21,m2110,i2110i7,m2110m21
integer::m2111,i2111i7,m2111m21,m2112,i2112i7,m2112m21,m2113,i2113i7,m2113m21,m2114,i2114i7,m2114m21,m2115,i2115i7,m2115m21 &
,m2116,i2116i7,m2116m21,m2117,i2117i7,m2117m21,m2118,i2118i7,m2118m21,m2119,i2119i7,m2119m21,m2120,i2120i7,m2120m21
integer::m2121,i2121i7,m2121m21,m2122,i2122i7,m2122m21,m2123,i2123i7,m2123m21,m2124,i2124i7,m2124m21,m2125,i2125i7,m2125m21 &
,m2126,i2126i7,m2126m21,m2127,i2127i7,m2127m21,m2128,i2128i7,m2128m21,m2129,i2129i7,m2129m21,m2130,i2130i7,m2130m21
integer::m2131,i2131i7,m2131m21,m2132,i2132i7,m2132m21,m2133,i2133i7,m2133m21,m2134,i2134i7,m2134m21,m2135,i2135i7,m2135m21 &
,m2136,i2136i7,m2136m21,m2137,i2137i7,m2137m21,m2138,i2138i7,m2138m21,m2139,i2139i7,m2139m21,m2140,i2140i7,m2140m21
integer::m2141,i2141i7,m2141m21,m2142,i2142i7,m2142m21,m2143,i2143i7,m2143m21,m2144,i2144i7,m2144m21,m2145,i2145i7,m2145m21 &
,m2146,i2146i7,m2146m21,m2147,i2147i7,m2147m21,m2148,i2148i7,m2148m21,m2149,i2149i7,m2149m21,m2150,i2150i7,m2150m21
integer::m2151,i2151i7,m2151m21,m2152,i2152i7,m2152m21,m2153,i2153i7,m2153m21,m2154,i2154i7,m2154m21,m2155,i2155i7,m2155m21 &
,m2156,i2156i7,m2156m21,m2157,i2157i7,m2157m21,m2158,i2158i7,m2158m21,m2159,i2159i7,m2159m21,m2160,i2160i7,m2160m21
integer::m2161,i2161i7,m2161m21,m2162,i2162i7,m2162m21,m2163,i2163i7,m2163m21,m2164,i2164i7,m2164m21,m2165,i2165i7,m2165m21 &
,m2166,i2166i7,m2166m21,m2167,i2167i7,m2167m21,m2168,i2168i7,m2168m21,m2169,i2169i7,m2169m21,m2170,i2170i7,m2170m21
integer::m2171,i2171i7,m2171m21,m2172,i2172i7,m2172m21,m2173,i2173i7,m2173m21,m2174,i2174i7,m2174m21,m2175,i2175i7,m2175m21 &
,m2176,i2176i7,m2176m21,m2177,i2177i7,m2177m21,m2178,i2178i7,m2178m21,m2179,i2179i7,m2179m21,m2180,i2180i7,m2180m21
integer::m2181,i2181i7,m2181m21,m2182,i2182i7,m2182m21,m2183,i2183i7,m2183m21,m2184,i2184i7,m2184m21,m2185,i2185i7,m2185m21 &
,m2186,i2186i7,m2186m21,m2187,i2187i7,m2187m21,m2188,i2188i7,m2188m21,m2189,i2189i7,m2189m21,m2190,i2190i7,m2190m21
integer::m2191,i2191i7,m2191m21,m2192,i2192i7,m2192m21,m2193,i2193i7,m2193m21,m2194,i2194i7,m2194m21,m2195,i2195i7,m2195m21 &
,m2196,i2196i7,m2196m21,m2197,i2197i7,m2197m21,m2198,i2198i7,m2198m21,m2199,i2199i7,m2199m21,m2200,i2200i7,m2200m21
integer::m2201,i2201i7,m2201m21,m2202,i2202i7,m2202m21,m2203,i2203i7,m2203m21,m2204,i2204i7,m2204m21,m2205,i2205i7,m2205m21 &
,m2206,i2206i7,m2206m21,m2207,i2207i7,m2207m21,m2208,i2208i7,m2208m21,m2209,i2209i7,m2209m21,m2210,i2210i7,m2210m21
integer::m2211,i2211i7,m2211m21,m2212,i2212i7,m2212m21,m2213,i2213i7,m2213m21,m2214,i2214i7,m2214m21,m2215,i2215i7,m2215m21 &
,m2216,i2216i7,m2216m21,m2217,i2217i7,m2217m21,m2218,i2218i7,m2218m21,m2219,i2219i7,m2219m21,m2220,i2220i7,m2220m21
integer::m2221,i2221i7,m2221m21,m2222,i2222i7,m2222m21,m2223,i2223i7,m2223m21,m2224,i2224i7,m2224m21,m2225,i2225i7,m2225m21 &
,m2226,i2226i7,m2226m21,m2227,i2227i7,m2227m21,m2228,i2228i7,m2228m21,m2229,i2229i7,m2229m21,m2230,i2230i7,m2230m21
integer::m2231,i2231i7,m2231m21,m2232,i2232i7,m2232m21,m2233,i2233i7,m2233m21,m2234,i2234i7,m2234m21,m2235,i2235i7,m2235m21 &
,m2236,i2236i7,m2236m21,m2237,i2237i7,m2237m21,m2238,i2238i7,m2238m21,m2239,i2239i7,m2239m21,m2240,i2240i7,m2240m21
integer::m2241,i2241i7,m2241m21,m2242,i2242i7,m2242m21,m2243,i2243i7,m2243m21,m2244,i2244i7,m2244m21,m2245,i2245i7,m2245m21 &
,m2246,i2246i7,m2246m21,m2247,i2247i7,m2247m21,m2248,i2248i7,m2248m21,m2249,i2249i7,m2249m21,m2250,i2250i7,m2250m21
integer::m2251,i2251i7,m2251m21,m2252,i2252i7,m2252m21,m2253,i2253i7,m2253m21,m2254,i2254i7,m2254m21,m2255,i2255i7,m2255m21 &
,m2256,i2256i7,m2256m21,m2257,i2257i7,m2257m21,m2258,i2258i7,m2258m21,m2259,i2259i7,m2259m21,m2260,i2260i7,m2260m21
integer::m2261,i2261i7,m2261m21,m2262,i2262i7,m2262m21,m2263,i2263i7,m2263m21,m2264,i2264i7,m2264m21,m2265,i2265i7,m2265m21 &
,m2266,i2266i7,m2266m21,m2267,i2267i7,m2267m21,m2268,i2268i7,m2268m21,m2269,i2269i7,m2269m21,m2270,i2270i7,m2270m21
integer::m2271,i2271i7,m2271m21,m2272,i2272i7,m2272m21,m2273,i2273i7,m2273m21,m2274,i2274i7,m2274m21,m2275,i2275i7,m2275m21 &
,m2276,i2276i7,m2276m21,m2277,i2277i7,m2277m21,m2278,i2278i7,m2278m21,m2279,i2279i7,m2279m21,m2280,i2280i7,m2280m21
integer::m2281,i2281i7,m2281m21,m2282,i2282i7,m2282m21,m2283,i2283i7,m2283m21,m2284,i2284i7,m2284m21,m2285,i2285i7,m2285m21 &
,m2286,i2286i7,m2286m21,m2287,i2287i7,m2287m21,m2288,i2288i7,m2288m21,m2289,i2289i7,m2289m21,m2290,i2290i7,m2290m21
integer::m2291,i2291i7,m2291m21,m2292,i2292i7,m2292m21,m2293,i2293i7,m2293m21,m2294,i2294i7,m2294m21,m2295,i2295i7,m2295m21 &
,m2296,i2296i7,m2296m21,m2297,i2297i7,m2297m21,m2298,i2298i7,m2298m21,m2299,i2299i7,m2299m21,m2300,i2300i7,m2300m21
integer::m2301,i2301i7,m2301m21,m2302,i2302i7,m2302m21,m2303,i2303i7,m2303m21,m2304,i2304i7,m2304m21,m2305,i2305i7,m2305m21 &
,m2306,i2306i7,m2306m21,m2307,i2307i7,m2307m21,m2308,i2308i7,m2308m21,m2309,i2309i7,m2309m21,m2310,i2310i7,m2310m21
integer::m2311,i2311i7,m2311m21,m2312,i2312i7,m2312m21,m2313,i2313i7,m2313m21,m2314,i2314i7,m2314m21,m2315,i2315i7,m2315m21 &
,m2316,i2316i7,m2316m21,m2317,i2317i7,m2317m21,m2318,i2318i7,m2318m21,m2319,i2319i7,m2319m21,m2320,i2320i7,m2320m21
integer::m2321,i2321i7,m2321m21,m2322,i2322i7,m2322m21,m2323,i2323i7,m2323m21,m2324,i2324i7,m2324m21,m2325,i2325i7,m2325m21 &
,m2326,i2326i7,m2326m21,m2327,i2327i7,m2327m21,m2328,i2328i7,m2328m21,m2329,i2329i7,m2329m21,m2330,i2330i7,m2330m21
integer::m2331,i2331i7,m2331m21,m2332,i2332i7,m2332m21,m2333,i2333i7,m2333m21,m2334,i2334i7,m2334m21,m2335,i2335i7,m2335m21 &
,m2336,i2336i7,m2336m21,m2337,i2337i7,m2337m21,m2338,i2338i7,m2338m21,m2339,i2339i7,m2339m21,m2340,i2340i7,m2340m21
integer::m2341,i2341i7,m2341m21,m2342,i2342i7,m2342m21,m2343,i2343i7,m2343m21,m2344,i2344i7,m2344m21,m2345,i2345i7,m2345m21 &
,m2346,i2346i7,m2346m21,m2347,i2347i7,m2347m21,m2348,i2348i7,m2348m21,m2349,i2349i7,m2349m21,m2350,i2350i7,m2350m21
integer::m2351,i2351i7,m2351m21,m2352,i2352i7,m2352m21,m2353,i2353i7,m2353m21,m2354,i2354i7,m2354m21,m2355,i2355i7,m2355m21 &
,m2356,i2356i7,m2356m21,m2357,i2357i7,m2357m21,m2358,i2358i7,m2358m21,m2359,i2359i7,m2359m21,m2360,i2360i7,m2360m21
integer::m2361,i2361i7,m2361m21,m2362,i2362i7,m2362m21,m2363,i2363i7,m2363m21,m2364,i2364i7,m2364m21,m2365,i2365i7,m2365m21 &
,m2366,i2366i7,m2366m21,m2367,i2367i7,m2367m21,m2368,i2368i7,m2368m21,m2369,i2369i7,m2369m21,m2370,i2370i7,m2370m21
integer::m2371,i2371i7,m2371m21,m2372,i2372i7,m2372m21,m2373,i2373i7,m2373m21,m2374,i2374i7,m2374m21,m2375,i2375i7,m2375m21 &
,m2376,i2376i7,m2376m21,m2377,i2377i7,m2377m21,m2378,i2378i7,m2378m21,m2379,i2379i7,m2379m21,m2380,i2380i7,m2380m21
integer::m2381,i2381i7,m2381m21,m2382,i2382i7,m2382m21,m2383,i2383i7,m2383m21,m2384,i2384i7,m2384m21,m2385,i2385i7,m2385m21 &
,m2386,i2386i7,m2386m21,m2387,i2387i7,m2387m21,m2388,i2388i7,m2388m21,m2389,i2389i7,m2389m21,m2390,i2390i7,m2390m21
integer::m2391,i2391i7,m2391m21,m2392,i2392i7,m2392m21,m2393,i2393i7,m2393m21,m2394,i2394i7,m2394m21,m2395,i2395i7,m2395m21 &
,m2396,i2396i7,m2396m21,m2397,i2397i7,m2397m21,m2398,i2398i7,m2398m21,m2399,i2399i7,m2399m21,m2400,i2400i7,m2400m21
integer::m2401,i2401i7,m2401m21,m2402,i2402i7,m2402m21,m2403,i2403i7,m2403m21,m2404,i2404i7,m2404m21,m2405,i2405i7,m2405m21 &
,m2406,i2406i7,m2406m21,m2407,i2407i7,m2407m21,m2408,i2408i7,m2408m21,m2409,i2409i7,m2409m21,m2410,i2410i7,m2410m21
integer::m2411,i2411i7,m2411m21,m2412,i2412i7,m2412m21,m2413,i2413i7,m2413m21,m2414,i2414i7,m2414m21,m2415,i2415i7,m2415m21 &
,m2416,i2416i7,m2416m21,m2417,i2417i7,m2417m21,m2418,i2418i7,m2418m21,m2419,i2419i7,m2419m21,m2420,i2420i7,m2420m21
integer::m2421,i2421i7,m2421m21,m2422,i2422i7,m2422m21,m2423,i2423i7,m2423m21,m2424,i2424i7,m2424m21,m2425,i2425i7,m2425m21 &
,m2426,i2426i7,m2426m21,m2427,i2427i7,m2427m21,m2428,i2428i7,m2428m21,m2429,i2429i7,m2429m21,m2430,i2430i7,m2430m21
integer::m2431,i2431i7,m2431m21,m2432,i2432i7,m2432m21,m2433,i2433i7,m2433m21,m2434,i2434i7,m2434m21,m2435,i2435i7,m2435m21 &
,m2436,i2436i7,m2436m21,m2437,i2437i7,m2437m21,m2438,i2438i7,m2438m21,m2439,i2439i7,m2439m21,m2440,i2440i7,m2440m21
integer::m2441,i2441i7,m2441m21,m2442,i2442i7,m2442m21,m2443,i2443i7,m2443m21,m2444,i2444i7,m2444m21,m2445,i2445i7,m2445m21 &
,m2446,i2446i7,m2446m21,m2447,i2447i7,m2447m21,m2448,i2448i7,m2448m21,m2449,i2449i7,m2449m21,m2450,i2450i7,m2450m21
integer::m2451,i2451i7,m2451m21,m2452,i2452i7,m2452m21,m2453,i2453i7,m2453m21,m2454,i2454i7,m2454m21,m2455,i2455i7,m2455m21 &
,m2456,i2456i7,m2456m21,m2457,i2457i7,m2457m21,m2458,i2458i7,m2458m21,m2459,i2459i7,m2459m21,m2460,i2460i7,m2460m21
integer::m2461,i2461i7,m2461m21,m2462,i2462i7,m2462m21,m2463,i2463i7,m2463m21,m2464,i2464i7,m2464m21,m2465,i2465i7,m2465m21 &
,m2466,i2466i7,m2466m21,m2467,i2467i7,m2467m21,m2468,i2468i7,m2468m21,m2469,i2469i7,m2469m21,m2470,i2470i7,m2470m21
integer::m2471,i2471i7,m2471m21,m2472,i2472i7,m2472m21,m2473,i2473i7,m2473m21,m2474,i2474i7,m2474m21,m2475,i2475i7,m2475m21 &
,m2476,i2476i7,m2476m21,m2477,i2477i7,m2477m21,m2478,i2478i7,m2478m21,m2479,i2479i7,m2479m21,m2480,i2480i7,m2480m21
integer::m2481,i2481i7,m2481m21,m2482,i2482i7,m2482m21,m2483,i2483i7,m2483m21,m2484,i2484i7,m2484m21,m2485,i2485i7,m2485m21 &
,m2486,i2486i7,m2486m21,m2487,i2487i7,m2487m21,m2488,i2488i7,m2488m21,m2489,i2489i7,m2489m21,m2490,i2490i7,m2490m21
integer::m2491,i2491i7,m2491m21,m2492,i2492i7,m2492m21,m2493,i2493i7,m2493m21,m2494,i2494i7,m2494m21,m2495,i2495i7,m2495m21 &
,m2496,i2496i7,m2496m21,m2497,i2497i7,m2497m21,m2498,i2498i7,m2498m21,m2499,i2499i7,m2499m21,m2500,i2500i7,m2500m21
integer::i36i7,i37i7,i38i7,i39i7,i40i7,m224m21,m225,m36,m36m21,m37,m37m21,m38,m38m21,m39,m39m21,m40,m40m21

print*,'enter_symm_xmi_new, symm',symm
Rid=0
mincmplt=0
do i=1,1500
mincmplt_set(i)=0
enddo
ncqss=ncqs
strnn=strn
incmplt=1
mns=0
u1=1
max_set=75000

if(nfset.eq.3.or.nfset.eq.5)then
rumset=0
call rumer_structures(nl,str3,ncqss,rumer,rumer_rad)
call write_rumer_xmi(nl,str3,ncqss,rumer,rumer_rad,quality_fac)
endif

set_number=0
bqlty=0
tqlty=0
sqlty=0
hqlty=0
indpnt=2
!ovlpval=1.0
if(noq0.gt.strnn)then
ttqlty0=noq0
else
ttqlty0=strnn+noq0
endif
ttqlty1=strnn+noq1
ttqlty2=strnn+noq2
ttqlty3=strnn+noq3

write(*,*)'sl  structures           group_numbers'
do i=1,ncqss
write(*,*)i,(str3(i,j),j=1,nae),q_fac2(i)
!write(*,231),i,(str3(i,j),j=1,nae),q_fac2(i),str_quality_1(i),str_quality_2(i),bondq(i)
group_num(i)=q_fac2(i)
enddo
231 format(30I5)

jj=1
do m19=1,ncqss
!print*,'q_fac2',q_fac2(m19)
if(m19.eq.1)qul(1)=q_fac2(1)
j=jj
do i=1,j
if(qul(i).eq.q_fac2(m19))goto 373
enddo
jj=jj+1
qul(i)=q_fac2(m19)
!print*,qul(i)
373 enddo
nqul=jj
print*,'nqul',nqul

do i=1,nqul
jjj=0
jj=0
do m19=1,ncqss
!print*,qul(i),q_fac2(m19)
if(qul(i).eq.q_fac2(m19))then
jjj=jjj+1
jj=m19
endif
enddo
nqset(i)=jjj
strset(i)=jj
print*,'i,nqset(i),strset(i)',i,nqset(i),strset(i)
enddo

flg=0
totstr=0
i7=0
m21=0
i1i7=0
m1m21=0
!i5=ndet
!do i8=1,1000
!finalvec(i8)=0
!enddo
!do m19=1,10000
!do m18=1,15
!str2(m19,m18)=0
!enddo
!enddo


!i5up1=i5
i1i7=i7
m1m21=m21


do m1=1,nqul
!i5=i5up1
!i7=i1i7
!m21=m1m21
i7=0
n21=0

!print*,'loop1'
call write_symm_xmi_1(i7,n21,m1,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 701
if (sf2.eq.1)goto 100

!print*,'i7,m21**',i7,m21
!i5up2=i5
i2i7=i7
m2m21=n21

do m2=m1+1,nqul
!i5=i5up2
i7=i2i7
n21=m2m21

!print*,'loop2'
call write_symm_xmi_1(i7,n21,m2,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 702
if (sf2.eq.1)goto 100

!print*,'22 i7,m21**',i7,m21
!i5up3=i5
i3i7=i7
m3m21=n21

do m3=m2+1,nqul
!i5=i5up3
i7=i3i7
n21=m3m21

!print*,'loop3'
call write_symm_xmi_1(i7,n21,m3,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 703
if (sf2.eq.1)goto 100

!print*,'33 i7,m21**',i7,m21
!stop
!i5up4=i5
i4i7=i7
m4m21=n21

do m4=m3+1,nqul
!i5=i5up4
i7=i4i7
n21=m4m21

!print*,'loop4'
call write_symm_xmi_1(i7,n21,m4,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 704
if (sf2.eq.1)goto 100

!i5up5=i5
i5i7=i7
m5m21=n21

do m5=m4+1,nqul
!i5=i5up5
i7=i5i7
n21=m5m21

!print*,'loop5'
call write_symm_xmi_1(i7,n21,m5,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 705
if (sf2.eq.1)goto 100

!i5up6=i5
i6i7=i7
m6m21=n21

do m6=m5+1,nqul
!i5=i5up6
i7=i6i7
n21=m6m21

!print*,'loop6'
call write_symm_xmi_1(i7,n21,m6,sf1,sf2,str3,q_fac2)
!print*,'sf1,sf2',sf1,sf2
if (sf1.eq.1)goto 706
if (sf2.eq.1)goto 100

!i5up7=i5
i7i7=i7
m7m21=n21

do m7=m6+1,nqul
!i5=i5up7
i7=i7i7
n21=m7m21

!print*,'loop7'
call write_symm_xmi_1(i7,n21,m7,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 707
if (sf2.eq.1)goto 100

!i5up8=i5
i8i7=i7
m8m21=n21

do m8=m7+1,nqul
!i5=i5up8
i7=i8i7
n21=m8m21

!print*,'loop8'
call write_symm_xmi_1(i7,n21,m8,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 708
if (sf2.eq.1)goto 100

!i5up9=i5
i9i7=i7
m9m21=n21

do m9=m8+1,nqul
!i5=i5up9
i7=i9i7
n21=m9m21

!print*,'loop9'
call write_symm_xmi_1(i7,n21,m9,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 709
if (sf2.eq.1)goto 100

!i5up10=i5
i10i7=i7
m10m21=n21

do m10=m9+1,nqul
!i5=i5up10
i7=i10i7
n21=m10m21

!print*,'loop10'
call write_symm_xmi_1(i7,n21,m10,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 710
if (sf2.eq.1)goto 100

!i5up11=i5
i11i7=i7
m11m21=n21

do m11=m10+1,nqul
!i5=i5up11
i7=i11i7
n21=m11m21

!print*,'loop11'
call write_symm_xmi_1(i7,n21,m11,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 711
if (sf2.eq.1)goto 100

!i5up12=i5
i12i7=i7
m12m21=n21

do m12=m11+1,nqul
!i5=i5up12
i7=i12i7
n21=m12m21

print*,'loop12'
call write_symm_xmi_1(i7,n21,m12,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 712
if (sf2.eq.1)goto 100

!i5up13=i5
i13i7=i7
m13m21=n21

do m13=m12+1,nqul
!i5=i5up13
i7=i13i7
n21=m13m21

print*,'loop13'
call write_symm_xmi_1(i7,n21,m13,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 713
if (sf2.eq.1)goto 100

!i5up14=i5
i14i7=i7
m14m21=n21

do m14=m13+1,nqul
!i5=i5up14
i7=i14i7
n21=m14m21

!print*,'loop14',m14,sf1,sf2
!stop
call write_symm_xmi_1(i7,n21,m14,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 714
if (sf2.eq.1)goto 100

!i5up15=i5
i15i7=i7
m15m21=n21

do m15=m14+1,nqul
!i5=i5up15
i7=i15i7
n21=m15m21

print*,'loop15'
call write_symm_xmi_1(i7,n21,m15,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 715
if (sf2.eq.1)goto 100

!i5up16=i5
i16i7=i7
m16m21=n21

do m16=m15+1,nqul
!i5=i5up16
i7=i16i7
n21=m16m21

print*,'loop16'
call write_symm_xmi_1(i7,n21,m16,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 716
if (sf2.eq.1)goto 100

!i5up16=i5
i17i7=i7
m17m21=n21

do m17=m16+1,nqul
!i5=i5up16
i7=i17i7
n21=m17m21

print*,'loop17'
call write_symm_xmi_1(i7,n21,m17,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 717
if (sf2.eq.1)goto 100

!i5up16=i5
i18i7=i7
m18m21=n21

do m18=m17+1,nqul
!i5=i5up16
i7=i18i7
n21=m18m21

print*,'loop18'
call write_symm_xmi_1(i7,n21,m18,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 718
if (sf2.eq.1)goto 100

!i5up16=i5
i19i7=i7
m19m21=n21


do m19=m18+1,nqul
!i5=i5up16
i7=i19i7
n21=m19m21

print*,'loop19'
call write_symm_xmi_1(i7,n21,m19,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 719
if (sf2.eq.1)goto 100

!i5up16=i5
i20i7=i7
m20m21=n21



do m20=m19+1,nqul

i7=i20i7
n21=m20m21

print*,'loop20'
call write_symm_xmi_1(i7,n21,m20,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 720
if (sf2.eq.1)goto 100

i21i7=i7
m21m21=n21

do m21=m20+1,nqul

i7=i21i7
n21=m21m21

print*,'loop21'
call write_symm_xmi_1(i7,n21,m21,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 721
if (sf2.eq.1)goto 100

i22i7=i7
m22m21=n21

do m22=m21+1,nqul

i7=i22i7
n21=m22m21

print*,'loop22'
call write_symm_xmi_1(i7,n21,m22,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 722
if (sf2.eq.1)goto 100

i23i7=i7
m23m21=n21

do m23=m22+1,nqul

i7=i23i7
n21=m23m21

print*,'loop23'
call write_symm_xmi_1(i7,n21,m23,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 723
if (sf2.eq.1)goto 100

i24i7=i7
m24m21=n21

do m24=m23+1,nqul

i7=i24i7
n21=m24m21

print*,'loop24'
call write_symm_xmi_1(i7,n21,m24,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 724
if (sf2.eq.1)goto 100

i25i7=i7
m25m21=n21

do m25=m24+1,nqul

i7=i25i7
n21=m25m21

print*,'loop25'
call write_symm_xmi_1(i7,n21,m25,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 725
if (sf2.eq.1)goto 100

i26i7=i7
m26m21=n21

do m26=m25+1,nqul

i7=i26i7
n21=m26m21

print*,'loop26'
call write_symm_xmi_1(i7,n21,m26,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 726
if (sf2.eq.1)goto 100

i27i7=i7
m27m21=n21

do m27=m26+1,nqul

i7=i27i7
n21=m27m21

print*,'loop27'
call write_symm_xmi_1(i7,n21,m27,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 727
if (sf2.eq.1)goto 100

i28i7=i7
m28m21=n21

do m28=m27+1,nqul

i7=i28i7
n21=m28m21

print*,'loop28'
call write_symm_xmi_1(i7,n21,m28,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 728
if (sf2.eq.1)goto 100

i29i7=i7
m29m21=n21

do m29=m28+1,nqul

i7=i29i7
n21=m29m21

print*,'loop29'
call write_symm_xmi_1(i7,n21,m29,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 729
if (sf2.eq.1)goto 100

i30i7=i7
m30m21=n21

do m30=m29+1,nqul

i7=i30i7
n21=m30m21

print*,'loop30'
call write_symm_xmi_1(i7,n21,m30,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 730
if (sf2.eq.1)goto 100

i31i7=i7
m31m21=n21

do m31=m30+1,nqul

i7=i31i7
n21=m31m21

print*,'loop31'
call write_symm_xmi_1(i7,n21,m31,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 731
if (sf2.eq.1)goto 100

i32i7=i7
m32m21=n21

do m32=m31+1,nqul

i7=i32i7
n21=m32m21

print*,'loop32'
call write_symm_xmi_1(i7,n21,m32,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 732
if (sf2.eq.1)goto 100

i33i7=i7
m33m21=n21

do m33=m32+1,nqul

i7=i33i7
n21=m33m21

print*,'loop33'
call write_symm_xmi_1(i7,n21,m33,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 733
if (sf2.eq.1)goto 100

i34i7=i7
m34m21=n21

do m34=m33+1,nqul

i7=i34i7
n21=m34m21

print*,'loop34'
call write_symm_xmi_1(i7,n21,m34,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 734
if (sf2.eq.1)goto 100

i35i7=i7
m35m21=n21

do m35=m34+1,nqul

i7=i35i7
n21=m35m21

print*,'loop35'
call write_symm_xmi_1(i7,n21,m35,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 735
if (sf2.eq.1)goto 100

i36i7=i7
m36m21=n21

do m36=m35+1,nqul

i7=i36i7
n21=m36m21

print*,'loop36'
call write_symm_xmi_1(i7,n21,m36,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 736
if (sf2.eq.1)goto 100

i37i7=i7
m37m21=n21

do m37=m36+1,nqul

i7=i37i7
n21=m37m21

print*,'loop37'
call write_symm_xmi_1(i7,n21,m37,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 737
if (sf2.eq.1)goto 100

i38i7=i7
m38m21=n21

do m38=m37+1,nqul

i7=i38i7
n21=m38m21

print*,'loop38'
call write_symm_xmi_1(i7,n21,m38,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 738
if (sf2.eq.1)goto 100

i39i7=i7
m39m21=n21

do m39=m38+1,nqul

i7=i39i7
n21=m39m21

print*,'loop39'
call write_symm_xmi_1(i7,n21,m39,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 739
if (sf2.eq.1)goto 100

i40i7=i7
m40m21=n21

do m40=m39+1,nqul

i7=i40i7
n21=m40m21

print*,'loop40'
call write_symm_xmi_1(i7,n21,m40,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 740
if (sf2.eq.1)goto 100

i41i7=i7
m41m21=n21

do m41=m40+1,nqul

i7=i41i7
n21=m41m21

print*,'loop41'
call write_symm_xmi_1(i7,n21,m41,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 741
if (sf2.eq.1)goto 100

i42i7=i7
m42m21=n21

do m42=m41+1,nqul

i7=i42i7
n21=m42m21

print*,'loop42'
call write_symm_xmi_1(i7,n21,m42,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 742
if (sf2.eq.1)goto 100

i43i7=i7
m43m21=n21

do m43=m42+1,nqul

i7=i43i7
n21=m43m21

print*,'loop43'
call write_symm_xmi_1(i7,n21,m43,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 743
if (sf2.eq.1)goto 100

i44i7=i7
m44m21=n21

do m44=m43+1,nqul

i7=i44i7
n21=m44m21

print*,'loop44'
call write_symm_xmi_1(i7,n21,m44,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 744
if (sf2.eq.1)goto 100

i45i7=i7
m45m21=n21

do m45=m44+1,nqul

i7=i45i7
n21=m45m21

print*,'loop45'
call write_symm_xmi_1(i7,n21,m45,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 745
if (sf2.eq.1)goto 100

i46i7=i7
m46m21=n21

do m46=m45+1,nqul

i7=i46i7
n21=m46m21

print*,'loop46'
call write_symm_xmi_1(i7,n21,m46,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 746
if (sf2.eq.1)goto 100

i47i7=i7
m47m21=n21

do m47=m46+1,nqul

i7=i47i7
n21=m47m21

print*,'loop47'
call write_symm_xmi_1(i7,n21,m47,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 747
if (sf2.eq.1)goto 100

i48i7=i7
m48m21=n21

do m48=m47+1,nqul

i7=i48i7
n21=m48m21

print*,'loop48'
call write_symm_xmi_1(i7,n21,m48,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 748
if (sf2.eq.1)goto 100

i49i7=i7
m49m21=n21

do m49=m48+1,nqul

i7=i49i7
n21=m49m21

print*,'loop49'
call write_symm_xmi_1(i7,n21,m49,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 749
if (sf2.eq.1)goto 100

i50i7=i7
m50m21=n21

do m50=m49+1,nqul

i7=i50i7
n21=m50m21

print*,'loop50'
call write_symm_xmi_1(i7,n21,m50,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 750
if (sf2.eq.1)goto 100

i51i7=i7
m51m21=n21

do m51=m50+1,nqul

i7=i51i7
n21=m51m21

print*,'loop51'
call write_symm_xmi_1(i7,n21,m51,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 751
if (sf2.eq.1)goto 100

i52i7=i7
m52m21=n21

do m52=m51+1,nqul

i7=i52i7
n21=m52m21

print*,'loop52'
call write_symm_xmi_1(i7,n21,m52,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 752
if (sf2.eq.1)goto 100

i53i7=i7
m53m21=n21

do m53=m52+1,nqul

i7=i53i7
n21=m53m21

print*,'loop53'
call write_symm_xmi_1(i7,n21,m53,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 753
if (sf2.eq.1)goto 100

i54i7=i7
m54m21=n21

do m54=m53+1,nqul

i7=i54i7
n21=m54m21

print*,'loop54'
call write_symm_xmi_1(i7,n21,m54,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 754
if (sf2.eq.1)goto 100

i55i7=i7
m55m21=n21

do m55=m54+1,nqul

i7=i55i7
n21=m55m21

print*,'loop55'
call write_symm_xmi_1(i7,n21,m55,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 755
if (sf2.eq.1)goto 100

i56i7=i7
m56m21=n21

do m56=m55+1,nqul

i7=i56i7
n21=m56m21

print*,'loop56'
call write_symm_xmi_1(i7,n21,m56,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 756
if (sf2.eq.1)goto 100

i57i7=i7
m57m21=n21

do m57=m56+1,nqul

i7=i57i7
n21=m57m21

print*,'loop57'
call write_symm_xmi_1(i7,n21,m57,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 757
if (sf2.eq.1)goto 100

i58i7=i7
m58m21=n21

do m58=m57+1,nqul

i7=i58i7
n21=m58m21

print*,'loop58'
call write_symm_xmi_1(i7,n21,m58,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 758
if (sf2.eq.1)goto 100

i59i7=i7
m59m21=n21

do m59=m58+1,nqul

i7=i59i7
n21=m59m21

print*,'loop59'
call write_symm_xmi_1(i7,n21,m59,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 759
if (sf2.eq.1)goto 100

i60i7=i7
m60m21=n21

do m60=m59+1,nqul

i7=i60i7
n21=m60m21

print*,'loop60'
call write_symm_xmi_1(i7,n21,m60,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 760
if (sf2.eq.1)goto 100

i61i7=i7
m61m21=n21

do m61=m60+1,nqul

i7=i61i7
n21=m61m21

print*,'loop61'
call write_symm_xmi_1(i7,n21,m61,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 761
if (sf2.eq.1)goto 100

i62i7=i7
m62m21=n21

do m62=m61+1,nqul

i7=i62i7
n21=m62m21

print*,'loop62'
call write_symm_xmi_1(i7,n21,m62,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 762
if (sf2.eq.1)goto 100

i63i7=i7
m63m21=n21

do m63=m62+1,nqul

i7=i63i7
n21=m63m21

print*,'loop63'
call write_symm_xmi_1(i7,n21,m63,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 763
if (sf2.eq.1)goto 100

i64i7=i7
m64m21=n21

do m64=m63+1,nqul

i7=i64i7
n21=m64m21

print*,'loop64'
call write_symm_xmi_1(i7,n21,m64,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 764
if (sf2.eq.1)goto 100

i65i7=i7
m65m21=n21

do m65=m64+1,nqul

i7=i65i7
n21=m65m21

print*,'loop65'
call write_symm_xmi_1(i7,n21,m65,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 765
if (sf2.eq.1)goto 100

i66i7=i7
m66m21=n21

do m66=m65+1,nqul

i7=i66i7
n21=m66m21

print*,'loop66'
call write_symm_xmi_1(i7,n21,m66,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 766
if (sf2.eq.1)goto 100

i67i7=i7
m67m21=n21

do m67=m66+1,nqul

i7=i67i7
n21=m67m21

print*,'loop67'
call write_symm_xmi_1(i7,n21,m67,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 767
if (sf2.eq.1)goto 100

i68i7=i7
m68m21=n21

do m68=m67+1,nqul

i7=i68i7
n21=m68m21

print*,'loop68'
call write_symm_xmi_1(i7,n21,m68,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 768
if (sf2.eq.1)goto 100

i69i7=i7
m69m21=n21

do m69=m68+1,nqul

i7=i69i7
n21=m69m21

print*,'loop69'
call write_symm_xmi_1(i7,n21,m69,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 769
if (sf2.eq.1)goto 100

i70i7=i7
m70m21=n21

do m70=m69+1,nqul

i7=i70i7
n21=m70m21

print*,'loop70'
call write_symm_xmi_1(i7,n21,m70,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 770
if (sf2.eq.1)goto 100

i71i7=i7
m71m21=n21

do m71=m70+1,nqul

i7=i71i7
n21=m71m21

print*,'loop71'
call write_symm_xmi_1(i7,n21,m71,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 771
if (sf2.eq.1)goto 100

i72i7=i7
m72m21=n21

do m72=m71+1,nqul

i7=i72i7
n21=m72m21

print*,'loop72'
call write_symm_xmi_1(i7,n21,m72,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 772
if (sf2.eq.1)goto 100

i73i7=i7
m73m21=n21

do m73=m72+1,nqul

i7=i73i7
n21=m73m21

print*,'loop73'
call write_symm_xmi_1(i7,n21,m73,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 773
if (sf2.eq.1)goto 100

i74i7=i7
m74m21=n21

do m74=m73+1,nqul

i7=i74i7
n21=m74m21

print*,'loop74'
call write_symm_xmi_1(i7,n21,m74,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 774
if (sf2.eq.1)goto 100

i75i7=i7
m75m21=n21

do m75=m74+1,nqul

i7=i75i7
n21=m75m21

print*,'loop75'
call write_symm_xmi_1(i7,n21,m75,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 775
if (sf2.eq.1)goto 100

i76i7=i7
m76m21=n21

do m76=m75+1,nqul

i7=i76i7
n21=m76m21

print*,'loop76'
call write_symm_xmi_1(i7,n21,m76,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 776
if (sf2.eq.1)goto 100

i77i7=i7
m77m21=n21

do m77=m76+1,nqul

i7=i77i7
n21=m77m21

print*,'loop77'
call write_symm_xmi_1(i7,n21,m77,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 777
if (sf2.eq.1)goto 100

i78i7=i7
m78m21=n21

do m78=m77+1,nqul

i7=i78i7
n21=m78m21

print*,'loop78'
call write_symm_xmi_1(i7,n21,m78,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 778
if (sf2.eq.1)goto 100

i79i7=i7
m79m21=n21

do m79=m78+1,nqul

i7=i79i7
n21=m79m21

print*,'loop79'
call write_symm_xmi_1(i7,n21,m79,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 779
if (sf2.eq.1)goto 100

i80i7=i7
m80m21=n21

do m80=m79+1,nqul

i7=i80i7
n21=m80m21

print*,'loop80'
call write_symm_xmi_1(i7,n21,m80,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 780
if (sf2.eq.1)goto 100

i81i7=i7
m81m21=n21

do m81=m80+1,nqul

i7=i81i7
n21=m81m21

print*,'loop81'
call write_symm_xmi_1(i7,n21,m81,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 781
if (sf2.eq.1)goto 100

i82i7=i7
m82m21=n21

do m82=m81+1,nqul

i7=i82i7
n21=m82m21

print*,'loop82'
call write_symm_xmi_1(i7,n21,m82,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 782
if (sf2.eq.1)goto 100

i83i7=i7
m83m21=n21

do m83=m82+1,nqul

i7=i83i7
n21=m83m21

print*,'loop83'
call write_symm_xmi_1(i7,n21,m83,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 783
if (sf2.eq.1)goto 100

i84i7=i7
m84m21=n21

do m84=m83+1,nqul

i7=i84i7
n21=m84m21

print*,'loop84'
call write_symm_xmi_1(i7,n21,m84,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 784
if (sf2.eq.1)goto 100

i85i7=i7
m85m21=n21

do m85=m84+1,nqul

i7=i85i7
n21=m85m21

print*,'loop85'
call write_symm_xmi_1(i7,n21,m85,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 785
if (sf2.eq.1)goto 100

i86i7=i7
m86m21=n21

do m86=m85+1,nqul

i7=i86i7
n21=m86m21

print*,'loop86'
call write_symm_xmi_1(i7,n21,m86,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 786
if (sf2.eq.1)goto 100

i87i7=i7
m87m21=n21

do m87=m86+1,nqul

i7=i87i7
n21=m87m21

print*,'loop87'
call write_symm_xmi_1(i7,n21,m87,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 787
if (sf2.eq.1)goto 100

i88i7=i7
m88m21=n21

do m88=m87+1,nqul

i7=i88i7
n21=m88m21

print*,'loop88'
call write_symm_xmi_1(i7,n21,m88,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 788
if (sf2.eq.1)goto 100

i89i7=i7
m89m21=n21

do m89=m88+1,nqul

i7=i89i7
n21=m89m21

print*,'loop89'
call write_symm_xmi_1(i7,n21,m89,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 789
if (sf2.eq.1)goto 100

i90i7=i7
m90m21=n21

do m90=m89+1,nqul

i7=i90i7
n21=m90m21

print*,'loop90'
call write_symm_xmi_1(i7,n21,m90,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 790
if (sf2.eq.1)goto 100

i91i7=i7
m91m21=n21

do m91=m90+1,nqul

i7=i91i7
n21=m91m21

print*,'loop91'
call write_symm_xmi_1(i7,n21,m91,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 791
if (sf2.eq.1)goto 100

i92i7=i7
m92m21=n21

do m92=m91+1,nqul

i7=i92i7
n21=m92m21

print*,'loop92'
call write_symm_xmi_1(i7,n21,m92,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 792
if (sf2.eq.1)goto 100

i93i7=i7
m93m21=n21

do m93=m92+1,nqul

i7=i93i7
n21=m93m21

print*,'loop93'
call write_symm_xmi_1(i7,n21,m93,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 793
if (sf2.eq.1)goto 100

i94i7=i7
m94m21=n21

do m94=m93+1,nqul

i7=i94i7
n21=m94m21

print*,'loop94'
call write_symm_xmi_1(i7,n21,m94,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 794
if (sf2.eq.1)goto 100

i95i7=i7
m95m21=n21

do m95=m94+1,nqul

i7=i95i7
n21=m95m21

print*,'loop95'
call write_symm_xmi_1(i7,n21,m95,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 795
if (sf2.eq.1)goto 100

i96i7=i7
m96m21=n21

do m96=m95+1,nqul

i7=i96i7
n21=m96m21

print*,'loop96'
call write_symm_xmi_1(i7,n21,m96,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 796
if (sf2.eq.1)goto 100

i97i7=i7
m97m21=n21

do m97=m96+1,nqul

i7=i97i7
n21=m97m21

print*,'loop97'
call write_symm_xmi_1(i7,n21,m97,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 797
if (sf2.eq.1)goto 100

i98i7=i7
m98m21=n21

do m98=m97+1,nqul

i7=i98i7
n21=m98m21

print*,'loop98'
call write_symm_xmi_1(i7,n21,m98,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 798
if (sf2.eq.1)goto 100

i99i7=i7
m99m21=n21

do m99=m98+1,nqul

i7=i99i7
n21=m99m21

print*,'loop99'
call write_symm_xmi_1(i7,n21,m99,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 799
if (sf2.eq.1)goto 100

i100i7=i7
m100m21=n21

do m100=m99+1,nqul

i7=i100i7
n21=m100m21

print*,'loop100'
call write_symm_xmi_1(i7,n21,m100,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 800
if (sf2.eq.1)goto 100

i101i7=i7
m101m21=n21

do m101=m100+1,nqul

i7=i101i7
n21=m101m21

print*,'loop101'
call write_symm_xmi_1(i7,n21,m101,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 801
if (sf2.eq.1)goto 100

i102i7=i7
m102m21=n21

do m102=m101+1,nqul

i7=i102i7
n21=m102m21

print*,'loop102'
call write_symm_xmi_1(i7,n21,m102,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 802
if (sf2.eq.1)goto 100

i103i7=i7
m103m21=n21

do m103=m102+1,nqul

i7=i103i7
n21=m103m21

print*,'loop103'
call write_symm_xmi_1(i7,n21,m103,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 803
if (sf2.eq.1)goto 100

i104i7=i7
m104m21=n21

do m104=m103+1,nqul

i7=i104i7
n21=m104m21

print*,'loop104'
call write_symm_xmi_1(i7,n21,m104,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 804
if (sf2.eq.1)goto 100

i105i7=i7
m105m21=n21

do m105=m104+1,nqul

i7=i105i7
n21=m105m21

print*,'loop105'
call write_symm_xmi_1(i7,n21,m105,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 805
if (sf2.eq.1)goto 100

i106i7=i7
m106m21=n21

do m106=m105+1,nqul

i7=i106i7
n21=m106m21

print*,'loop106'
call write_symm_xmi_1(i7,n21,m106,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 806
if (sf2.eq.1)goto 100

i107i7=i7
m107m21=n21

do m107=m106+1,nqul

i7=i107i7
n21=m107m21

print*,'loop107'
call write_symm_xmi_1(i7,n21,m107,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 807
if (sf2.eq.1)goto 100

i108i7=i7
m108m21=n21

do m108=m107+1,nqul

i7=i108i7
n21=m108m21

print*,'loop108'
call write_symm_xmi_1(i7,n21,m108,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 808
if (sf2.eq.1)goto 100

i109i7=i7
m109m21=n21

do m109=m108+1,nqul

i7=i109i7
n21=m109m21

print*,'loop109'
call write_symm_xmi_1(i7,n21,m109,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 809
if (sf2.eq.1)goto 100

i110i7=i7
m110m21=n21

do m110=m109+1,nqul

i7=i110i7
n21=m110m21

print*,'loop110'
call write_symm_xmi_1(i7,n21,m110,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 810
if (sf2.eq.1)goto 100

i111i7=i7
m111m21=n21

do m111=m110+1,nqul

i7=i111i7
n21=m111m21

print*,'loop111'
call write_symm_xmi_1(i7,n21,m111,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 811
if (sf2.eq.1)goto 100

i112i7=i7
m112m21=n21

do m112=m111+1,nqul

i7=i112i7
n21=m112m21

print*,'loop112'
call write_symm_xmi_1(i7,n21,m112,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 812
if (sf2.eq.1)goto 100

i113i7=i7
m113m21=n21

do m113=m112+1,nqul

i7=i113i7
n21=m113m21

print*,'loop113'
call write_symm_xmi_1(i7,n21,m113,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 813
if (sf2.eq.1)goto 100

i114i7=i7
m114m21=n21

do m114=m113+1,nqul

i7=i114i7
n21=m114m21

print*,'loop114'
call write_symm_xmi_1(i7,n21,m114,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 814
if (sf2.eq.1)goto 100

i115i7=i7
m115m21=n21

do m115=m114+1,nqul

i7=i115i7
n21=m115m21

print*,'loop115'
call write_symm_xmi_1(i7,n21,m115,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 815
if (sf2.eq.1)goto 100

i116i7=i7
m116m21=n21

do m116=m115+1,nqul

i7=i116i7
n21=m116m21

print*,'loop116'
call write_symm_xmi_1(i7,n21,m116,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 816
if (sf2.eq.1)goto 100

i117i7=i7
m117m21=n21

do m117=m116+1,nqul

i7=i117i7
n21=m117m21

print*,'loop117'
call write_symm_xmi_1(i7,n21,m117,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 817
if (sf2.eq.1)goto 100

i118i7=i7
m118m21=n21

do m118=m117+1,nqul

i7=i118i7
n21=m118m21

print*,'loop118'
call write_symm_xmi_1(i7,n21,m118,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 818
if (sf2.eq.1)goto 100

i119i7=i7
m119m21=n21

do m119=m118+1,nqul

i7=i119i7
n21=m119m21

print*,'loop119'
call write_symm_xmi_1(i7,n21,m119,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 819
if (sf2.eq.1)goto 100

i120i7=i7
m120m21=n21

do m120=m119+1,nqul

i7=i120i7
n21=m120m21

print*,'loop120'
call write_symm_xmi_1(i7,n21,m120,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 820
if (sf2.eq.1)goto 100

i121i7=i7
m121m21=n21

do m121=m120+1,nqul

i7=i121i7
n21=m121m21

print*,'loop121'
call write_symm_xmi_1(i7,n21,m121,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 821
if (sf2.eq.1)goto 100

i122i7=i7
m122m21=n21

do m122=m121+1,nqul

i7=i122i7
n21=m122m21

print*,'loop122'
call write_symm_xmi_1(i7,n21,m122,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 822
if (sf2.eq.1)goto 100

i123i7=i7
m123m21=n21

do m123=m122+1,nqul

i7=i123i7
n21=m123m21

print*,'loop123'
call write_symm_xmi_1(i7,n21,m123,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 823
if (sf2.eq.1)goto 100

i124i7=i7
m124m21=n21

do m124=m123+1,nqul

i7=i124i7
n21=m124m21

print*,'loop124'
call write_symm_xmi_1(i7,n21,m124,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 824
if (sf2.eq.1)goto 100

i125i7=i7
m125m21=n21

do m125=m124+1,nqul

i7=i125i7
n21=m125m21

print*,'loop125'
call write_symm_xmi_1(i7,n21,m125,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 825
if (sf2.eq.1)goto 100

i126i7=i7
m126m21=n21

do m126=m125+1,nqul

i7=i126i7
n21=m126m21

print*,'loop126'
call write_symm_xmi_1(i7,n21,m126,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 826
if (sf2.eq.1)goto 100

i127i7=i7
m127m21=n21

do m127=m126+1,nqul

i7=i127i7
n21=m127m21

print*,'loop127'
call write_symm_xmi_1(i7,n21,m127,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 827
if (sf2.eq.1)goto 100

i128i7=i7
m128m21=n21

do m128=m127+1,nqul

i7=i128i7
n21=m128m21

print*,'loop128'
call write_symm_xmi_1(i7,n21,m128,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 828
if (sf2.eq.1)goto 100

i129i7=i7
m129m21=n21

do m129=m128+1,nqul

i7=i129i7
n21=m129m21

print*,'loop129'
call write_symm_xmi_1(i7,n21,m129,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 829
if (sf2.eq.1)goto 100

i130i7=i7
m130m21=n21

do m130=m129+1,nqul

i7=i130i7
n21=m130m21

print*,'loop130'
call write_symm_xmi_1(i7,n21,m130,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 830
if (sf2.eq.1)goto 100

i131i7=i7
m131m21=n21

do m131=m130+1,nqul

i7=i131i7
n21=m131m21

print*,'loop131'
call write_symm_xmi_1(i7,n21,m131,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 831
if (sf2.eq.1)goto 100

i132i7=i7
m132m21=n21

do m132=m131+1,nqul

i7=i132i7
n21=m132m21

print*,'loop132'
call write_symm_xmi_1(i7,n21,m132,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 832
if (sf2.eq.1)goto 100

i133i7=i7
m133m21=n21

do m133=m132+1,nqul

i7=i133i7
n21=m133m21

print*,'loop133'
call write_symm_xmi_1(i7,n21,m133,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 833
if (sf2.eq.1)goto 100

i134i7=i7
m134m21=n21

do m134=m133+1,nqul

i7=i134i7
n21=m134m21

print*,'loop134'
call write_symm_xmi_1(i7,n21,m134,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 834
if (sf2.eq.1)goto 100

i135i7=i7
m135m21=n21

do m135=m134+1,nqul

i7=i135i7
n21=m135m21

print*,'loop135'
call write_symm_xmi_1(i7,n21,m135,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 835
if (sf2.eq.1)goto 100

i136i7=i7
m136m21=n21

do m136=m135+1,nqul

i7=i136i7
n21=m136m21

print*,'loop136'
call write_symm_xmi_1(i7,n21,m136,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 836
if (sf2.eq.1)goto 100

i137i7=i7
m137m21=n21

do m137=m136+1,nqul

i7=i137i7
n21=m137m21

print*,'loop137'
call write_symm_xmi_1(i7,n21,m137,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 837
if (sf2.eq.1)goto 100

i138i7=i7
m138m21=n21

do m138=m137+1,nqul

i7=i138i7
n21=m138m21

print*,'loop138'
call write_symm_xmi_1(i7,n21,m138,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 838
if (sf2.eq.1)goto 100

i139i7=i7
m139m21=n21

do m139=m138+1,nqul

i7=i139i7
n21=m139m21

print*,'loop139'
call write_symm_xmi_1(i7,n21,m139,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 839
if (sf2.eq.1)goto 100

i140i7=i7
m140m21=n21

do m140=m139+1,nqul

i7=i140i7
n21=m140m21

print*,'loop140'
call write_symm_xmi_1(i7,n21,m140,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 840
if (sf2.eq.1)goto 100

i141i7=i7
m141m21=n21

do m141=m140+1,nqul

i7=i141i7
n21=m141m21

print*,'loop141'
call write_symm_xmi_1(i7,n21,m141,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 841
if (sf2.eq.1)goto 100

i142i7=i7
m142m21=n21

do m142=m141+1,nqul

i7=i142i7
n21=m142m21

print*,'loop142'
call write_symm_xmi_1(i7,n21,m142,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 842
if (sf2.eq.1)goto 100

i143i7=i7
m143m21=n21

do m143=m142+1,nqul

i7=i143i7
n21=m143m21

print*,'loop143'
call write_symm_xmi_1(i7,n21,m143,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 843
if (sf2.eq.1)goto 100

i144i7=i7
m144m21=n21

do m144=m143+1,nqul

i7=i144i7
n21=m144m21

print*,'loop144'
call write_symm_xmi_1(i7,n21,m144,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 844
if (sf2.eq.1)goto 100

i145i7=i7
m145m21=n21

do m145=m144+1,nqul

i7=i145i7
n21=m145m21

print*,'loop145'
call write_symm_xmi_1(i7,n21,m145,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 845
if (sf2.eq.1)goto 100

i146i7=i7
m146m21=n21

do m146=m145+1,nqul

i7=i146i7
n21=m146m21

print*,'loop146'
call write_symm_xmi_1(i7,n21,m146,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 846
if (sf2.eq.1)goto 100

i147i7=i7
m147m21=n21

do m147=m146+1,nqul

i7=i147i7
n21=m147m21

print*,'loop147'
call write_symm_xmi_1(i7,n21,m147,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 847
if (sf2.eq.1)goto 100

i148i7=i7
m148m21=n21

do m148=m147+1,nqul

i7=i148i7
n21=m148m21

print*,'loop148'
call write_symm_xmi_1(i7,n21,m148,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 848
if (sf2.eq.1)goto 100

i149i7=i7
m149m21=n21

do m149=m148+1,nqul

i7=i149i7
n21=m149m21

print*,'loop149'
call write_symm_xmi_1(i7,n21,m149,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 849
if (sf2.eq.1)goto 100

i150i7=i7
m150m21=n21

do m150=m149+1,nqul

i7=i150i7
n21=m150m21

print*,'loop150'
call write_symm_xmi_1(i7,n21,m150,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 850
if (sf2.eq.1)goto 100

i151i7=i7
m151m21=n21

do m151=m150+1,nqul

i7=i151i7
n21=m151m21

print*,'loop151'
call write_symm_xmi_1(i7,n21,m151,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 851
if (sf2.eq.1)goto 100

i152i7=i7
m152m21=n21

do m152=m151+1,nqul

i7=i152i7
n21=m152m21

print*,'loop152'
call write_symm_xmi_1(i7,n21,m152,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 852
if (sf2.eq.1)goto 100

i153i7=i7
m153m21=n21

do m153=m152+1,nqul

i7=i153i7
n21=m153m21

print*,'loop153'
call write_symm_xmi_1(i7,n21,m153,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 853
if (sf2.eq.1)goto 100

i154i7=i7
m154m21=n21

do m154=m153+1,nqul

i7=i154i7
n21=m154m21

print*,'loop154'
call write_symm_xmi_1(i7,n21,m154,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 854
if (sf2.eq.1)goto 100

i155i7=i7
m155m21=n21

do m155=m154+1,nqul

i7=i155i7
n21=m155m21

print*,'loop155'
call write_symm_xmi_1(i7,n21,m155,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 855
if (sf2.eq.1)goto 100

i156i7=i7
m156m21=n21

do m156=m155+1,nqul

i7=i156i7
n21=m156m21

print*,'loop156'
call write_symm_xmi_1(i7,n21,m156,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 856
if (sf2.eq.1)goto 100

i157i7=i7
m157m21=n21

do m157=m156+1,nqul

i7=i157i7
n21=m157m21

print*,'loop157'
call write_symm_xmi_1(i7,n21,m157,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 857
if (sf2.eq.1)goto 100

i158i7=i7
m158m21=n21

do m158=m157+1,nqul

i7=i158i7
n21=m158m21

print*,'loop158'
call write_symm_xmi_1(i7,n21,m158,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 858
if (sf2.eq.1)goto 100

i159i7=i7
m159m21=n21

do m159=m158+1,nqul

i7=i159i7
n21=m159m21

print*,'loop159'
call write_symm_xmi_1(i7,n21,m159,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 859
if (sf2.eq.1)goto 100

i160i7=i7
m160m21=n21

do m160=m159+1,nqul

i7=i160i7
n21=m160m21

print*,'loop160'
call write_symm_xmi_1(i7,n21,m160,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 860
if (sf2.eq.1)goto 100

i161i7=i7
m161m21=n21

do m161=m160+1,nqul

i7=i161i7
n21=m161m21

print*,'loop161'
call write_symm_xmi_1(i7,n21,m161,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 861
if (sf2.eq.1)goto 100

i162i7=i7
m162m21=n21

do m162=m161+1,nqul

i7=i162i7
n21=m162m21

print*,'loop162'
call write_symm_xmi_1(i7,n21,m162,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 862
if (sf2.eq.1)goto 100

i163i7=i7
m163m21=n21

do m163=m162+1,nqul

i7=i163i7
n21=m163m21

print*,'loop163'
call write_symm_xmi_1(i7,n21,m163,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 863
if (sf2.eq.1)goto 100

i164i7=i7
m164m21=n21

do m164=m163+1,nqul

i7=i164i7
n21=m164m21

print*,'loop164'
call write_symm_xmi_1(i7,n21,m164,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 864
if (sf2.eq.1)goto 100

i165i7=i7
m165m21=n21

do m165=m164+1,nqul

i7=i165i7
n21=m165m21

print*,'loop165'
call write_symm_xmi_1(i7,n21,m165,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 865
if (sf2.eq.1)goto 100

i166i7=i7
m166m21=n21

do m166=m165+1,nqul

i7=i166i7
n21=m166m21

print*,'loop166'
call write_symm_xmi_1(i7,n21,m166,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 866
if (sf2.eq.1)goto 100

i167i7=i7
m167m21=n21

do m167=m166+1,nqul

i7=i167i7
n21=m167m21

print*,'loop167'
call write_symm_xmi_1(i7,n21,m167,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 867
if (sf2.eq.1)goto 100

i168i7=i7
m168m21=n21

do m168=m167+1,nqul

i7=i168i7
n21=m168m21

print*,'loop168'
call write_symm_xmi_1(i7,n21,m168,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 868
if (sf2.eq.1)goto 100

i169i7=i7
m169m21=n21

do m169=m168+1,nqul

i7=i169i7
n21=m169m21

print*,'loop169'
call write_symm_xmi_1(i7,n21,m169,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 869
if (sf2.eq.1)goto 100

i170i7=i7
m170m21=n21

do m170=m169+1,nqul

i7=i170i7
n21=m170m21

print*,'loop170'
call write_symm_xmi_1(i7,n21,m170,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 870
if (sf2.eq.1)goto 100

i171i7=i7
m171m21=n21

do m171=m170+1,nqul

i7=i171i7
n21=m171m21

print*,'loop171'
call write_symm_xmi_1(i7,n21,m171,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 871
if (sf2.eq.1)goto 100

i172i7=i7
m172m21=n21

do m172=m171+1,nqul

i7=i172i7
n21=m172m21

print*,'loop172'
call write_symm_xmi_1(i7,n21,m172,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 872
if (sf2.eq.1)goto 100

i173i7=i7
m173m21=n21

do m173=m172+1,nqul

i7=i173i7
n21=m173m21

print*,'loop173'
call write_symm_xmi_1(i7,n21,m173,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 873
if (sf2.eq.1)goto 100

i174i7=i7
m174m21=n21

do m174=m173+1,nqul

i7=i174i7
n21=m174m21

print*,'loop174'
call write_symm_xmi_1(i7,n21,m174,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 874
if (sf2.eq.1)goto 100

i175i7=i7
m175m21=n21

do m175=m174+1,nqul

i7=i175i7
n21=m175m21

print*,'loop175'
call write_symm_xmi_1(i7,n21,m175,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 875
if (sf2.eq.1)goto 100

i176i7=i7
m176m21=n21

do m176=m175+1,nqul

i7=i176i7
n21=m176m21

print*,'loop176'
call write_symm_xmi_1(i7,n21,m176,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 876
if (sf2.eq.1)goto 100

i177i7=i7
m177m21=n21

do m177=m176+1,nqul

i7=i177i7
n21=m177m21

print*,'loop177'
call write_symm_xmi_1(i7,n21,m177,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 877
if (sf2.eq.1)goto 100

i178i7=i7
m178m21=n21

do m178=m177+1,nqul

i7=i178i7
n21=m178m21

print*,'loop178'
call write_symm_xmi_1(i7,n21,m178,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 878
if (sf2.eq.1)goto 100

i179i7=i7
m179m21=n21

do m179=m178+1,nqul

i7=i179i7
n21=m179m21

print*,'loop179'
call write_symm_xmi_1(i7,n21,m179,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 879
if (sf2.eq.1)goto 100

i180i7=i7
m180m21=n21

do m180=m179+1,nqul

i7=i180i7
n21=m180m21

print*,'loop180'
call write_symm_xmi_1(i7,n21,m180,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 880
if (sf2.eq.1)goto 100

i181i7=i7
m181m21=n21

do m181=m180+1,nqul

i7=i181i7
n21=m181m21

print*,'loop181'
call write_symm_xmi_1(i7,n21,m181,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 881
if (sf2.eq.1)goto 100

i182i7=i7
m182m21=n21

do m182=m181+1,nqul

i7=i182i7
n21=m182m21

print*,'loop182'
call write_symm_xmi_1(i7,n21,m182,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 882
if (sf2.eq.1)goto 100

i183i7=i7
m183m21=n21

do m183=m182+1,nqul

i7=i183i7
n21=m183m21

print*,'loop183'
call write_symm_xmi_1(i7,n21,m183,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 883
if (sf2.eq.1)goto 100

i184i7=i7
m184m21=n21

do m184=m183+1,nqul

i7=i184i7
n21=m184m21

print*,'loop184'
call write_symm_xmi_1(i7,n21,m184,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 884
if (sf2.eq.1)goto 100

i185i7=i7
m185m21=n21

do m185=m184+1,nqul

i7=i185i7
n21=m185m21

print*,'loop185'
call write_symm_xmi_1(i7,n21,m185,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 885
if (sf2.eq.1)goto 100

i186i7=i7
m186m21=n21

do m186=m185+1,nqul

i7=i186i7
n21=m186m21

print*,'loop186'
call write_symm_xmi_1(i7,n21,m186,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 886
if (sf2.eq.1)goto 100

i187i7=i7
m187m21=n21

do m187=m186+1,nqul

i7=i187i7
n21=m187m21

print*,'loop187'
call write_symm_xmi_1(i7,n21,m187,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 887
if (sf2.eq.1)goto 100

i188i7=i7
m188m21=n21

do m188=m187+1,nqul

i7=i188i7
n21=m188m21

print*,'loop188'
call write_symm_xmi_1(i7,n21,m188,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 888
if (sf2.eq.1)goto 100

i189i7=i7
m189m21=n21

do m189=m188+1,nqul

i7=i189i7
n21=m189m21

print*,'loop189'
call write_symm_xmi_1(i7,n21,m189,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 889
if (sf2.eq.1)goto 100

i190i7=i7
m190m21=n21

do m190=m189+1,nqul

i7=i190i7
n21=m190m21

print*,'loop190'
call write_symm_xmi_1(i7,n21,m190,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 890
if (sf2.eq.1)goto 100

i191i7=i7
m191m21=n21

do m191=m190+1,nqul

i7=i191i7
n21=m191m21

print*,'loop191'
call write_symm_xmi_1(i7,n21,m191,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 891
if (sf2.eq.1)goto 100

i192i7=i7
m192m21=n21

do m192=m191+1,nqul

i7=i192i7
n21=m192m21

print*,'loop192'
call write_symm_xmi_1(i7,n21,m192,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 892
if (sf2.eq.1)goto 100

i193i7=i7
m193m21=n21

do m193=m192+1,nqul

i7=i193i7
n21=m193m21

print*,'loop193'
call write_symm_xmi_1(i7,n21,m193,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 893
if (sf2.eq.1)goto 100

i194i7=i7
m194m21=n21

do m194=m193+1,nqul

i7=i194i7
n21=m194m21

print*,'loop194'
call write_symm_xmi_1(i7,n21,m194,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 894
if (sf2.eq.1)goto 100

i195i7=i7
m195m21=n21

do m195=m194+1,nqul

i7=i195i7
n21=m195m21

print*,'loop195'
call write_symm_xmi_1(i7,n21,m195,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 895
if (sf2.eq.1)goto 100

i196i7=i7
m196m21=n21

do m196=m195+1,nqul

i7=i196i7
n21=m196m21

print*,'loop196'
call write_symm_xmi_1(i7,n21,m196,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 896
if (sf2.eq.1)goto 100

i197i7=i7
m197m21=n21

do m197=m196+1,nqul

i7=i197i7
n21=m197m21

print*,'loop197'
call write_symm_xmi_1(i7,n21,m197,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 897
if (sf2.eq.1)goto 100

i198i7=i7
m198m21=n21

do m198=m197+1,nqul

i7=i198i7
n21=m198m21

print*,'loop198'
call write_symm_xmi_1(i7,n21,m198,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 898
if (sf2.eq.1)goto 100

i199i7=i7
m199m21=n21

do m199=m198+1,nqul

i7=i199i7
n21=m199m21

print*,'loop199'
call write_symm_xmi_1(i7,n21,m199,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 899
if (sf2.eq.1)goto 100

i200i7=i7
m200m21=n21

do m200=m199+1,nqul

i7=i200i7
n21=m200m21

print*,'loop200'
call write_symm_xmi_1(i7,n21,m200,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 900
if (sf2.eq.1)goto 100

i201i7=i7
m201m21=n21

do m201=m200+1,nqul

i7=i201i7
n21=m201m21

print*,'loop201'
call write_symm_xmi_1(i7,n21,m201,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 901
if (sf2.eq.1)goto 100

i202i7=i7
m202m21=n21

do m202=m201+1,nqul

i7=i202i7
n21=m202m21

print*,'loop202'
call write_symm_xmi_1(i7,n21,m202,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 902
if (sf2.eq.1)goto 100

i203i7=i7
m203m21=n21

do m203=m202+1,nqul

i7=i203i7
n21=m203m21

print*,'loop203'
call write_symm_xmi_1(i7,n21,m203,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 903
if (sf2.eq.1)goto 100

i204i7=i7
m204m21=n21

do m204=m203+1,nqul

i7=i204i7
n21=m204m21

print*,'loop204'
call write_symm_xmi_1(i7,n21,m204,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 904
if (sf2.eq.1)goto 100

i205i7=i7
m205m21=n21

do m205=m204+1,nqul

i7=i205i7
n21=m205m21

print*,'loop205'
call write_symm_xmi_1(i7,n21,m205,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 905
if (sf2.eq.1)goto 100

i206i7=i7
m206m21=n21

do m206=m205+1,nqul

i7=i206i7
n21=m206m21

print*,'loop206'
call write_symm_xmi_1(i7,n21,m206,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 906
if (sf2.eq.1)goto 100

i207i7=i7
m207m21=n21

do m207=m206+1,nqul

i7=i207i7
n21=m207m21

print*,'loop207'
call write_symm_xmi_1(i7,n21,m207,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 907
if (sf2.eq.1)goto 100

i208i7=i7
m208m21=n21

do m208=m207+1,nqul

i7=i208i7
n21=m208m21

print*,'loop208'
call write_symm_xmi_1(i7,n21,m208,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 908
if (sf2.eq.1)goto 100

i209i7=i7
m209m21=n21

do m209=m208+1,nqul

i7=i209i7
n21=m209m21

print*,'loop209'
call write_symm_xmi_1(i7,n21,m209,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 909
if (sf2.eq.1)goto 100

i210i7=i7
m210m21=n21

do m210=m209+1,nqul

i7=i210i7
n21=m210m21

print*,'loop210'
call write_symm_xmi_1(i7,n21,m210,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 910
if (sf2.eq.1)goto 100

i211i7=i7
m211m21=n21

do m211=m210+1,nqul

i7=i211i7
n21=m211m21

print*,'loop211'
call write_symm_xmi_1(i7,n21,m211,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 911
if (sf2.eq.1)goto 100

i212i7=i7
m212m21=n21

do m212=m211+1,nqul

i7=i212i7
n21=m212m21

print*,'loop212'
call write_symm_xmi_1(i7,n21,m212,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 912
if (sf2.eq.1)goto 100

i213i7=i7
m213m21=n21

do m213=m212+1,nqul

i7=i213i7
n21=m213m21

print*,'loop213'
call write_symm_xmi_1(i7,n21,m213,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 913
if (sf2.eq.1)goto 100

i214i7=i7
m214m21=n21

do m214=m213+1,nqul

i7=i214i7
n21=m214m21

print*,'loop214'
call write_symm_xmi_1(i7,n21,m214,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 914
if (sf2.eq.1)goto 100

i215i7=i7
m215m21=n21

do m215=m214+1,nqul

i7=i215i7
n21=m215m21

print*,'loop215'
call write_symm_xmi_1(i7,n21,m215,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 915
if (sf2.eq.1)goto 100

i216i7=i7
m216m21=n21

do m216=m215+1,nqul

i7=i216i7
n21=m216m21

print*,'loop216'
call write_symm_xmi_1(i7,n21,m216,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 916
if (sf2.eq.1)goto 100

i217i7=i7
m217m21=n21

do m217=m216+1,nqul

i7=i217i7
n21=m217m21

print*,'loop217'
call write_symm_xmi_1(i7,n21,m217,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 917
if (sf2.eq.1)goto 100

i218i7=i7
m218m21=n21

do m218=m217+1,nqul

i7=i218i7
n21=m218m21

print*,'loop218'
call write_symm_xmi_1(i7,n21,m218,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 918
if (sf2.eq.1)goto 100

i219i7=i7
m219m21=n21

do m219=m218+1,nqul

i7=i219i7
n21=m219m21

print*,'loop219'
call write_symm_xmi_1(i7,n21,m219,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 919
if (sf2.eq.1)goto 100

i220i7=i7
m220m21=n21

do m220=m219+1,nqul

i7=i220i7
n21=m220m21

print*,'loop220'
call write_symm_xmi_1(i7,n21,m220,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 920
if (sf2.eq.1)goto 100

i221i7=i7
m221m21=n21

do m221=m220+1,nqul

i7=i221i7
n21=m221m21

print*,'loop221'
call write_symm_xmi_1(i7,n21,m221,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 921
if (sf2.eq.1)goto 100

i222i7=i7
m222m21=n21

do m222=m221+1,nqul

i7=i222i7
n21=m222m21

print*,'loop222'
call write_symm_xmi_1(i7,n21,m222,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 922
if (sf2.eq.1)goto 100

i223i7=i7
m223m21=n21

do m223=m222+1,nqul

i7=i223i7
n21=m223m21

print*,'loop223'
call write_symm_xmi_1(i7,n21,m223,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 923
if (sf2.eq.1)goto 100

i224i7=i7
m224m21=n21

do m224=m223+1,nqul

i7=i224i7
n21=m224m21

print*,'loop224'
call write_symm_xmi_1(i7,n21,m224,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 924
if (sf2.eq.1)goto 100

i225i7=i7
m225m21=n21

do m225=m224+1,nqul

i7=i225i7
n21=m225m21

print*,'loop225'
call write_symm_xmi_1(i7,n21,m225,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 925
if (sf2.eq.1)goto 100

i226i7=i7
m226m21=n21

do m226=m225+1,nqul

i7=i226i7
n21=m226m21

print*,'loop226'
call write_symm_xmi_1(i7,n21,m226,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 926
if (sf2.eq.1)goto 100

i227i7=i7
m227m21=n21

do m227=m226+1,nqul

i7=i227i7
n21=m227m21

print*,'loop227'
call write_symm_xmi_1(i7,n21,m227,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 927
if (sf2.eq.1)goto 100

i228i7=i7
m228m21=n21

do m228=m227+1,nqul

i7=i228i7
n21=m228m21

print*,'loop228'
call write_symm_xmi_1(i7,n21,m228,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 928
if (sf2.eq.1)goto 100

i229i7=i7
m229m21=n21

do m229=m228+1,nqul

i7=i229i7
n21=m229m21

print*,'loop229'
call write_symm_xmi_1(i7,n21,m229,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 929
if (sf2.eq.1)goto 100

i230i7=i7
m230m21=n21

do m230=m229+1,nqul

i7=i230i7
n21=m230m21

print*,'loop230'
call write_symm_xmi_1(i7,n21,m230,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 930
if (sf2.eq.1)goto 100

i231i7=i7
m231m21=n21

do m231=m230+1,nqul

i7=i231i7
n21=m231m21

print*,'loop231'
call write_symm_xmi_1(i7,n21,m231,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 931
if (sf2.eq.1)goto 100

i232i7=i7
m232m21=n21

do m232=m231+1,nqul

i7=i232i7
n21=m232m21

print*,'loop232'
call write_symm_xmi_1(i7,n21,m232,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 932
if (sf2.eq.1)goto 100

i233i7=i7
m233m21=n21

do m233=m232+1,nqul

i7=i233i7
n21=m233m21

print*,'loop233'
call write_symm_xmi_1(i7,n21,m233,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 933
if (sf2.eq.1)goto 100

i234i7=i7
m234m21=n21

do m234=m233+1,nqul

i7=i234i7
n21=m234m21

print*,'loop234'
call write_symm_xmi_1(i7,n21,m234,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 934
if (sf2.eq.1)goto 100

i235i7=i7
m235m21=n21

do m235=m234+1,nqul

i7=i235i7
n21=m235m21

print*,'loop235'
call write_symm_xmi_1(i7,n21,m235,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 935
if (sf2.eq.1)goto 100

i236i7=i7
m236m21=n21

do m236=m235+1,nqul

i7=i236i7
n21=m236m21

print*,'loop236'
call write_symm_xmi_1(i7,n21,m236,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 936
if (sf2.eq.1)goto 100

i237i7=i7
m237m21=n21

do m237=m236+1,nqul

i7=i237i7
n21=m237m21

print*,'loop237'
call write_symm_xmi_1(i7,n21,m237,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 937
if (sf2.eq.1)goto 100

i238i7=i7
m238m21=n21

do m238=m237+1,nqul

i7=i238i7
n21=m238m21

print*,'loop238'
call write_symm_xmi_1(i7,n21,m238,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 938
if (sf2.eq.1)goto 100

i239i7=i7
m239m21=n21

do m239=m238+1,nqul

i7=i239i7
n21=m239m21

print*,'loop239'
call write_symm_xmi_1(i7,n21,m239,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 939
if (sf2.eq.1)goto 100

i240i7=i7
m240m21=n21

do m240=m239+1,nqul

i7=i240i7
n21=m240m21

print*,'loop240'
call write_symm_xmi_1(i7,n21,m240,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 940
if (sf2.eq.1)goto 100

i241i7=i7
m241m21=n21

do m241=m240+1,nqul

i7=i241i7
n21=m241m21

print*,'loop241'
call write_symm_xmi_1(i7,n21,m241,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 941
if (sf2.eq.1)goto 100

i242i7=i7
m242m21=n21

do m242=m241+1,nqul

i7=i242i7
n21=m242m21

print*,'loop242'
call write_symm_xmi_1(i7,n21,m242,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 942
if (sf2.eq.1)goto 100

i243i7=i7
m243m21=n21

do m243=m242+1,nqul

i7=i243i7
n21=m243m21

print*,'loop243'
call write_symm_xmi_1(i7,n21,m243,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 943
if (sf2.eq.1)goto 100

i244i7=i7
m244m21=n21

do m244=m243+1,nqul

i7=i244i7
n21=m244m21

print*,'loop244'
call write_symm_xmi_1(i7,n21,m244,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 944
if (sf2.eq.1)goto 100

i245i7=i7
m245m21=n21

do m245=m244+1,nqul

i7=i245i7
n21=m245m21

print*,'loop245'
call write_symm_xmi_1(i7,n21,m245,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 945
if (sf2.eq.1)goto 100

i246i7=i7
m246m21=n21

do m246=m245+1,nqul

i7=i246i7
n21=m246m21

print*,'loop246'
call write_symm_xmi_1(i7,n21,m246,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 946
if (sf2.eq.1)goto 100

i247i7=i7
m247m21=n21

do m247=m246+1,nqul

i7=i247i7
n21=m247m21

print*,'loop247'
call write_symm_xmi_1(i7,n21,m247,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 947
if (sf2.eq.1)goto 100

i248i7=i7
m248m21=n21

do m248=m247+1,nqul

i7=i248i7
n21=m248m21

print*,'loop248'
call write_symm_xmi_1(i7,n21,m248,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 948
if (sf2.eq.1)goto 100

i249i7=i7
m249m21=n21

do m249=m248+1,nqul

i7=i249i7
n21=m249m21

print*,'loop249'
call write_symm_xmi_1(i7,n21,m249,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 949
if (sf2.eq.1)goto 100

i250i7=i7
m250m21=n21

do m250=m249+1,nqul

i7=i250i7
n21=m250m21

print*,'loop250'
call write_symm_xmi_1(i7,n21,m250,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 950
if (sf2.eq.1)goto 100

i251i7=i7
m251m21=n21

do m251=m250+1,nqul

i7=i251i7
n21=m251m21

print*,'loop251'
call write_symm_xmi_1(i7,n21,m251,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 951
if (sf2.eq.1)goto 100

i252i7=i7
m252m21=n21

do m252=m251+1,nqul

i7=i252i7
n21=m252m21

print*,'loop252'
call write_symm_xmi_1(i7,n21,m252,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 952
if (sf2.eq.1)goto 100

i253i7=i7
m253m21=n21

do m253=m252+1,nqul

i7=i253i7
n21=m253m21

print*,'loop253'
call write_symm_xmi_1(i7,n21,m253,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 953
if (sf2.eq.1)goto 100

i254i7=i7
m254m21=n21

do m254=m253+1,nqul

i7=i254i7
n21=m254m21

print*,'loop254'
call write_symm_xmi_1(i7,n21,m254,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 954
if (sf2.eq.1)goto 100

i255i7=i7
m255m21=n21

do m255=m254+1,nqul

i7=i255i7
n21=m255m21

print*,'loop255'
call write_symm_xmi_1(i7,n21,m255,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 955
if (sf2.eq.1)goto 100

i256i7=i7
m256m21=n21

do m256=m255+1,nqul

i7=i256i7
n21=m256m21

print*,'loop256'
call write_symm_xmi_1(i7,n21,m256,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 956
if (sf2.eq.1)goto 100

i257i7=i7
m257m21=n21

do m257=m256+1,nqul

i7=i257i7
n21=m257m21

print*,'loop257'
call write_symm_xmi_1(i7,n21,m257,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 957
if (sf2.eq.1)goto 100

i258i7=i7
m258m21=n21

do m258=m257+1,nqul

i7=i258i7
n21=m258m21

print*,'loop258'
call write_symm_xmi_1(i7,n21,m258,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 958
if (sf2.eq.1)goto 100

i259i7=i7
m259m21=n21

do m259=m258+1,nqul

i7=i259i7
n21=m259m21

print*,'loop259'
call write_symm_xmi_1(i7,n21,m259,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 959
if (sf2.eq.1)goto 100

i260i7=i7
m260m21=n21

do m260=m259+1,nqul

i7=i260i7
n21=m260m21

print*,'loop260'
call write_symm_xmi_1(i7,n21,m260,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 960
if (sf2.eq.1)goto 100

i261i7=i7
m261m21=n21

do m261=m260+1,nqul

i7=i261i7
n21=m261m21

print*,'loop261'
call write_symm_xmi_1(i7,n21,m261,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 961
if (sf2.eq.1)goto 100

i262i7=i7
m262m21=n21

do m262=m261+1,nqul

i7=i262i7
n21=m262m21

print*,'loop262'
call write_symm_xmi_1(i7,n21,m262,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 962
if (sf2.eq.1)goto 100

i263i7=i7
m263m21=n21

do m263=m262+1,nqul

i7=i263i7
n21=m263m21

print*,'loop263'
call write_symm_xmi_1(i7,n21,m263,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 963
if (sf2.eq.1)goto 100

i264i7=i7
m264m21=n21

do m264=m263+1,nqul

i7=i264i7
n21=m264m21

print*,'loop264'
call write_symm_xmi_1(i7,n21,m264,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 964
if (sf2.eq.1)goto 100

i265i7=i7
m265m21=n21

do m265=m264+1,nqul

i7=i265i7
n21=m265m21

print*,'loop265'
call write_symm_xmi_1(i7,n21,m265,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 965
if (sf2.eq.1)goto 100

i266i7=i7
m266m21=n21

do m266=m265+1,nqul

i7=i266i7
n21=m266m21

print*,'loop266'
call write_symm_xmi_1(i7,n21,m266,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 966
if (sf2.eq.1)goto 100

i267i7=i7
m267m21=n21

do m267=m266+1,nqul

i7=i267i7
n21=m267m21

print*,'loop267'
call write_symm_xmi_1(i7,n21,m267,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 967
if (sf2.eq.1)goto 100

i268i7=i7
m268m21=n21

do m268=m267+1,nqul

i7=i268i7
n21=m268m21

print*,'loop268'
call write_symm_xmi_1(i7,n21,m268,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 968
if (sf2.eq.1)goto 100

i269i7=i7
m269m21=n21

do m269=m268+1,nqul

i7=i269i7
n21=m269m21

print*,'loop269'
call write_symm_xmi_1(i7,n21,m269,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 969
if (sf2.eq.1)goto 100

i270i7=i7
m270m21=n21

do m270=m269+1,nqul

i7=i270i7
n21=m270m21

print*,'loop270'
call write_symm_xmi_1(i7,n21,m270,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 970
if (sf2.eq.1)goto 100

i271i7=i7
m271m21=n21

do m271=m270+1,nqul

i7=i271i7
n21=m271m21

print*,'loop271'
call write_symm_xmi_1(i7,n21,m271,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 971
if (sf2.eq.1)goto 100

i272i7=i7
m272m21=n21

do m272=m271+1,nqul

i7=i272i7
n21=m272m21

print*,'loop272'
call write_symm_xmi_1(i7,n21,m272,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 972
if (sf2.eq.1)goto 100

i273i7=i7
m273m21=n21

do m273=m272+1,nqul

i7=i273i7
n21=m273m21

print*,'loop273'
call write_symm_xmi_1(i7,n21,m273,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 973
if (sf2.eq.1)goto 100

i274i7=i7
m274m21=n21

do m274=m273+1,nqul

i7=i274i7
n21=m274m21

print*,'loop274'
call write_symm_xmi_1(i7,n21,m274,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 974
if (sf2.eq.1)goto 100

i275i7=i7
m275m21=n21

do m275=m274+1,nqul

i7=i275i7
n21=m275m21

print*,'loop275'
call write_symm_xmi_1(i7,n21,m275,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 975
if (sf2.eq.1)goto 100

i276i7=i7
m276m21=n21

do m276=m275+1,nqul

i7=i276i7
n21=m276m21

print*,'loop276'
call write_symm_xmi_1(i7,n21,m276,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 976
if (sf2.eq.1)goto 100

i277i7=i7
m277m21=n21

do m277=m276+1,nqul

i7=i277i7
n21=m277m21

print*,'loop277'
call write_symm_xmi_1(i7,n21,m277,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 977
if (sf2.eq.1)goto 100

i278i7=i7
m278m21=n21

do m278=m277+1,nqul

i7=i278i7
n21=m278m21

print*,'loop278'
call write_symm_xmi_1(i7,n21,m278,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 978
if (sf2.eq.1)goto 100

i279i7=i7
m279m21=n21

do m279=m278+1,nqul

i7=i279i7
n21=m279m21

print*,'loop279'
call write_symm_xmi_1(i7,n21,m279,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 979
if (sf2.eq.1)goto 100

i280i7=i7
m280m21=n21

do m280=m279+1,nqul

i7=i280i7
n21=m280m21

print*,'loop280'
call write_symm_xmi_1(i7,n21,m280,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 980
if (sf2.eq.1)goto 100

i281i7=i7
m281m21=n21

do m281=m280+1,nqul

i7=i281i7
n21=m281m21

print*,'loop281'
call write_symm_xmi_1(i7,n21,m281,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 981
if (sf2.eq.1)goto 100

i282i7=i7
m282m21=n21

do m282=m281+1,nqul

i7=i282i7
n21=m282m21

print*,'loop282'
call write_symm_xmi_1(i7,n21,m282,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 982
if (sf2.eq.1)goto 100

i283i7=i7
m283m21=n21

do m283=m282+1,nqul

i7=i283i7
n21=m283m21

print*,'loop283'
call write_symm_xmi_1(i7,n21,m283,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 983
if (sf2.eq.1)goto 100

i284i7=i7
m284m21=n21

do m284=m283+1,nqul

i7=i284i7
n21=m284m21

print*,'loop284'
call write_symm_xmi_1(i7,n21,m284,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 984
if (sf2.eq.1)goto 100

i285i7=i7
m285m21=n21

do m285=m284+1,nqul

i7=i285i7
n21=m285m21

print*,'loop285'
call write_symm_xmi_1(i7,n21,m285,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 985
if (sf2.eq.1)goto 100

i286i7=i7
m286m21=n21

do m286=m285+1,nqul

i7=i286i7
n21=m286m21

print*,'loop286'
call write_symm_xmi_1(i7,n21,m286,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 986
if (sf2.eq.1)goto 100

i287i7=i7
m287m21=n21

do m287=m286+1,nqul

i7=i287i7
n21=m287m21

print*,'loop287'
call write_symm_xmi_1(i7,n21,m287,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 987
if (sf2.eq.1)goto 100

i288i7=i7
m288m21=n21

do m288=m287+1,nqul

i7=i288i7
n21=m288m21

print*,'loop288'
call write_symm_xmi_1(i7,n21,m288,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 988
if (sf2.eq.1)goto 100

i289i7=i7
m289m21=n21

do m289=m288+1,nqul

i7=i289i7
n21=m289m21

print*,'loop289'
call write_symm_xmi_1(i7,n21,m289,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 989
if (sf2.eq.1)goto 100

i290i7=i7
m290m21=n21

do m290=m289+1,nqul

i7=i290i7
n21=m290m21

print*,'loop290'
call write_symm_xmi_1(i7,n21,m290,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 990
if (sf2.eq.1)goto 100

i291i7=i7
m291m21=n21

do m291=m290+1,nqul

i7=i291i7
n21=m291m21

print*,'loop291'
call write_symm_xmi_1(i7,n21,m291,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 991
if (sf2.eq.1)goto 100

i292i7=i7
m292m21=n21

do m292=m291+1,nqul

i7=i292i7
n21=m292m21

print*,'loop292'
call write_symm_xmi_1(i7,n21,m292,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 992
if (sf2.eq.1)goto 100

i293i7=i7
m293m21=n21

do m293=m292+1,nqul

i7=i293i7
n21=m293m21

print*,'loop293'
call write_symm_xmi_1(i7,n21,m293,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 993
if (sf2.eq.1)goto 100

i294i7=i7
m294m21=n21

do m294=m293+1,nqul

i7=i294i7
n21=m294m21

print*,'loop294'
call write_symm_xmi_1(i7,n21,m294,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 994
if (sf2.eq.1)goto 100

i295i7=i7
m295m21=n21

do m295=m294+1,nqul

i7=i295i7
n21=m295m21

print*,'loop295'
call write_symm_xmi_1(i7,n21,m295,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 995
if (sf2.eq.1)goto 100

i296i7=i7
m296m21=n21

do m296=m295+1,nqul

i7=i296i7
n21=m296m21

print*,'loop296'
call write_symm_xmi_1(i7,n21,m296,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 996
if (sf2.eq.1)goto 100

i297i7=i7
m297m21=n21

do m297=m296+1,nqul

i7=i297i7
n21=m297m21

print*,'loop297'
call write_symm_xmi_1(i7,n21,m297,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 997
if (sf2.eq.1)goto 100

i298i7=i7
m298m21=n21

do m298=m297+1,nqul

i7=i298i7
n21=m298m21

print*,'loop298'
call write_symm_xmi_1(i7,n21,m298,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 998
if (sf2.eq.1)goto 100

i299i7=i7
m299m21=n21

do m299=m298+1,nqul

i7=i299i7
n21=m299m21

print*,'loop299'
call write_symm_xmi_1(i7,n21,m299,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 999
if (sf2.eq.1)goto 100

i300i7=i7
m300m21=n21

do m300=m299+1,nqul

i7=i300i7
n21=m300m21

print*,'loop300'
call write_symm_xmi_1(i7,n21,m300,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1000
if (sf2.eq.1)goto 100

i301i7=i7
m301m21=n21

do m301=m300+1,nqul

i7=i301i7
n21=m301m21

print*,'loop301'
call write_symm_xmi_1(i7,n21,m301,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1001
if (sf2.eq.1)goto 100

i302i7=i7
m302m21=n21

do m302=m301+1,nqul

i7=i302i7
n21=m302m21

print*,'loop302'
call write_symm_xmi_1(i7,n21,m302,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1002
if (sf2.eq.1)goto 100

i303i7=i7
m303m21=n21

do m303=m302+1,nqul

i7=i303i7
n21=m303m21

print*,'loop303'
call write_symm_xmi_1(i7,n21,m303,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1003
if (sf2.eq.1)goto 100

i304i7=i7
m304m21=n21

do m304=m303+1,nqul

i7=i304i7
n21=m304m21

print*,'loop304'
call write_symm_xmi_1(i7,n21,m304,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1004
if (sf2.eq.1)goto 100

i305i7=i7
m305m21=n21

do m305=m304+1,nqul

i7=i305i7
n21=m305m21

print*,'loop305'
call write_symm_xmi_1(i7,n21,m305,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1005
if (sf2.eq.1)goto 100

i306i7=i7
m306m21=n21

do m306=m305+1,nqul

i7=i306i7
n21=m306m21

print*,'loop306'
call write_symm_xmi_1(i7,n21,m306,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1006
if (sf2.eq.1)goto 100

i307i7=i7
m307m21=n21

do m307=m306+1,nqul

i7=i307i7
n21=m307m21

print*,'loop307'
call write_symm_xmi_1(i7,n21,m307,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1007
if (sf2.eq.1)goto 100

i308i7=i7
m308m21=n21

do m308=m307+1,nqul

i7=i308i7
n21=m308m21

print*,'loop308'
call write_symm_xmi_1(i7,n21,m308,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1008
if (sf2.eq.1)goto 100

i309i7=i7
m309m21=n21

do m309=m308+1,nqul

i7=i309i7
n21=m309m21

print*,'loop309'
call write_symm_xmi_1(i7,n21,m309,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1009
if (sf2.eq.1)goto 100

i310i7=i7
m310m21=n21

do m310=m309+1,nqul

i7=i310i7
n21=m310m21

print*,'loop310'
call write_symm_xmi_1(i7,n21,m310,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1010
if (sf2.eq.1)goto 100

i311i7=i7
m311m21=n21

do m311=m310+1,nqul

i7=i311i7
n21=m311m21

print*,'loop311'
call write_symm_xmi_1(i7,n21,m311,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1011
if (sf2.eq.1)goto 100

i312i7=i7
m312m21=n21

do m312=m311+1,nqul

i7=i312i7
n21=m312m21

print*,'loop312'
call write_symm_xmi_1(i7,n21,m312,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1012
if (sf2.eq.1)goto 100

i313i7=i7
m313m21=n21

do m313=m312+1,nqul

i7=i313i7
n21=m313m21

print*,'loop313'
call write_symm_xmi_1(i7,n21,m313,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1013
if (sf2.eq.1)goto 100

i314i7=i7
m314m21=n21

do m314=m313+1,nqul

i7=i314i7
n21=m314m21

print*,'loop314'
call write_symm_xmi_1(i7,n21,m314,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1014
if (sf2.eq.1)goto 100

i315i7=i7
m315m21=n21

do m315=m314+1,nqul

i7=i315i7
n21=m315m21

print*,'loop315'
call write_symm_xmi_1(i7,n21,m315,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1015
if (sf2.eq.1)goto 100

i316i7=i7
m316m21=n21

do m316=m315+1,nqul

i7=i316i7
n21=m316m21

print*,'loop316'
call write_symm_xmi_1(i7,n21,m316,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1016
if (sf2.eq.1)goto 100

i317i7=i7
m317m21=n21

do m317=m316+1,nqul

i7=i317i7
n21=m317m21

print*,'loop317'
call write_symm_xmi_1(i7,n21,m317,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1017
if (sf2.eq.1)goto 100

i318i7=i7
m318m21=n21

do m318=m317+1,nqul

i7=i318i7
n21=m318m21

print*,'loop318'
call write_symm_xmi_1(i7,n21,m318,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1018
if (sf2.eq.1)goto 100

i319i7=i7
m319m21=n21

do m319=m318+1,nqul

i7=i319i7
n21=m319m21

print*,'loop319'
call write_symm_xmi_1(i7,n21,m319,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1019
if (sf2.eq.1)goto 100

i320i7=i7
m320m21=n21

do m320=m319+1,nqul

i7=i320i7
n21=m320m21

print*,'loop320'
call write_symm_xmi_1(i7,n21,m320,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1020
if (sf2.eq.1)goto 100

i321i7=i7
m321m21=n21

do m321=m320+1,nqul

i7=i321i7
n21=m321m21

print*,'loop321'
call write_symm_xmi_1(i7,n21,m321,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1021
if (sf2.eq.1)goto 100

i322i7=i7
m322m21=n21

do m322=m321+1,nqul

i7=i322i7
n21=m322m21

print*,'loop322'
call write_symm_xmi_1(i7,n21,m322,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1022
if (sf2.eq.1)goto 100

i323i7=i7
m323m21=n21

do m323=m322+1,nqul

i7=i323i7
n21=m323m21

print*,'loop323'
call write_symm_xmi_1(i7,n21,m323,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1023
if (sf2.eq.1)goto 100

i324i7=i7
m324m21=n21

do m324=m323+1,nqul

i7=i324i7
n21=m324m21

print*,'loop324'
call write_symm_xmi_1(i7,n21,m324,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1024
if (sf2.eq.1)goto 100

i325i7=i7
m325m21=n21

do m325=m324+1,nqul

i7=i325i7
n21=m325m21

print*,'loop325'
call write_symm_xmi_1(i7,n21,m325,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1025
if (sf2.eq.1)goto 100

i326i7=i7
m326m21=n21

do m326=m325+1,nqul

i7=i326i7
n21=m326m21

print*,'loop326'
call write_symm_xmi_1(i7,n21,m326,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1026
if (sf2.eq.1)goto 100

i327i7=i7
m327m21=n21

do m327=m326+1,nqul

i7=i327i7
n21=m327m21

print*,'loop327'
call write_symm_xmi_1(i7,n21,m327,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1027
if (sf2.eq.1)goto 100

i328i7=i7
m328m21=n21

do m328=m327+1,nqul

i7=i328i7
n21=m328m21

print*,'loop328'
call write_symm_xmi_1(i7,n21,m328,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1028
if (sf2.eq.1)goto 100

i329i7=i7
m329m21=n21

do m329=m328+1,nqul

i7=i329i7
n21=m329m21

print*,'loop329'
call write_symm_xmi_1(i7,n21,m329,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1029
if (sf2.eq.1)goto 100

i330i7=i7
m330m21=n21

do m330=m329+1,nqul

i7=i330i7
n21=m330m21

print*,'loop330'
call write_symm_xmi_1(i7,n21,m330,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1030
if (sf2.eq.1)goto 100

i331i7=i7
m331m21=n21

do m331=m330+1,nqul

i7=i331i7
n21=m331m21

print*,'loop331'
call write_symm_xmi_1(i7,n21,m331,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1031
if (sf2.eq.1)goto 100

i332i7=i7
m332m21=n21

do m332=m331+1,nqul

i7=i332i7
n21=m332m21

print*,'loop332'
call write_symm_xmi_1(i7,n21,m332,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1032
if (sf2.eq.1)goto 100

i333i7=i7
m333m21=n21

do m333=m332+1,nqul

i7=i333i7
n21=m333m21

print*,'loop333'
call write_symm_xmi_1(i7,n21,m333,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1033
if (sf2.eq.1)goto 100

i334i7=i7
m334m21=n21

do m334=m333+1,nqul

i7=i334i7
n21=m334m21

print*,'loop334'
call write_symm_xmi_1(i7,n21,m334,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1034
if (sf2.eq.1)goto 100

i335i7=i7
m335m21=n21

do m335=m334+1,nqul

i7=i335i7
n21=m335m21

print*,'loop335'
call write_symm_xmi_1(i7,n21,m335,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1035
if (sf2.eq.1)goto 100

i336i7=i7
m336m21=n21

do m336=m335+1,nqul

i7=i336i7
n21=m336m21

print*,'loop336'
call write_symm_xmi_1(i7,n21,m336,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1036
if (sf2.eq.1)goto 100

i337i7=i7
m337m21=n21

do m337=m336+1,nqul

i7=i337i7
n21=m337m21

print*,'loop337'
call write_symm_xmi_1(i7,n21,m337,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1037
if (sf2.eq.1)goto 100

i338i7=i7
m338m21=n21

do m338=m337+1,nqul

i7=i338i7
n21=m338m21

print*,'loop338'
call write_symm_xmi_1(i7,n21,m338,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1038
if (sf2.eq.1)goto 100

i339i7=i7
m339m21=n21

do m339=m338+1,nqul

i7=i339i7
n21=m339m21

print*,'loop339'
call write_symm_xmi_1(i7,n21,m339,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1039
if (sf2.eq.1)goto 100

i340i7=i7
m340m21=n21

do m340=m339+1,nqul

i7=i340i7
n21=m340m21

print*,'loop340'
call write_symm_xmi_1(i7,n21,m340,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1040
if (sf2.eq.1)goto 100

i341i7=i7
m341m21=n21

do m341=m340+1,nqul

i7=i341i7
n21=m341m21

print*,'loop341'
call write_symm_xmi_1(i7,n21,m341,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1041
if (sf2.eq.1)goto 100

i342i7=i7
m342m21=n21

do m342=m341+1,nqul

i7=i342i7
n21=m342m21

print*,'loop342'
call write_symm_xmi_1(i7,n21,m342,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1042
if (sf2.eq.1)goto 100

i343i7=i7
m343m21=n21

do m343=m342+1,nqul

i7=i343i7
n21=m343m21

print*,'loop343'
call write_symm_xmi_1(i7,n21,m343,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1043
if (sf2.eq.1)goto 100

i344i7=i7
m344m21=n21

do m344=m343+1,nqul

i7=i344i7
n21=m344m21

print*,'loop344'
call write_symm_xmi_1(i7,n21,m344,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1044
if (sf2.eq.1)goto 100

i345i7=i7
m345m21=n21

do m345=m344+1,nqul

i7=i345i7
n21=m345m21

print*,'loop345'
call write_symm_xmi_1(i7,n21,m345,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1045
if (sf2.eq.1)goto 100

i346i7=i7
m346m21=n21

do m346=m345+1,nqul

i7=i346i7
n21=m346m21

print*,'loop346'
call write_symm_xmi_1(i7,n21,m346,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1046
if (sf2.eq.1)goto 100

i347i7=i7
m347m21=n21

do m347=m346+1,nqul

i7=i347i7
n21=m347m21

print*,'loop347'
call write_symm_xmi_1(i7,n21,m347,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1047
if (sf2.eq.1)goto 100

i348i7=i7
m348m21=n21

do m348=m347+1,nqul

i7=i348i7
n21=m348m21

print*,'loop348'
call write_symm_xmi_1(i7,n21,m348,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1048
if (sf2.eq.1)goto 100

i349i7=i7
m349m21=n21

do m349=m348+1,nqul

i7=i349i7
n21=m349m21

print*,'loop349'
call write_symm_xmi_1(i7,n21,m349,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1049
if (sf2.eq.1)goto 100

i350i7=i7
m350m21=n21

do m350=m349+1,nqul

i7=i350i7
n21=m350m21

print*,'loop350'
call write_symm_xmi_1(i7,n21,m350,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1050
if (sf2.eq.1)goto 100

i351i7=i7
m351m21=n21

do m351=m350+1,nqul

i7=i351i7
n21=m351m21

print*,'loop351'
call write_symm_xmi_1(i7,n21,m351,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1051
if (sf2.eq.1)goto 100

i352i7=i7
m352m21=n21

do m352=m351+1,nqul

i7=i352i7
n21=m352m21

print*,'loop352'
call write_symm_xmi_1(i7,n21,m352,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1052
if (sf2.eq.1)goto 100

i353i7=i7
m353m21=n21

do m353=m352+1,nqul

i7=i353i7
n21=m353m21

print*,'loop353'
call write_symm_xmi_1(i7,n21,m353,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1053
if (sf2.eq.1)goto 100

i354i7=i7
m354m21=n21

do m354=m353+1,nqul

i7=i354i7
n21=m354m21

print*,'loop354'
call write_symm_xmi_1(i7,n21,m354,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1054
if (sf2.eq.1)goto 100

i355i7=i7
m355m21=n21

do m355=m354+1,nqul

i7=i355i7
n21=m355m21

print*,'loop355'
call write_symm_xmi_1(i7,n21,m355,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1055
if (sf2.eq.1)goto 100

i356i7=i7
m356m21=n21

do m356=m355+1,nqul

i7=i356i7
n21=m356m21

print*,'loop356'
call write_symm_xmi_1(i7,n21,m356,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1056
if (sf2.eq.1)goto 100

i357i7=i7
m357m21=n21

do m357=m356+1,nqul

i7=i357i7
n21=m357m21

print*,'loop357'
call write_symm_xmi_1(i7,n21,m357,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1057
if (sf2.eq.1)goto 100

i358i7=i7
m358m21=n21

do m358=m357+1,nqul

i7=i358i7
n21=m358m21

print*,'loop358'
call write_symm_xmi_1(i7,n21,m358,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1058
if (sf2.eq.1)goto 100

i359i7=i7
m359m21=n21

do m359=m358+1,nqul

i7=i359i7
n21=m359m21

print*,'loop359'
call write_symm_xmi_1(i7,n21,m359,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1059
if (sf2.eq.1)goto 100

i360i7=i7
m360m21=n21

do m360=m359+1,nqul

i7=i360i7
n21=m360m21

print*,'loop360'
call write_symm_xmi_1(i7,n21,m360,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1060
if (sf2.eq.1)goto 100

i361i7=i7
m361m21=n21

do m361=m360+1,nqul

i7=i361i7
n21=m361m21

print*,'loop361'
call write_symm_xmi_1(i7,n21,m361,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1061
if (sf2.eq.1)goto 100

i362i7=i7
m362m21=n21

do m362=m361+1,nqul

i7=i362i7
n21=m362m21

print*,'loop362'
call write_symm_xmi_1(i7,n21,m362,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1062
if (sf2.eq.1)goto 100

i363i7=i7
m363m21=n21

do m363=m362+1,nqul

i7=i363i7
n21=m363m21

print*,'loop363'
call write_symm_xmi_1(i7,n21,m363,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1063
if (sf2.eq.1)goto 100

i364i7=i7
m364m21=n21

do m364=m363+1,nqul

i7=i364i7
n21=m364m21

print*,'loop364'
call write_symm_xmi_1(i7,n21,m364,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1064
if (sf2.eq.1)goto 100

i365i7=i7
m365m21=n21

do m365=m364+1,nqul

i7=i365i7
n21=m365m21

print*,'loop365'
call write_symm_xmi_1(i7,n21,m365,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1065
if (sf2.eq.1)goto 100

i366i7=i7
m366m21=n21

do m366=m365+1,nqul

i7=i366i7
n21=m366m21

print*,'loop366'
call write_symm_xmi_1(i7,n21,m366,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1066
if (sf2.eq.1)goto 100

i367i7=i7
m367m21=n21

do m367=m366+1,nqul

i7=i367i7
n21=m367m21

print*,'loop367'
call write_symm_xmi_1(i7,n21,m367,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1067
if (sf2.eq.1)goto 100

i368i7=i7
m368m21=n21

do m368=m367+1,nqul

i7=i368i7
n21=m368m21

print*,'loop368'
call write_symm_xmi_1(i7,n21,m368,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1068
if (sf2.eq.1)goto 100

i369i7=i7
m369m21=n21

do m369=m368+1,nqul

i7=i369i7
n21=m369m21

print*,'loop369'
call write_symm_xmi_1(i7,n21,m369,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1069
if (sf2.eq.1)goto 100

i370i7=i7
m370m21=n21

do m370=m369+1,nqul

i7=i370i7
n21=m370m21

print*,'loop370'
call write_symm_xmi_1(i7,n21,m370,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1070
if (sf2.eq.1)goto 100

i371i7=i7
m371m21=n21

do m371=m370+1,nqul

i7=i371i7
n21=m371m21

print*,'loop371'
call write_symm_xmi_1(i7,n21,m371,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1071
if (sf2.eq.1)goto 100

i372i7=i7
m372m21=n21

do m372=m371+1,nqul

i7=i372i7
n21=m372m21

print*,'loop372'
call write_symm_xmi_1(i7,n21,m372,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1072
if (sf2.eq.1)goto 100

i373i7=i7
m373m21=n21

do m373=m372+1,nqul

i7=i373i7
n21=m373m21

print*,'loop373'
call write_symm_xmi_1(i7,n21,m373,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1073
if (sf2.eq.1)goto 100

i374i7=i7
m374m21=n21

do m374=m373+1,nqul

i7=i374i7
n21=m374m21

print*,'loop374'
call write_symm_xmi_1(i7,n21,m374,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1074
if (sf2.eq.1)goto 100

i375i7=i7
m375m21=n21

do m375=m374+1,nqul

i7=i375i7
n21=m375m21

print*,'loop375'
call write_symm_xmi_1(i7,n21,m375,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1075
if (sf2.eq.1)goto 100

i376i7=i7
m376m21=n21

do m376=m375+1,nqul

i7=i376i7
n21=m376m21

print*,'loop376'
call write_symm_xmi_1(i7,n21,m376,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1076
if (sf2.eq.1)goto 100

i377i7=i7
m377m21=n21

do m377=m376+1,nqul

i7=i377i7
n21=m377m21

print*,'loop377'
call write_symm_xmi_1(i7,n21,m377,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1077
if (sf2.eq.1)goto 100

i378i7=i7
m378m21=n21

do m378=m377+1,nqul

i7=i378i7
n21=m378m21

print*,'loop378'
call write_symm_xmi_1(i7,n21,m378,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1078
if (sf2.eq.1)goto 100

i379i7=i7
m379m21=n21

do m379=m378+1,nqul

i7=i379i7
n21=m379m21

print*,'loop379'
call write_symm_xmi_1(i7,n21,m379,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1079
if (sf2.eq.1)goto 100

i380i7=i7
m380m21=n21

do m380=m379+1,nqul

i7=i380i7
n21=m380m21

print*,'loop380'
call write_symm_xmi_1(i7,n21,m380,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1080
if (sf2.eq.1)goto 100

i381i7=i7
m381m21=n21

do m381=m380+1,nqul

i7=i381i7
n21=m381m21

print*,'loop381'
call write_symm_xmi_1(i7,n21,m381,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1081
if (sf2.eq.1)goto 100

i382i7=i7
m382m21=n21

do m382=m381+1,nqul

i7=i382i7
n21=m382m21

print*,'loop382'
call write_symm_xmi_1(i7,n21,m382,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1082
if (sf2.eq.1)goto 100

i383i7=i7
m383m21=n21

do m383=m382+1,nqul

i7=i383i7
n21=m383m21

print*,'loop383'
call write_symm_xmi_1(i7,n21,m383,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1083
if (sf2.eq.1)goto 100

i384i7=i7
m384m21=n21

do m384=m383+1,nqul

i7=i384i7
n21=m384m21

print*,'loop384'
call write_symm_xmi_1(i7,n21,m384,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1084
if (sf2.eq.1)goto 100

i385i7=i7
m385m21=n21

do m385=m384+1,nqul

i7=i385i7
n21=m385m21

print*,'loop385'
call write_symm_xmi_1(i7,n21,m385,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1085
if (sf2.eq.1)goto 100

i386i7=i7
m386m21=n21

do m386=m385+1,nqul

i7=i386i7
n21=m386m21

print*,'loop386'
call write_symm_xmi_1(i7,n21,m386,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1086
if (sf2.eq.1)goto 100

i387i7=i7
m387m21=n21

do m387=m386+1,nqul

i7=i387i7
n21=m387m21

print*,'loop387'
call write_symm_xmi_1(i7,n21,m387,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1087
if (sf2.eq.1)goto 100

i388i7=i7
m388m21=n21

do m388=m387+1,nqul

i7=i388i7
n21=m388m21

print*,'loop388'
call write_symm_xmi_1(i7,n21,m388,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1088
if (sf2.eq.1)goto 100

i389i7=i7
m389m21=n21

do m389=m388+1,nqul

i7=i389i7
n21=m389m21

print*,'loop389'
call write_symm_xmi_1(i7,n21,m389,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1089
if (sf2.eq.1)goto 100

i390i7=i7
m390m21=n21

do m390=m389+1,nqul

i7=i390i7
n21=m390m21

print*,'loop390'
call write_symm_xmi_1(i7,n21,m390,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1090
if (sf2.eq.1)goto 100

i391i7=i7
m391m21=n21

do m391=m390+1,nqul

i7=i391i7
n21=m391m21

print*,'loop391'
call write_symm_xmi_1(i7,n21,m391,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1091
if (sf2.eq.1)goto 100

i392i7=i7
m392m21=n21

do m392=m391+1,nqul

i7=i392i7
n21=m392m21

print*,'loop392'
call write_symm_xmi_1(i7,n21,m392,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1092
if (sf2.eq.1)goto 100

i393i7=i7
m393m21=n21

do m393=m392+1,nqul

i7=i393i7
n21=m393m21

print*,'loop393'
call write_symm_xmi_1(i7,n21,m393,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1093
if (sf2.eq.1)goto 100

i394i7=i7
m394m21=n21

do m394=m393+1,nqul

i7=i394i7
n21=m394m21

print*,'loop394'
call write_symm_xmi_1(i7,n21,m394,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1094
if (sf2.eq.1)goto 100

i395i7=i7
m395m21=n21

do m395=m394+1,nqul

i7=i395i7
n21=m395m21

print*,'loop395'
call write_symm_xmi_1(i7,n21,m395,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1095
if (sf2.eq.1)goto 100

i396i7=i7
m396m21=n21

do m396=m395+1,nqul

i7=i396i7
n21=m396m21

print*,'loop396'
call write_symm_xmi_1(i7,n21,m396,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1096
if (sf2.eq.1)goto 100

i397i7=i7
m397m21=n21

do m397=m396+1,nqul

i7=i397i7
n21=m397m21

print*,'loop397'
call write_symm_xmi_1(i7,n21,m397,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1097
if (sf2.eq.1)goto 100

i398i7=i7
m398m21=n21

do m398=m397+1,nqul

i7=i398i7
n21=m398m21

print*,'loop398'
call write_symm_xmi_1(i7,n21,m398,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1098
if (sf2.eq.1)goto 100

i399i7=i7
m399m21=n21

do m399=m398+1,nqul

i7=i399i7
n21=m399m21

print*,'loop399'
call write_symm_xmi_1(i7,n21,m399,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1099
if (sf2.eq.1)goto 100

i400i7=i7
m400m21=n21

do m400=m399+1,nqul

i7=i400i7
n21=m400m21

print*,'loop400'
call write_symm_xmi_1(i7,n21,m400,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1100
if (sf2.eq.1)goto 100

i401i7=i7
m401m21=n21

do m401=m400+1,nqul

i7=i401i7
n21=m401m21

print*,'loop401'
call write_symm_xmi_1(i7,n21,m401,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1101
if (sf2.eq.1)goto 100

i402i7=i7
m402m21=n21

do m402=m401+1,nqul

i7=i402i7
n21=m402m21

print*,'loop402'
call write_symm_xmi_1(i7,n21,m402,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1102
if (sf2.eq.1)goto 100

i403i7=i7
m403m21=n21

do m403=m402+1,nqul

i7=i403i7
n21=m403m21

print*,'loop403'
call write_symm_xmi_1(i7,n21,m403,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1103
if (sf2.eq.1)goto 100

i404i7=i7
m404m21=n21

do m404=m403+1,nqul

i7=i404i7
n21=m404m21

print*,'loop404'
call write_symm_xmi_1(i7,n21,m404,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1104
if (sf2.eq.1)goto 100

i405i7=i7
m405m21=n21

do m405=m404+1,nqul

i7=i405i7
n21=m405m21

print*,'loop405'
call write_symm_xmi_1(i7,n21,m405,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1105
if (sf2.eq.1)goto 100

i406i7=i7
m406m21=n21

do m406=m405+1,nqul

i7=i406i7
n21=m406m21

print*,'loop406'
call write_symm_xmi_1(i7,n21,m406,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1106
if (sf2.eq.1)goto 100

i407i7=i7
m407m21=n21

do m407=m406+1,nqul

i7=i407i7
n21=m407m21

print*,'loop407'
call write_symm_xmi_1(i7,n21,m407,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1107
if (sf2.eq.1)goto 100

i408i7=i7
m408m21=n21

do m408=m407+1,nqul

i7=i408i7
n21=m408m21

print*,'loop408'
call write_symm_xmi_1(i7,n21,m408,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1108
if (sf2.eq.1)goto 100

i409i7=i7
m409m21=n21

do m409=m408+1,nqul

i7=i409i7
n21=m409m21

print*,'loop409'
call write_symm_xmi_1(i7,n21,m409,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1109
if (sf2.eq.1)goto 100

i410i7=i7
m410m21=n21

do m410=m409+1,nqul

i7=i410i7
n21=m410m21

print*,'loop410'
call write_symm_xmi_1(i7,n21,m410,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1110
if (sf2.eq.1)goto 100

i411i7=i7
m411m21=n21

do m411=m410+1,nqul

i7=i411i7
n21=m411m21

print*,'loop411'
call write_symm_xmi_1(i7,n21,m411,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1111
if (sf2.eq.1)goto 100

i412i7=i7
m412m21=n21

do m412=m411+1,nqul

i7=i412i7
n21=m412m21

print*,'loop412'
call write_symm_xmi_1(i7,n21,m412,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1112
if (sf2.eq.1)goto 100

i413i7=i7
m413m21=n21

do m413=m412+1,nqul

i7=i413i7
n21=m413m21

print*,'loop413'
call write_symm_xmi_1(i7,n21,m413,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1113
if (sf2.eq.1)goto 100

i414i7=i7
m414m21=n21

do m414=m413+1,nqul

i7=i414i7
n21=m414m21

print*,'loop414'
call write_symm_xmi_1(i7,n21,m414,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1114
if (sf2.eq.1)goto 100

i415i7=i7
m415m21=n21

do m415=m414+1,nqul

i7=i415i7
n21=m415m21

print*,'loop415'
call write_symm_xmi_1(i7,n21,m415,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1115
if (sf2.eq.1)goto 100

i416i7=i7
m416m21=n21

do m416=m415+1,nqul

i7=i416i7
n21=m416m21

print*,'loop416'
call write_symm_xmi_1(i7,n21,m416,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1116
if (sf2.eq.1)goto 100

i417i7=i7
m417m21=n21

do m417=m416+1,nqul

i7=i417i7
n21=m417m21

print*,'loop417'
call write_symm_xmi_1(i7,n21,m417,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1117
if (sf2.eq.1)goto 100

i418i7=i7
m418m21=n21

do m418=m417+1,nqul

i7=i418i7
n21=m418m21

print*,'loop418'
call write_symm_xmi_1(i7,n21,m418,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1118
if (sf2.eq.1)goto 100

i419i7=i7
m419m21=n21

do m419=m418+1,nqul

i7=i419i7
n21=m419m21

print*,'loop419'
call write_symm_xmi_1(i7,n21,m419,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1119
if (sf2.eq.1)goto 100

i420i7=i7
m420m21=n21

do m420=m419+1,nqul

i7=i420i7
n21=m420m21

print*,'loop420'
call write_symm_xmi_1(i7,n21,m420,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1120
if (sf2.eq.1)goto 100

i421i7=i7
m421m21=n21

do m421=m420+1,nqul

i7=i421i7
n21=m421m21

print*,'loop421'
call write_symm_xmi_1(i7,n21,m421,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1121
if (sf2.eq.1)goto 100

i422i7=i7
m422m21=n21

do m422=m421+1,nqul

i7=i422i7
n21=m422m21

print*,'loop422'
call write_symm_xmi_1(i7,n21,m422,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1122
if (sf2.eq.1)goto 100

i423i7=i7
m423m21=n21

do m423=m422+1,nqul

i7=i423i7
n21=m423m21

print*,'loop423'
call write_symm_xmi_1(i7,n21,m423,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1123
if (sf2.eq.1)goto 100

i424i7=i7
m424m21=n21

do m424=m423+1,nqul

i7=i424i7
n21=m424m21

print*,'loop424'
call write_symm_xmi_1(i7,n21,m424,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1124
if (sf2.eq.1)goto 100

i425i7=i7
m425m21=n21

do m425=m424+1,nqul

i7=i425i7
n21=m425m21

print*,'loop425'
call write_symm_xmi_1(i7,n21,m425,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1125
if (sf2.eq.1)goto 100

i426i7=i7
m426m21=n21

do m426=m425+1,nqul

i7=i426i7
n21=m426m21

print*,'loop426'
call write_symm_xmi_1(i7,n21,m426,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1126
if (sf2.eq.1)goto 100

i427i7=i7
m427m21=n21

do m427=m426+1,nqul

i7=i427i7
n21=m427m21

print*,'loop427'
call write_symm_xmi_1(i7,n21,m427,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1127
if (sf2.eq.1)goto 100

i428i7=i7
m428m21=n21

do m428=m427+1,nqul

i7=i428i7
n21=m428m21

print*,'loop428'
call write_symm_xmi_1(i7,n21,m428,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1128
if (sf2.eq.1)goto 100

i429i7=i7
m429m21=n21

do m429=m428+1,nqul

i7=i429i7
n21=m429m21

print*,'loop429'
call write_symm_xmi_1(i7,n21,m429,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1129
if (sf2.eq.1)goto 100

i430i7=i7
m430m21=n21

do m430=m429+1,nqul

i7=i430i7
n21=m430m21

print*,'loop430'
call write_symm_xmi_1(i7,n21,m430,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1130
if (sf2.eq.1)goto 100

i431i7=i7
m431m21=n21

do m431=m430+1,nqul

i7=i431i7
n21=m431m21

print*,'loop431'
call write_symm_xmi_1(i7,n21,m431,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1131
if (sf2.eq.1)goto 100

i432i7=i7
m432m21=n21

do m432=m431+1,nqul

i7=i432i7
n21=m432m21

print*,'loop432'
call write_symm_xmi_1(i7,n21,m432,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1132
if (sf2.eq.1)goto 100

i433i7=i7
m433m21=n21

do m433=m432+1,nqul

i7=i433i7
n21=m433m21

print*,'loop433'
call write_symm_xmi_1(i7,n21,m433,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1133
if (sf2.eq.1)goto 100

i434i7=i7
m434m21=n21

do m434=m433+1,nqul

i7=i434i7
n21=m434m21

print*,'loop434'
call write_symm_xmi_1(i7,n21,m434,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1134
if (sf2.eq.1)goto 100

i435i7=i7
m435m21=n21

do m435=m434+1,nqul

i7=i435i7
n21=m435m21

print*,'loop435'
call write_symm_xmi_1(i7,n21,m435,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1135
if (sf2.eq.1)goto 100

i436i7=i7
m436m21=n21

do m436=m435+1,nqul

i7=i436i7
n21=m436m21

print*,'loop436'
call write_symm_xmi_1(i7,n21,m436,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1136
if (sf2.eq.1)goto 100

i437i7=i7
m437m21=n21

do m437=m436+1,nqul

i7=i437i7
n21=m437m21

print*,'loop437'
call write_symm_xmi_1(i7,n21,m437,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1137
if (sf2.eq.1)goto 100

i438i7=i7
m438m21=n21

do m438=m437+1,nqul

i7=i438i7
n21=m438m21

print*,'loop438'
call write_symm_xmi_1(i7,n21,m438,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1138
if (sf2.eq.1)goto 100

i439i7=i7
m439m21=n21

do m439=m438+1,nqul

i7=i439i7
n21=m439m21

print*,'loop439'
call write_symm_xmi_1(i7,n21,m439,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1139
if (sf2.eq.1)goto 100

i440i7=i7
m440m21=n21

do m440=m439+1,nqul

i7=i440i7
n21=m440m21

print*,'loop440'
call write_symm_xmi_1(i7,n21,m440,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1140
if (sf2.eq.1)goto 100

i441i7=i7
m441m21=n21

do m441=m440+1,nqul

i7=i441i7
n21=m441m21

print*,'loop441'
call write_symm_xmi_1(i7,n21,m441,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1141
if (sf2.eq.1)goto 100

i442i7=i7
m442m21=n21

do m442=m441+1,nqul

i7=i442i7
n21=m442m21

print*,'loop442'
call write_symm_xmi_1(i7,n21,m442,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1142
if (sf2.eq.1)goto 100

i443i7=i7
m443m21=n21

do m443=m442+1,nqul

i7=i443i7
n21=m443m21

print*,'loop443'
call write_symm_xmi_1(i7,n21,m443,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1143
if (sf2.eq.1)goto 100

i444i7=i7
m444m21=n21

do m444=m443+1,nqul

i7=i444i7
n21=m444m21

print*,'loop444'
call write_symm_xmi_1(i7,n21,m444,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1144
if (sf2.eq.1)goto 100

i445i7=i7
m445m21=n21

do m445=m444+1,nqul

i7=i445i7
n21=m445m21

print*,'loop445'
call write_symm_xmi_1(i7,n21,m445,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1145
if (sf2.eq.1)goto 100

i446i7=i7
m446m21=n21

do m446=m445+1,nqul

i7=i446i7
n21=m446m21

print*,'loop446'
call write_symm_xmi_1(i7,n21,m446,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1146
if (sf2.eq.1)goto 100

i447i7=i7
m447m21=n21

do m447=m446+1,nqul

i7=i447i7
n21=m447m21

print*,'loop447'
call write_symm_xmi_1(i7,n21,m447,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1147
if (sf2.eq.1)goto 100

i448i7=i7
m448m21=n21

do m448=m447+1,nqul

i7=i448i7
n21=m448m21

print*,'loop448'
call write_symm_xmi_1(i7,n21,m448,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1148
if (sf2.eq.1)goto 100

i449i7=i7
m449m21=n21

do m449=m448+1,nqul

i7=i449i7
n21=m449m21

print*,'loop449'
call write_symm_xmi_1(i7,n21,m449,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1149
if (sf2.eq.1)goto 100

i450i7=i7
m450m21=n21

do m450=m449+1,nqul

i7=i450i7
n21=m450m21

print*,'loop450'
call write_symm_xmi_1(i7,n21,m450,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1150
if (sf2.eq.1)goto 100

i451i7=i7
m451m21=n21

do m451=m450+1,nqul

i7=i451i7
n21=m451m21

print*,'loop451'
call write_symm_xmi_1(i7,n21,m451,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1151
if (sf2.eq.1)goto 100

i452i7=i7
m452m21=n21

do m452=m451+1,nqul

i7=i452i7
n21=m452m21

print*,'loop452'
call write_symm_xmi_1(i7,n21,m452,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1152
if (sf2.eq.1)goto 100

i453i7=i7
m453m21=n21

do m453=m452+1,nqul

i7=i453i7
n21=m453m21

print*,'loop453'
call write_symm_xmi_1(i7,n21,m453,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1153
if (sf2.eq.1)goto 100

i454i7=i7
m454m21=n21

do m454=m453+1,nqul

i7=i454i7
n21=m454m21

print*,'loop454'
call write_symm_xmi_1(i7,n21,m454,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1154
if (sf2.eq.1)goto 100

i455i7=i7
m455m21=n21

do m455=m454+1,nqul

i7=i455i7
n21=m455m21

print*,'loop455'
call write_symm_xmi_1(i7,n21,m455,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1155
if (sf2.eq.1)goto 100

i456i7=i7
m456m21=n21

do m456=m455+1,nqul

i7=i456i7
n21=m456m21

print*,'loop456'
call write_symm_xmi_1(i7,n21,m456,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1156
if (sf2.eq.1)goto 100

i457i7=i7
m457m21=n21

do m457=m456+1,nqul

i7=i457i7
n21=m457m21

print*,'loop457'
call write_symm_xmi_1(i7,n21,m457,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1157
if (sf2.eq.1)goto 100

i458i7=i7
m458m21=n21

do m458=m457+1,nqul

i7=i458i7
n21=m458m21

print*,'loop458'
call write_symm_xmi_1(i7,n21,m458,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1158
if (sf2.eq.1)goto 100

i459i7=i7
m459m21=n21

do m459=m458+1,nqul

i7=i459i7
n21=m459m21

print*,'loop459'
call write_symm_xmi_1(i7,n21,m459,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1159
if (sf2.eq.1)goto 100

i460i7=i7
m460m21=n21

do m460=m459+1,nqul

i7=i460i7
n21=m460m21

print*,'loop460'
call write_symm_xmi_1(i7,n21,m460,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1160
if (sf2.eq.1)goto 100

i461i7=i7
m461m21=n21

do m461=m460+1,nqul

i7=i461i7
n21=m461m21

print*,'loop461'
call write_symm_xmi_1(i7,n21,m461,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1161
if (sf2.eq.1)goto 100

i462i7=i7
m462m21=n21

do m462=m461+1,nqul

i7=i462i7
n21=m462m21

print*,'loop462'
call write_symm_xmi_1(i7,n21,m462,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1162
if (sf2.eq.1)goto 100

i463i7=i7
m463m21=n21

do m463=m462+1,nqul

i7=i463i7
n21=m463m21

print*,'loop463'
call write_symm_xmi_1(i7,n21,m463,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1163
if (sf2.eq.1)goto 100

i464i7=i7
m464m21=n21

do m464=m463+1,nqul

i7=i464i7
n21=m464m21

print*,'loop464'
call write_symm_xmi_1(i7,n21,m464,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1164
if (sf2.eq.1)goto 100

i465i7=i7
m465m21=n21

do m465=m464+1,nqul

i7=i465i7
n21=m465m21

print*,'loop465'
call write_symm_xmi_1(i7,n21,m465,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1165
if (sf2.eq.1)goto 100

i466i7=i7
m466m21=n21

do m466=m465+1,nqul

i7=i466i7
n21=m466m21

print*,'loop466'
call write_symm_xmi_1(i7,n21,m466,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1166
if (sf2.eq.1)goto 100

i467i7=i7
m467m21=n21

do m467=m466+1,nqul

i7=i467i7
n21=m467m21

print*,'loop467'
call write_symm_xmi_1(i7,n21,m467,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1167
if (sf2.eq.1)goto 100

i468i7=i7
m468m21=n21

do m468=m467+1,nqul

i7=i468i7
n21=m468m21

print*,'loop468'
call write_symm_xmi_1(i7,n21,m468,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1168
if (sf2.eq.1)goto 100

i469i7=i7
m469m21=n21

do m469=m468+1,nqul

i7=i469i7
n21=m469m21

print*,'loop469'
call write_symm_xmi_1(i7,n21,m469,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1169
if (sf2.eq.1)goto 100

i470i7=i7
m470m21=n21

do m470=m469+1,nqul

i7=i470i7
n21=m470m21

print*,'loop470'
call write_symm_xmi_1(i7,n21,m470,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1170
if (sf2.eq.1)goto 100

i471i7=i7
m471m21=n21

do m471=m470+1,nqul

i7=i471i7
n21=m471m21

print*,'loop471'
call write_symm_xmi_1(i7,n21,m471,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1171
if (sf2.eq.1)goto 100

i472i7=i7
m472m21=n21

do m472=m471+1,nqul

i7=i472i7
n21=m472m21

print*,'loop472'
call write_symm_xmi_1(i7,n21,m472,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1172
if (sf2.eq.1)goto 100

i473i7=i7
m473m21=n21

do m473=m472+1,nqul

i7=i473i7
n21=m473m21

print*,'loop473'
call write_symm_xmi_1(i7,n21,m473,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1173
if (sf2.eq.1)goto 100

i474i7=i7
m474m21=n21

do m474=m473+1,nqul

i7=i474i7
n21=m474m21

print*,'loop474'
call write_symm_xmi_1(i7,n21,m474,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1174
if (sf2.eq.1)goto 100

i475i7=i7
m475m21=n21

do m475=m474+1,nqul

i7=i475i7
n21=m475m21

print*,'loop475'
call write_symm_xmi_1(i7,n21,m475,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1175
if (sf2.eq.1)goto 100

i476i7=i7
m476m21=n21

do m476=m475+1,nqul

i7=i476i7
n21=m476m21

print*,'loop476'
call write_symm_xmi_1(i7,n21,m476,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1176
if (sf2.eq.1)goto 100

i477i7=i7
m477m21=n21

do m477=m476+1,nqul

i7=i477i7
n21=m477m21

print*,'loop477'
call write_symm_xmi_1(i7,n21,m477,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1177
if (sf2.eq.1)goto 100

i478i7=i7
m478m21=n21

do m478=m477+1,nqul

i7=i478i7
n21=m478m21

print*,'loop478'
call write_symm_xmi_1(i7,n21,m478,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1178
if (sf2.eq.1)goto 100

i479i7=i7
m479m21=n21

do m479=m478+1,nqul

i7=i479i7
n21=m479m21

print*,'loop479'
call write_symm_xmi_1(i7,n21,m479,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1179
if (sf2.eq.1)goto 100

i480i7=i7
m480m21=n21

do m480=m479+1,nqul

i7=i480i7
n21=m480m21

print*,'loop480'
call write_symm_xmi_1(i7,n21,m480,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1180
if (sf2.eq.1)goto 100

i481i7=i7
m481m21=n21

do m481=m480+1,nqul

i7=i481i7
n21=m481m21

print*,'loop481'
call write_symm_xmi_1(i7,n21,m481,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1181
if (sf2.eq.1)goto 100

i482i7=i7
m482m21=n21

do m482=m481+1,nqul

i7=i482i7
n21=m482m21

print*,'loop482'
call write_symm_xmi_1(i7,n21,m482,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1182
if (sf2.eq.1)goto 100

i483i7=i7
m483m21=n21

do m483=m482+1,nqul

i7=i483i7
n21=m483m21

print*,'loop483'
call write_symm_xmi_1(i7,n21,m483,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1183
if (sf2.eq.1)goto 100

i484i7=i7
m484m21=n21

do m484=m483+1,nqul

i7=i484i7
n21=m484m21

print*,'loop484'
call write_symm_xmi_1(i7,n21,m484,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1184
if (sf2.eq.1)goto 100

i485i7=i7
m485m21=n21

do m485=m484+1,nqul

i7=i485i7
n21=m485m21

print*,'loop485'
call write_symm_xmi_1(i7,n21,m485,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1185
if (sf2.eq.1)goto 100

i486i7=i7
m486m21=n21

do m486=m485+1,nqul

i7=i486i7
n21=m486m21

print*,'loop486'
call write_symm_xmi_1(i7,n21,m486,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1186
if (sf2.eq.1)goto 100

i487i7=i7
m487m21=n21

do m487=m486+1,nqul

i7=i487i7
n21=m487m21

print*,'loop487'
call write_symm_xmi_1(i7,n21,m487,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1187
if (sf2.eq.1)goto 100

i488i7=i7
m488m21=n21

do m488=m487+1,nqul

i7=i488i7
n21=m488m21

print*,'loop488'
call write_symm_xmi_1(i7,n21,m488,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1188
if (sf2.eq.1)goto 100

i489i7=i7
m489m21=n21

do m489=m488+1,nqul

i7=i489i7
n21=m489m21

print*,'loop489'
call write_symm_xmi_1(i7,n21,m489,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1189
if (sf2.eq.1)goto 100

i490i7=i7
m490m21=n21

do m490=m489+1,nqul

i7=i490i7
n21=m490m21

print*,'loop490'
call write_symm_xmi_1(i7,n21,m490,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1190
if (sf2.eq.1)goto 100

i491i7=i7
m491m21=n21

do m491=m490+1,nqul

i7=i491i7
n21=m491m21

print*,'loop491'
call write_symm_xmi_1(i7,n21,m491,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1191
if (sf2.eq.1)goto 100

i492i7=i7
m492m21=n21

do m492=m491+1,nqul

i7=i492i7
n21=m492m21

print*,'loop492'
call write_symm_xmi_1(i7,n21,m492,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1192
if (sf2.eq.1)goto 100

i493i7=i7
m493m21=n21

do m493=m492+1,nqul

i7=i493i7
n21=m493m21

print*,'loop493'
call write_symm_xmi_1(i7,n21,m493,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1193
if (sf2.eq.1)goto 100

i494i7=i7
m494m21=n21

do m494=m493+1,nqul

i7=i494i7
n21=m494m21

print*,'loop494'
call write_symm_xmi_1(i7,n21,m494,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1194
if (sf2.eq.1)goto 100

i495i7=i7
m495m21=n21

do m495=m494+1,nqul

i7=i495i7
n21=m495m21

print*,'loop495'
call write_symm_xmi_1(i7,n21,m495,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1195
if (sf2.eq.1)goto 100

i496i7=i7
m496m21=n21

do m496=m495+1,nqul

i7=i496i7
n21=m496m21

print*,'loop496'
call write_symm_xmi_1(i7,n21,m496,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1196
if (sf2.eq.1)goto 100

i497i7=i7
m497m21=n21

do m497=m496+1,nqul

i7=i497i7
n21=m497m21

print*,'loop497'
call write_symm_xmi_1(i7,n21,m497,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1197
if (sf2.eq.1)goto 100

i498i7=i7
m498m21=n21

do m498=m497+1,nqul

i7=i498i7
n21=m498m21

print*,'loop498'
call write_symm_xmi_1(i7,n21,m498,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1198
if (sf2.eq.1)goto 100

i499i7=i7
m499m21=n21

do m499=m498+1,nqul

i7=i499i7
n21=m499m21

print*,'loop499'
call write_symm_xmi_1(i7,n21,m499,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1199
if (sf2.eq.1)goto 100

i500i7=i7
m500m21=n21

do m500=m499+1,nqul

i7=i500i7
n21=m500m21

print*,'loop500'
call write_symm_xmi_1(i7,n21,m500,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1200
if (sf2.eq.1)goto 100

i501i7=i7
m501m21=n21

do m501=m500+1,nqul

i7=i501i7
n21=m501m21

print*,'loop501'
call write_symm_xmi_1(i7,n21,m501,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1201
if (sf2.eq.1)goto 100

i502i7=i7
m502m21=n21

do m502=m501+1,nqul

i7=i502i7
n21=m502m21

print*,'loop502'
call write_symm_xmi_1(i7,n21,m502,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1202
if (sf2.eq.1)goto 100

i503i7=i7
m503m21=n21

do m503=m502+1,nqul

i7=i503i7
n21=m503m21

print*,'loop503'
call write_symm_xmi_1(i7,n21,m503,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1203
if (sf2.eq.1)goto 100

i504i7=i7
m504m21=n21

do m504=m503+1,nqul

i7=i504i7
n21=m504m21

print*,'loop504'
call write_symm_xmi_1(i7,n21,m504,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1204
if (sf2.eq.1)goto 100

i505i7=i7
m505m21=n21

do m505=m504+1,nqul

i7=i505i7
n21=m505m21

print*,'loop505'
call write_symm_xmi_1(i7,n21,m505,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1205
if (sf2.eq.1)goto 100

i506i7=i7
m506m21=n21

do m506=m505+1,nqul

i7=i506i7
n21=m506m21

print*,'loop506'
call write_symm_xmi_1(i7,n21,m506,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1206
if (sf2.eq.1)goto 100

i507i7=i7
m507m21=n21

do m507=m506+1,nqul

i7=i507i7
n21=m507m21

print*,'loop507'
call write_symm_xmi_1(i7,n21,m507,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1207
if (sf2.eq.1)goto 100

i508i7=i7
m508m21=n21

do m508=m507+1,nqul

i7=i508i7
n21=m508m21

print*,'loop508'
call write_symm_xmi_1(i7,n21,m508,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1208
if (sf2.eq.1)goto 100

i509i7=i7
m509m21=n21

do m509=m508+1,nqul

i7=i509i7
n21=m509m21

print*,'loop509'
call write_symm_xmi_1(i7,n21,m509,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1209
if (sf2.eq.1)goto 100

i510i7=i7
m510m21=n21

do m510=m509+1,nqul

i7=i510i7
n21=m510m21

print*,'loop510'
call write_symm_xmi_1(i7,n21,m510,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1210
if (sf2.eq.1)goto 100

i511i7=i7
m511m21=n21

do m511=m510+1,nqul

i7=i511i7
n21=m511m21

print*,'loop511'
call write_symm_xmi_1(i7,n21,m511,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1211
if (sf2.eq.1)goto 100

i512i7=i7
m512m21=n21

do m512=m511+1,nqul

i7=i512i7
n21=m512m21

print*,'loop512'
call write_symm_xmi_1(i7,n21,m512,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1212
if (sf2.eq.1)goto 100

i513i7=i7
m513m21=n21

do m513=m512+1,nqul

i7=i513i7
n21=m513m21

print*,'loop513'
call write_symm_xmi_1(i7,n21,m513,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1213
if (sf2.eq.1)goto 100

i514i7=i7
m514m21=n21

do m514=m513+1,nqul

i7=i514i7
n21=m514m21

print*,'loop514'
call write_symm_xmi_1(i7,n21,m514,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1214
if (sf2.eq.1)goto 100

i515i7=i7
m515m21=n21

do m515=m514+1,nqul

i7=i515i7
n21=m515m21

print*,'loop515'
call write_symm_xmi_1(i7,n21,m515,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1215
if (sf2.eq.1)goto 100

i516i7=i7
m516m21=n21

do m516=m515+1,nqul

i7=i516i7
n21=m516m21

print*,'loop516'
call write_symm_xmi_1(i7,n21,m516,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1216
if (sf2.eq.1)goto 100

i517i7=i7
m517m21=n21

do m517=m516+1,nqul

i7=i517i7
n21=m517m21

print*,'loop517'
call write_symm_xmi_1(i7,n21,m517,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1217
if (sf2.eq.1)goto 100

i518i7=i7
m518m21=n21

do m518=m517+1,nqul

i7=i518i7
n21=m518m21

print*,'loop518'
call write_symm_xmi_1(i7,n21,m518,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1218
if (sf2.eq.1)goto 100

i519i7=i7
m519m21=n21

do m519=m518+1,nqul

i7=i519i7
n21=m519m21

print*,'loop519'
call write_symm_xmi_1(i7,n21,m519,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1219
if (sf2.eq.1)goto 100

i520i7=i7
m520m21=n21

do m520=m519+1,nqul

i7=i520i7
n21=m520m21

print*,'loop520'
call write_symm_xmi_1(i7,n21,m520,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1220
if (sf2.eq.1)goto 100

i521i7=i7
m521m21=n21

do m521=m520+1,nqul

i7=i521i7
n21=m521m21

print*,'loop521'
call write_symm_xmi_1(i7,n21,m521,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1221
if (sf2.eq.1)goto 100

i522i7=i7
m522m21=n21

do m522=m521+1,nqul

i7=i522i7
n21=m522m21

print*,'loop522'
call write_symm_xmi_1(i7,n21,m522,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1222
if (sf2.eq.1)goto 100

i523i7=i7
m523m21=n21

do m523=m522+1,nqul

i7=i523i7
n21=m523m21

print*,'loop523'
call write_symm_xmi_1(i7,n21,m523,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1223
if (sf2.eq.1)goto 100

i524i7=i7
m524m21=n21

do m524=m523+1,nqul

i7=i524i7
n21=m524m21

print*,'loop524'
call write_symm_xmi_1(i7,n21,m524,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1224
if (sf2.eq.1)goto 100

i525i7=i7
m525m21=n21

do m525=m524+1,nqul

i7=i525i7
n21=m525m21

print*,'loop525'
call write_symm_xmi_1(i7,n21,m525,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1225
if (sf2.eq.1)goto 100

i526i7=i7
m526m21=n21

do m526=m525+1,nqul

i7=i526i7
n21=m526m21

print*,'loop526'
call write_symm_xmi_1(i7,n21,m526,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1226
if (sf2.eq.1)goto 100

i527i7=i7
m527m21=n21

do m527=m526+1,nqul

i7=i527i7
n21=m527m21

print*,'loop527'
call write_symm_xmi_1(i7,n21,m527,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1227
if (sf2.eq.1)goto 100

i528i7=i7
m528m21=n21

do m528=m527+1,nqul

i7=i528i7
n21=m528m21

print*,'loop528'
call write_symm_xmi_1(i7,n21,m528,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1228
if (sf2.eq.1)goto 100

i529i7=i7
m529m21=n21

do m529=m528+1,nqul

i7=i529i7
n21=m529m21

print*,'loop529'
call write_symm_xmi_1(i7,n21,m529,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1229
if (sf2.eq.1)goto 100

i530i7=i7
m530m21=n21

do m530=m529+1,nqul

i7=i530i7
n21=m530m21

print*,'loop530'
call write_symm_xmi_1(i7,n21,m530,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1230
if (sf2.eq.1)goto 100

i531i7=i7
m531m21=n21

do m531=m530+1,nqul

i7=i531i7
n21=m531m21

print*,'loop531'
call write_symm_xmi_1(i7,n21,m531,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1231
if (sf2.eq.1)goto 100

i532i7=i7
m532m21=n21

do m532=m531+1,nqul

i7=i532i7
n21=m532m21

print*,'loop532'
call write_symm_xmi_1(i7,n21,m532,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1232
if (sf2.eq.1)goto 100

i533i7=i7
m533m21=n21

do m533=m532+1,nqul

i7=i533i7
n21=m533m21

print*,'loop533'
call write_symm_xmi_1(i7,n21,m533,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1233
if (sf2.eq.1)goto 100

i534i7=i7
m534m21=n21

do m534=m533+1,nqul

i7=i534i7
n21=m534m21

print*,'loop534'
call write_symm_xmi_1(i7,n21,m534,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1234
if (sf2.eq.1)goto 100

i535i7=i7
m535m21=n21

do m535=m534+1,nqul

i7=i535i7
n21=m535m21

print*,'loop535'
call write_symm_xmi_1(i7,n21,m535,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1235
if (sf2.eq.1)goto 100

i536i7=i7
m536m21=n21

do m536=m535+1,nqul

i7=i536i7
n21=m536m21

print*,'loop536'
call write_symm_xmi_1(i7,n21,m536,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1236
if (sf2.eq.1)goto 100

i537i7=i7
m537m21=n21

do m537=m536+1,nqul

i7=i537i7
n21=m537m21

print*,'loop537'
call write_symm_xmi_1(i7,n21,m537,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1237
if (sf2.eq.1)goto 100

i538i7=i7
m538m21=n21

do m538=m537+1,nqul

i7=i538i7
n21=m538m21

print*,'loop538'
call write_symm_xmi_1(i7,n21,m538,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1238
if (sf2.eq.1)goto 100

i539i7=i7
m539m21=n21

do m539=m538+1,nqul

i7=i539i7
n21=m539m21

print*,'loop539'
call write_symm_xmi_1(i7,n21,m539,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1239
if (sf2.eq.1)goto 100

i540i7=i7
m540m21=n21

do m540=m539+1,nqul

i7=i540i7
n21=m540m21

print*,'loop540'
call write_symm_xmi_1(i7,n21,m540,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1240
if (sf2.eq.1)goto 100

i541i7=i7
m541m21=n21

do m541=m540+1,nqul

i7=i541i7
n21=m541m21

print*,'loop541'
call write_symm_xmi_1(i7,n21,m541,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1241
if (sf2.eq.1)goto 100

i542i7=i7
m542m21=n21

do m542=m541+1,nqul

i7=i542i7
n21=m542m21

print*,'loop542'
call write_symm_xmi_1(i7,n21,m542,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1242
if (sf2.eq.1)goto 100

i543i7=i7
m543m21=n21

do m543=m542+1,nqul

i7=i543i7
n21=m543m21

print*,'loop543'
call write_symm_xmi_1(i7,n21,m543,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1243
if (sf2.eq.1)goto 100

i544i7=i7
m544m21=n21

do m544=m543+1,nqul

i7=i544i7
n21=m544m21

print*,'loop544'
call write_symm_xmi_1(i7,n21,m544,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1244
if (sf2.eq.1)goto 100

i545i7=i7
m545m21=n21

do m545=m544+1,nqul

i7=i545i7
n21=m545m21

print*,'loop545'
call write_symm_xmi_1(i7,n21,m545,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1245
if (sf2.eq.1)goto 100

i546i7=i7
m546m21=n21

do m546=m545+1,nqul

i7=i546i7
n21=m546m21

print*,'loop546'
call write_symm_xmi_1(i7,n21,m546,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1246
if (sf2.eq.1)goto 100

i547i7=i7
m547m21=n21

do m547=m546+1,nqul

i7=i547i7
n21=m547m21

print*,'loop547'
call write_symm_xmi_1(i7,n21,m547,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1247
if (sf2.eq.1)goto 100

i548i7=i7
m548m21=n21

do m548=m547+1,nqul

i7=i548i7
n21=m548m21

print*,'loop548'
call write_symm_xmi_1(i7,n21,m548,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1248
if (sf2.eq.1)goto 100

i549i7=i7
m549m21=n21

do m549=m548+1,nqul

i7=i549i7
n21=m549m21

print*,'loop549'
call write_symm_xmi_1(i7,n21,m549,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1249
if (sf2.eq.1)goto 100

i550i7=i7
m550m21=n21

do m550=m549+1,nqul

i7=i550i7
n21=m550m21

print*,'loop550'
call write_symm_xmi_1(i7,n21,m550,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1250
if (sf2.eq.1)goto 100

i551i7=i7
m551m21=n21

do m551=m550+1,nqul

i7=i551i7
n21=m551m21

print*,'loop551'
call write_symm_xmi_1(i7,n21,m551,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1251
if (sf2.eq.1)goto 100

i552i7=i7
m552m21=n21

do m552=m551+1,nqul

i7=i552i7
n21=m552m21

print*,'loop552'
call write_symm_xmi_1(i7,n21,m552,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1252
if (sf2.eq.1)goto 100

i553i7=i7
m553m21=n21

do m553=m552+1,nqul

i7=i553i7
n21=m553m21

print*,'loop553'
call write_symm_xmi_1(i7,n21,m553,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1253
if (sf2.eq.1)goto 100

i554i7=i7
m554m21=n21

do m554=m553+1,nqul

i7=i554i7
n21=m554m21

print*,'loop554'
call write_symm_xmi_1(i7,n21,m554,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1254
if (sf2.eq.1)goto 100

i555i7=i7
m555m21=n21

do m555=m554+1,nqul

i7=i555i7
n21=m555m21

print*,'loop555'
call write_symm_xmi_1(i7,n21,m555,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1255
if (sf2.eq.1)goto 100

i556i7=i7
m556m21=n21

do m556=m555+1,nqul

i7=i556i7
n21=m556m21

print*,'loop556'
call write_symm_xmi_1(i7,n21,m556,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1256
if (sf2.eq.1)goto 100

i557i7=i7
m557m21=n21

do m557=m556+1,nqul

i7=i557i7
n21=m557m21

print*,'loop557'
call write_symm_xmi_1(i7,n21,m557,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1257
if (sf2.eq.1)goto 100

i558i7=i7
m558m21=n21

do m558=m557+1,nqul

i7=i558i7
n21=m558m21

print*,'loop558'
call write_symm_xmi_1(i7,n21,m558,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1258
if (sf2.eq.1)goto 100

i559i7=i7
m559m21=n21

do m559=m558+1,nqul

i7=i559i7
n21=m559m21

print*,'loop559'
call write_symm_xmi_1(i7,n21,m559,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1259
if (sf2.eq.1)goto 100

i560i7=i7
m560m21=n21

do m560=m559+1,nqul

i7=i560i7
n21=m560m21

print*,'loop560'
call write_symm_xmi_1(i7,n21,m560,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1260
if (sf2.eq.1)goto 100

i561i7=i7
m561m21=n21

do m561=m560+1,nqul

i7=i561i7
n21=m561m21

print*,'loop561'
call write_symm_xmi_1(i7,n21,m561,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1261
if (sf2.eq.1)goto 100

i562i7=i7
m562m21=n21

do m562=m561+1,nqul

i7=i562i7
n21=m562m21

print*,'loop562'
call write_symm_xmi_1(i7,n21,m562,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1262
if (sf2.eq.1)goto 100

i563i7=i7
m563m21=n21

do m563=m562+1,nqul

i7=i563i7
n21=m563m21

print*,'loop563'
call write_symm_xmi_1(i7,n21,m563,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1263
if (sf2.eq.1)goto 100

i564i7=i7
m564m21=n21

do m564=m563+1,nqul

i7=i564i7
n21=m564m21

print*,'loop564'
call write_symm_xmi_1(i7,n21,m564,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1264
if (sf2.eq.1)goto 100

i565i7=i7
m565m21=n21

do m565=m564+1,nqul

i7=i565i7
n21=m565m21

print*,'loop565'
call write_symm_xmi_1(i7,n21,m565,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1265
if (sf2.eq.1)goto 100

i566i7=i7
m566m21=n21

do m566=m565+1,nqul

i7=i566i7
n21=m566m21

print*,'loop566'
call write_symm_xmi_1(i7,n21,m566,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1266
if (sf2.eq.1)goto 100

i567i7=i7
m567m21=n21

do m567=m566+1,nqul

i7=i567i7
n21=m567m21

print*,'loop567'
call write_symm_xmi_1(i7,n21,m567,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1267
if (sf2.eq.1)goto 100

i568i7=i7
m568m21=n21

do m568=m567+1,nqul

i7=i568i7
n21=m568m21

print*,'loop568'
call write_symm_xmi_1(i7,n21,m568,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1268
if (sf2.eq.1)goto 100

i569i7=i7
m569m21=n21

do m569=m568+1,nqul

i7=i569i7
n21=m569m21

print*,'loop569'
call write_symm_xmi_1(i7,n21,m569,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1269
if (sf2.eq.1)goto 100

i570i7=i7
m570m21=n21

do m570=m569+1,nqul

i7=i570i7
n21=m570m21

print*,'loop570'
call write_symm_xmi_1(i7,n21,m570,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1270
if (sf2.eq.1)goto 100

i571i7=i7
m571m21=n21

do m571=m570+1,nqul

i7=i571i7
n21=m571m21

print*,'loop571'
call write_symm_xmi_1(i7,n21,m571,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1271
if (sf2.eq.1)goto 100

i572i7=i7
m572m21=n21

do m572=m571+1,nqul

i7=i572i7
n21=m572m21

print*,'loop572'
call write_symm_xmi_1(i7,n21,m572,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1272
if (sf2.eq.1)goto 100

i573i7=i7
m573m21=n21

do m573=m572+1,nqul

i7=i573i7
n21=m573m21

print*,'loop573'
call write_symm_xmi_1(i7,n21,m573,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1273
if (sf2.eq.1)goto 100

i574i7=i7
m574m21=n21

do m574=m573+1,nqul

i7=i574i7
n21=m574m21

print*,'loop574'
call write_symm_xmi_1(i7,n21,m574,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1274
if (sf2.eq.1)goto 100

i575i7=i7
m575m21=n21

do m575=m574+1,nqul

i7=i575i7
n21=m575m21

print*,'loop575'
call write_symm_xmi_1(i7,n21,m575,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1275
if (sf2.eq.1)goto 100

i576i7=i7
m576m21=n21

do m576=m575+1,nqul

i7=i576i7
n21=m576m21

print*,'loop576'
call write_symm_xmi_1(i7,n21,m576,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1276
if (sf2.eq.1)goto 100

i577i7=i7
m577m21=n21

do m577=m576+1,nqul

i7=i577i7
n21=m577m21

print*,'loop577'
call write_symm_xmi_1(i7,n21,m577,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1277
if (sf2.eq.1)goto 100

i578i7=i7
m578m21=n21

do m578=m577+1,nqul

i7=i578i7
n21=m578m21

print*,'loop578'
call write_symm_xmi_1(i7,n21,m578,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1278
if (sf2.eq.1)goto 100

i579i7=i7
m579m21=n21

do m579=m578+1,nqul

i7=i579i7
n21=m579m21

print*,'loop579'
call write_symm_xmi_1(i7,n21,m579,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1279
if (sf2.eq.1)goto 100

i580i7=i7
m580m21=n21

do m580=m579+1,nqul

i7=i580i7
n21=m580m21

print*,'loop580'
call write_symm_xmi_1(i7,n21,m580,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1280
if (sf2.eq.1)goto 100

i581i7=i7
m581m21=n21

do m581=m580+1,nqul

i7=i581i7
n21=m581m21

print*,'loop581'
call write_symm_xmi_1(i7,n21,m581,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1281
if (sf2.eq.1)goto 100

i582i7=i7
m582m21=n21

do m582=m581+1,nqul

i7=i582i7
n21=m582m21

print*,'loop582'
call write_symm_xmi_1(i7,n21,m582,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1282
if (sf2.eq.1)goto 100

i583i7=i7
m583m21=n21

do m583=m582+1,nqul

i7=i583i7
n21=m583m21

print*,'loop583'
call write_symm_xmi_1(i7,n21,m583,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1283
if (sf2.eq.1)goto 100

i584i7=i7
m584m21=n21

do m584=m583+1,nqul

i7=i584i7
n21=m584m21

print*,'loop584'
call write_symm_xmi_1(i7,n21,m584,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1284
if (sf2.eq.1)goto 100

i585i7=i7
m585m21=n21

do m585=m584+1,nqul

i7=i585i7
n21=m585m21

print*,'loop585'
call write_symm_xmi_1(i7,n21,m585,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1285
if (sf2.eq.1)goto 100

i586i7=i7
m586m21=n21

do m586=m585+1,nqul

i7=i586i7
n21=m586m21

print*,'loop586'
call write_symm_xmi_1(i7,n21,m586,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1286
if (sf2.eq.1)goto 100

i587i7=i7
m587m21=n21

do m587=m586+1,nqul

i7=i587i7
n21=m587m21

print*,'loop587'
call write_symm_xmi_1(i7,n21,m587,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1287
if (sf2.eq.1)goto 100

i588i7=i7
m588m21=n21

do m588=m587+1,nqul

i7=i588i7
n21=m588m21

print*,'loop588'
call write_symm_xmi_1(i7,n21,m588,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1288
if (sf2.eq.1)goto 100

i589i7=i7
m589m21=n21

do m589=m588+1,nqul

i7=i589i7
n21=m589m21

print*,'loop589'
call write_symm_xmi_1(i7,n21,m589,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1289
if (sf2.eq.1)goto 100

i590i7=i7
m590m21=n21

do m590=m589+1,nqul

i7=i590i7
n21=m590m21

print*,'loop590'
call write_symm_xmi_1(i7,n21,m590,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1290
if (sf2.eq.1)goto 100

i591i7=i7
m591m21=n21

do m591=m590+1,nqul

i7=i591i7
n21=m591m21

print*,'loop591'
call write_symm_xmi_1(i7,n21,m591,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1291
if (sf2.eq.1)goto 100

i592i7=i7
m592m21=n21

do m592=m591+1,nqul

i7=i592i7
n21=m592m21

print*,'loop592'
call write_symm_xmi_1(i7,n21,m592,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1292
if (sf2.eq.1)goto 100

i593i7=i7
m593m21=n21

do m593=m592+1,nqul

i7=i593i7
n21=m593m21

print*,'loop593'
call write_symm_xmi_1(i7,n21,m593,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1293
if (sf2.eq.1)goto 100

i594i7=i7
m594m21=n21

do m594=m593+1,nqul

i7=i594i7
n21=m594m21

print*,'loop594'
call write_symm_xmi_1(i7,n21,m594,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1294
if (sf2.eq.1)goto 100

i595i7=i7
m595m21=n21

do m595=m594+1,nqul

i7=i595i7
n21=m595m21

print*,'loop595'
call write_symm_xmi_1(i7,n21,m595,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1295
if (sf2.eq.1)goto 100

i596i7=i7
m596m21=n21

do m596=m595+1,nqul

i7=i596i7
n21=m596m21

print*,'loop596'
call write_symm_xmi_1(i7,n21,m596,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1296
if (sf2.eq.1)goto 100

i597i7=i7
m597m21=n21

do m597=m596+1,nqul

i7=i597i7
n21=m597m21

print*,'loop597'
call write_symm_xmi_1(i7,n21,m597,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1297
if (sf2.eq.1)goto 100

i598i7=i7
m598m21=n21

do m598=m597+1,nqul

i7=i598i7
n21=m598m21

print*,'loop598'
call write_symm_xmi_1(i7,n21,m598,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1298
if (sf2.eq.1)goto 100

i599i7=i7
m599m21=n21

do m599=m598+1,nqul

i7=i599i7
n21=m599m21

print*,'loop599'
call write_symm_xmi_1(i7,n21,m599,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1299
if (sf2.eq.1)goto 100

i600i7=i7
m600m21=n21

do m600=m599+1,nqul

i7=i600i7
n21=m600m21

print*,'loop600'
call write_symm_xmi_1(i7,n21,m600,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1300
if (sf2.eq.1)goto 100

i601i7=i7
m601m21=n21

do m601=m600+1,nqul

i7=i601i7
n21=m601m21

print*,'loop601'
call write_symm_xmi_1(i7,n21,m601,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1301
if (sf2.eq.1)goto 100

i602i7=i7
m602m21=n21

do m602=m601+1,nqul

i7=i602i7
n21=m602m21

print*,'loop602'
call write_symm_xmi_1(i7,n21,m602,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1302
if (sf2.eq.1)goto 100

i603i7=i7
m603m21=n21

do m603=m602+1,nqul

i7=i603i7
n21=m603m21

print*,'loop603'
call write_symm_xmi_1(i7,n21,m603,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1303
if (sf2.eq.1)goto 100

i604i7=i7
m604m21=n21

do m604=m603+1,nqul

i7=i604i7
n21=m604m21

print*,'loop604'
call write_symm_xmi_1(i7,n21,m604,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1304
if (sf2.eq.1)goto 100

i605i7=i7
m605m21=n21

do m605=m604+1,nqul

i7=i605i7
n21=m605m21

print*,'loop605'
call write_symm_xmi_1(i7,n21,m605,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1305
if (sf2.eq.1)goto 100

i606i7=i7
m606m21=n21

do m606=m605+1,nqul

i7=i606i7
n21=m606m21

print*,'loop606'
call write_symm_xmi_1(i7,n21,m606,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1306
if (sf2.eq.1)goto 100

i607i7=i7
m607m21=n21

do m607=m606+1,nqul

i7=i607i7
n21=m607m21

print*,'loop607'
call write_symm_xmi_1(i7,n21,m607,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1307
if (sf2.eq.1)goto 100

i608i7=i7
m608m21=n21

do m608=m607+1,nqul

i7=i608i7
n21=m608m21

print*,'loop608'
call write_symm_xmi_1(i7,n21,m608,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1308
if (sf2.eq.1)goto 100

i609i7=i7
m609m21=n21

do m609=m608+1,nqul

i7=i609i7
n21=m609m21

print*,'loop609'
call write_symm_xmi_1(i7,n21,m609,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1309
if (sf2.eq.1)goto 100

i610i7=i7
m610m21=n21

do m610=m609+1,nqul

i7=i610i7
n21=m610m21

print*,'loop610'
call write_symm_xmi_1(i7,n21,m610,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1310
if (sf2.eq.1)goto 100

i611i7=i7
m611m21=n21

do m611=m610+1,nqul

i7=i611i7
n21=m611m21

print*,'loop611'
call write_symm_xmi_1(i7,n21,m611,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1311
if (sf2.eq.1)goto 100

i612i7=i7
m612m21=n21

do m612=m611+1,nqul

i7=i612i7
n21=m612m21

print*,'loop612'
call write_symm_xmi_1(i7,n21,m612,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1312
if (sf2.eq.1)goto 100

i613i7=i7
m613m21=n21

do m613=m612+1,nqul

i7=i613i7
n21=m613m21

print*,'loop613'
call write_symm_xmi_1(i7,n21,m613,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1313
if (sf2.eq.1)goto 100

i614i7=i7
m614m21=n21

do m614=m613+1,nqul

i7=i614i7
n21=m614m21

print*,'loop614'
call write_symm_xmi_1(i7,n21,m614,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1314
if (sf2.eq.1)goto 100

i615i7=i7
m615m21=n21

do m615=m614+1,nqul

i7=i615i7
n21=m615m21

print*,'loop615'
call write_symm_xmi_1(i7,n21,m615,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1315
if (sf2.eq.1)goto 100

i616i7=i7
m616m21=n21

do m616=m615+1,nqul

i7=i616i7
n21=m616m21

print*,'loop616'
call write_symm_xmi_1(i7,n21,m616,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1316
if (sf2.eq.1)goto 100

i617i7=i7
m617m21=n21

do m617=m616+1,nqul

i7=i617i7
n21=m617m21

print*,'loop617'
call write_symm_xmi_1(i7,n21,m617,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1317
if (sf2.eq.1)goto 100

i618i7=i7
m618m21=n21

do m618=m617+1,nqul

i7=i618i7
n21=m618m21

print*,'loop618'
call write_symm_xmi_1(i7,n21,m618,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1318
if (sf2.eq.1)goto 100

i619i7=i7
m619m21=n21

do m619=m618+1,nqul

i7=i619i7
n21=m619m21

print*,'loop619'
call write_symm_xmi_1(i7,n21,m619,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1319
if (sf2.eq.1)goto 100

i620i7=i7
m620m21=n21

do m620=m619+1,nqul

i7=i620i7
n21=m620m21

print*,'loop620'
call write_symm_xmi_1(i7,n21,m620,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1320
if (sf2.eq.1)goto 100

i621i7=i7
m621m21=n21

do m621=m620+1,nqul

i7=i621i7
n21=m621m21

print*,'loop621'
call write_symm_xmi_1(i7,n21,m621,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1321
if (sf2.eq.1)goto 100

i622i7=i7
m622m21=n21

do m622=m621+1,nqul

i7=i622i7
n21=m622m21

print*,'loop622'
call write_symm_xmi_1(i7,n21,m622,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1322
if (sf2.eq.1)goto 100

i623i7=i7
m623m21=n21

do m623=m622+1,nqul

i7=i623i7
n21=m623m21

print*,'loop623'
call write_symm_xmi_1(i7,n21,m623,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1323
if (sf2.eq.1)goto 100

i624i7=i7
m624m21=n21

do m624=m623+1,nqul

i7=i624i7
n21=m624m21

print*,'loop624'
call write_symm_xmi_1(i7,n21,m624,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1324
if (sf2.eq.1)goto 100

i625i7=i7
m625m21=n21

do m625=m624+1,nqul

i7=i625i7
n21=m625m21

print*,'loop625'
call write_symm_xmi_1(i7,n21,m625,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1325
if (sf2.eq.1)goto 100

i626i7=i7
m626m21=n21

do m626=m625+1,nqul

i7=i626i7
n21=m626m21

print*,'loop626'
call write_symm_xmi_1(i7,n21,m626,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1326
if (sf2.eq.1)goto 100

i627i7=i7
m627m21=n21

do m627=m626+1,nqul

i7=i627i7
n21=m627m21

print*,'loop627'
call write_symm_xmi_1(i7,n21,m627,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1327
if (sf2.eq.1)goto 100

i628i7=i7
m628m21=n21

do m628=m627+1,nqul

i7=i628i7
n21=m628m21

print*,'loop628'
call write_symm_xmi_1(i7,n21,m628,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1328
if (sf2.eq.1)goto 100

i629i7=i7
m629m21=n21

do m629=m628+1,nqul

i7=i629i7
n21=m629m21

print*,'loop629'
call write_symm_xmi_1(i7,n21,m629,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1329
if (sf2.eq.1)goto 100

i630i7=i7
m630m21=n21

do m630=m629+1,nqul

i7=i630i7
n21=m630m21

print*,'loop630'
call write_symm_xmi_1(i7,n21,m630,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1330
if (sf2.eq.1)goto 100

i631i7=i7
m631m21=n21

do m631=m630+1,nqul

i7=i631i7
n21=m631m21

print*,'loop631'
call write_symm_xmi_1(i7,n21,m631,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1331
if (sf2.eq.1)goto 100

i632i7=i7
m632m21=n21

do m632=m631+1,nqul

i7=i632i7
n21=m632m21

print*,'loop632'
call write_symm_xmi_1(i7,n21,m632,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1332
if (sf2.eq.1)goto 100

i633i7=i7
m633m21=n21

do m633=m632+1,nqul

i7=i633i7
n21=m633m21

print*,'loop633'
call write_symm_xmi_1(i7,n21,m633,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1333
if (sf2.eq.1)goto 100

i634i7=i7
m634m21=n21

do m634=m633+1,nqul

i7=i634i7
n21=m634m21

print*,'loop634'
call write_symm_xmi_1(i7,n21,m634,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1334
if (sf2.eq.1)goto 100

i635i7=i7
m635m21=n21

do m635=m634+1,nqul

i7=i635i7
n21=m635m21

print*,'loop635'
call write_symm_xmi_1(i7,n21,m635,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1335
if (sf2.eq.1)goto 100

i636i7=i7
m636m21=n21

do m636=m635+1,nqul

i7=i636i7
n21=m636m21

print*,'loop636'
call write_symm_xmi_1(i7,n21,m636,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1336
if (sf2.eq.1)goto 100

i637i7=i7
m637m21=n21

do m637=m636+1,nqul

i7=i637i7
n21=m637m21

print*,'loop637'
call write_symm_xmi_1(i7,n21,m637,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1337
if (sf2.eq.1)goto 100

i638i7=i7
m638m21=n21

do m638=m637+1,nqul

i7=i638i7
n21=m638m21

print*,'loop638'
call write_symm_xmi_1(i7,n21,m638,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1338
if (sf2.eq.1)goto 100

i639i7=i7
m639m21=n21

do m639=m638+1,nqul

i7=i639i7
n21=m639m21

print*,'loop639'
call write_symm_xmi_1(i7,n21,m639,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1339
if (sf2.eq.1)goto 100

i640i7=i7
m640m21=n21

do m640=m639+1,nqul

i7=i640i7
n21=m640m21

print*,'loop640'
call write_symm_xmi_1(i7,n21,m640,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1340
if (sf2.eq.1)goto 100

i641i7=i7
m641m21=n21

do m641=m640+1,nqul

i7=i641i7
n21=m641m21

print*,'loop641'
call write_symm_xmi_1(i7,n21,m641,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1341
if (sf2.eq.1)goto 100

i642i7=i7
m642m21=n21

do m642=m641+1,nqul

i7=i642i7
n21=m642m21

print*,'loop642'
call write_symm_xmi_1(i7,n21,m642,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1342
if (sf2.eq.1)goto 100

i643i7=i7
m643m21=n21

do m643=m642+1,nqul

i7=i643i7
n21=m643m21

print*,'loop643'
call write_symm_xmi_1(i7,n21,m643,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1343
if (sf2.eq.1)goto 100

i644i7=i7
m644m21=n21

do m644=m643+1,nqul

i7=i644i7
n21=m644m21

print*,'loop644'
call write_symm_xmi_1(i7,n21,m644,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1344
if (sf2.eq.1)goto 100

i645i7=i7
m645m21=n21

do m645=m644+1,nqul

i7=i645i7
n21=m645m21

print*,'loop645'
call write_symm_xmi_1(i7,n21,m645,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1345
if (sf2.eq.1)goto 100

i646i7=i7
m646m21=n21

do m646=m645+1,nqul

i7=i646i7
n21=m646m21

print*,'loop646'
call write_symm_xmi_1(i7,n21,m646,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1346
if (sf2.eq.1)goto 100

i647i7=i7
m647m21=n21

do m647=m646+1,nqul

i7=i647i7
n21=m647m21

print*,'loop647'
call write_symm_xmi_1(i7,n21,m647,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1347
if (sf2.eq.1)goto 100

i648i7=i7
m648m21=n21

do m648=m647+1,nqul

i7=i648i7
n21=m648m21

print*,'loop648'
call write_symm_xmi_1(i7,n21,m648,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1348
if (sf2.eq.1)goto 100

i649i7=i7
m649m21=n21

do m649=m648+1,nqul

i7=i649i7
n21=m649m21

print*,'loop649'
call write_symm_xmi_1(i7,n21,m649,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1349
if (sf2.eq.1)goto 100

i650i7=i7
m650m21=n21

do m650=m649+1,nqul

i7=i650i7
n21=m650m21

print*,'loop650'
call write_symm_xmi_1(i7,n21,m650,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1350
if (sf2.eq.1)goto 100

i651i7=i7
m651m21=n21

do m651=m650+1,nqul

i7=i651i7
n21=m651m21

print*,'loop651'
call write_symm_xmi_1(i7,n21,m651,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1351
if (sf2.eq.1)goto 100

i652i7=i7
m652m21=n21

do m652=m651+1,nqul

i7=i652i7
n21=m652m21

print*,'loop652'
call write_symm_xmi_1(i7,n21,m652,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1352
if (sf2.eq.1)goto 100

i653i7=i7
m653m21=n21

do m653=m652+1,nqul

i7=i653i7
n21=m653m21

print*,'loop653'
call write_symm_xmi_1(i7,n21,m653,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1353
if (sf2.eq.1)goto 100

i654i7=i7
m654m21=n21

do m654=m653+1,nqul

i7=i654i7
n21=m654m21

print*,'loop654'
call write_symm_xmi_1(i7,n21,m654,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1354
if (sf2.eq.1)goto 100

i655i7=i7
m655m21=n21

do m655=m654+1,nqul

i7=i655i7
n21=m655m21

print*,'loop655'
call write_symm_xmi_1(i7,n21,m655,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1355
if (sf2.eq.1)goto 100

i656i7=i7
m656m21=n21

do m656=m655+1,nqul

i7=i656i7
n21=m656m21

print*,'loop656'
call write_symm_xmi_1(i7,n21,m656,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1356
if (sf2.eq.1)goto 100

i657i7=i7
m657m21=n21

do m657=m656+1,nqul

i7=i657i7
n21=m657m21

print*,'loop657'
call write_symm_xmi_1(i7,n21,m657,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1357
if (sf2.eq.1)goto 100

i658i7=i7
m658m21=n21

do m658=m657+1,nqul

i7=i658i7
n21=m658m21

print*,'loop658'
call write_symm_xmi_1(i7,n21,m658,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1358
if (sf2.eq.1)goto 100

i659i7=i7
m659m21=n21

do m659=m658+1,nqul

i7=i659i7
n21=m659m21

print*,'loop659'
call write_symm_xmi_1(i7,n21,m659,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1359
if (sf2.eq.1)goto 100

i660i7=i7
m660m21=n21

do m660=m659+1,nqul

i7=i660i7
n21=m660m21

print*,'loop660'
call write_symm_xmi_1(i7,n21,m660,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1360
if (sf2.eq.1)goto 100

i661i7=i7
m661m21=n21

do m661=m660+1,nqul

i7=i661i7
n21=m661m21

print*,'loop661'
call write_symm_xmi_1(i7,n21,m661,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1361
if (sf2.eq.1)goto 100

i662i7=i7
m662m21=n21

do m662=m661+1,nqul

i7=i662i7
n21=m662m21

print*,'loop662'
call write_symm_xmi_1(i7,n21,m662,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1362
if (sf2.eq.1)goto 100

i663i7=i7
m663m21=n21

do m663=m662+1,nqul

i7=i663i7
n21=m663m21

print*,'loop663'
call write_symm_xmi_1(i7,n21,m663,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1363
if (sf2.eq.1)goto 100

i664i7=i7
m664m21=n21

do m664=m663+1,nqul

i7=i664i7
n21=m664m21

print*,'loop664'
call write_symm_xmi_1(i7,n21,m664,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1364
if (sf2.eq.1)goto 100

i665i7=i7
m665m21=n21

do m665=m664+1,nqul

i7=i665i7
n21=m665m21

print*,'loop665'
call write_symm_xmi_1(i7,n21,m665,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1365
if (sf2.eq.1)goto 100

i666i7=i7
m666m21=n21

do m666=m665+1,nqul

i7=i666i7
n21=m666m21

print*,'loop666'
call write_symm_xmi_1(i7,n21,m666,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1366
if (sf2.eq.1)goto 100

i667i7=i7
m667m21=n21

do m667=m666+1,nqul

i7=i667i7
n21=m667m21

print*,'loop667'
call write_symm_xmi_1(i7,n21,m667,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1367
if (sf2.eq.1)goto 100

i668i7=i7
m668m21=n21

do m668=m667+1,nqul

i7=i668i7
n21=m668m21

print*,'loop668'
call write_symm_xmi_1(i7,n21,m668,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1368
if (sf2.eq.1)goto 100

i669i7=i7
m669m21=n21

do m669=m668+1,nqul

i7=i669i7
n21=m669m21

print*,'loop669'
call write_symm_xmi_1(i7,n21,m669,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1369
if (sf2.eq.1)goto 100

i670i7=i7
m670m21=n21

do m670=m669+1,nqul

i7=i670i7
n21=m670m21

print*,'loop670'
call write_symm_xmi_1(i7,n21,m670,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1370
if (sf2.eq.1)goto 100

i671i7=i7
m671m21=n21

do m671=m670+1,nqul

i7=i671i7
n21=m671m21

print*,'loop671'
call write_symm_xmi_1(i7,n21,m671,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1371
if (sf2.eq.1)goto 100

i672i7=i7
m672m21=n21

do m672=m671+1,nqul

i7=i672i7
n21=m672m21

print*,'loop672'
call write_symm_xmi_1(i7,n21,m672,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1372
if (sf2.eq.1)goto 100

i673i7=i7
m673m21=n21

do m673=m672+1,nqul

i7=i673i7
n21=m673m21

print*,'loop673'
call write_symm_xmi_1(i7,n21,m673,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1373
if (sf2.eq.1)goto 100

i674i7=i7
m674m21=n21

do m674=m673+1,nqul

i7=i674i7
n21=m674m21

print*,'loop674'
call write_symm_xmi_1(i7,n21,m674,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1374
if (sf2.eq.1)goto 100

i675i7=i7
m675m21=n21

do m675=m674+1,nqul

i7=i675i7
n21=m675m21

print*,'loop675'
call write_symm_xmi_1(i7,n21,m675,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1375
if (sf2.eq.1)goto 100

i676i7=i7
m676m21=n21

do m676=m675+1,nqul

i7=i676i7
n21=m676m21

print*,'loop676'
call write_symm_xmi_1(i7,n21,m676,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1376
if (sf2.eq.1)goto 100

i677i7=i7
m677m21=n21

do m677=m676+1,nqul

i7=i677i7
n21=m677m21

print*,'loop677'
call write_symm_xmi_1(i7,n21,m677,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1377
if (sf2.eq.1)goto 100

i678i7=i7
m678m21=n21

do m678=m677+1,nqul

i7=i678i7
n21=m678m21

print*,'loop678'
call write_symm_xmi_1(i7,n21,m678,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1378
if (sf2.eq.1)goto 100

i679i7=i7
m679m21=n21

do m679=m678+1,nqul

i7=i679i7
n21=m679m21

print*,'loop679'
call write_symm_xmi_1(i7,n21,m679,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1379
if (sf2.eq.1)goto 100

i680i7=i7
m680m21=n21

do m680=m679+1,nqul

i7=i680i7
n21=m680m21

print*,'loop680'
call write_symm_xmi_1(i7,n21,m680,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1380
if (sf2.eq.1)goto 100

i681i7=i7
m681m21=n21

do m681=m680+1,nqul

i7=i681i7
n21=m681m21

print*,'loop681'
call write_symm_xmi_1(i7,n21,m681,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1381
if (sf2.eq.1)goto 100

i682i7=i7
m682m21=n21

do m682=m681+1,nqul

i7=i682i7
n21=m682m21

print*,'loop682'
call write_symm_xmi_1(i7,n21,m682,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1382
if (sf2.eq.1)goto 100

i683i7=i7
m683m21=n21

do m683=m682+1,nqul

i7=i683i7
n21=m683m21

print*,'loop683'
call write_symm_xmi_1(i7,n21,m683,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1383
if (sf2.eq.1)goto 100

i684i7=i7
m684m21=n21

do m684=m683+1,nqul

i7=i684i7
n21=m684m21

print*,'loop684'
call write_symm_xmi_1(i7,n21,m684,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1384
if (sf2.eq.1)goto 100

i685i7=i7
m685m21=n21

do m685=m684+1,nqul

i7=i685i7
n21=m685m21

print*,'loop685'
call write_symm_xmi_1(i7,n21,m685,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1385
if (sf2.eq.1)goto 100

i686i7=i7
m686m21=n21

do m686=m685+1,nqul

i7=i686i7
n21=m686m21

print*,'loop686'
call write_symm_xmi_1(i7,n21,m686,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1386
if (sf2.eq.1)goto 100

i687i7=i7
m687m21=n21

do m687=m686+1,nqul

i7=i687i7
n21=m687m21

print*,'loop687'
call write_symm_xmi_1(i7,n21,m687,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1387
if (sf2.eq.1)goto 100

i688i7=i7
m688m21=n21

do m688=m687+1,nqul

i7=i688i7
n21=m688m21

print*,'loop688'
call write_symm_xmi_1(i7,n21,m688,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1388
if (sf2.eq.1)goto 100

i689i7=i7
m689m21=n21

do m689=m688+1,nqul

i7=i689i7
n21=m689m21

print*,'loop689'
call write_symm_xmi_1(i7,n21,m689,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1389
if (sf2.eq.1)goto 100

i690i7=i7
m690m21=n21

do m690=m689+1,nqul

i7=i690i7
n21=m690m21

print*,'loop690'
call write_symm_xmi_1(i7,n21,m690,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1390
if (sf2.eq.1)goto 100

i691i7=i7
m691m21=n21

do m691=m690+1,nqul

i7=i691i7
n21=m691m21

print*,'loop691'
call write_symm_xmi_1(i7,n21,m691,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1391
if (sf2.eq.1)goto 100

i692i7=i7
m692m21=n21

do m692=m691+1,nqul

i7=i692i7
n21=m692m21

print*,'loop692'
call write_symm_xmi_1(i7,n21,m692,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1392
if (sf2.eq.1)goto 100

i693i7=i7
m693m21=n21

do m693=m692+1,nqul

i7=i693i7
n21=m693m21

print*,'loop693'
call write_symm_xmi_1(i7,n21,m693,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1393
if (sf2.eq.1)goto 100

i694i7=i7
m694m21=n21

do m694=m693+1,nqul

i7=i694i7
n21=m694m21

print*,'loop694'
call write_symm_xmi_1(i7,n21,m694,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1394
if (sf2.eq.1)goto 100

i695i7=i7
m695m21=n21

do m695=m694+1,nqul

i7=i695i7
n21=m695m21

print*,'loop695'
call write_symm_xmi_1(i7,n21,m695,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1395
if (sf2.eq.1)goto 100

i696i7=i7
m696m21=n21

do m696=m695+1,nqul

i7=i696i7
n21=m696m21

print*,'loop696'
call write_symm_xmi_1(i7,n21,m696,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1396
if (sf2.eq.1)goto 100

i697i7=i7
m697m21=n21

do m697=m696+1,nqul

i7=i697i7
n21=m697m21

print*,'loop697'
call write_symm_xmi_1(i7,n21,m697,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1397
if (sf2.eq.1)goto 100

i698i7=i7
m698m21=n21

do m698=m697+1,nqul

i7=i698i7
n21=m698m21

print*,'loop698'
call write_symm_xmi_1(i7,n21,m698,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1398
if (sf2.eq.1)goto 100

i699i7=i7
m699m21=n21

do m699=m698+1,nqul

i7=i699i7
n21=m699m21

print*,'loop699'
call write_symm_xmi_1(i7,n21,m699,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1399
if (sf2.eq.1)goto 100

i700i7=i7
m700m21=n21

do m700=m699+1,nqul

i7=i700i7
n21=m700m21

print*,'loop700'
call write_symm_xmi_1(i7,n21,m700,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1400
if (sf2.eq.1)goto 100

i701i7=i7
m701m21=n21

do m701=m700+1,nqul

i7=i701i7
n21=m701m21

print*,'loop701'
call write_symm_xmi_1(i7,n21,m701,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1401
if (sf2.eq.1)goto 100

i702i7=i7
m702m21=n21

do m702=m701+1,nqul

i7=i702i7
n21=m702m21

print*,'loop702'
call write_symm_xmi_1(i7,n21,m702,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1402
if (sf2.eq.1)goto 100

i703i7=i7
m703m21=n21

do m703=m702+1,nqul

i7=i703i7
n21=m703m21

print*,'loop703'
call write_symm_xmi_1(i7,n21,m703,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1403
if (sf2.eq.1)goto 100

i704i7=i7
m704m21=n21

do m704=m703+1,nqul

i7=i704i7
n21=m704m21

print*,'loop704'
call write_symm_xmi_1(i7,n21,m704,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1404
if (sf2.eq.1)goto 100

i705i7=i7
m705m21=n21

do m705=m704+1,nqul

i7=i705i7
n21=m705m21

print*,'loop705'
call write_symm_xmi_1(i7,n21,m705,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1405
if (sf2.eq.1)goto 100

i706i7=i7
m706m21=n21

do m706=m705+1,nqul

i7=i706i7
n21=m706m21

print*,'loop706'
call write_symm_xmi_1(i7,n21,m706,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1406
if (sf2.eq.1)goto 100

i707i7=i7
m707m21=n21

do m707=m706+1,nqul

i7=i707i7
n21=m707m21

print*,'loop707'
call write_symm_xmi_1(i7,n21,m707,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1407
if (sf2.eq.1)goto 100

i708i7=i7
m708m21=n21

do m708=m707+1,nqul

i7=i708i7
n21=m708m21

print*,'loop708'
call write_symm_xmi_1(i7,n21,m708,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1408
if (sf2.eq.1)goto 100

i709i7=i7
m709m21=n21

do m709=m708+1,nqul

i7=i709i7
n21=m709m21

print*,'loop709'
call write_symm_xmi_1(i7,n21,m709,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1409
if (sf2.eq.1)goto 100

i710i7=i7
m710m21=n21

do m710=m709+1,nqul

i7=i710i7
n21=m710m21

print*,'loop710'
call write_symm_xmi_1(i7,n21,m710,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1410
if (sf2.eq.1)goto 100

i711i7=i7
m711m21=n21

do m711=m710+1,nqul

i7=i711i7
n21=m711m21

print*,'loop711'
call write_symm_xmi_1(i7,n21,m711,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1411
if (sf2.eq.1)goto 100

i712i7=i7
m712m21=n21

do m712=m711+1,nqul

i7=i712i7
n21=m712m21

print*,'loop712'
call write_symm_xmi_1(i7,n21,m712,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1412
if (sf2.eq.1)goto 100

i713i7=i7
m713m21=n21

do m713=m712+1,nqul

i7=i713i7
n21=m713m21

print*,'loop713'
call write_symm_xmi_1(i7,n21,m713,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1413
if (sf2.eq.1)goto 100

i714i7=i7
m714m21=n21

do m714=m713+1,nqul

i7=i714i7
n21=m714m21

print*,'loop714'
call write_symm_xmi_1(i7,n21,m714,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1414
if (sf2.eq.1)goto 100

i715i7=i7
m715m21=n21

do m715=m714+1,nqul

i7=i715i7
n21=m715m21

print*,'loop715'
call write_symm_xmi_1(i7,n21,m715,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1415
if (sf2.eq.1)goto 100

i716i7=i7
m716m21=n21

do m716=m715+1,nqul

i7=i716i7
n21=m716m21

print*,'loop716'
call write_symm_xmi_1(i7,n21,m716,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1416
if (sf2.eq.1)goto 100

i717i7=i7
m717m21=n21

do m717=m716+1,nqul

i7=i717i7
n21=m717m21

print*,'loop717'
call write_symm_xmi_1(i7,n21,m717,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1417
if (sf2.eq.1)goto 100

i718i7=i7
m718m21=n21

do m718=m717+1,nqul

i7=i718i7
n21=m718m21

print*,'loop718'
call write_symm_xmi_1(i7,n21,m718,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1418
if (sf2.eq.1)goto 100

i719i7=i7
m719m21=n21

do m719=m718+1,nqul

i7=i719i7
n21=m719m21

print*,'loop719'
call write_symm_xmi_1(i7,n21,m719,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1419
if (sf2.eq.1)goto 100

i720i7=i7
m720m21=n21

do m720=m719+1,nqul

i7=i720i7
n21=m720m21

print*,'loop720'
call write_symm_xmi_1(i7,n21,m720,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1420
if (sf2.eq.1)goto 100

i721i7=i7
m721m21=n21

do m721=m720+1,nqul

i7=i721i7
n21=m721m21

print*,'loop721'
call write_symm_xmi_1(i7,n21,m721,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1421
if (sf2.eq.1)goto 100

i722i7=i7
m722m21=n21

do m722=m721+1,nqul

i7=i722i7
n21=m722m21

print*,'loop722'
call write_symm_xmi_1(i7,n21,m722,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1422
if (sf2.eq.1)goto 100

i723i7=i7
m723m21=n21

do m723=m722+1,nqul

i7=i723i7
n21=m723m21

print*,'loop723'
call write_symm_xmi_1(i7,n21,m723,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1423
if (sf2.eq.1)goto 100

i724i7=i7
m724m21=n21

do m724=m723+1,nqul

i7=i724i7
n21=m724m21

print*,'loop724'
call write_symm_xmi_1(i7,n21,m724,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1424
if (sf2.eq.1)goto 100

i725i7=i7
m725m21=n21

do m725=m724+1,nqul

i7=i725i7
n21=m725m21

print*,'loop725'
call write_symm_xmi_1(i7,n21,m725,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1425
if (sf2.eq.1)goto 100

i726i7=i7
m726m21=n21

do m726=m725+1,nqul

i7=i726i7
n21=m726m21

print*,'loop726'
call write_symm_xmi_1(i7,n21,m726,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1426
if (sf2.eq.1)goto 100

i727i7=i7
m727m21=n21

do m727=m726+1,nqul

i7=i727i7
n21=m727m21

print*,'loop727'
call write_symm_xmi_1(i7,n21,m727,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1427
if (sf2.eq.1)goto 100

i728i7=i7
m728m21=n21

do m728=m727+1,nqul

i7=i728i7
n21=m728m21

print*,'loop728'
call write_symm_xmi_1(i7,n21,m728,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1428
if (sf2.eq.1)goto 100

i729i7=i7
m729m21=n21

do m729=m728+1,nqul

i7=i729i7
n21=m729m21

print*,'loop729'
call write_symm_xmi_1(i7,n21,m729,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1429
if (sf2.eq.1)goto 100

i730i7=i7
m730m21=n21

do m730=m729+1,nqul

i7=i730i7
n21=m730m21

print*,'loop730'
call write_symm_xmi_1(i7,n21,m730,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1430
if (sf2.eq.1)goto 100

i731i7=i7
m731m21=n21

do m731=m730+1,nqul

i7=i731i7
n21=m731m21

print*,'loop731'
call write_symm_xmi_1(i7,n21,m731,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1431
if (sf2.eq.1)goto 100

i732i7=i7
m732m21=n21

do m732=m731+1,nqul

i7=i732i7
n21=m732m21

print*,'loop732'
call write_symm_xmi_1(i7,n21,m732,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1432
if (sf2.eq.1)goto 100

i733i7=i7
m733m21=n21

do m733=m732+1,nqul

i7=i733i7
n21=m733m21

print*,'loop733'
call write_symm_xmi_1(i7,n21,m733,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1433
if (sf2.eq.1)goto 100

i734i7=i7
m734m21=n21

do m734=m733+1,nqul

i7=i734i7
n21=m734m21

print*,'loop734'
call write_symm_xmi_1(i7,n21,m734,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1434
if (sf2.eq.1)goto 100

i735i7=i7
m735m21=n21

do m735=m734+1,nqul

i7=i735i7
n21=m735m21

print*,'loop735'
call write_symm_xmi_1(i7,n21,m735,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1435
if (sf2.eq.1)goto 100

i736i7=i7
m736m21=n21

do m736=m735+1,nqul

i7=i736i7
n21=m736m21

print*,'loop736'
call write_symm_xmi_1(i7,n21,m736,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1436
if (sf2.eq.1)goto 100

i737i7=i7
m737m21=n21

do m737=m736+1,nqul

i7=i737i7
n21=m737m21

print*,'loop737'
call write_symm_xmi_1(i7,n21,m737,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1437
if (sf2.eq.1)goto 100

i738i7=i7
m738m21=n21

do m738=m737+1,nqul

i7=i738i7
n21=m738m21

print*,'loop738'
call write_symm_xmi_1(i7,n21,m738,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1438
if (sf2.eq.1)goto 100

i739i7=i7
m739m21=n21

do m739=m738+1,nqul

i7=i739i7
n21=m739m21

print*,'loop739'
call write_symm_xmi_1(i7,n21,m739,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1439
if (sf2.eq.1)goto 100

i740i7=i7
m740m21=n21

do m740=m739+1,nqul

i7=i740i7
n21=m740m21

print*,'loop740'
call write_symm_xmi_1(i7,n21,m740,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1440
if (sf2.eq.1)goto 100

i741i7=i7
m741m21=n21

do m741=m740+1,nqul

i7=i741i7
n21=m741m21

print*,'loop741'
call write_symm_xmi_1(i7,n21,m741,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1441
if (sf2.eq.1)goto 100

i742i7=i7
m742m21=n21

do m742=m741+1,nqul

i7=i742i7
n21=m742m21

print*,'loop742'
call write_symm_xmi_1(i7,n21,m742,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1442
if (sf2.eq.1)goto 100

i743i7=i7
m743m21=n21

do m743=m742+1,nqul

i7=i743i7
n21=m743m21

print*,'loop743'
call write_symm_xmi_1(i7,n21,m743,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1443
if (sf2.eq.1)goto 100

i744i7=i7
m744m21=n21

do m744=m743+1,nqul

i7=i744i7
n21=m744m21

print*,'loop744'
call write_symm_xmi_1(i7,n21,m744,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1444
if (sf2.eq.1)goto 100

i745i7=i7
m745m21=n21

do m745=m744+1,nqul

i7=i745i7
n21=m745m21

print*,'loop745'
call write_symm_xmi_1(i7,n21,m745,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1445
if (sf2.eq.1)goto 100

i746i7=i7
m746m21=n21

do m746=m745+1,nqul

i7=i746i7
n21=m746m21

print*,'loop746'
call write_symm_xmi_1(i7,n21,m746,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1446
if (sf2.eq.1)goto 100

i747i7=i7
m747m21=n21

do m747=m746+1,nqul

i7=i747i7
n21=m747m21

print*,'loop747'
call write_symm_xmi_1(i7,n21,m747,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1447
if (sf2.eq.1)goto 100

i748i7=i7
m748m21=n21

do m748=m747+1,nqul

i7=i748i7
n21=m748m21

print*,'loop748'
call write_symm_xmi_1(i7,n21,m748,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1448
if (sf2.eq.1)goto 100

i749i7=i7
m749m21=n21

do m749=m748+1,nqul

i7=i749i7
n21=m749m21

print*,'loop749'
call write_symm_xmi_1(i7,n21,m749,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1449
if (sf2.eq.1)goto 100

i750i7=i7
m750m21=n21

do m750=m749+1,nqul

i7=i750i7
n21=m750m21

print*,'loop750'
call write_symm_xmi_1(i7,n21,m750,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1450
if (sf2.eq.1)goto 100

i751i7=i7
m751m21=n21

do m751=m750+1,nqul

i7=i751i7
n21=m751m21

print*,'loop751'
call write_symm_xmi_1(i7,n21,m751,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1451
if (sf2.eq.1)goto 100

i752i7=i7
m752m21=n21

do m752=m751+1,nqul

i7=i752i7
n21=m752m21

print*,'loop752'
call write_symm_xmi_1(i7,n21,m752,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1452
if (sf2.eq.1)goto 100

i753i7=i7
m753m21=n21

do m753=m752+1,nqul

i7=i753i7
n21=m753m21

print*,'loop753'
call write_symm_xmi_1(i7,n21,m753,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1453
if (sf2.eq.1)goto 100

i754i7=i7
m754m21=n21

do m754=m753+1,nqul

i7=i754i7
n21=m754m21

print*,'loop754'
call write_symm_xmi_1(i7,n21,m754,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1454
if (sf2.eq.1)goto 100

i755i7=i7
m755m21=n21

do m755=m754+1,nqul

i7=i755i7
n21=m755m21

print*,'loop755'
call write_symm_xmi_1(i7,n21,m755,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1455
if (sf2.eq.1)goto 100

i756i7=i7
m756m21=n21

do m756=m755+1,nqul

i7=i756i7
n21=m756m21

print*,'loop756'
call write_symm_xmi_1(i7,n21,m756,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1456
if (sf2.eq.1)goto 100

i757i7=i7
m757m21=n21

do m757=m756+1,nqul

i7=i757i7
n21=m757m21

print*,'loop757'
call write_symm_xmi_1(i7,n21,m757,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1457
if (sf2.eq.1)goto 100

i758i7=i7
m758m21=n21

do m758=m757+1,nqul

i7=i758i7
n21=m758m21

print*,'loop758'
call write_symm_xmi_1(i7,n21,m758,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1458
if (sf2.eq.1)goto 100

i759i7=i7
m759m21=n21

do m759=m758+1,nqul

i7=i759i7
n21=m759m21

print*,'loop759'
call write_symm_xmi_1(i7,n21,m759,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1459
if (sf2.eq.1)goto 100

i760i7=i7
m760m21=n21

do m760=m759+1,nqul

i7=i760i7
n21=m760m21

print*,'loop760'
call write_symm_xmi_1(i7,n21,m760,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1460
if (sf2.eq.1)goto 100

i761i7=i7
m761m21=n21

do m761=m760+1,nqul

i7=i761i7
n21=m761m21

print*,'loop761'
call write_symm_xmi_1(i7,n21,m761,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1461
if (sf2.eq.1)goto 100

i762i7=i7
m762m21=n21

do m762=m761+1,nqul

i7=i762i7
n21=m762m21

print*,'loop762'
call write_symm_xmi_1(i7,n21,m762,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1462
if (sf2.eq.1)goto 100

i763i7=i7
m763m21=n21

do m763=m762+1,nqul

i7=i763i7
n21=m763m21

print*,'loop763'
call write_symm_xmi_1(i7,n21,m763,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1463
if (sf2.eq.1)goto 100

i764i7=i7
m764m21=n21

do m764=m763+1,nqul

i7=i764i7
n21=m764m21

print*,'loop764'
call write_symm_xmi_1(i7,n21,m764,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1464
if (sf2.eq.1)goto 100

i765i7=i7
m765m21=n21

do m765=m764+1,nqul

i7=i765i7
n21=m765m21

print*,'loop765'
call write_symm_xmi_1(i7,n21,m765,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1465
if (sf2.eq.1)goto 100

i766i7=i7
m766m21=n21

do m766=m765+1,nqul

i7=i766i7
n21=m766m21

print*,'loop766'
call write_symm_xmi_1(i7,n21,m766,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1466
if (sf2.eq.1)goto 100

i767i7=i7
m767m21=n21

do m767=m766+1,nqul

i7=i767i7
n21=m767m21

print*,'loop767'
call write_symm_xmi_1(i7,n21,m767,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1467
if (sf2.eq.1)goto 100

i768i7=i7
m768m21=n21

do m768=m767+1,nqul

i7=i768i7
n21=m768m21

print*,'loop768'
call write_symm_xmi_1(i7,n21,m768,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1468
if (sf2.eq.1)goto 100

i769i7=i7
m769m21=n21

do m769=m768+1,nqul

i7=i769i7
n21=m769m21

print*,'loop769'
call write_symm_xmi_1(i7,n21,m769,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1469
if (sf2.eq.1)goto 100

i770i7=i7
m770m21=n21

do m770=m769+1,nqul

i7=i770i7
n21=m770m21

print*,'loop770'
call write_symm_xmi_1(i7,n21,m770,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1470
if (sf2.eq.1)goto 100

i771i7=i7
m771m21=n21

do m771=m770+1,nqul

i7=i771i7
n21=m771m21

print*,'loop771'
call write_symm_xmi_1(i7,n21,m771,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1471
if (sf2.eq.1)goto 100

i772i7=i7
m772m21=n21

do m772=m771+1,nqul

i7=i772i7
n21=m772m21

print*,'loop772'
call write_symm_xmi_1(i7,n21,m772,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1472
if (sf2.eq.1)goto 100

i773i7=i7
m773m21=n21

do m773=m772+1,nqul

i7=i773i7
n21=m773m21

print*,'loop773'
call write_symm_xmi_1(i7,n21,m773,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1473
if (sf2.eq.1)goto 100

i774i7=i7
m774m21=n21

do m774=m773+1,nqul

i7=i774i7
n21=m774m21

print*,'loop774'
call write_symm_xmi_1(i7,n21,m774,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1474
if (sf2.eq.1)goto 100

i775i7=i7
m775m21=n21

do m775=m774+1,nqul

i7=i775i7
n21=m775m21

print*,'loop775'
call write_symm_xmi_1(i7,n21,m775,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1475
if (sf2.eq.1)goto 100

i776i7=i7
m776m21=n21

do m776=m775+1,nqul

i7=i776i7
n21=m776m21

print*,'loop776'
call write_symm_xmi_1(i7,n21,m776,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1476
if (sf2.eq.1)goto 100

i777i7=i7
m777m21=n21

do m777=m776+1,nqul

i7=i777i7
n21=m777m21

print*,'loop777'
call write_symm_xmi_1(i7,n21,m777,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1477
if (sf2.eq.1)goto 100

i778i7=i7
m778m21=n21

do m778=m777+1,nqul

i7=i778i7
n21=m778m21

print*,'loop778'
call write_symm_xmi_1(i7,n21,m778,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1478
if (sf2.eq.1)goto 100

i779i7=i7
m779m21=n21

do m779=m778+1,nqul

i7=i779i7
n21=m779m21

print*,'loop779'
call write_symm_xmi_1(i7,n21,m779,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1479
if (sf2.eq.1)goto 100

i780i7=i7
m780m21=n21

do m780=m779+1,nqul

i7=i780i7
n21=m780m21

print*,'loop780'
call write_symm_xmi_1(i7,n21,m780,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1480
if (sf2.eq.1)goto 100

i781i7=i7
m781m21=n21

do m781=m780+1,nqul

i7=i781i7
n21=m781m21

print*,'loop781'
call write_symm_xmi_1(i7,n21,m781,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1481
if (sf2.eq.1)goto 100

i782i7=i7
m782m21=n21

do m782=m781+1,nqul

i7=i782i7
n21=m782m21

print*,'loop782'
call write_symm_xmi_1(i7,n21,m782,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1482
if (sf2.eq.1)goto 100

i783i7=i7
m783m21=n21

do m783=m782+1,nqul

i7=i783i7
n21=m783m21

print*,'loop783'
call write_symm_xmi_1(i7,n21,m783,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1483
if (sf2.eq.1)goto 100

i784i7=i7
m784m21=n21

do m784=m783+1,nqul

i7=i784i7
n21=m784m21

print*,'loop784'
call write_symm_xmi_1(i7,n21,m784,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1484
if (sf2.eq.1)goto 100

i785i7=i7
m785m21=n21

do m785=m784+1,nqul

i7=i785i7
n21=m785m21

print*,'loop785'
call write_symm_xmi_1(i7,n21,m785,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1485
if (sf2.eq.1)goto 100

i786i7=i7
m786m21=n21

do m786=m785+1,nqul

i7=i786i7
n21=m786m21

print*,'loop786'
call write_symm_xmi_1(i7,n21,m786,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1486
if (sf2.eq.1)goto 100

i787i7=i7
m787m21=n21

do m787=m786+1,nqul

i7=i787i7
n21=m787m21

print*,'loop787'
call write_symm_xmi_1(i7,n21,m787,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1487
if (sf2.eq.1)goto 100

i788i7=i7
m788m21=n21

do m788=m787+1,nqul

i7=i788i7
n21=m788m21

print*,'loop788'
call write_symm_xmi_1(i7,n21,m788,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1488
if (sf2.eq.1)goto 100

i789i7=i7
m789m21=n21

do m789=m788+1,nqul

i7=i789i7
n21=m789m21

print*,'loop789'
call write_symm_xmi_1(i7,n21,m789,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1489
if (sf2.eq.1)goto 100

i790i7=i7
m790m21=n21

do m790=m789+1,nqul

i7=i790i7
n21=m790m21

print*,'loop790'
call write_symm_xmi_1(i7,n21,m790,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1490
if (sf2.eq.1)goto 100

i791i7=i7
m791m21=n21

do m791=m790+1,nqul

i7=i791i7
n21=m791m21

print*,'loop791'
call write_symm_xmi_1(i7,n21,m791,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1491
if (sf2.eq.1)goto 100

i792i7=i7
m792m21=n21

do m792=m791+1,nqul

i7=i792i7
n21=m792m21

print*,'loop792'
call write_symm_xmi_1(i7,n21,m792,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1492
if (sf2.eq.1)goto 100

i793i7=i7
m793m21=n21

do m793=m792+1,nqul

i7=i793i7
n21=m793m21

print*,'loop793'
call write_symm_xmi_1(i7,n21,m793,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1493
if (sf2.eq.1)goto 100

i794i7=i7
m794m21=n21

do m794=m793+1,nqul

i7=i794i7
n21=m794m21

print*,'loop794'
call write_symm_xmi_1(i7,n21,m794,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1494
if (sf2.eq.1)goto 100

i795i7=i7
m795m21=n21

do m795=m794+1,nqul

i7=i795i7
n21=m795m21

print*,'loop795'
call write_symm_xmi_1(i7,n21,m795,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1495
if (sf2.eq.1)goto 100

i796i7=i7
m796m21=n21

do m796=m795+1,nqul

i7=i796i7
n21=m796m21

print*,'loop796'
call write_symm_xmi_1(i7,n21,m796,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1496
if (sf2.eq.1)goto 100

i797i7=i7
m797m21=n21

do m797=m796+1,nqul

i7=i797i7
n21=m797m21

print*,'loop797'
call write_symm_xmi_1(i7,n21,m797,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1497
if (sf2.eq.1)goto 100

i798i7=i7
m798m21=n21

do m798=m797+1,nqul

i7=i798i7
n21=m798m21

print*,'loop798'
call write_symm_xmi_1(i7,n21,m798,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1498
if (sf2.eq.1)goto 100

i799i7=i7
m799m21=n21

do m799=m798+1,nqul

i7=i799i7
n21=m799m21

print*,'loop799'
call write_symm_xmi_1(i7,n21,m799,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1499
if (sf2.eq.1)goto 100

i800i7=i7
m800m21=n21

do m800=m799+1,nqul

i7=i800i7
n21=m800m21

print*,'loop800'
call write_symm_xmi_1(i7,n21,m800,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1500
if (sf2.eq.1)goto 100

i801i7=i7
m801m21=n21

do m801=m800+1,nqul

i7=i801i7
n21=m801m21

print*,'loop801'
call write_symm_xmi_1(i7,n21,m801,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1501
if (sf2.eq.1)goto 100

i802i7=i7
m802m21=n21

do m802=m801+1,nqul

i7=i802i7
n21=m802m21

print*,'loop802'
call write_symm_xmi_1(i7,n21,m802,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1502
if (sf2.eq.1)goto 100

i803i7=i7
m803m21=n21

do m803=m802+1,nqul

i7=i803i7
n21=m803m21

print*,'loop803'
call write_symm_xmi_1(i7,n21,m803,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1503
if (sf2.eq.1)goto 100

i804i7=i7
m804m21=n21

do m804=m803+1,nqul

i7=i804i7
n21=m804m21

print*,'loop804'
call write_symm_xmi_1(i7,n21,m804,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1504
if (sf2.eq.1)goto 100

i805i7=i7
m805m21=n21

do m805=m804+1,nqul

i7=i805i7
n21=m805m21

print*,'loop805'
call write_symm_xmi_1(i7,n21,m805,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1505
if (sf2.eq.1)goto 100

i806i7=i7
m806m21=n21

do m806=m805+1,nqul

i7=i806i7
n21=m806m21

print*,'loop806'
call write_symm_xmi_1(i7,n21,m806,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1506
if (sf2.eq.1)goto 100

i807i7=i7
m807m21=n21

do m807=m806+1,nqul

i7=i807i7
n21=m807m21

print*,'loop807'
call write_symm_xmi_1(i7,n21,m807,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1507
if (sf2.eq.1)goto 100

i808i7=i7
m808m21=n21

do m808=m807+1,nqul

i7=i808i7
n21=m808m21

print*,'loop808'
call write_symm_xmi_1(i7,n21,m808,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1508
if (sf2.eq.1)goto 100

i809i7=i7
m809m21=n21

do m809=m808+1,nqul

i7=i809i7
n21=m809m21

print*,'loop809'
call write_symm_xmi_1(i7,n21,m809,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1509
if (sf2.eq.1)goto 100

i810i7=i7
m810m21=n21

do m810=m809+1,nqul

i7=i810i7
n21=m810m21

print*,'loop810'
call write_symm_xmi_1(i7,n21,m810,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1510
if (sf2.eq.1)goto 100

i811i7=i7
m811m21=n21

do m811=m810+1,nqul

i7=i811i7
n21=m811m21

print*,'loop811'
call write_symm_xmi_1(i7,n21,m811,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1511
if (sf2.eq.1)goto 100

i812i7=i7
m812m21=n21

do m812=m811+1,nqul

i7=i812i7
n21=m812m21

print*,'loop812'
call write_symm_xmi_1(i7,n21,m812,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1512
if (sf2.eq.1)goto 100

i813i7=i7
m813m21=n21

do m813=m812+1,nqul

i7=i813i7
n21=m813m21

print*,'loop813'
call write_symm_xmi_1(i7,n21,m813,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1513
if (sf2.eq.1)goto 100

i814i7=i7
m814m21=n21

do m814=m813+1,nqul

i7=i814i7
n21=m814m21

print*,'loop814'
call write_symm_xmi_1(i7,n21,m814,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1514
if (sf2.eq.1)goto 100

i815i7=i7
m815m21=n21

do m815=m814+1,nqul

i7=i815i7
n21=m815m21

print*,'loop815'
call write_symm_xmi_1(i7,n21,m815,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1515
if (sf2.eq.1)goto 100

i816i7=i7
m816m21=n21

do m816=m815+1,nqul

i7=i816i7
n21=m816m21

print*,'loop816'
call write_symm_xmi_1(i7,n21,m816,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1516
if (sf2.eq.1)goto 100

i817i7=i7
m817m21=n21

do m817=m816+1,nqul

i7=i817i7
n21=m817m21

print*,'loop817'
call write_symm_xmi_1(i7,n21,m817,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1517
if (sf2.eq.1)goto 100

i818i7=i7
m818m21=n21

do m818=m817+1,nqul

i7=i818i7
n21=m818m21

print*,'loop818'
call write_symm_xmi_1(i7,n21,m818,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1518
if (sf2.eq.1)goto 100

i819i7=i7
m819m21=n21

do m819=m818+1,nqul

i7=i819i7
n21=m819m21

print*,'loop819'
call write_symm_xmi_1(i7,n21,m819,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1519
if (sf2.eq.1)goto 100

i820i7=i7
m820m21=n21

do m820=m819+1,nqul

i7=i820i7
n21=m820m21

print*,'loop820'
call write_symm_xmi_1(i7,n21,m820,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1520
if (sf2.eq.1)goto 100

i821i7=i7
m821m21=n21

do m821=m820+1,nqul

i7=i821i7
n21=m821m21

print*,'loop821'
call write_symm_xmi_1(i7,n21,m821,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1521
if (sf2.eq.1)goto 100

i822i7=i7
m822m21=n21

do m822=m821+1,nqul

i7=i822i7
n21=m822m21

print*,'loop822'
call write_symm_xmi_1(i7,n21,m822,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1522
if (sf2.eq.1)goto 100

i823i7=i7
m823m21=n21

do m823=m822+1,nqul

i7=i823i7
n21=m823m21

print*,'loop823'
call write_symm_xmi_1(i7,n21,m823,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1523
if (sf2.eq.1)goto 100

i824i7=i7
m824m21=n21

do m824=m823+1,nqul

i7=i824i7
n21=m824m21

print*,'loop824'
call write_symm_xmi_1(i7,n21,m824,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1524
if (sf2.eq.1)goto 100

i825i7=i7
m825m21=n21

do m825=m824+1,nqul

i7=i825i7
n21=m825m21

print*,'loop825'
call write_symm_xmi_1(i7,n21,m825,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1525
if (sf2.eq.1)goto 100

i826i7=i7
m826m21=n21

do m826=m825+1,nqul

i7=i826i7
n21=m826m21

print*,'loop826'
call write_symm_xmi_1(i7,n21,m826,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1526
if (sf2.eq.1)goto 100

i827i7=i7
m827m21=n21

do m827=m826+1,nqul

i7=i827i7
n21=m827m21

print*,'loop827'
call write_symm_xmi_1(i7,n21,m827,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1527
if (sf2.eq.1)goto 100

i828i7=i7
m828m21=n21

do m828=m827+1,nqul

i7=i828i7
n21=m828m21

print*,'loop828'
call write_symm_xmi_1(i7,n21,m828,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1528
if (sf2.eq.1)goto 100

i829i7=i7
m829m21=n21

do m829=m828+1,nqul

i7=i829i7
n21=m829m21

print*,'loop829'
call write_symm_xmi_1(i7,n21,m829,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1529
if (sf2.eq.1)goto 100

i830i7=i7
m830m21=n21

do m830=m829+1,nqul

i7=i830i7
n21=m830m21

print*,'loop830'
call write_symm_xmi_1(i7,n21,m830,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1530
if (sf2.eq.1)goto 100

i831i7=i7
m831m21=n21

do m831=m830+1,nqul

i7=i831i7
n21=m831m21

print*,'loop831'
call write_symm_xmi_1(i7,n21,m831,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1531
if (sf2.eq.1)goto 100

i832i7=i7
m832m21=n21

do m832=m831+1,nqul

i7=i832i7
n21=m832m21

print*,'loop832'
call write_symm_xmi_1(i7,n21,m832,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1532
if (sf2.eq.1)goto 100

i833i7=i7
m833m21=n21

do m833=m832+1,nqul

i7=i833i7
n21=m833m21

print*,'loop833'
call write_symm_xmi_1(i7,n21,m833,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1533
if (sf2.eq.1)goto 100

i834i7=i7
m834m21=n21

do m834=m833+1,nqul

i7=i834i7
n21=m834m21

print*,'loop834'
call write_symm_xmi_1(i7,n21,m834,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1534
if (sf2.eq.1)goto 100

i835i7=i7
m835m21=n21

do m835=m834+1,nqul

i7=i835i7
n21=m835m21

print*,'loop835'
call write_symm_xmi_1(i7,n21,m835,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1535
if (sf2.eq.1)goto 100

i836i7=i7
m836m21=n21

do m836=m835+1,nqul

i7=i836i7
n21=m836m21

print*,'loop836'
call write_symm_xmi_1(i7,n21,m836,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1536
if (sf2.eq.1)goto 100

i837i7=i7
m837m21=n21

do m837=m836+1,nqul

i7=i837i7
n21=m837m21

print*,'loop837'
call write_symm_xmi_1(i7,n21,m837,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1537
if (sf2.eq.1)goto 100

i838i7=i7
m838m21=n21

do m838=m837+1,nqul

i7=i838i7
n21=m838m21

print*,'loop838'
call write_symm_xmi_1(i7,n21,m838,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1538
if (sf2.eq.1)goto 100

i839i7=i7
m839m21=n21

do m839=m838+1,nqul

i7=i839i7
n21=m839m21

print*,'loop839'
call write_symm_xmi_1(i7,n21,m839,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1539
if (sf2.eq.1)goto 100

i840i7=i7
m840m21=n21

do m840=m839+1,nqul

i7=i840i7
n21=m840m21

print*,'loop840'
call write_symm_xmi_1(i7,n21,m840,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1540
if (sf2.eq.1)goto 100

i841i7=i7
m841m21=n21

do m841=m840+1,nqul

i7=i841i7
n21=m841m21

print*,'loop841'
call write_symm_xmi_1(i7,n21,m841,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1541
if (sf2.eq.1)goto 100

i842i7=i7
m842m21=n21

do m842=m841+1,nqul

i7=i842i7
n21=m842m21

print*,'loop842'
call write_symm_xmi_1(i7,n21,m842,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1542
if (sf2.eq.1)goto 100

i843i7=i7
m843m21=n21

do m843=m842+1,nqul

i7=i843i7
n21=m843m21

print*,'loop843'
call write_symm_xmi_1(i7,n21,m843,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1543
if (sf2.eq.1)goto 100

i844i7=i7
m844m21=n21

do m844=m843+1,nqul

i7=i844i7
n21=m844m21

print*,'loop844'
call write_symm_xmi_1(i7,n21,m844,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1544
if (sf2.eq.1)goto 100

i845i7=i7
m845m21=n21

do m845=m844+1,nqul

i7=i845i7
n21=m845m21

print*,'loop845'
call write_symm_xmi_1(i7,n21,m845,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1545
if (sf2.eq.1)goto 100

i846i7=i7
m846m21=n21

do m846=m845+1,nqul

i7=i846i7
n21=m846m21

print*,'loop846'
call write_symm_xmi_1(i7,n21,m846,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1546
if (sf2.eq.1)goto 100

i847i7=i7
m847m21=n21

do m847=m846+1,nqul

i7=i847i7
n21=m847m21

print*,'loop847'
call write_symm_xmi_1(i7,n21,m847,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1547
if (sf2.eq.1)goto 100

i848i7=i7
m848m21=n21

do m848=m847+1,nqul

i7=i848i7
n21=m848m21

print*,'loop848'
call write_symm_xmi_1(i7,n21,m848,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1548
if (sf2.eq.1)goto 100

i849i7=i7
m849m21=n21

do m849=m848+1,nqul

i7=i849i7
n21=m849m21

print*,'loop849'
call write_symm_xmi_1(i7,n21,m849,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1549
if (sf2.eq.1)goto 100

i850i7=i7
m850m21=n21

do m850=m849+1,nqul

i7=i850i7
n21=m850m21

print*,'loop850'
call write_symm_xmi_1(i7,n21,m850,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1550
if (sf2.eq.1)goto 100

i851i7=i7
m851m21=n21

do m851=m850+1,nqul

i7=i851i7
n21=m851m21

print*,'loop851'
call write_symm_xmi_1(i7,n21,m851,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1551
if (sf2.eq.1)goto 100

i852i7=i7
m852m21=n21

do m852=m851+1,nqul

i7=i852i7
n21=m852m21

print*,'loop852'
call write_symm_xmi_1(i7,n21,m852,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1552
if (sf2.eq.1)goto 100

i853i7=i7
m853m21=n21

do m853=m852+1,nqul

i7=i853i7
n21=m853m21

print*,'loop853'
call write_symm_xmi_1(i7,n21,m853,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1553
if (sf2.eq.1)goto 100

i854i7=i7
m854m21=n21

do m854=m853+1,nqul

i7=i854i7
n21=m854m21

print*,'loop854'
call write_symm_xmi_1(i7,n21,m854,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1554
if (sf2.eq.1)goto 100

i855i7=i7
m855m21=n21

do m855=m854+1,nqul

i7=i855i7
n21=m855m21

print*,'loop855'
call write_symm_xmi_1(i7,n21,m855,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1555
if (sf2.eq.1)goto 100

i856i7=i7
m856m21=n21

do m856=m855+1,nqul

i7=i856i7
n21=m856m21

print*,'loop856'
call write_symm_xmi_1(i7,n21,m856,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1556
if (sf2.eq.1)goto 100

i857i7=i7
m857m21=n21

do m857=m856+1,nqul

i7=i857i7
n21=m857m21

print*,'loop857'
call write_symm_xmi_1(i7,n21,m857,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1557
if (sf2.eq.1)goto 100

i858i7=i7
m858m21=n21

do m858=m857+1,nqul

i7=i858i7
n21=m858m21

print*,'loop858'
call write_symm_xmi_1(i7,n21,m858,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1558
if (sf2.eq.1)goto 100

i859i7=i7
m859m21=n21

do m859=m858+1,nqul

i7=i859i7
n21=m859m21

print*,'loop859'
call write_symm_xmi_1(i7,n21,m859,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1559
if (sf2.eq.1)goto 100

i860i7=i7
m860m21=n21

do m860=m859+1,nqul

i7=i860i7
n21=m860m21

print*,'loop860'
call write_symm_xmi_1(i7,n21,m860,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1560
if (sf2.eq.1)goto 100

i861i7=i7
m861m21=n21

do m861=m860+1,nqul

i7=i861i7
n21=m861m21

print*,'loop861'
call write_symm_xmi_1(i7,n21,m861,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1561
if (sf2.eq.1)goto 100

i862i7=i7
m862m21=n21

do m862=m861+1,nqul

i7=i862i7
n21=m862m21

print*,'loop862'
call write_symm_xmi_1(i7,n21,m862,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1562
if (sf2.eq.1)goto 100

i863i7=i7
m863m21=n21

do m863=m862+1,nqul

i7=i863i7
n21=m863m21

print*,'loop863'
call write_symm_xmi_1(i7,n21,m863,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1563
if (sf2.eq.1)goto 100

i864i7=i7
m864m21=n21

do m864=m863+1,nqul

i7=i864i7
n21=m864m21

print*,'loop864'
call write_symm_xmi_1(i7,n21,m864,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1564
if (sf2.eq.1)goto 100

i865i7=i7
m865m21=n21

do m865=m864+1,nqul

i7=i865i7
n21=m865m21

print*,'loop865'
call write_symm_xmi_1(i7,n21,m865,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1565
if (sf2.eq.1)goto 100

i866i7=i7
m866m21=n21

do m866=m865+1,nqul

i7=i866i7
n21=m866m21

print*,'loop866'
call write_symm_xmi_1(i7,n21,m866,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1566
if (sf2.eq.1)goto 100

i867i7=i7
m867m21=n21

do m867=m866+1,nqul

i7=i867i7
n21=m867m21

print*,'loop867'
call write_symm_xmi_1(i7,n21,m867,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1567
if (sf2.eq.1)goto 100

i868i7=i7
m868m21=n21

do m868=m867+1,nqul

i7=i868i7
n21=m868m21

print*,'loop868'
call write_symm_xmi_1(i7,n21,m868,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1568
if (sf2.eq.1)goto 100

i869i7=i7
m869m21=n21

do m869=m868+1,nqul

i7=i869i7
n21=m869m21

print*,'loop869'
call write_symm_xmi_1(i7,n21,m869,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1569
if (sf2.eq.1)goto 100

i870i7=i7
m870m21=n21

do m870=m869+1,nqul

i7=i870i7
n21=m870m21

print*,'loop870'
call write_symm_xmi_1(i7,n21,m870,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1570
if (sf2.eq.1)goto 100

i871i7=i7
m871m21=n21

do m871=m870+1,nqul

i7=i871i7
n21=m871m21

print*,'loop871'
call write_symm_xmi_1(i7,n21,m871,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1571
if (sf2.eq.1)goto 100

i872i7=i7
m872m21=n21

do m872=m871+1,nqul

i7=i872i7
n21=m872m21

print*,'loop872'
call write_symm_xmi_1(i7,n21,m872,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1572
if (sf2.eq.1)goto 100

i873i7=i7
m873m21=n21

do m873=m872+1,nqul

i7=i873i7
n21=m873m21

print*,'loop873'
call write_symm_xmi_1(i7,n21,m873,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1573
if (sf2.eq.1)goto 100

i874i7=i7
m874m21=n21

do m874=m873+1,nqul

i7=i874i7
n21=m874m21

print*,'loop874'
call write_symm_xmi_1(i7,n21,m874,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1574
if (sf2.eq.1)goto 100

i875i7=i7
m875m21=n21

do m875=m874+1,nqul

i7=i875i7
n21=m875m21

print*,'loop875'
call write_symm_xmi_1(i7,n21,m875,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1575
if (sf2.eq.1)goto 100

i876i7=i7
m876m21=n21

do m876=m875+1,nqul

i7=i876i7
n21=m876m21

print*,'loop876'
call write_symm_xmi_1(i7,n21,m876,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1576
if (sf2.eq.1)goto 100

i877i7=i7
m877m21=n21

do m877=m876+1,nqul

i7=i877i7
n21=m877m21

print*,'loop877'
call write_symm_xmi_1(i7,n21,m877,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1577
if (sf2.eq.1)goto 100

i878i7=i7
m878m21=n21

do m878=m877+1,nqul

i7=i878i7
n21=m878m21

print*,'loop878'
call write_symm_xmi_1(i7,n21,m878,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1578
if (sf2.eq.1)goto 100

i879i7=i7
m879m21=n21

do m879=m878+1,nqul

i7=i879i7
n21=m879m21

print*,'loop879'
call write_symm_xmi_1(i7,n21,m879,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1579
if (sf2.eq.1)goto 100

i880i7=i7
m880m21=n21

do m880=m879+1,nqul

i7=i880i7
n21=m880m21

print*,'loop880'
call write_symm_xmi_1(i7,n21,m880,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1580
if (sf2.eq.1)goto 100

i881i7=i7
m881m21=n21

do m881=m880+1,nqul

i7=i881i7
n21=m881m21

print*,'loop881'
call write_symm_xmi_1(i7,n21,m881,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1581
if (sf2.eq.1)goto 100

i882i7=i7
m882m21=n21

do m882=m881+1,nqul

i7=i882i7
n21=m882m21

print*,'loop882'
call write_symm_xmi_1(i7,n21,m882,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1582
if (sf2.eq.1)goto 100

i883i7=i7
m883m21=n21

do m883=m882+1,nqul

i7=i883i7
n21=m883m21

print*,'loop883'
call write_symm_xmi_1(i7,n21,m883,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1583
if (sf2.eq.1)goto 100

i884i7=i7
m884m21=n21

do m884=m883+1,nqul

i7=i884i7
n21=m884m21

print*,'loop884'
call write_symm_xmi_1(i7,n21,m884,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1584
if (sf2.eq.1)goto 100

i885i7=i7
m885m21=n21

do m885=m884+1,nqul

i7=i885i7
n21=m885m21

print*,'loop885'
call write_symm_xmi_1(i7,n21,m885,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1585
if (sf2.eq.1)goto 100

i886i7=i7
m886m21=n21

do m886=m885+1,nqul

i7=i886i7
n21=m886m21

print*,'loop886'
call write_symm_xmi_1(i7,n21,m886,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1586
if (sf2.eq.1)goto 100

i887i7=i7
m887m21=n21

do m887=m886+1,nqul

i7=i887i7
n21=m887m21

print*,'loop887'
call write_symm_xmi_1(i7,n21,m887,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1587
if (sf2.eq.1)goto 100

i888i7=i7
m888m21=n21

do m888=m887+1,nqul

i7=i888i7
n21=m888m21

print*,'loop888'
call write_symm_xmi_1(i7,n21,m888,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1588
if (sf2.eq.1)goto 100

i889i7=i7
m889m21=n21

do m889=m888+1,nqul

i7=i889i7
n21=m889m21

print*,'loop889'
call write_symm_xmi_1(i7,n21,m889,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1589
if (sf2.eq.1)goto 100

i890i7=i7
m890m21=n21

do m890=m889+1,nqul

i7=i890i7
n21=m890m21

print*,'loop890'
call write_symm_xmi_1(i7,n21,m890,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1590
if (sf2.eq.1)goto 100

i891i7=i7
m891m21=n21

do m891=m890+1,nqul

i7=i891i7
n21=m891m21

print*,'loop891'
call write_symm_xmi_1(i7,n21,m891,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1591
if (sf2.eq.1)goto 100

i892i7=i7
m892m21=n21

do m892=m891+1,nqul

i7=i892i7
n21=m892m21

print*,'loop892'
call write_symm_xmi_1(i7,n21,m892,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1592
if (sf2.eq.1)goto 100

i893i7=i7
m893m21=n21

do m893=m892+1,nqul

i7=i893i7
n21=m893m21

print*,'loop893'
call write_symm_xmi_1(i7,n21,m893,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1593
if (sf2.eq.1)goto 100

i894i7=i7
m894m21=n21

do m894=m893+1,nqul

i7=i894i7
n21=m894m21

print*,'loop894'
call write_symm_xmi_1(i7,n21,m894,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1594
if (sf2.eq.1)goto 100

i895i7=i7
m895m21=n21

do m895=m894+1,nqul

i7=i895i7
n21=m895m21

print*,'loop895'
call write_symm_xmi_1(i7,n21,m895,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1595
if (sf2.eq.1)goto 100

i896i7=i7
m896m21=n21

do m896=m895+1,nqul

i7=i896i7
n21=m896m21

print*,'loop896'
call write_symm_xmi_1(i7,n21,m896,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1596
if (sf2.eq.1)goto 100

i897i7=i7
m897m21=n21

do m897=m896+1,nqul

i7=i897i7
n21=m897m21

print*,'loop897'
call write_symm_xmi_1(i7,n21,m897,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1597
if (sf2.eq.1)goto 100

i898i7=i7
m898m21=n21

do m898=m897+1,nqul

i7=i898i7
n21=m898m21

print*,'loop898'
call write_symm_xmi_1(i7,n21,m898,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1598
if (sf2.eq.1)goto 100

i899i7=i7
m899m21=n21

do m899=m898+1,nqul

i7=i899i7
n21=m899m21

print*,'loop899'
call write_symm_xmi_1(i7,n21,m899,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1599
if (sf2.eq.1)goto 100

i900i7=i7
m900m21=n21

do m900=m899+1,nqul

i7=i900i7
n21=m900m21

print*,'loop900'
call write_symm_xmi_1(i7,n21,m900,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1600
if (sf2.eq.1)goto 100

i901i7=i7
m901m21=n21

do m901=m900+1,nqul

i7=i901i7
n21=m901m21

print*,'loop901'
call write_symm_xmi_1(i7,n21,m901,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1601
if (sf2.eq.1)goto 100

i902i7=i7
m902m21=n21

do m902=m901+1,nqul

i7=i902i7
n21=m902m21

print*,'loop902'
call write_symm_xmi_1(i7,n21,m902,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1602
if (sf2.eq.1)goto 100

i903i7=i7
m903m21=n21

do m903=m902+1,nqul

i7=i903i7
n21=m903m21

print*,'loop903'
call write_symm_xmi_1(i7,n21,m903,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1603
if (sf2.eq.1)goto 100

i904i7=i7
m904m21=n21

do m904=m903+1,nqul

i7=i904i7
n21=m904m21

print*,'loop904'
call write_symm_xmi_1(i7,n21,m904,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1604
if (sf2.eq.1)goto 100

i905i7=i7
m905m21=n21

do m905=m904+1,nqul

i7=i905i7
n21=m905m21

print*,'loop905'
call write_symm_xmi_1(i7,n21,m905,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1605
if (sf2.eq.1)goto 100

i906i7=i7
m906m21=n21

do m906=m905+1,nqul

i7=i906i7
n21=m906m21

print*,'loop906'
call write_symm_xmi_1(i7,n21,m906,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1606
if (sf2.eq.1)goto 100

i907i7=i7
m907m21=n21

do m907=m906+1,nqul

i7=i907i7
n21=m907m21

print*,'loop907'
call write_symm_xmi_1(i7,n21,m907,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1607
if (sf2.eq.1)goto 100

i908i7=i7
m908m21=n21

do m908=m907+1,nqul

i7=i908i7
n21=m908m21

print*,'loop908'
call write_symm_xmi_1(i7,n21,m908,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1608
if (sf2.eq.1)goto 100

i909i7=i7
m909m21=n21

do m909=m908+1,nqul

i7=i909i7
n21=m909m21

print*,'loop909'
call write_symm_xmi_1(i7,n21,m909,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1609
if (sf2.eq.1)goto 100

i910i7=i7
m910m21=n21

do m910=m909+1,nqul

i7=i910i7
n21=m910m21

print*,'loop910'
call write_symm_xmi_1(i7,n21,m910,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1610
if (sf2.eq.1)goto 100

i911i7=i7
m911m21=n21

do m911=m910+1,nqul

i7=i911i7
n21=m911m21

print*,'loop911'
call write_symm_xmi_1(i7,n21,m911,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1611
if (sf2.eq.1)goto 100

i912i7=i7
m912m21=n21

do m912=m911+1,nqul

i7=i912i7
n21=m912m21

print*,'loop912'
call write_symm_xmi_1(i7,n21,m912,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1612
if (sf2.eq.1)goto 100

i913i7=i7
m913m21=n21

do m913=m912+1,nqul

i7=i913i7
n21=m913m21

print*,'loop913'
call write_symm_xmi_1(i7,n21,m913,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1613
if (sf2.eq.1)goto 100

i914i7=i7
m914m21=n21

do m914=m913+1,nqul

i7=i914i7
n21=m914m21

print*,'loop914'
call write_symm_xmi_1(i7,n21,m914,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1614
if (sf2.eq.1)goto 100

i915i7=i7
m915m21=n21

do m915=m914+1,nqul

i7=i915i7
n21=m915m21

print*,'loop915'
call write_symm_xmi_1(i7,n21,m915,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1615
if (sf2.eq.1)goto 100

i916i7=i7
m916m21=n21

do m916=m915+1,nqul

i7=i916i7
n21=m916m21

print*,'loop916'
call write_symm_xmi_1(i7,n21,m916,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1616
if (sf2.eq.1)goto 100

i917i7=i7
m917m21=n21

do m917=m916+1,nqul

i7=i917i7
n21=m917m21

print*,'loop917'
call write_symm_xmi_1(i7,n21,m917,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1617
if (sf2.eq.1)goto 100

i918i7=i7
m918m21=n21

do m918=m917+1,nqul

i7=i918i7
n21=m918m21

print*,'loop918'
call write_symm_xmi_1(i7,n21,m918,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1618
if (sf2.eq.1)goto 100

i919i7=i7
m919m21=n21

do m919=m918+1,nqul

i7=i919i7
n21=m919m21

print*,'loop919'
call write_symm_xmi_1(i7,n21,m919,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1619
if (sf2.eq.1)goto 100

i920i7=i7
m920m21=n21

do m920=m919+1,nqul

i7=i920i7
n21=m920m21

print*,'loop920'
call write_symm_xmi_1(i7,n21,m920,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1620
if (sf2.eq.1)goto 100

i921i7=i7
m921m21=n21

do m921=m920+1,nqul

i7=i921i7
n21=m921m21

print*,'loop921'
call write_symm_xmi_1(i7,n21,m921,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1621
if (sf2.eq.1)goto 100

i922i7=i7
m922m21=n21

do m922=m921+1,nqul

i7=i922i7
n21=m922m21

print*,'loop922'
call write_symm_xmi_1(i7,n21,m922,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1622
if (sf2.eq.1)goto 100

i923i7=i7
m923m21=n21

do m923=m922+1,nqul

i7=i923i7
n21=m923m21

print*,'loop923'
call write_symm_xmi_1(i7,n21,m923,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1623
if (sf2.eq.1)goto 100

i924i7=i7
m924m21=n21

do m924=m923+1,nqul

i7=i924i7
n21=m924m21

print*,'loop924'
call write_symm_xmi_1(i7,n21,m924,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1624
if (sf2.eq.1)goto 100

i925i7=i7
m925m21=n21

do m925=m924+1,nqul

i7=i925i7
n21=m925m21

print*,'loop925'
call write_symm_xmi_1(i7,n21,m925,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1625
if (sf2.eq.1)goto 100

i926i7=i7
m926m21=n21

do m926=m925+1,nqul

i7=i926i7
n21=m926m21

print*,'loop926'
call write_symm_xmi_1(i7,n21,m926,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1626
if (sf2.eq.1)goto 100

i927i7=i7
m927m21=n21

do m927=m926+1,nqul

i7=i927i7
n21=m927m21

print*,'loop927'
call write_symm_xmi_1(i7,n21,m927,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1627
if (sf2.eq.1)goto 100

i928i7=i7
m928m21=n21

do m928=m927+1,nqul

i7=i928i7
n21=m928m21

print*,'loop928'
call write_symm_xmi_1(i7,n21,m928,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1628
if (sf2.eq.1)goto 100

i929i7=i7
m929m21=n21

do m929=m928+1,nqul

i7=i929i7
n21=m929m21

print*,'loop929'
call write_symm_xmi_1(i7,n21,m929,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1629
if (sf2.eq.1)goto 100

i930i7=i7
m930m21=n21

do m930=m929+1,nqul

i7=i930i7
n21=m930m21

print*,'loop930'
call write_symm_xmi_1(i7,n21,m930,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1630
if (sf2.eq.1)goto 100

i931i7=i7
m931m21=n21

do m931=m930+1,nqul

i7=i931i7
n21=m931m21

print*,'loop931'
call write_symm_xmi_1(i7,n21,m931,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1631
if (sf2.eq.1)goto 100

i932i7=i7
m932m21=n21

do m932=m931+1,nqul

i7=i932i7
n21=m932m21

print*,'loop932'
call write_symm_xmi_1(i7,n21,m932,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1632
if (sf2.eq.1)goto 100

i933i7=i7
m933m21=n21

do m933=m932+1,nqul

i7=i933i7
n21=m933m21

print*,'loop933'
call write_symm_xmi_1(i7,n21,m933,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1633
if (sf2.eq.1)goto 100

i934i7=i7
m934m21=n21

do m934=m933+1,nqul

i7=i934i7
n21=m934m21

print*,'loop934'
call write_symm_xmi_1(i7,n21,m934,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1634
if (sf2.eq.1)goto 100

i935i7=i7
m935m21=n21

do m935=m934+1,nqul

i7=i935i7
n21=m935m21

print*,'loop935'
call write_symm_xmi_1(i7,n21,m935,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1635
if (sf2.eq.1)goto 100

i936i7=i7
m936m21=n21

do m936=m935+1,nqul

i7=i936i7
n21=m936m21

print*,'loop936'
call write_symm_xmi_1(i7,n21,m936,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1636
if (sf2.eq.1)goto 100

i937i7=i7
m937m21=n21

do m937=m936+1,nqul

i7=i937i7
n21=m937m21

print*,'loop937'
call write_symm_xmi_1(i7,n21,m937,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1637
if (sf2.eq.1)goto 100

i938i7=i7
m938m21=n21

do m938=m937+1,nqul

i7=i938i7
n21=m938m21

print*,'loop938'
call write_symm_xmi_1(i7,n21,m938,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1638
if (sf2.eq.1)goto 100

i939i7=i7
m939m21=n21

do m939=m938+1,nqul

i7=i939i7
n21=m939m21

print*,'loop939'
call write_symm_xmi_1(i7,n21,m939,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1639
if (sf2.eq.1)goto 100

i940i7=i7
m940m21=n21

do m940=m939+1,nqul

i7=i940i7
n21=m940m21

print*,'loop940'
call write_symm_xmi_1(i7,n21,m940,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1640
if (sf2.eq.1)goto 100

i941i7=i7
m941m21=n21

do m941=m940+1,nqul

i7=i941i7
n21=m941m21

print*,'loop941'
call write_symm_xmi_1(i7,n21,m941,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1641
if (sf2.eq.1)goto 100

i942i7=i7
m942m21=n21

do m942=m941+1,nqul

i7=i942i7
n21=m942m21

print*,'loop942'
call write_symm_xmi_1(i7,n21,m942,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1642
if (sf2.eq.1)goto 100

i943i7=i7
m943m21=n21

do m943=m942+1,nqul

i7=i943i7
n21=m943m21

print*,'loop943'
call write_symm_xmi_1(i7,n21,m943,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1643
if (sf2.eq.1)goto 100

i944i7=i7
m944m21=n21

do m944=m943+1,nqul

i7=i944i7
n21=m944m21

print*,'loop944'
call write_symm_xmi_1(i7,n21,m944,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1644
if (sf2.eq.1)goto 100

i945i7=i7
m945m21=n21

do m945=m944+1,nqul

i7=i945i7
n21=m945m21

print*,'loop945'
call write_symm_xmi_1(i7,n21,m945,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1645
if (sf2.eq.1)goto 100

i946i7=i7
m946m21=n21

do m946=m945+1,nqul

i7=i946i7
n21=m946m21

print*,'loop946'
call write_symm_xmi_1(i7,n21,m946,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1646
if (sf2.eq.1)goto 100

i947i7=i7
m947m21=n21

do m947=m946+1,nqul

i7=i947i7
n21=m947m21

print*,'loop947'
call write_symm_xmi_1(i7,n21,m947,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1647
if (sf2.eq.1)goto 100

i948i7=i7
m948m21=n21

do m948=m947+1,nqul

i7=i948i7
n21=m948m21

print*,'loop948'
call write_symm_xmi_1(i7,n21,m948,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1648
if (sf2.eq.1)goto 100

i949i7=i7
m949m21=n21

do m949=m948+1,nqul

i7=i949i7
n21=m949m21

print*,'loop949'
call write_symm_xmi_1(i7,n21,m949,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1649
if (sf2.eq.1)goto 100

i950i7=i7
m950m21=n21

do m950=m949+1,nqul

i7=i950i7
n21=m950m21

print*,'loop950'
call write_symm_xmi_1(i7,n21,m950,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1650
if (sf2.eq.1)goto 100

i951i7=i7
m951m21=n21

do m951=m950+1,nqul

i7=i951i7
n21=m951m21

print*,'loop951'
call write_symm_xmi_1(i7,n21,m951,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1651
if (sf2.eq.1)goto 100

i952i7=i7
m952m21=n21

do m952=m951+1,nqul

i7=i952i7
n21=m952m21

print*,'loop952'
call write_symm_xmi_1(i7,n21,m952,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1652
if (sf2.eq.1)goto 100

i953i7=i7
m953m21=n21

do m953=m952+1,nqul

i7=i953i7
n21=m953m21

print*,'loop953'
call write_symm_xmi_1(i7,n21,m953,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1653
if (sf2.eq.1)goto 100

i954i7=i7
m954m21=n21

do m954=m953+1,nqul

i7=i954i7
n21=m954m21

print*,'loop954'
call write_symm_xmi_1(i7,n21,m954,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1654
if (sf2.eq.1)goto 100

i955i7=i7
m955m21=n21

do m955=m954+1,nqul

i7=i955i7
n21=m955m21

print*,'loop955'
call write_symm_xmi_1(i7,n21,m955,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1655
if (sf2.eq.1)goto 100

i956i7=i7
m956m21=n21

do m956=m955+1,nqul

i7=i956i7
n21=m956m21

print*,'loop956'
call write_symm_xmi_1(i7,n21,m956,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1656
if (sf2.eq.1)goto 100

i957i7=i7
m957m21=n21

do m957=m956+1,nqul

i7=i957i7
n21=m957m21

print*,'loop957'
call write_symm_xmi_1(i7,n21,m957,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1657
if (sf2.eq.1)goto 100

i958i7=i7
m958m21=n21

do m958=m957+1,nqul

i7=i958i7
n21=m958m21

print*,'loop958'
call write_symm_xmi_1(i7,n21,m958,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1658
if (sf2.eq.1)goto 100

i959i7=i7
m959m21=n21

do m959=m958+1,nqul

i7=i959i7
n21=m959m21

print*,'loop959'
call write_symm_xmi_1(i7,n21,m959,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1659
if (sf2.eq.1)goto 100

i960i7=i7
m960m21=n21

do m960=m959+1,nqul

i7=i960i7
n21=m960m21

print*,'loop960'
call write_symm_xmi_1(i7,n21,m960,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1660
if (sf2.eq.1)goto 100

i961i7=i7
m961m21=n21

do m961=m960+1,nqul

i7=i961i7
n21=m961m21

print*,'loop961'
call write_symm_xmi_1(i7,n21,m961,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1661
if (sf2.eq.1)goto 100

i962i7=i7
m962m21=n21

do m962=m961+1,nqul

i7=i962i7
n21=m962m21

print*,'loop962'
call write_symm_xmi_1(i7,n21,m962,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1662
if (sf2.eq.1)goto 100

i963i7=i7
m963m21=n21

do m963=m962+1,nqul

i7=i963i7
n21=m963m21

print*,'loop963'
call write_symm_xmi_1(i7,n21,m963,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1663
if (sf2.eq.1)goto 100

i964i7=i7
m964m21=n21

do m964=m963+1,nqul

i7=i964i7
n21=m964m21

print*,'loop964'
call write_symm_xmi_1(i7,n21,m964,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1664
if (sf2.eq.1)goto 100

i965i7=i7
m965m21=n21

do m965=m964+1,nqul

i7=i965i7
n21=m965m21

print*,'loop965'
call write_symm_xmi_1(i7,n21,m965,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1665
if (sf2.eq.1)goto 100

i966i7=i7
m966m21=n21

do m966=m965+1,nqul

i7=i966i7
n21=m966m21

print*,'loop966'
call write_symm_xmi_1(i7,n21,m966,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1666
if (sf2.eq.1)goto 100

i967i7=i7
m967m21=n21

do m967=m966+1,nqul

i7=i967i7
n21=m967m21

print*,'loop967'
call write_symm_xmi_1(i7,n21,m967,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1667
if (sf2.eq.1)goto 100

i968i7=i7
m968m21=n21

do m968=m967+1,nqul

i7=i968i7
n21=m968m21

print*,'loop968'
call write_symm_xmi_1(i7,n21,m968,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1668
if (sf2.eq.1)goto 100

i969i7=i7
m969m21=n21

do m969=m968+1,nqul

i7=i969i7
n21=m969m21

print*,'loop969'
call write_symm_xmi_1(i7,n21,m969,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1669
if (sf2.eq.1)goto 100

i970i7=i7
m970m21=n21

do m970=m969+1,nqul

i7=i970i7
n21=m970m21

print*,'loop970'
call write_symm_xmi_1(i7,n21,m970,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1670
if (sf2.eq.1)goto 100

i971i7=i7
m971m21=n21

do m971=m970+1,nqul

i7=i971i7
n21=m971m21

print*,'loop971'
call write_symm_xmi_1(i7,n21,m971,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1671
if (sf2.eq.1)goto 100

i972i7=i7
m972m21=n21

do m972=m971+1,nqul

i7=i972i7
n21=m972m21

print*,'loop972'
call write_symm_xmi_1(i7,n21,m972,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1672
if (sf2.eq.1)goto 100

i973i7=i7
m973m21=n21

do m973=m972+1,nqul

i7=i973i7
n21=m973m21

print*,'loop973'
call write_symm_xmi_1(i7,n21,m973,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1673
if (sf2.eq.1)goto 100

i974i7=i7
m974m21=n21

do m974=m973+1,nqul

i7=i974i7
n21=m974m21

print*,'loop974'
call write_symm_xmi_1(i7,n21,m974,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1674
if (sf2.eq.1)goto 100

i975i7=i7
m975m21=n21

do m975=m974+1,nqul

i7=i975i7
n21=m975m21

print*,'loop975'
call write_symm_xmi_1(i7,n21,m975,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1675
if (sf2.eq.1)goto 100

i976i7=i7
m976m21=n21

do m976=m975+1,nqul

i7=i976i7
n21=m976m21

print*,'loop976'
call write_symm_xmi_1(i7,n21,m976,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1676
if (sf2.eq.1)goto 100

i977i7=i7
m977m21=n21

do m977=m976+1,nqul

i7=i977i7
n21=m977m21

print*,'loop977'
call write_symm_xmi_1(i7,n21,m977,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1677
if (sf2.eq.1)goto 100

i978i7=i7
m978m21=n21

do m978=m977+1,nqul

i7=i978i7
n21=m978m21

print*,'loop978'
call write_symm_xmi_1(i7,n21,m978,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1678
if (sf2.eq.1)goto 100

i979i7=i7
m979m21=n21

do m979=m978+1,nqul

i7=i979i7
n21=m979m21

print*,'loop979'
call write_symm_xmi_1(i7,n21,m979,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1679
if (sf2.eq.1)goto 100

i980i7=i7
m980m21=n21

do m980=m979+1,nqul

i7=i980i7
n21=m980m21

print*,'loop980'
call write_symm_xmi_1(i7,n21,m980,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1680
if (sf2.eq.1)goto 100

i981i7=i7
m981m21=n21

do m981=m980+1,nqul

i7=i981i7
n21=m981m21

print*,'loop981'
call write_symm_xmi_1(i7,n21,m981,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1681
if (sf2.eq.1)goto 100

i982i7=i7
m982m21=n21

do m982=m981+1,nqul

i7=i982i7
n21=m982m21

print*,'loop982'
call write_symm_xmi_1(i7,n21,m982,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1682
if (sf2.eq.1)goto 100

i983i7=i7
m983m21=n21

do m983=m982+1,nqul

i7=i983i7
n21=m983m21

print*,'loop983'
call write_symm_xmi_1(i7,n21,m983,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1683
if (sf2.eq.1)goto 100

i984i7=i7
m984m21=n21

do m984=m983+1,nqul

i7=i984i7
n21=m984m21

print*,'loop984'
call write_symm_xmi_1(i7,n21,m984,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1684
if (sf2.eq.1)goto 100

i985i7=i7
m985m21=n21

do m985=m984+1,nqul

i7=i985i7
n21=m985m21

print*,'loop985'
call write_symm_xmi_1(i7,n21,m985,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1685
if (sf2.eq.1)goto 100

i986i7=i7
m986m21=n21

do m986=m985+1,nqul

i7=i986i7
n21=m986m21

print*,'loop986'
call write_symm_xmi_1(i7,n21,m986,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1686
if (sf2.eq.1)goto 100

i987i7=i7
m987m21=n21

do m987=m986+1,nqul

i7=i987i7
n21=m987m21

print*,'loop987'
call write_symm_xmi_1(i7,n21,m987,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1687
if (sf2.eq.1)goto 100

i988i7=i7
m988m21=n21

do m988=m987+1,nqul

i7=i988i7
n21=m988m21

print*,'loop988'
call write_symm_xmi_1(i7,n21,m988,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1688
if (sf2.eq.1)goto 100

i989i7=i7
m989m21=n21

do m989=m988+1,nqul

i7=i989i7
n21=m989m21

print*,'loop989'
call write_symm_xmi_1(i7,n21,m989,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1689
if (sf2.eq.1)goto 100

i990i7=i7
m990m21=n21

do m990=m989+1,nqul

i7=i990i7
n21=m990m21

print*,'loop990'
call write_symm_xmi_1(i7,n21,m990,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1690
if (sf2.eq.1)goto 100

i991i7=i7
m991m21=n21

do m991=m990+1,nqul

i7=i991i7
n21=m991m21

print*,'loop991'
call write_symm_xmi_1(i7,n21,m991,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1691
if (sf2.eq.1)goto 100

i992i7=i7
m992m21=n21

do m992=m991+1,nqul

i7=i992i7
n21=m992m21

print*,'loop992'
call write_symm_xmi_1(i7,n21,m992,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1692
if (sf2.eq.1)goto 100

i993i7=i7
m993m21=n21

do m993=m992+1,nqul

i7=i993i7
n21=m993m21

print*,'loop993'
call write_symm_xmi_1(i7,n21,m993,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1693
if (sf2.eq.1)goto 100

i994i7=i7
m994m21=n21

do m994=m993+1,nqul

i7=i994i7
n21=m994m21

print*,'loop994'
call write_symm_xmi_1(i7,n21,m994,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1694
if (sf2.eq.1)goto 100

i995i7=i7
m995m21=n21

do m995=m994+1,nqul

i7=i995i7
n21=m995m21

print*,'loop995'
call write_symm_xmi_1(i7,n21,m995,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1695
if (sf2.eq.1)goto 100

i996i7=i7
m996m21=n21

do m996=m995+1,nqul

i7=i996i7
n21=m996m21

print*,'loop996'
call write_symm_xmi_1(i7,n21,m996,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1696
if (sf2.eq.1)goto 100

i997i7=i7
m997m21=n21

do m997=m996+1,nqul

i7=i997i7
n21=m997m21

print*,'loop997'
call write_symm_xmi_1(i7,n21,m997,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1697
if (sf2.eq.1)goto 100

i998i7=i7
m998m21=n21

do m998=m997+1,nqul

i7=i998i7
n21=m998m21

print*,'loop998'
call write_symm_xmi_1(i7,n21,m998,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1698
if (sf2.eq.1)goto 100

i999i7=i7
m999m21=n21

do m999=m998+1,nqul

i7=i999i7
n21=m999m21

print*,'loop999'
call write_symm_xmi_1(i7,n21,m999,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1699
if (sf2.eq.1)goto 100

i1000i7=i7
m1000m21=n21

do m1000=m999+1,nqul

i7=i1000i7
n21=m1000m21

print*,'loop1000'
call write_symm_xmi_1(i7,n21,m1000,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1700
if (sf2.eq.1)goto 100

i1001i7=i7
m1001m21=n21

do m1001=m1000+1,nqul

i7=i1001i7
n21=m1001m21

print*,'loop1001'
call write_symm_xmi_1(i7,n21,m1001,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1701
if (sf2.eq.1)goto 100

i1002i7=i7
m1002m21=n21

do m1002=m1001+1,nqul

i7=i1002i7
n21=m1002m21

print*,'loop1002'
call write_symm_xmi_1(i7,n21,m1002,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1702
if (sf2.eq.1)goto 100

i1003i7=i7
m1003m21=n21

do m1003=m1002+1,nqul

i7=i1003i7
n21=m1003m21

print*,'loop1003'
call write_symm_xmi_1(i7,n21,m1003,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1703
if (sf2.eq.1)goto 100

i1004i7=i7
m1004m21=n21

do m1004=m1003+1,nqul

i7=i1004i7
n21=m1004m21

print*,'loop1004'
call write_symm_xmi_1(i7,n21,m1004,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1704
if (sf2.eq.1)goto 100

i1005i7=i7
m1005m21=n21

do m1005=m1004+1,nqul

i7=i1005i7
n21=m1005m21

print*,'loop1005'
call write_symm_xmi_1(i7,n21,m1005,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1705
if (sf2.eq.1)goto 100

i1006i7=i7
m1006m21=n21

do m1006=m1005+1,nqul

i7=i1006i7
n21=m1006m21

print*,'loop1006'
call write_symm_xmi_1(i7,n21,m1006,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1706
if (sf2.eq.1)goto 100

i1007i7=i7
m1007m21=n21

do m1007=m1006+1,nqul

i7=i1007i7
n21=m1007m21

print*,'loop1007'
call write_symm_xmi_1(i7,n21,m1007,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1707
if (sf2.eq.1)goto 100

i1008i7=i7
m1008m21=n21

do m1008=m1007+1,nqul

i7=i1008i7
n21=m1008m21

print*,'loop1008'
call write_symm_xmi_1(i7,n21,m1008,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1708
if (sf2.eq.1)goto 100

i1009i7=i7
m1009m21=n21

do m1009=m1008+1,nqul

i7=i1009i7
n21=m1009m21

print*,'loop1009'
call write_symm_xmi_1(i7,n21,m1009,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1709
if (sf2.eq.1)goto 100

i1010i7=i7
m1010m21=n21

do m1010=m1009+1,nqul

i7=i1010i7
n21=m1010m21

print*,'loop1010'
call write_symm_xmi_1(i7,n21,m1010,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1710
if (sf2.eq.1)goto 100

i1011i7=i7
m1011m21=n21

do m1011=m1010+1,nqul

i7=i1011i7
n21=m1011m21

print*,'loop1011'
call write_symm_xmi_1(i7,n21,m1011,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1711
if (sf2.eq.1)goto 100

i1012i7=i7
m1012m21=n21

do m1012=m1011+1,nqul

i7=i1012i7
n21=m1012m21

print*,'loop1012'
call write_symm_xmi_1(i7,n21,m1012,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1712
if (sf2.eq.1)goto 100

i1013i7=i7
m1013m21=n21

do m1013=m1012+1,nqul

i7=i1013i7
n21=m1013m21

print*,'loop1013'
call write_symm_xmi_1(i7,n21,m1013,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1713
if (sf2.eq.1)goto 100

i1014i7=i7
m1014m21=n21

do m1014=m1013+1,nqul

i7=i1014i7
n21=m1014m21

print*,'loop1014'
call write_symm_xmi_1(i7,n21,m1014,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1714
if (sf2.eq.1)goto 100

i1015i7=i7
m1015m21=n21

do m1015=m1014+1,nqul

i7=i1015i7
n21=m1015m21

print*,'loop1015'
call write_symm_xmi_1(i7,n21,m1015,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1715
if (sf2.eq.1)goto 100

i1016i7=i7
m1016m21=n21

do m1016=m1015+1,nqul

i7=i1016i7
n21=m1016m21

print*,'loop1016'
call write_symm_xmi_1(i7,n21,m1016,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1716
if (sf2.eq.1)goto 100

i1017i7=i7
m1017m21=n21

do m1017=m1016+1,nqul

i7=i1017i7
n21=m1017m21

print*,'loop1017'
call write_symm_xmi_1(i7,n21,m1017,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1717
if (sf2.eq.1)goto 100

i1018i7=i7
m1018m21=n21

do m1018=m1017+1,nqul

i7=i1018i7
n21=m1018m21

print*,'loop1018'
call write_symm_xmi_1(i7,n21,m1018,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1718
if (sf2.eq.1)goto 100

i1019i7=i7
m1019m21=n21

do m1019=m1018+1,nqul

i7=i1019i7
n21=m1019m21

print*,'loop1019'
call write_symm_xmi_1(i7,n21,m1019,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1719
if (sf2.eq.1)goto 100

i1020i7=i7
m1020m21=n21

do m1020=m1019+1,nqul

i7=i1020i7
n21=m1020m21

print*,'loop1020'
call write_symm_xmi_1(i7,n21,m1020,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1720
if (sf2.eq.1)goto 100

i1021i7=i7
m1021m21=n21

do m1021=m1020+1,nqul

i7=i1021i7
n21=m1021m21

print*,'loop1021'
call write_symm_xmi_1(i7,n21,m1021,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1721
if (sf2.eq.1)goto 100

i1022i7=i7
m1022m21=n21

do m1022=m1021+1,nqul

i7=i1022i7
n21=m1022m21

print*,'loop1022'
call write_symm_xmi_1(i7,n21,m1022,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1722
if (sf2.eq.1)goto 100

i1023i7=i7
m1023m21=n21

do m1023=m1022+1,nqul

i7=i1023i7
n21=m1023m21

print*,'loop1023'
call write_symm_xmi_1(i7,n21,m1023,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1723
if (sf2.eq.1)goto 100

i1024i7=i7
m1024m21=n21

do m1024=m1023+1,nqul

i7=i1024i7
n21=m1024m21

print*,'loop1024'
call write_symm_xmi_1(i7,n21,m1024,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1724
if (sf2.eq.1)goto 100

i1025i7=i7
m1025m21=n21

do m1025=m1024+1,nqul

i7=i1025i7
n21=m1025m21

print*,'loop1025'
call write_symm_xmi_1(i7,n21,m1025,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1725
if (sf2.eq.1)goto 100

i1026i7=i7
m1026m21=n21

do m1026=m1025+1,nqul

i7=i1026i7
n21=m1026m21

print*,'loop1026'
call write_symm_xmi_1(i7,n21,m1026,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1726
if (sf2.eq.1)goto 100

i1027i7=i7
m1027m21=n21

do m1027=m1026+1,nqul

i7=i1027i7
n21=m1027m21

print*,'loop1027'
call write_symm_xmi_1(i7,n21,m1027,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1727
if (sf2.eq.1)goto 100

i1028i7=i7
m1028m21=n21

do m1028=m1027+1,nqul

i7=i1028i7
n21=m1028m21

print*,'loop1028'
call write_symm_xmi_1(i7,n21,m1028,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1728
if (sf2.eq.1)goto 100

i1029i7=i7
m1029m21=n21

do m1029=m1028+1,nqul

i7=i1029i7
n21=m1029m21

print*,'loop1029'
call write_symm_xmi_1(i7,n21,m1029,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1729
if (sf2.eq.1)goto 100

i1030i7=i7
m1030m21=n21

do m1030=m1029+1,nqul

i7=i1030i7
n21=m1030m21

print*,'loop1030'
call write_symm_xmi_1(i7,n21,m1030,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1730
if (sf2.eq.1)goto 100

i1031i7=i7
m1031m21=n21

do m1031=m1030+1,nqul

i7=i1031i7
n21=m1031m21

print*,'loop1031'
call write_symm_xmi_1(i7,n21,m1031,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1731
if (sf2.eq.1)goto 100

i1032i7=i7
m1032m21=n21

do m1032=m1031+1,nqul

i7=i1032i7
n21=m1032m21

print*,'loop1032'
call write_symm_xmi_1(i7,n21,m1032,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1732
if (sf2.eq.1)goto 100

i1033i7=i7
m1033m21=n21

do m1033=m1032+1,nqul

i7=i1033i7
n21=m1033m21

print*,'loop1033'
call write_symm_xmi_1(i7,n21,m1033,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1733
if (sf2.eq.1)goto 100

i1034i7=i7
m1034m21=n21

do m1034=m1033+1,nqul

i7=i1034i7
n21=m1034m21

print*,'loop1034'
call write_symm_xmi_1(i7,n21,m1034,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1734
if (sf2.eq.1)goto 100

i1035i7=i7
m1035m21=n21

do m1035=m1034+1,nqul

i7=i1035i7
n21=m1035m21

print*,'loop1035'
call write_symm_xmi_1(i7,n21,m1035,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1735
if (sf2.eq.1)goto 100

i1036i7=i7
m1036m21=n21

do m1036=m1035+1,nqul

i7=i1036i7
n21=m1036m21

print*,'loop1036'
call write_symm_xmi_1(i7,n21,m1036,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1736
if (sf2.eq.1)goto 100

i1037i7=i7
m1037m21=n21

do m1037=m1036+1,nqul

i7=i1037i7
n21=m1037m21

print*,'loop1037'
call write_symm_xmi_1(i7,n21,m1037,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1737
if (sf2.eq.1)goto 100

i1038i7=i7
m1038m21=n21

do m1038=m1037+1,nqul

i7=i1038i7
n21=m1038m21

print*,'loop1038'
call write_symm_xmi_1(i7,n21,m1038,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1738
if (sf2.eq.1)goto 100

i1039i7=i7
m1039m21=n21

do m1039=m1038+1,nqul

i7=i1039i7
n21=m1039m21

print*,'loop1039'
call write_symm_xmi_1(i7,n21,m1039,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1739
if (sf2.eq.1)goto 100

i1040i7=i7
m1040m21=n21

do m1040=m1039+1,nqul

i7=i1040i7
n21=m1040m21

print*,'loop1040'
call write_symm_xmi_1(i7,n21,m1040,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1740
if (sf2.eq.1)goto 100

i1041i7=i7
m1041m21=n21

do m1041=m1040+1,nqul

i7=i1041i7
n21=m1041m21

print*,'loop1041'
call write_symm_xmi_1(i7,n21,m1041,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1741
if (sf2.eq.1)goto 100

i1042i7=i7
m1042m21=n21

do m1042=m1041+1,nqul

i7=i1042i7
n21=m1042m21

print*,'loop1042'
call write_symm_xmi_1(i7,n21,m1042,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1742
if (sf2.eq.1)goto 100

i1043i7=i7
m1043m21=n21

do m1043=m1042+1,nqul

i7=i1043i7
n21=m1043m21

print*,'loop1043'
call write_symm_xmi_1(i7,n21,m1043,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1743
if (sf2.eq.1)goto 100

i1044i7=i7
m1044m21=n21

do m1044=m1043+1,nqul

i7=i1044i7
n21=m1044m21

print*,'loop1044'
call write_symm_xmi_1(i7,n21,m1044,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1744
if (sf2.eq.1)goto 100

i1045i7=i7
m1045m21=n21

do m1045=m1044+1,nqul

i7=i1045i7
n21=m1045m21

print*,'loop1045'
call write_symm_xmi_1(i7,n21,m1045,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1745
if (sf2.eq.1)goto 100

i1046i7=i7
m1046m21=n21

do m1046=m1045+1,nqul

i7=i1046i7
n21=m1046m21

print*,'loop1046'
call write_symm_xmi_1(i7,n21,m1046,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1746
if (sf2.eq.1)goto 100

i1047i7=i7
m1047m21=n21

do m1047=m1046+1,nqul

i7=i1047i7
n21=m1047m21

print*,'loop1047'
call write_symm_xmi_1(i7,n21,m1047,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1747
if (sf2.eq.1)goto 100

i1048i7=i7
m1048m21=n21

do m1048=m1047+1,nqul

i7=i1048i7
n21=m1048m21

print*,'loop1048'
call write_symm_xmi_1(i7,n21,m1048,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1748
if (sf2.eq.1)goto 100

i1049i7=i7
m1049m21=n21

do m1049=m1048+1,nqul

i7=i1049i7
n21=m1049m21

print*,'loop1049'
call write_symm_xmi_1(i7,n21,m1049,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1749
if (sf2.eq.1)goto 100

i1050i7=i7
m1050m21=n21

do m1050=m1049+1,nqul

i7=i1050i7
n21=m1050m21

print*,'loop1050'
call write_symm_xmi_1(i7,n21,m1050,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1750
if (sf2.eq.1)goto 100

i1051i7=i7
m1051m21=n21

do m1051=m1050+1,nqul

i7=i1051i7
n21=m1051m21

print*,'loop1051'
call write_symm_xmi_1(i7,n21,m1051,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1751
if (sf2.eq.1)goto 100

i1052i7=i7
m1052m21=n21

do m1052=m1051+1,nqul

i7=i1052i7
n21=m1052m21

print*,'loop1052'
call write_symm_xmi_1(i7,n21,m1052,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1752
if (sf2.eq.1)goto 100

i1053i7=i7
m1053m21=n21

do m1053=m1052+1,nqul

i7=i1053i7
n21=m1053m21

print*,'loop1053'
call write_symm_xmi_1(i7,n21,m1053,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1753
if (sf2.eq.1)goto 100

i1054i7=i7
m1054m21=n21

do m1054=m1053+1,nqul

i7=i1054i7
n21=m1054m21

print*,'loop1054'
call write_symm_xmi_1(i7,n21,m1054,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1754
if (sf2.eq.1)goto 100

i1055i7=i7
m1055m21=n21

do m1055=m1054+1,nqul

i7=i1055i7
n21=m1055m21

print*,'loop1055'
call write_symm_xmi_1(i7,n21,m1055,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1755
if (sf2.eq.1)goto 100

i1056i7=i7
m1056m21=n21

do m1056=m1055+1,nqul

i7=i1056i7
n21=m1056m21

print*,'loop1056'
call write_symm_xmi_1(i7,n21,m1056,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1756
if (sf2.eq.1)goto 100

i1057i7=i7
m1057m21=n21

do m1057=m1056+1,nqul

i7=i1057i7
n21=m1057m21

print*,'loop1057'
call write_symm_xmi_1(i7,n21,m1057,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1757
if (sf2.eq.1)goto 100

i1058i7=i7
m1058m21=n21

do m1058=m1057+1,nqul

i7=i1058i7
n21=m1058m21

print*,'loop1058'
call write_symm_xmi_1(i7,n21,m1058,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1758
if (sf2.eq.1)goto 100

i1059i7=i7
m1059m21=n21

do m1059=m1058+1,nqul

i7=i1059i7
n21=m1059m21

print*,'loop1059'
call write_symm_xmi_1(i7,n21,m1059,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1759
if (sf2.eq.1)goto 100

i1060i7=i7
m1060m21=n21

do m1060=m1059+1,nqul

i7=i1060i7
n21=m1060m21

print*,'loop1060'
call write_symm_xmi_1(i7,n21,m1060,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1760
if (sf2.eq.1)goto 100

i1061i7=i7
m1061m21=n21

do m1061=m1060+1,nqul

i7=i1061i7
n21=m1061m21

print*,'loop1061'
call write_symm_xmi_1(i7,n21,m1061,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1761
if (sf2.eq.1)goto 100

i1062i7=i7
m1062m21=n21

do m1062=m1061+1,nqul

i7=i1062i7
n21=m1062m21

print*,'loop1062'
call write_symm_xmi_1(i7,n21,m1062,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1762
if (sf2.eq.1)goto 100

i1063i7=i7
m1063m21=n21

do m1063=m1062+1,nqul

i7=i1063i7
n21=m1063m21

print*,'loop1063'
call write_symm_xmi_1(i7,n21,m1063,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1763
if (sf2.eq.1)goto 100

i1064i7=i7
m1064m21=n21

do m1064=m1063+1,nqul

i7=i1064i7
n21=m1064m21

print*,'loop1064'
call write_symm_xmi_1(i7,n21,m1064,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1764
if (sf2.eq.1)goto 100

i1065i7=i7
m1065m21=n21

do m1065=m1064+1,nqul

i7=i1065i7
n21=m1065m21

print*,'loop1065'
call write_symm_xmi_1(i7,n21,m1065,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1765
if (sf2.eq.1)goto 100

i1066i7=i7
m1066m21=n21

do m1066=m1065+1,nqul

i7=i1066i7
n21=m1066m21

print*,'loop1066'
call write_symm_xmi_1(i7,n21,m1066,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1766
if (sf2.eq.1)goto 100

i1067i7=i7
m1067m21=n21

do m1067=m1066+1,nqul

i7=i1067i7
n21=m1067m21

print*,'loop1067'
call write_symm_xmi_1(i7,n21,m1067,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1767
if (sf2.eq.1)goto 100

i1068i7=i7
m1068m21=n21

do m1068=m1067+1,nqul

i7=i1068i7
n21=m1068m21

print*,'loop1068'
call write_symm_xmi_1(i7,n21,m1068,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1768
if (sf2.eq.1)goto 100

i1069i7=i7
m1069m21=n21

do m1069=m1068+1,nqul

i7=i1069i7
n21=m1069m21

print*,'loop1069'
call write_symm_xmi_1(i7,n21,m1069,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1769
if (sf2.eq.1)goto 100

i1070i7=i7
m1070m21=n21

do m1070=m1069+1,nqul

i7=i1070i7
n21=m1070m21

print*,'loop1070'
call write_symm_xmi_1(i7,n21,m1070,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1770
if (sf2.eq.1)goto 100

i1071i7=i7
m1071m21=n21

do m1071=m1070+1,nqul

i7=i1071i7
n21=m1071m21

print*,'loop1071'
call write_symm_xmi_1(i7,n21,m1071,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1771
if (sf2.eq.1)goto 100

i1072i7=i7
m1072m21=n21

do m1072=m1071+1,nqul

i7=i1072i7
n21=m1072m21

print*,'loop1072'
call write_symm_xmi_1(i7,n21,m1072,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1772
if (sf2.eq.1)goto 100

i1073i7=i7
m1073m21=n21

do m1073=m1072+1,nqul

i7=i1073i7
n21=m1073m21

print*,'loop1073'
call write_symm_xmi_1(i7,n21,m1073,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1773
if (sf2.eq.1)goto 100

i1074i7=i7
m1074m21=n21

do m1074=m1073+1,nqul

i7=i1074i7
n21=m1074m21

print*,'loop1074'
call write_symm_xmi_1(i7,n21,m1074,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1774
if (sf2.eq.1)goto 100

i1075i7=i7
m1075m21=n21

do m1075=m1074+1,nqul

i7=i1075i7
n21=m1075m21

print*,'loop1075'
call write_symm_xmi_1(i7,n21,m1075,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1775
if (sf2.eq.1)goto 100

i1076i7=i7
m1076m21=n21

do m1076=m1075+1,nqul

i7=i1076i7
n21=m1076m21

print*,'loop1076'
call write_symm_xmi_1(i7,n21,m1076,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1776
if (sf2.eq.1)goto 100

i1077i7=i7
m1077m21=n21

do m1077=m1076+1,nqul

i7=i1077i7
n21=m1077m21

print*,'loop1077'
call write_symm_xmi_1(i7,n21,m1077,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1777
if (sf2.eq.1)goto 100

i1078i7=i7
m1078m21=n21

do m1078=m1077+1,nqul

i7=i1078i7
n21=m1078m21

print*,'loop1078'
call write_symm_xmi_1(i7,n21,m1078,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1778
if (sf2.eq.1)goto 100

i1079i7=i7
m1079m21=n21

do m1079=m1078+1,nqul

i7=i1079i7
n21=m1079m21

print*,'loop1079'
call write_symm_xmi_1(i7,n21,m1079,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1779
if (sf2.eq.1)goto 100

i1080i7=i7
m1080m21=n21

do m1080=m1079+1,nqul

i7=i1080i7
n21=m1080m21

print*,'loop1080'
call write_symm_xmi_1(i7,n21,m1080,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1780
if (sf2.eq.1)goto 100

i1081i7=i7
m1081m21=n21

do m1081=m1080+1,nqul

i7=i1081i7
n21=m1081m21

print*,'loop1081'
call write_symm_xmi_1(i7,n21,m1081,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1781
if (sf2.eq.1)goto 100

i1082i7=i7
m1082m21=n21

do m1082=m1081+1,nqul

i7=i1082i7
n21=m1082m21

print*,'loop1082'
call write_symm_xmi_1(i7,n21,m1082,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1782
if (sf2.eq.1)goto 100

i1083i7=i7
m1083m21=n21

do m1083=m1082+1,nqul

i7=i1083i7
n21=m1083m21

print*,'loop1083'
call write_symm_xmi_1(i7,n21,m1083,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1783
if (sf2.eq.1)goto 100

i1084i7=i7
m1084m21=n21

do m1084=m1083+1,nqul

i7=i1084i7
n21=m1084m21

print*,'loop1084'
call write_symm_xmi_1(i7,n21,m1084,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1784
if (sf2.eq.1)goto 100

i1085i7=i7
m1085m21=n21

do m1085=m1084+1,nqul

i7=i1085i7
n21=m1085m21

print*,'loop1085'
call write_symm_xmi_1(i7,n21,m1085,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1785
if (sf2.eq.1)goto 100

i1086i7=i7
m1086m21=n21

do m1086=m1085+1,nqul

i7=i1086i7
n21=m1086m21

print*,'loop1086'
call write_symm_xmi_1(i7,n21,m1086,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1786
if (sf2.eq.1)goto 100

i1087i7=i7
m1087m21=n21

do m1087=m1086+1,nqul

i7=i1087i7
n21=m1087m21

print*,'loop1087'
call write_symm_xmi_1(i7,n21,m1087,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1787
if (sf2.eq.1)goto 100

i1088i7=i7
m1088m21=n21

do m1088=m1087+1,nqul

i7=i1088i7
n21=m1088m21

print*,'loop1088'
call write_symm_xmi_1(i7,n21,m1088,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1788
if (sf2.eq.1)goto 100

i1089i7=i7
m1089m21=n21

do m1089=m1088+1,nqul

i7=i1089i7
n21=m1089m21

print*,'loop1089'
call write_symm_xmi_1(i7,n21,m1089,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1789
if (sf2.eq.1)goto 100

i1090i7=i7
m1090m21=n21

do m1090=m1089+1,nqul

i7=i1090i7
n21=m1090m21

print*,'loop1090'
call write_symm_xmi_1(i7,n21,m1090,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1790
if (sf2.eq.1)goto 100

i1091i7=i7
m1091m21=n21

do m1091=m1090+1,nqul

i7=i1091i7
n21=m1091m21

print*,'loop1091'
call write_symm_xmi_1(i7,n21,m1091,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1791
if (sf2.eq.1)goto 100

i1092i7=i7
m1092m21=n21

do m1092=m1091+1,nqul

i7=i1092i7
n21=m1092m21

print*,'loop1092'
call write_symm_xmi_1(i7,n21,m1092,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1792
if (sf2.eq.1)goto 100

i1093i7=i7
m1093m21=n21

do m1093=m1092+1,nqul

i7=i1093i7
n21=m1093m21

print*,'loop1093'
call write_symm_xmi_1(i7,n21,m1093,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1793
if (sf2.eq.1)goto 100

i1094i7=i7
m1094m21=n21

do m1094=m1093+1,nqul

i7=i1094i7
n21=m1094m21

print*,'loop1094'
call write_symm_xmi_1(i7,n21,m1094,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1794
if (sf2.eq.1)goto 100

i1095i7=i7
m1095m21=n21

do m1095=m1094+1,nqul

i7=i1095i7
n21=m1095m21

print*,'loop1095'
call write_symm_xmi_1(i7,n21,m1095,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1795
if (sf2.eq.1)goto 100

i1096i7=i7
m1096m21=n21

do m1096=m1095+1,nqul

i7=i1096i7
n21=m1096m21

print*,'loop1096'
call write_symm_xmi_1(i7,n21,m1096,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1796
if (sf2.eq.1)goto 100

i1097i7=i7
m1097m21=n21

do m1097=m1096+1,nqul

i7=i1097i7
n21=m1097m21

print*,'loop1097'
call write_symm_xmi_1(i7,n21,m1097,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1797
if (sf2.eq.1)goto 100

i1098i7=i7
m1098m21=n21

do m1098=m1097+1,nqul

i7=i1098i7
n21=m1098m21

print*,'loop1098'
call write_symm_xmi_1(i7,n21,m1098,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1798
if (sf2.eq.1)goto 100

i1099i7=i7
m1099m21=n21

do m1099=m1098+1,nqul

i7=i1099i7
n21=m1099m21

print*,'loop1099'
call write_symm_xmi_1(i7,n21,m1099,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1799
if (sf2.eq.1)goto 100

i1100i7=i7
m1100m21=n21

do m1100=m1099+1,nqul

i7=i1100i7
n21=m1100m21

print*,'loop1100'
call write_symm_xmi_1(i7,n21,m1100,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1800
if (sf2.eq.1)goto 100

i1101i7=i7
m1101m21=n21

do m1101=m1100+1,nqul

i7=i1101i7
n21=m1101m21

print*,'loop1101'
call write_symm_xmi_1(i7,n21,m1101,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1801
if (sf2.eq.1)goto 100

i1102i7=i7
m1102m21=n21

do m1102=m1101+1,nqul

i7=i1102i7
n21=m1102m21

print*,'loop1102'
call write_symm_xmi_1(i7,n21,m1102,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1802
if (sf2.eq.1)goto 100

i1103i7=i7
m1103m21=n21

do m1103=m1102+1,nqul

i7=i1103i7
n21=m1103m21

print*,'loop1103'
call write_symm_xmi_1(i7,n21,m1103,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1803
if (sf2.eq.1)goto 100

i1104i7=i7
m1104m21=n21

do m1104=m1103+1,nqul

i7=i1104i7
n21=m1104m21

print*,'loop1104'
call write_symm_xmi_1(i7,n21,m1104,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1804
if (sf2.eq.1)goto 100

i1105i7=i7
m1105m21=n21

do m1105=m1104+1,nqul

i7=i1105i7
n21=m1105m21

print*,'loop1105'
call write_symm_xmi_1(i7,n21,m1105,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1805
if (sf2.eq.1)goto 100

i1106i7=i7
m1106m21=n21

do m1106=m1105+1,nqul

i7=i1106i7
n21=m1106m21

print*,'loop1106'
call write_symm_xmi_1(i7,n21,m1106,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1806
if (sf2.eq.1)goto 100

i1107i7=i7
m1107m21=n21

do m1107=m1106+1,nqul

i7=i1107i7
n21=m1107m21

print*,'loop1107'
call write_symm_xmi_1(i7,n21,m1107,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1807
if (sf2.eq.1)goto 100

i1108i7=i7
m1108m21=n21

do m1108=m1107+1,nqul

i7=i1108i7
n21=m1108m21

print*,'loop1108'
call write_symm_xmi_1(i7,n21,m1108,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1808
if (sf2.eq.1)goto 100

i1109i7=i7
m1109m21=n21

do m1109=m1108+1,nqul

i7=i1109i7
n21=m1109m21

print*,'loop1109'
call write_symm_xmi_1(i7,n21,m1109,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1809
if (sf2.eq.1)goto 100

i1110i7=i7
m1110m21=n21

do m1110=m1109+1,nqul

i7=i1110i7
n21=m1110m21

print*,'loop1110'
call write_symm_xmi_1(i7,n21,m1110,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1810
if (sf2.eq.1)goto 100

i1111i7=i7
m1111m21=n21

do m1111=m1110+1,nqul

i7=i1111i7
n21=m1111m21

print*,'loop1111'
call write_symm_xmi_1(i7,n21,m1111,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1811
if (sf2.eq.1)goto 100

i1112i7=i7
m1112m21=n21

do m1112=m1111+1,nqul

i7=i1112i7
n21=m1112m21

print*,'loop1112'
call write_symm_xmi_1(i7,n21,m1112,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1812
if (sf2.eq.1)goto 100

i1113i7=i7
m1113m21=n21

do m1113=m1112+1,nqul

i7=i1113i7
n21=m1113m21

print*,'loop1113'
call write_symm_xmi_1(i7,n21,m1113,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1813
if (sf2.eq.1)goto 100

i1114i7=i7
m1114m21=n21

do m1114=m1113+1,nqul

i7=i1114i7
n21=m1114m21

print*,'loop1114'
call write_symm_xmi_1(i7,n21,m1114,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1814
if (sf2.eq.1)goto 100

i1115i7=i7
m1115m21=n21

do m1115=m1114+1,nqul

i7=i1115i7
n21=m1115m21

print*,'loop1115'
call write_symm_xmi_1(i7,n21,m1115,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1815
if (sf2.eq.1)goto 100

i1116i7=i7
m1116m21=n21

do m1116=m1115+1,nqul

i7=i1116i7
n21=m1116m21

print*,'loop1116'
call write_symm_xmi_1(i7,n21,m1116,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1816
if (sf2.eq.1)goto 100

i1117i7=i7
m1117m21=n21

do m1117=m1116+1,nqul

i7=i1117i7
n21=m1117m21

print*,'loop1117'
call write_symm_xmi_1(i7,n21,m1117,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1817
if (sf2.eq.1)goto 100

i1118i7=i7
m1118m21=n21

do m1118=m1117+1,nqul

i7=i1118i7
n21=m1118m21

print*,'loop1118'
call write_symm_xmi_1(i7,n21,m1118,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1818
if (sf2.eq.1)goto 100

i1119i7=i7
m1119m21=n21

do m1119=m1118+1,nqul

i7=i1119i7
n21=m1119m21

print*,'loop1119'
call write_symm_xmi_1(i7,n21,m1119,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1819
if (sf2.eq.1)goto 100

i1120i7=i7
m1120m21=n21

do m1120=m1119+1,nqul

i7=i1120i7
n21=m1120m21

print*,'loop1120'
call write_symm_xmi_1(i7,n21,m1120,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1820
if (sf2.eq.1)goto 100

i1121i7=i7
m1121m21=n21

do m1121=m1120+1,nqul

i7=i1121i7
n21=m1121m21

print*,'loop1121'
call write_symm_xmi_1(i7,n21,m1121,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1821
if (sf2.eq.1)goto 100

i1122i7=i7
m1122m21=n21

do m1122=m1121+1,nqul

i7=i1122i7
n21=m1122m21

print*,'loop1122'
call write_symm_xmi_1(i7,n21,m1122,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1822
if (sf2.eq.1)goto 100

i1123i7=i7
m1123m21=n21

do m1123=m1122+1,nqul

i7=i1123i7
n21=m1123m21

print*,'loop1123'
call write_symm_xmi_1(i7,n21,m1123,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1823
if (sf2.eq.1)goto 100

i1124i7=i7
m1124m21=n21

do m1124=m1123+1,nqul

i7=i1124i7
n21=m1124m21

print*,'loop1124'
call write_symm_xmi_1(i7,n21,m1124,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1824
if (sf2.eq.1)goto 100

i1125i7=i7
m1125m21=n21

do m1125=m1124+1,nqul

i7=i1125i7
n21=m1125m21

print*,'loop1125'
call write_symm_xmi_1(i7,n21,m1125,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1825
if (sf2.eq.1)goto 100

i1126i7=i7
m1126m21=n21

do m1126=m1125+1,nqul

i7=i1126i7
n21=m1126m21

print*,'loop1126'
call write_symm_xmi_1(i7,n21,m1126,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1826
if (sf2.eq.1)goto 100

i1127i7=i7
m1127m21=n21

do m1127=m1126+1,nqul

i7=i1127i7
n21=m1127m21

print*,'loop1127'
call write_symm_xmi_1(i7,n21,m1127,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1827
if (sf2.eq.1)goto 100

i1128i7=i7
m1128m21=n21

do m1128=m1127+1,nqul

i7=i1128i7
n21=m1128m21

print*,'loop1128'
call write_symm_xmi_1(i7,n21,m1128,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1828
if (sf2.eq.1)goto 100

i1129i7=i7
m1129m21=n21

do m1129=m1128+1,nqul

i7=i1129i7
n21=m1129m21

print*,'loop1129'
call write_symm_xmi_1(i7,n21,m1129,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1829
if (sf2.eq.1)goto 100

i1130i7=i7
m1130m21=n21

do m1130=m1129+1,nqul

i7=i1130i7
n21=m1130m21

print*,'loop1130'
call write_symm_xmi_1(i7,n21,m1130,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1830
if (sf2.eq.1)goto 100

i1131i7=i7
m1131m21=n21

do m1131=m1130+1,nqul

i7=i1131i7
n21=m1131m21

print*,'loop1131'
call write_symm_xmi_1(i7,n21,m1131,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1831
if (sf2.eq.1)goto 100

i1132i7=i7
m1132m21=n21

do m1132=m1131+1,nqul

i7=i1132i7
n21=m1132m21

print*,'loop1132'
call write_symm_xmi_1(i7,n21,m1132,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1832
if (sf2.eq.1)goto 100

i1133i7=i7
m1133m21=n21

do m1133=m1132+1,nqul

i7=i1133i7
n21=m1133m21

print*,'loop1133'
call write_symm_xmi_1(i7,n21,m1133,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1833
if (sf2.eq.1)goto 100

i1134i7=i7
m1134m21=n21

do m1134=m1133+1,nqul

i7=i1134i7
n21=m1134m21

print*,'loop1134'
call write_symm_xmi_1(i7,n21,m1134,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1834
if (sf2.eq.1)goto 100

i1135i7=i7
m1135m21=n21

do m1135=m1134+1,nqul

i7=i1135i7
n21=m1135m21

print*,'loop1135'
call write_symm_xmi_1(i7,n21,m1135,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1835
if (sf2.eq.1)goto 100

i1136i7=i7
m1136m21=n21

do m1136=m1135+1,nqul

i7=i1136i7
n21=m1136m21

print*,'loop1136'
call write_symm_xmi_1(i7,n21,m1136,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1836
if (sf2.eq.1)goto 100

i1137i7=i7
m1137m21=n21

do m1137=m1136+1,nqul

i7=i1137i7
n21=m1137m21

print*,'loop1137'
call write_symm_xmi_1(i7,n21,m1137,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1837
if (sf2.eq.1)goto 100

i1138i7=i7
m1138m21=n21

do m1138=m1137+1,nqul

i7=i1138i7
n21=m1138m21

print*,'loop1138'
call write_symm_xmi_1(i7,n21,m1138,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1838
if (sf2.eq.1)goto 100

i1139i7=i7
m1139m21=n21

do m1139=m1138+1,nqul

i7=i1139i7
n21=m1139m21

print*,'loop1139'
call write_symm_xmi_1(i7,n21,m1139,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1839
if (sf2.eq.1)goto 100

i1140i7=i7
m1140m21=n21

do m1140=m1139+1,nqul

i7=i1140i7
n21=m1140m21

print*,'loop1140'
call write_symm_xmi_1(i7,n21,m1140,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1840
if (sf2.eq.1)goto 100

i1141i7=i7
m1141m21=n21

do m1141=m1140+1,nqul

i7=i1141i7
n21=m1141m21

print*,'loop1141'
call write_symm_xmi_1(i7,n21,m1141,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1841
if (sf2.eq.1)goto 100

i1142i7=i7
m1142m21=n21

do m1142=m1141+1,nqul

i7=i1142i7
n21=m1142m21

print*,'loop1142'
call write_symm_xmi_1(i7,n21,m1142,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1842
if (sf2.eq.1)goto 100

i1143i7=i7
m1143m21=n21

do m1143=m1142+1,nqul

i7=i1143i7
n21=m1143m21

print*,'loop1143'
call write_symm_xmi_1(i7,n21,m1143,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1843
if (sf2.eq.1)goto 100

i1144i7=i7
m1144m21=n21

do m1144=m1143+1,nqul

i7=i1144i7
n21=m1144m21

print*,'loop1144'
call write_symm_xmi_1(i7,n21,m1144,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1844
if (sf2.eq.1)goto 100

i1145i7=i7
m1145m21=n21

do m1145=m1144+1,nqul

i7=i1145i7
n21=m1145m21

print*,'loop1145'
call write_symm_xmi_1(i7,n21,m1145,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1845
if (sf2.eq.1)goto 100

i1146i7=i7
m1146m21=n21

do m1146=m1145+1,nqul

i7=i1146i7
n21=m1146m21

print*,'loop1146'
call write_symm_xmi_1(i7,n21,m1146,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1846
if (sf2.eq.1)goto 100

i1147i7=i7
m1147m21=n21

do m1147=m1146+1,nqul

i7=i1147i7
n21=m1147m21

print*,'loop1147'
call write_symm_xmi_1(i7,n21,m1147,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1847
if (sf2.eq.1)goto 100

i1148i7=i7
m1148m21=n21

do m1148=m1147+1,nqul

i7=i1148i7
n21=m1148m21

print*,'loop1148'
call write_symm_xmi_1(i7,n21,m1148,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1848
if (sf2.eq.1)goto 100

i1149i7=i7
m1149m21=n21

do m1149=m1148+1,nqul

i7=i1149i7
n21=m1149m21

print*,'loop1149'
call write_symm_xmi_1(i7,n21,m1149,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1849
if (sf2.eq.1)goto 100

i1150i7=i7
m1150m21=n21

do m1150=m1149+1,nqul

i7=i1150i7
n21=m1150m21

print*,'loop1150'
call write_symm_xmi_1(i7,n21,m1150,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1850
if (sf2.eq.1)goto 100

i1151i7=i7
m1151m21=n21

do m1151=m1150+1,nqul

i7=i1151i7
n21=m1151m21

print*,'loop1151'
call write_symm_xmi_1(i7,n21,m1151,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1851
if (sf2.eq.1)goto 100

i1152i7=i7
m1152m21=n21

do m1152=m1151+1,nqul

i7=i1152i7
n21=m1152m21

print*,'loop1152'
call write_symm_xmi_1(i7,n21,m1152,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1852
if (sf2.eq.1)goto 100

i1153i7=i7
m1153m21=n21

do m1153=m1152+1,nqul

i7=i1153i7
n21=m1153m21

print*,'loop1153'
call write_symm_xmi_1(i7,n21,m1153,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1853
if (sf2.eq.1)goto 100

i1154i7=i7
m1154m21=n21

do m1154=m1153+1,nqul

i7=i1154i7
n21=m1154m21

print*,'loop1154'
call write_symm_xmi_1(i7,n21,m1154,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1854
if (sf2.eq.1)goto 100

i1155i7=i7
m1155m21=n21

do m1155=m1154+1,nqul

i7=i1155i7
n21=m1155m21

print*,'loop1155'
call write_symm_xmi_1(i7,n21,m1155,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1855
if (sf2.eq.1)goto 100

i1156i7=i7
m1156m21=n21

do m1156=m1155+1,nqul

i7=i1156i7
n21=m1156m21

print*,'loop1156'
call write_symm_xmi_1(i7,n21,m1156,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1856
if (sf2.eq.1)goto 100

i1157i7=i7
m1157m21=n21

do m1157=m1156+1,nqul

i7=i1157i7
n21=m1157m21

print*,'loop1157'
call write_symm_xmi_1(i7,n21,m1157,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1857
if (sf2.eq.1)goto 100

i1158i7=i7
m1158m21=n21

do m1158=m1157+1,nqul

i7=i1158i7
n21=m1158m21

print*,'loop1158'
call write_symm_xmi_1(i7,n21,m1158,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1858
if (sf2.eq.1)goto 100

i1159i7=i7
m1159m21=n21

do m1159=m1158+1,nqul

i7=i1159i7
n21=m1159m21

print*,'loop1159'
call write_symm_xmi_1(i7,n21,m1159,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1859
if (sf2.eq.1)goto 100

i1160i7=i7
m1160m21=n21

do m1160=m1159+1,nqul

i7=i1160i7
n21=m1160m21

print*,'loop1160'
call write_symm_xmi_1(i7,n21,m1160,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1860
if (sf2.eq.1)goto 100

i1161i7=i7
m1161m21=n21

do m1161=m1160+1,nqul

i7=i1161i7
n21=m1161m21

print*,'loop1161'
call write_symm_xmi_1(i7,n21,m1161,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1861
if (sf2.eq.1)goto 100

i1162i7=i7
m1162m21=n21

do m1162=m1161+1,nqul

i7=i1162i7
n21=m1162m21

print*,'loop1162'
call write_symm_xmi_1(i7,n21,m1162,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1862
if (sf2.eq.1)goto 100

i1163i7=i7
m1163m21=n21

do m1163=m1162+1,nqul

i7=i1163i7
n21=m1163m21

print*,'loop1163'
call write_symm_xmi_1(i7,n21,m1163,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1863
if (sf2.eq.1)goto 100

i1164i7=i7
m1164m21=n21

do m1164=m1163+1,nqul

i7=i1164i7
n21=m1164m21

print*,'loop1164'
call write_symm_xmi_1(i7,n21,m1164,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1864
if (sf2.eq.1)goto 100

i1165i7=i7
m1165m21=n21

do m1165=m1164+1,nqul

i7=i1165i7
n21=m1165m21

print*,'loop1165'
call write_symm_xmi_1(i7,n21,m1165,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1865
if (sf2.eq.1)goto 100

i1166i7=i7
m1166m21=n21

do m1166=m1165+1,nqul

i7=i1166i7
n21=m1166m21

print*,'loop1166'
call write_symm_xmi_1(i7,n21,m1166,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1866
if (sf2.eq.1)goto 100

i1167i7=i7
m1167m21=n21

do m1167=m1166+1,nqul

i7=i1167i7
n21=m1167m21

print*,'loop1167'
call write_symm_xmi_1(i7,n21,m1167,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1867
if (sf2.eq.1)goto 100

i1168i7=i7
m1168m21=n21

do m1168=m1167+1,nqul

i7=i1168i7
n21=m1168m21

print*,'loop1168'
call write_symm_xmi_1(i7,n21,m1168,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1868
if (sf2.eq.1)goto 100

i1169i7=i7
m1169m21=n21

do m1169=m1168+1,nqul

i7=i1169i7
n21=m1169m21

print*,'loop1169'
call write_symm_xmi_1(i7,n21,m1169,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1869
if (sf2.eq.1)goto 100

i1170i7=i7
m1170m21=n21

do m1170=m1169+1,nqul

i7=i1170i7
n21=m1170m21

print*,'loop1170'
call write_symm_xmi_1(i7,n21,m1170,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1870
if (sf2.eq.1)goto 100

i1171i7=i7
m1171m21=n21

do m1171=m1170+1,nqul

i7=i1171i7
n21=m1171m21

print*,'loop1171'
call write_symm_xmi_1(i7,n21,m1171,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1871
if (sf2.eq.1)goto 100

i1172i7=i7
m1172m21=n21

do m1172=m1171+1,nqul

i7=i1172i7
n21=m1172m21

print*,'loop1172'
call write_symm_xmi_1(i7,n21,m1172,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1872
if (sf2.eq.1)goto 100

i1173i7=i7
m1173m21=n21

do m1173=m1172+1,nqul

i7=i1173i7
n21=m1173m21

print*,'loop1173'
call write_symm_xmi_1(i7,n21,m1173,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1873
if (sf2.eq.1)goto 100

i1174i7=i7
m1174m21=n21

do m1174=m1173+1,nqul

i7=i1174i7
n21=m1174m21

print*,'loop1174'
call write_symm_xmi_1(i7,n21,m1174,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1874
if (sf2.eq.1)goto 100

i1175i7=i7
m1175m21=n21

do m1175=m1174+1,nqul

i7=i1175i7
n21=m1175m21

print*,'loop1175'
call write_symm_xmi_1(i7,n21,m1175,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1875
if (sf2.eq.1)goto 100

i1176i7=i7
m1176m21=n21

do m1176=m1175+1,nqul

i7=i1176i7
n21=m1176m21

print*,'loop1176'
call write_symm_xmi_1(i7,n21,m1176,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1876
if (sf2.eq.1)goto 100

i1177i7=i7
m1177m21=n21

do m1177=m1176+1,nqul

i7=i1177i7
n21=m1177m21

print*,'loop1177'
call write_symm_xmi_1(i7,n21,m1177,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1877
if (sf2.eq.1)goto 100

i1178i7=i7
m1178m21=n21

do m1178=m1177+1,nqul

i7=i1178i7
n21=m1178m21

print*,'loop1178'
call write_symm_xmi_1(i7,n21,m1178,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1878
if (sf2.eq.1)goto 100

i1179i7=i7
m1179m21=n21

do m1179=m1178+1,nqul

i7=i1179i7
n21=m1179m21

print*,'loop1179'
call write_symm_xmi_1(i7,n21,m1179,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1879
if (sf2.eq.1)goto 100

i1180i7=i7
m1180m21=n21

do m1180=m1179+1,nqul

i7=i1180i7
n21=m1180m21

print*,'loop1180'
call write_symm_xmi_1(i7,n21,m1180,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1880
if (sf2.eq.1)goto 100

i1181i7=i7
m1181m21=n21

do m1181=m1180+1,nqul

i7=i1181i7
n21=m1181m21

print*,'loop1181'
call write_symm_xmi_1(i7,n21,m1181,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1881
if (sf2.eq.1)goto 100

i1182i7=i7
m1182m21=n21

do m1182=m1181+1,nqul

i7=i1182i7
n21=m1182m21

print*,'loop1182'
call write_symm_xmi_1(i7,n21,m1182,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1882
if (sf2.eq.1)goto 100

i1183i7=i7
m1183m21=n21

do m1183=m1182+1,nqul

i7=i1183i7
n21=m1183m21

print*,'loop1183'
call write_symm_xmi_1(i7,n21,m1183,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1883
if (sf2.eq.1)goto 100

i1184i7=i7
m1184m21=n21

do m1184=m1183+1,nqul

i7=i1184i7
n21=m1184m21

print*,'loop1184'
call write_symm_xmi_1(i7,n21,m1184,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1884
if (sf2.eq.1)goto 100

i1185i7=i7
m1185m21=n21

do m1185=m1184+1,nqul

i7=i1185i7
n21=m1185m21

print*,'loop1185'
call write_symm_xmi_1(i7,n21,m1185,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1885
if (sf2.eq.1)goto 100

i1186i7=i7
m1186m21=n21

do m1186=m1185+1,nqul

i7=i1186i7
n21=m1186m21

print*,'loop1186'
call write_symm_xmi_1(i7,n21,m1186,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1886
if (sf2.eq.1)goto 100

i1187i7=i7
m1187m21=n21

do m1187=m1186+1,nqul

i7=i1187i7
n21=m1187m21

print*,'loop1187'
call write_symm_xmi_1(i7,n21,m1187,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1887
if (sf2.eq.1)goto 100

i1188i7=i7
m1188m21=n21

do m1188=m1187+1,nqul

i7=i1188i7
n21=m1188m21

print*,'loop1188'
call write_symm_xmi_1(i7,n21,m1188,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1888
if (sf2.eq.1)goto 100

i1189i7=i7
m1189m21=n21

do m1189=m1188+1,nqul

i7=i1189i7
n21=m1189m21

print*,'loop1189'
call write_symm_xmi_1(i7,n21,m1189,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1889
if (sf2.eq.1)goto 100

i1190i7=i7
m1190m21=n21

do m1190=m1189+1,nqul

i7=i1190i7
n21=m1190m21

print*,'loop1190'
call write_symm_xmi_1(i7,n21,m1190,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1890
if (sf2.eq.1)goto 100

i1191i7=i7
m1191m21=n21

do m1191=m1190+1,nqul

i7=i1191i7
n21=m1191m21

print*,'loop1191'
call write_symm_xmi_1(i7,n21,m1191,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1891
if (sf2.eq.1)goto 100

i1192i7=i7
m1192m21=n21

do m1192=m1191+1,nqul

i7=i1192i7
n21=m1192m21

print*,'loop1192'
call write_symm_xmi_1(i7,n21,m1192,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1892
if (sf2.eq.1)goto 100

i1193i7=i7
m1193m21=n21

do m1193=m1192+1,nqul

i7=i1193i7
n21=m1193m21

print*,'loop1193'
call write_symm_xmi_1(i7,n21,m1193,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1893
if (sf2.eq.1)goto 100

i1194i7=i7
m1194m21=n21

do m1194=m1193+1,nqul

i7=i1194i7
n21=m1194m21

print*,'loop1194'
call write_symm_xmi_1(i7,n21,m1194,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1894
if (sf2.eq.1)goto 100

i1195i7=i7
m1195m21=n21

do m1195=m1194+1,nqul

i7=i1195i7
n21=m1195m21

print*,'loop1195'
call write_symm_xmi_1(i7,n21,m1195,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1895
if (sf2.eq.1)goto 100

i1196i7=i7
m1196m21=n21

do m1196=m1195+1,nqul

i7=i1196i7
n21=m1196m21

print*,'loop1196'
call write_symm_xmi_1(i7,n21,m1196,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1896
if (sf2.eq.1)goto 100

i1197i7=i7
m1197m21=n21

do m1197=m1196+1,nqul

i7=i1197i7
n21=m1197m21

print*,'loop1197'
call write_symm_xmi_1(i7,n21,m1197,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1897
if (sf2.eq.1)goto 100

i1198i7=i7
m1198m21=n21

do m1198=m1197+1,nqul

i7=i1198i7
n21=m1198m21

print*,'loop1198'
call write_symm_xmi_1(i7,n21,m1198,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1898
if (sf2.eq.1)goto 100

i1199i7=i7
m1199m21=n21

do m1199=m1198+1,nqul

i7=i1199i7
n21=m1199m21

print*,'loop1199'
call write_symm_xmi_1(i7,n21,m1199,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1899
if (sf2.eq.1)goto 100

i1200i7=i7
m1200m21=n21

do m1200=m1199+1,nqul

i7=i1200i7
n21=m1200m21

print*,'loop1200'
call write_symm_xmi_1(i7,n21,m1200,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1900
if (sf2.eq.1)goto 100

i1201i7=i7
m1201m21=n21

do m1201=m1200+1,nqul

i7=i1201i7
n21=m1201m21

print*,'loop1201'
call write_symm_xmi_1(i7,n21,m1201,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1901
if (sf2.eq.1)goto 100

i1202i7=i7
m1202m21=n21

do m1202=m1201+1,nqul

i7=i1202i7
n21=m1202m21

print*,'loop1202'
call write_symm_xmi_1(i7,n21,m1202,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1902
if (sf2.eq.1)goto 100

i1203i7=i7
m1203m21=n21

do m1203=m1202+1,nqul

i7=i1203i7
n21=m1203m21

print*,'loop1203'
call write_symm_xmi_1(i7,n21,m1203,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1903
if (sf2.eq.1)goto 100

i1204i7=i7
m1204m21=n21

do m1204=m1203+1,nqul

i7=i1204i7
n21=m1204m21

print*,'loop1204'
call write_symm_xmi_1(i7,n21,m1204,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1904
if (sf2.eq.1)goto 100

i1205i7=i7
m1205m21=n21

do m1205=m1204+1,nqul

i7=i1205i7
n21=m1205m21

print*,'loop1205'
call write_symm_xmi_1(i7,n21,m1205,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1905
if (sf2.eq.1)goto 100

i1206i7=i7
m1206m21=n21

do m1206=m1205+1,nqul

i7=i1206i7
n21=m1206m21

print*,'loop1206'
call write_symm_xmi_1(i7,n21,m1206,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1906
if (sf2.eq.1)goto 100

i1207i7=i7
m1207m21=n21

do m1207=m1206+1,nqul

i7=i1207i7
n21=m1207m21

print*,'loop1207'
call write_symm_xmi_1(i7,n21,m1207,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1907
if (sf2.eq.1)goto 100

i1208i7=i7
m1208m21=n21

do m1208=m1207+1,nqul

i7=i1208i7
n21=m1208m21

print*,'loop1208'
call write_symm_xmi_1(i7,n21,m1208,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1908
if (sf2.eq.1)goto 100

i1209i7=i7
m1209m21=n21

do m1209=m1208+1,nqul

i7=i1209i7
n21=m1209m21

print*,'loop1209'
call write_symm_xmi_1(i7,n21,m1209,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1909
if (sf2.eq.1)goto 100

i1210i7=i7
m1210m21=n21

do m1210=m1209+1,nqul

i7=i1210i7
n21=m1210m21

print*,'loop1210'
call write_symm_xmi_1(i7,n21,m1210,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1910
if (sf2.eq.1)goto 100

i1211i7=i7
m1211m21=n21

do m1211=m1210+1,nqul

i7=i1211i7
n21=m1211m21

print*,'loop1211'
call write_symm_xmi_1(i7,n21,m1211,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1911
if (sf2.eq.1)goto 100

i1212i7=i7
m1212m21=n21

do m1212=m1211+1,nqul

i7=i1212i7
n21=m1212m21

print*,'loop1212'
call write_symm_xmi_1(i7,n21,m1212,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1912
if (sf2.eq.1)goto 100

i1213i7=i7
m1213m21=n21

do m1213=m1212+1,nqul

i7=i1213i7
n21=m1213m21

print*,'loop1213'
call write_symm_xmi_1(i7,n21,m1213,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1913
if (sf2.eq.1)goto 100

i1214i7=i7
m1214m21=n21

do m1214=m1213+1,nqul

i7=i1214i7
n21=m1214m21

print*,'loop1214'
call write_symm_xmi_1(i7,n21,m1214,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1914
if (sf2.eq.1)goto 100

i1215i7=i7
m1215m21=n21

do m1215=m1214+1,nqul

i7=i1215i7
n21=m1215m21

print*,'loop1215'
call write_symm_xmi_1(i7,n21,m1215,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1915
if (sf2.eq.1)goto 100

i1216i7=i7
m1216m21=n21

do m1216=m1215+1,nqul

i7=i1216i7
n21=m1216m21

print*,'loop1216'
call write_symm_xmi_1(i7,n21,m1216,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1916
if (sf2.eq.1)goto 100

i1217i7=i7
m1217m21=n21

do m1217=m1216+1,nqul

i7=i1217i7
n21=m1217m21

print*,'loop1217'
call write_symm_xmi_1(i7,n21,m1217,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1917
if (sf2.eq.1)goto 100

i1218i7=i7
m1218m21=n21

do m1218=m1217+1,nqul

i7=i1218i7
n21=m1218m21

print*,'loop1218'
call write_symm_xmi_1(i7,n21,m1218,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1918
if (sf2.eq.1)goto 100

i1219i7=i7
m1219m21=n21

do m1219=m1218+1,nqul

i7=i1219i7
n21=m1219m21

print*,'loop1219'
call write_symm_xmi_1(i7,n21,m1219,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1919
if (sf2.eq.1)goto 100

i1220i7=i7
m1220m21=n21

do m1220=m1219+1,nqul

i7=i1220i7
n21=m1220m21

print*,'loop1220'
call write_symm_xmi_1(i7,n21,m1220,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1920
if (sf2.eq.1)goto 100

i1221i7=i7
m1221m21=n21

do m1221=m1220+1,nqul

i7=i1221i7
n21=m1221m21

print*,'loop1221'
call write_symm_xmi_1(i7,n21,m1221,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1921
if (sf2.eq.1)goto 100

i1222i7=i7
m1222m21=n21

do m1222=m1221+1,nqul

i7=i1222i7
n21=m1222m21

print*,'loop1222'
call write_symm_xmi_1(i7,n21,m1222,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1922
if (sf2.eq.1)goto 100

i1223i7=i7
m1223m21=n21

do m1223=m1222+1,nqul

i7=i1223i7
n21=m1223m21

print*,'loop1223'
call write_symm_xmi_1(i7,n21,m1223,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1923
if (sf2.eq.1)goto 100

i1224i7=i7
m1224m21=n21

do m1224=m1223+1,nqul

i7=i1224i7
n21=m1224m21

print*,'loop1224'
call write_symm_xmi_1(i7,n21,m1224,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1924
if (sf2.eq.1)goto 100

i1225i7=i7
m1225m21=n21

do m1225=m1224+1,nqul

i7=i1225i7
n21=m1225m21

print*,'loop1225'
call write_symm_xmi_1(i7,n21,m1225,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1925
if (sf2.eq.1)goto 100

i1226i7=i7
m1226m21=n21

do m1226=m1225+1,nqul

i7=i1226i7
n21=m1226m21

print*,'loop1226'
call write_symm_xmi_1(i7,n21,m1226,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1926
if (sf2.eq.1)goto 100

i1227i7=i7
m1227m21=n21

do m1227=m1226+1,nqul

i7=i1227i7
n21=m1227m21

print*,'loop1227'
call write_symm_xmi_1(i7,n21,m1227,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1927
if (sf2.eq.1)goto 100

i1228i7=i7
m1228m21=n21

do m1228=m1227+1,nqul

i7=i1228i7
n21=m1228m21

print*,'loop1228'
call write_symm_xmi_1(i7,n21,m1228,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1928
if (sf2.eq.1)goto 100

i1229i7=i7
m1229m21=n21

do m1229=m1228+1,nqul

i7=i1229i7
n21=m1229m21

print*,'loop1229'
call write_symm_xmi_1(i7,n21,m1229,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1929
if (sf2.eq.1)goto 100

i1230i7=i7
m1230m21=n21

do m1230=m1229+1,nqul

i7=i1230i7
n21=m1230m21

print*,'loop1230'
call write_symm_xmi_1(i7,n21,m1230,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1930
if (sf2.eq.1)goto 100

i1231i7=i7
m1231m21=n21

do m1231=m1230+1,nqul

i7=i1231i7
n21=m1231m21

print*,'loop1231'
call write_symm_xmi_1(i7,n21,m1231,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1931
if (sf2.eq.1)goto 100

i1232i7=i7
m1232m21=n21

do m1232=m1231+1,nqul

i7=i1232i7
n21=m1232m21

print*,'loop1232'
call write_symm_xmi_1(i7,n21,m1232,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1932
if (sf2.eq.1)goto 100

i1233i7=i7
m1233m21=n21

do m1233=m1232+1,nqul

i7=i1233i7
n21=m1233m21

print*,'loop1233'
call write_symm_xmi_1(i7,n21,m1233,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1933
if (sf2.eq.1)goto 100

i1234i7=i7
m1234m21=n21

do m1234=m1233+1,nqul

i7=i1234i7
n21=m1234m21

print*,'loop1234'
call write_symm_xmi_1(i7,n21,m1234,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1934
if (sf2.eq.1)goto 100

i1235i7=i7
m1235m21=n21

do m1235=m1234+1,nqul

i7=i1235i7
n21=m1235m21

print*,'loop1235'
call write_symm_xmi_1(i7,n21,m1235,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1935
if (sf2.eq.1)goto 100

i1236i7=i7
m1236m21=n21

do m1236=m1235+1,nqul

i7=i1236i7
n21=m1236m21

print*,'loop1236'
call write_symm_xmi_1(i7,n21,m1236,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1936
if (sf2.eq.1)goto 100

i1237i7=i7
m1237m21=n21

do m1237=m1236+1,nqul

i7=i1237i7
n21=m1237m21

print*,'loop1237'
call write_symm_xmi_1(i7,n21,m1237,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1937
if (sf2.eq.1)goto 100

i1238i7=i7
m1238m21=n21

do m1238=m1237+1,nqul

i7=i1238i7
n21=m1238m21

print*,'loop1238'
call write_symm_xmi_1(i7,n21,m1238,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1938
if (sf2.eq.1)goto 100

i1239i7=i7
m1239m21=n21

do m1239=m1238+1,nqul

i7=i1239i7
n21=m1239m21

print*,'loop1239'
call write_symm_xmi_1(i7,n21,m1239,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1939
if (sf2.eq.1)goto 100

i1240i7=i7
m1240m21=n21

do m1240=m1239+1,nqul

i7=i1240i7
n21=m1240m21

print*,'loop1240'
call write_symm_xmi_1(i7,n21,m1240,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1940
if (sf2.eq.1)goto 100

i1241i7=i7
m1241m21=n21

do m1241=m1240+1,nqul

i7=i1241i7
n21=m1241m21

print*,'loop1241'
call write_symm_xmi_1(i7,n21,m1241,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1941
if (sf2.eq.1)goto 100

i1242i7=i7
m1242m21=n21

do m1242=m1241+1,nqul

i7=i1242i7
n21=m1242m21

print*,'loop1242'
call write_symm_xmi_1(i7,n21,m1242,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1942
if (sf2.eq.1)goto 100

i1243i7=i7
m1243m21=n21

do m1243=m1242+1,nqul

i7=i1243i7
n21=m1243m21

print*,'loop1243'
call write_symm_xmi_1(i7,n21,m1243,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1943
if (sf2.eq.1)goto 100

i1244i7=i7
m1244m21=n21

do m1244=m1243+1,nqul

i7=i1244i7
n21=m1244m21

print*,'loop1244'
call write_symm_xmi_1(i7,n21,m1244,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1944
if (sf2.eq.1)goto 100

i1245i7=i7
m1245m21=n21

do m1245=m1244+1,nqul

i7=i1245i7
n21=m1245m21

print*,'loop1245'
call write_symm_xmi_1(i7,n21,m1245,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1945
if (sf2.eq.1)goto 100

i1246i7=i7
m1246m21=n21

do m1246=m1245+1,nqul

i7=i1246i7
n21=m1246m21

print*,'loop1246'
call write_symm_xmi_1(i7,n21,m1246,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1946
if (sf2.eq.1)goto 100

i1247i7=i7
m1247m21=n21

do m1247=m1246+1,nqul

i7=i1247i7
n21=m1247m21

print*,'loop1247'
call write_symm_xmi_1(i7,n21,m1247,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1947
if (sf2.eq.1)goto 100

i1248i7=i7
m1248m21=n21

do m1248=m1247+1,nqul

i7=i1248i7
n21=m1248m21

print*,'loop1248'
call write_symm_xmi_1(i7,n21,m1248,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1948
if (sf2.eq.1)goto 100

i1249i7=i7
m1249m21=n21

do m1249=m1248+1,nqul

i7=i1249i7
n21=m1249m21

print*,'loop1249'
call write_symm_xmi_1(i7,n21,m1249,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1949
if (sf2.eq.1)goto 100

i1250i7=i7
m1250m21=n21

do m1250=m1249+1,nqul

i7=i1250i7
n21=m1250m21

print*,'loop1250'
call write_symm_xmi_1(i7,n21,m1250,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1950
if (sf2.eq.1)goto 100

i1251i7=i7
m1251m21=n21

do m1251=m1250+1,nqul

i7=i1251i7
n21=m1251m21

print*,'loop1251'
call write_symm_xmi_1(i7,n21,m1251,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1951
if (sf2.eq.1)goto 100

i1252i7=i7
m1252m21=n21

do m1252=m1251+1,nqul

i7=i1252i7
n21=m1252m21

print*,'loop1252'
call write_symm_xmi_1(i7,n21,m1252,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1952
if (sf2.eq.1)goto 100

i1253i7=i7
m1253m21=n21

do m1253=m1252+1,nqul

i7=i1253i7
n21=m1253m21

print*,'loop1253'
call write_symm_xmi_1(i7,n21,m1253,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1953
if (sf2.eq.1)goto 100

i1254i7=i7
m1254m21=n21

do m1254=m1253+1,nqul

i7=i1254i7
n21=m1254m21

print*,'loop1254'
call write_symm_xmi_1(i7,n21,m1254,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1954
if (sf2.eq.1)goto 100

i1255i7=i7
m1255m21=n21

do m1255=m1254+1,nqul

i7=i1255i7
n21=m1255m21

print*,'loop1255'
call write_symm_xmi_1(i7,n21,m1255,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1955
if (sf2.eq.1)goto 100

i1256i7=i7
m1256m21=n21

do m1256=m1255+1,nqul

i7=i1256i7
n21=m1256m21

print*,'loop1256'
call write_symm_xmi_1(i7,n21,m1256,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1956
if (sf2.eq.1)goto 100

i1257i7=i7
m1257m21=n21

do m1257=m1256+1,nqul

i7=i1257i7
n21=m1257m21

print*,'loop1257'
call write_symm_xmi_1(i7,n21,m1257,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1957
if (sf2.eq.1)goto 100

i1258i7=i7
m1258m21=n21

do m1258=m1257+1,nqul

i7=i1258i7
n21=m1258m21

print*,'loop1258'
call write_symm_xmi_1(i7,n21,m1258,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1958
if (sf2.eq.1)goto 100

i1259i7=i7
m1259m21=n21

do m1259=m1258+1,nqul

i7=i1259i7
n21=m1259m21

print*,'loop1259'
call write_symm_xmi_1(i7,n21,m1259,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1959
if (sf2.eq.1)goto 100

i1260i7=i7
m1260m21=n21

do m1260=m1259+1,nqul

i7=i1260i7
n21=m1260m21

print*,'loop1260'
call write_symm_xmi_1(i7,n21,m1260,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1960
if (sf2.eq.1)goto 100

i1261i7=i7
m1261m21=n21

do m1261=m1260+1,nqul

i7=i1261i7
n21=m1261m21

print*,'loop1261'
call write_symm_xmi_1(i7,n21,m1261,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1961
if (sf2.eq.1)goto 100

i1262i7=i7
m1262m21=n21

do m1262=m1261+1,nqul

i7=i1262i7
n21=m1262m21

print*,'loop1262'
call write_symm_xmi_1(i7,n21,m1262,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1962
if (sf2.eq.1)goto 100

i1263i7=i7
m1263m21=n21

do m1263=m1262+1,nqul

i7=i1263i7
n21=m1263m21

print*,'loop1263'
call write_symm_xmi_1(i7,n21,m1263,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1963
if (sf2.eq.1)goto 100

i1264i7=i7
m1264m21=n21

do m1264=m1263+1,nqul

i7=i1264i7
n21=m1264m21

print*,'loop1264'
call write_symm_xmi_1(i7,n21,m1264,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1964
if (sf2.eq.1)goto 100

i1265i7=i7
m1265m21=n21

do m1265=m1264+1,nqul

i7=i1265i7
n21=m1265m21

print*,'loop1265'
call write_symm_xmi_1(i7,n21,m1265,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1965
if (sf2.eq.1)goto 100

i1266i7=i7
m1266m21=n21

do m1266=m1265+1,nqul

i7=i1266i7
n21=m1266m21

print*,'loop1266'
call write_symm_xmi_1(i7,n21,m1266,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1966
if (sf2.eq.1)goto 100

i1267i7=i7
m1267m21=n21

do m1267=m1266+1,nqul

i7=i1267i7
n21=m1267m21

print*,'loop1267'
call write_symm_xmi_1(i7,n21,m1267,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1967
if (sf2.eq.1)goto 100

i1268i7=i7
m1268m21=n21

do m1268=m1267+1,nqul

i7=i1268i7
n21=m1268m21

print*,'loop1268'
call write_symm_xmi_1(i7,n21,m1268,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1968
if (sf2.eq.1)goto 100

i1269i7=i7
m1269m21=n21

do m1269=m1268+1,nqul

i7=i1269i7
n21=m1269m21

print*,'loop1269'
call write_symm_xmi_1(i7,n21,m1269,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1969
if (sf2.eq.1)goto 100

i1270i7=i7
m1270m21=n21

do m1270=m1269+1,nqul

i7=i1270i7
n21=m1270m21

print*,'loop1270'
call write_symm_xmi_1(i7,n21,m1270,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1970
if (sf2.eq.1)goto 100

i1271i7=i7
m1271m21=n21

do m1271=m1270+1,nqul

i7=i1271i7
n21=m1271m21

print*,'loop1271'
call write_symm_xmi_1(i7,n21,m1271,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1971
if (sf2.eq.1)goto 100

i1272i7=i7
m1272m21=n21

do m1272=m1271+1,nqul

i7=i1272i7
n21=m1272m21

print*,'loop1272'
call write_symm_xmi_1(i7,n21,m1272,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1972
if (sf2.eq.1)goto 100

i1273i7=i7
m1273m21=n21

do m1273=m1272+1,nqul

i7=i1273i7
n21=m1273m21

print*,'loop1273'
call write_symm_xmi_1(i7,n21,m1273,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1973
if (sf2.eq.1)goto 100

i1274i7=i7
m1274m21=n21

do m1274=m1273+1,nqul

i7=i1274i7
n21=m1274m21

print*,'loop1274'
call write_symm_xmi_1(i7,n21,m1274,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1974
if (sf2.eq.1)goto 100

i1275i7=i7
m1275m21=n21

do m1275=m1274+1,nqul

i7=i1275i7
n21=m1275m21

print*,'loop1275'
call write_symm_xmi_1(i7,n21,m1275,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1975
if (sf2.eq.1)goto 100

i1276i7=i7
m1276m21=n21

do m1276=m1275+1,nqul

i7=i1276i7
n21=m1276m21

print*,'loop1276'
call write_symm_xmi_1(i7,n21,m1276,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1976
if (sf2.eq.1)goto 100

i1277i7=i7
m1277m21=n21

do m1277=m1276+1,nqul

i7=i1277i7
n21=m1277m21

print*,'loop1277'
call write_symm_xmi_1(i7,n21,m1277,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1977
if (sf2.eq.1)goto 100

i1278i7=i7
m1278m21=n21

do m1278=m1277+1,nqul

i7=i1278i7
n21=m1278m21

print*,'loop1278'
call write_symm_xmi_1(i7,n21,m1278,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1978
if (sf2.eq.1)goto 100

i1279i7=i7
m1279m21=n21

do m1279=m1278+1,nqul

i7=i1279i7
n21=m1279m21

print*,'loop1279'
call write_symm_xmi_1(i7,n21,m1279,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1979
if (sf2.eq.1)goto 100

i1280i7=i7
m1280m21=n21

do m1280=m1279+1,nqul

i7=i1280i7
n21=m1280m21

print*,'loop1280'
call write_symm_xmi_1(i7,n21,m1280,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1980
if (sf2.eq.1)goto 100

i1281i7=i7
m1281m21=n21

do m1281=m1280+1,nqul

i7=i1281i7
n21=m1281m21

print*,'loop1281'
call write_symm_xmi_1(i7,n21,m1281,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1981
if (sf2.eq.1)goto 100

i1282i7=i7
m1282m21=n21

do m1282=m1281+1,nqul

i7=i1282i7
n21=m1282m21

print*,'loop1282'
call write_symm_xmi_1(i7,n21,m1282,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1982
if (sf2.eq.1)goto 100

i1283i7=i7
m1283m21=n21

do m1283=m1282+1,nqul

i7=i1283i7
n21=m1283m21

print*,'loop1283'
call write_symm_xmi_1(i7,n21,m1283,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1983
if (sf2.eq.1)goto 100

i1284i7=i7
m1284m21=n21

do m1284=m1283+1,nqul

i7=i1284i7
n21=m1284m21

print*,'loop1284'
call write_symm_xmi_1(i7,n21,m1284,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1984
if (sf2.eq.1)goto 100

i1285i7=i7
m1285m21=n21

do m1285=m1284+1,nqul

i7=i1285i7
n21=m1285m21

print*,'loop1285'
call write_symm_xmi_1(i7,n21,m1285,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1985
if (sf2.eq.1)goto 100

i1286i7=i7
m1286m21=n21

do m1286=m1285+1,nqul

i7=i1286i7
n21=m1286m21

print*,'loop1286'
call write_symm_xmi_1(i7,n21,m1286,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1986
if (sf2.eq.1)goto 100

i1287i7=i7
m1287m21=n21

do m1287=m1286+1,nqul

i7=i1287i7
n21=m1287m21

print*,'loop1287'
call write_symm_xmi_1(i7,n21,m1287,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1987
if (sf2.eq.1)goto 100

i1288i7=i7
m1288m21=n21

do m1288=m1287+1,nqul

i7=i1288i7
n21=m1288m21

print*,'loop1288'
call write_symm_xmi_1(i7,n21,m1288,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1988
if (sf2.eq.1)goto 100

i1289i7=i7
m1289m21=n21

do m1289=m1288+1,nqul

i7=i1289i7
n21=m1289m21

print*,'loop1289'
call write_symm_xmi_1(i7,n21,m1289,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1989
if (sf2.eq.1)goto 100

i1290i7=i7
m1290m21=n21

do m1290=m1289+1,nqul

i7=i1290i7
n21=m1290m21

print*,'loop1290'
call write_symm_xmi_1(i7,n21,m1290,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1990
if (sf2.eq.1)goto 100

i1291i7=i7
m1291m21=n21

do m1291=m1290+1,nqul

i7=i1291i7
n21=m1291m21

print*,'loop1291'
call write_symm_xmi_1(i7,n21,m1291,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1991
if (sf2.eq.1)goto 100

i1292i7=i7
m1292m21=n21

do m1292=m1291+1,nqul

i7=i1292i7
n21=m1292m21

print*,'loop1292'
call write_symm_xmi_1(i7,n21,m1292,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1992
if (sf2.eq.1)goto 100

i1293i7=i7
m1293m21=n21

do m1293=m1292+1,nqul

i7=i1293i7
n21=m1293m21

print*,'loop1293'
call write_symm_xmi_1(i7,n21,m1293,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1993
if (sf2.eq.1)goto 100

i1294i7=i7
m1294m21=n21

do m1294=m1293+1,nqul

i7=i1294i7
n21=m1294m21

print*,'loop1294'
call write_symm_xmi_1(i7,n21,m1294,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1994
if (sf2.eq.1)goto 100

i1295i7=i7
m1295m21=n21

do m1295=m1294+1,nqul

i7=i1295i7
n21=m1295m21

print*,'loop1295'
call write_symm_xmi_1(i7,n21,m1295,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1995
if (sf2.eq.1)goto 100

i1296i7=i7
m1296m21=n21

do m1296=m1295+1,nqul

i7=i1296i7
n21=m1296m21

print*,'loop1296'
call write_symm_xmi_1(i7,n21,m1296,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1996
if (sf2.eq.1)goto 100

i1297i7=i7
m1297m21=n21

do m1297=m1296+1,nqul

i7=i1297i7
n21=m1297m21

print*,'loop1297'
call write_symm_xmi_1(i7,n21,m1297,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1997
if (sf2.eq.1)goto 100

i1298i7=i7
m1298m21=n21

do m1298=m1297+1,nqul

i7=i1298i7
n21=m1298m21

print*,'loop1298'
call write_symm_xmi_1(i7,n21,m1298,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1998
if (sf2.eq.1)goto 100

i1299i7=i7
m1299m21=n21

do m1299=m1298+1,nqul

i7=i1299i7
n21=m1299m21

print*,'loop1299'
call write_symm_xmi_1(i7,n21,m1299,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 1999
if (sf2.eq.1)goto 100

i1300i7=i7
m1300m21=n21

do m1300=m1299+1,nqul

i7=i1300i7
n21=m1300m21

print*,'loop1300'
call write_symm_xmi_1(i7,n21,m1300,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2000
if (sf2.eq.1)goto 100

i1301i7=i7
m1301m21=n21

do m1301=m1300+1,nqul

i7=i1301i7
n21=m1301m21

print*,'loop1301'
call write_symm_xmi_1(i7,n21,m1301,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2001
if (sf2.eq.1)goto 100

i1302i7=i7
m1302m21=n21

do m1302=m1301+1,nqul

i7=i1302i7
n21=m1302m21

print*,'loop1302'
call write_symm_xmi_1(i7,n21,m1302,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2002
if (sf2.eq.1)goto 100

i1303i7=i7
m1303m21=n21

do m1303=m1302+1,nqul

i7=i1303i7
n21=m1303m21

print*,'loop1303'
call write_symm_xmi_1(i7,n21,m1303,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2003
if (sf2.eq.1)goto 100

i1304i7=i7
m1304m21=n21

do m1304=m1303+1,nqul

i7=i1304i7
n21=m1304m21

print*,'loop1304'
call write_symm_xmi_1(i7,n21,m1304,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2004
if (sf2.eq.1)goto 100

i1305i7=i7
m1305m21=n21

do m1305=m1304+1,nqul

i7=i1305i7
n21=m1305m21

print*,'loop1305'
call write_symm_xmi_1(i7,n21,m1305,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2005
if (sf2.eq.1)goto 100

i1306i7=i7
m1306m21=n21

do m1306=m1305+1,nqul

i7=i1306i7
n21=m1306m21

print*,'loop1306'
call write_symm_xmi_1(i7,n21,m1306,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2006
if (sf2.eq.1)goto 100

i1307i7=i7
m1307m21=n21

do m1307=m1306+1,nqul

i7=i1307i7
n21=m1307m21

print*,'loop1307'
call write_symm_xmi_1(i7,n21,m1307,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2007
if (sf2.eq.1)goto 100

i1308i7=i7
m1308m21=n21

do m1308=m1307+1,nqul

i7=i1308i7
n21=m1308m21

print*,'loop1308'
call write_symm_xmi_1(i7,n21,m1308,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2008
if (sf2.eq.1)goto 100

i1309i7=i7
m1309m21=n21

do m1309=m1308+1,nqul

i7=i1309i7
n21=m1309m21

print*,'loop1309'
call write_symm_xmi_1(i7,n21,m1309,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2009
if (sf2.eq.1)goto 100

i1310i7=i7
m1310m21=n21

do m1310=m1309+1,nqul

i7=i1310i7
n21=m1310m21

print*,'loop1310'
call write_symm_xmi_1(i7,n21,m1310,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2010
if (sf2.eq.1)goto 100

i1311i7=i7
m1311m21=n21

do m1311=m1310+1,nqul

i7=i1311i7
n21=m1311m21

print*,'loop1311'
call write_symm_xmi_1(i7,n21,m1311,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2011
if (sf2.eq.1)goto 100

i1312i7=i7
m1312m21=n21

do m1312=m1311+1,nqul

i7=i1312i7
n21=m1312m21

print*,'loop1312'
call write_symm_xmi_1(i7,n21,m1312,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2012
if (sf2.eq.1)goto 100

i1313i7=i7
m1313m21=n21

do m1313=m1312+1,nqul

i7=i1313i7
n21=m1313m21

print*,'loop1313'
call write_symm_xmi_1(i7,n21,m1313,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2013
if (sf2.eq.1)goto 100

i1314i7=i7
m1314m21=n21

do m1314=m1313+1,nqul

i7=i1314i7
n21=m1314m21

print*,'loop1314'
call write_symm_xmi_1(i7,n21,m1314,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2014
if (sf2.eq.1)goto 100

i1315i7=i7
m1315m21=n21

do m1315=m1314+1,nqul

i7=i1315i7
n21=m1315m21

print*,'loop1315'
call write_symm_xmi_1(i7,n21,m1315,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2015
if (sf2.eq.1)goto 100

i1316i7=i7
m1316m21=n21

do m1316=m1315+1,nqul

i7=i1316i7
n21=m1316m21

print*,'loop1316'
call write_symm_xmi_1(i7,n21,m1316,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2016
if (sf2.eq.1)goto 100

i1317i7=i7
m1317m21=n21

do m1317=m1316+1,nqul

i7=i1317i7
n21=m1317m21

print*,'loop1317'
call write_symm_xmi_1(i7,n21,m1317,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2017
if (sf2.eq.1)goto 100

i1318i7=i7
m1318m21=n21

do m1318=m1317+1,nqul

i7=i1318i7
n21=m1318m21

print*,'loop1318'
call write_symm_xmi_1(i7,n21,m1318,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2018
if (sf2.eq.1)goto 100

i1319i7=i7
m1319m21=n21

do m1319=m1318+1,nqul

i7=i1319i7
n21=m1319m21

print*,'loop1319'
call write_symm_xmi_1(i7,n21,m1319,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2019
if (sf2.eq.1)goto 100

i1320i7=i7
m1320m21=n21

do m1320=m1319+1,nqul

i7=i1320i7
n21=m1320m21

print*,'loop1320'
call write_symm_xmi_1(i7,n21,m1320,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2020
if (sf2.eq.1)goto 100

i1321i7=i7
m1321m21=n21

do m1321=m1320+1,nqul

i7=i1321i7
n21=m1321m21

print*,'loop1321'
call write_symm_xmi_1(i7,n21,m1321,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2021
if (sf2.eq.1)goto 100

i1322i7=i7
m1322m21=n21

do m1322=m1321+1,nqul

i7=i1322i7
n21=m1322m21

print*,'loop1322'
call write_symm_xmi_1(i7,n21,m1322,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2022
if (sf2.eq.1)goto 100

i1323i7=i7
m1323m21=n21

do m1323=m1322+1,nqul

i7=i1323i7
n21=m1323m21

print*,'loop1323'
call write_symm_xmi_1(i7,n21,m1323,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2023
if (sf2.eq.1)goto 100

i1324i7=i7
m1324m21=n21

do m1324=m1323+1,nqul

i7=i1324i7
n21=m1324m21

print*,'loop1324'
call write_symm_xmi_1(i7,n21,m1324,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2024
if (sf2.eq.1)goto 100

i1325i7=i7
m1325m21=n21

do m1325=m1324+1,nqul

i7=i1325i7
n21=m1325m21

print*,'loop1325'
call write_symm_xmi_1(i7,n21,m1325,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2025
if (sf2.eq.1)goto 100

i1326i7=i7
m1326m21=n21

do m1326=m1325+1,nqul

i7=i1326i7
n21=m1326m21

print*,'loop1326'
call write_symm_xmi_1(i7,n21,m1326,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2026
if (sf2.eq.1)goto 100

i1327i7=i7
m1327m21=n21

do m1327=m1326+1,nqul

i7=i1327i7
n21=m1327m21

print*,'loop1327'
call write_symm_xmi_1(i7,n21,m1327,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2027
if (sf2.eq.1)goto 100

i1328i7=i7
m1328m21=n21

do m1328=m1327+1,nqul

i7=i1328i7
n21=m1328m21

print*,'loop1328'
call write_symm_xmi_1(i7,n21,m1328,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2028
if (sf2.eq.1)goto 100

i1329i7=i7
m1329m21=n21

do m1329=m1328+1,nqul

i7=i1329i7
n21=m1329m21

print*,'loop1329'
call write_symm_xmi_1(i7,n21,m1329,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2029
if (sf2.eq.1)goto 100

i1330i7=i7
m1330m21=n21

do m1330=m1329+1,nqul

i7=i1330i7
n21=m1330m21

print*,'loop1330'
call write_symm_xmi_1(i7,n21,m1330,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2030
if (sf2.eq.1)goto 100

i1331i7=i7
m1331m21=n21

do m1331=m1330+1,nqul

i7=i1331i7
n21=m1331m21

print*,'loop1331'
call write_symm_xmi_1(i7,n21,m1331,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2031
if (sf2.eq.1)goto 100

i1332i7=i7
m1332m21=n21

do m1332=m1331+1,nqul

i7=i1332i7
n21=m1332m21

print*,'loop1332'
call write_symm_xmi_1(i7,n21,m1332,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2032
if (sf2.eq.1)goto 100

i1333i7=i7
m1333m21=n21

do m1333=m1332+1,nqul

i7=i1333i7
n21=m1333m21

print*,'loop1333'
call write_symm_xmi_1(i7,n21,m1333,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2033
if (sf2.eq.1)goto 100

i1334i7=i7
m1334m21=n21

do m1334=m1333+1,nqul

i7=i1334i7
n21=m1334m21

print*,'loop1334'
call write_symm_xmi_1(i7,n21,m1334,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2034
if (sf2.eq.1)goto 100

i1335i7=i7
m1335m21=n21

do m1335=m1334+1,nqul

i7=i1335i7
n21=m1335m21

print*,'loop1335'
call write_symm_xmi_1(i7,n21,m1335,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2035
if (sf2.eq.1)goto 100

i1336i7=i7
m1336m21=n21

do m1336=m1335+1,nqul

i7=i1336i7
n21=m1336m21

print*,'loop1336'
call write_symm_xmi_1(i7,n21,m1336,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2036
if (sf2.eq.1)goto 100

i1337i7=i7
m1337m21=n21

do m1337=m1336+1,nqul

i7=i1337i7
n21=m1337m21

print*,'loop1337'
call write_symm_xmi_1(i7,n21,m1337,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2037
if (sf2.eq.1)goto 100

i1338i7=i7
m1338m21=n21

do m1338=m1337+1,nqul

i7=i1338i7
n21=m1338m21

print*,'loop1338'
call write_symm_xmi_1(i7,n21,m1338,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2038
if (sf2.eq.1)goto 100

i1339i7=i7
m1339m21=n21

do m1339=m1338+1,nqul

i7=i1339i7
n21=m1339m21

print*,'loop1339'
call write_symm_xmi_1(i7,n21,m1339,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2039
if (sf2.eq.1)goto 100

i1340i7=i7
m1340m21=n21

do m1340=m1339+1,nqul

i7=i1340i7
n21=m1340m21

print*,'loop1340'
call write_symm_xmi_1(i7,n21,m1340,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2040
if (sf2.eq.1)goto 100

i1341i7=i7
m1341m21=n21

do m1341=m1340+1,nqul

i7=i1341i7
n21=m1341m21

print*,'loop1341'
call write_symm_xmi_1(i7,n21,m1341,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2041
if (sf2.eq.1)goto 100

i1342i7=i7
m1342m21=n21

do m1342=m1341+1,nqul

i7=i1342i7
n21=m1342m21

print*,'loop1342'
call write_symm_xmi_1(i7,n21,m1342,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2042
if (sf2.eq.1)goto 100

i1343i7=i7
m1343m21=n21

do m1343=m1342+1,nqul

i7=i1343i7
n21=m1343m21

print*,'loop1343'
call write_symm_xmi_1(i7,n21,m1343,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2043
if (sf2.eq.1)goto 100

i1344i7=i7
m1344m21=n21

do m1344=m1343+1,nqul

i7=i1344i7
n21=m1344m21

print*,'loop1344'
call write_symm_xmi_1(i7,n21,m1344,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2044
if (sf2.eq.1)goto 100

i1345i7=i7
m1345m21=n21

do m1345=m1344+1,nqul

i7=i1345i7
n21=m1345m21

print*,'loop1345'
call write_symm_xmi_1(i7,n21,m1345,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2045
if (sf2.eq.1)goto 100

i1346i7=i7
m1346m21=n21

do m1346=m1345+1,nqul

i7=i1346i7
n21=m1346m21

print*,'loop1346'
call write_symm_xmi_1(i7,n21,m1346,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2046
if (sf2.eq.1)goto 100

i1347i7=i7
m1347m21=n21

do m1347=m1346+1,nqul

i7=i1347i7
n21=m1347m21

print*,'loop1347'
call write_symm_xmi_1(i7,n21,m1347,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2047
if (sf2.eq.1)goto 100

i1348i7=i7
m1348m21=n21

do m1348=m1347+1,nqul

i7=i1348i7
n21=m1348m21

print*,'loop1348'
call write_symm_xmi_1(i7,n21,m1348,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2048
if (sf2.eq.1)goto 100

i1349i7=i7
m1349m21=n21

do m1349=m1348+1,nqul

i7=i1349i7
n21=m1349m21

print*,'loop1349'
call write_symm_xmi_1(i7,n21,m1349,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2049
if (sf2.eq.1)goto 100

i1350i7=i7
m1350m21=n21

do m1350=m1349+1,nqul

i7=i1350i7
n21=m1350m21

print*,'loop1350'
call write_symm_xmi_1(i7,n21,m1350,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2050
if (sf2.eq.1)goto 100

i1351i7=i7
m1351m21=n21

do m1351=m1350+1,nqul

i7=i1351i7
n21=m1351m21

print*,'loop1351'
call write_symm_xmi_1(i7,n21,m1351,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2051
if (sf2.eq.1)goto 100

i1352i7=i7
m1352m21=n21

do m1352=m1351+1,nqul

i7=i1352i7
n21=m1352m21

print*,'loop1352'
call write_symm_xmi_1(i7,n21,m1352,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2052
if (sf2.eq.1)goto 100

i1353i7=i7
m1353m21=n21

do m1353=m1352+1,nqul

i7=i1353i7
n21=m1353m21

print*,'loop1353'
call write_symm_xmi_1(i7,n21,m1353,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2053
if (sf2.eq.1)goto 100

i1354i7=i7
m1354m21=n21

do m1354=m1353+1,nqul

i7=i1354i7
n21=m1354m21

print*,'loop1354'
call write_symm_xmi_1(i7,n21,m1354,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2054
if (sf2.eq.1)goto 100

i1355i7=i7
m1355m21=n21

do m1355=m1354+1,nqul

i7=i1355i7
n21=m1355m21

print*,'loop1355'
call write_symm_xmi_1(i7,n21,m1355,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2055
if (sf2.eq.1)goto 100

i1356i7=i7
m1356m21=n21

do m1356=m1355+1,nqul

i7=i1356i7
n21=m1356m21

print*,'loop1356'
call write_symm_xmi_1(i7,n21,m1356,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2056
if (sf2.eq.1)goto 100

i1357i7=i7
m1357m21=n21

do m1357=m1356+1,nqul

i7=i1357i7
n21=m1357m21

print*,'loop1357'
call write_symm_xmi_1(i7,n21,m1357,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2057
if (sf2.eq.1)goto 100

i1358i7=i7
m1358m21=n21

do m1358=m1357+1,nqul

i7=i1358i7
n21=m1358m21

print*,'loop1358'
call write_symm_xmi_1(i7,n21,m1358,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2058
if (sf2.eq.1)goto 100

i1359i7=i7
m1359m21=n21

do m1359=m1358+1,nqul

i7=i1359i7
n21=m1359m21

print*,'loop1359'
call write_symm_xmi_1(i7,n21,m1359,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2059
if (sf2.eq.1)goto 100

i1360i7=i7
m1360m21=n21

do m1360=m1359+1,nqul

i7=i1360i7
n21=m1360m21

print*,'loop1360'
call write_symm_xmi_1(i7,n21,m1360,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2060
if (sf2.eq.1)goto 100

i1361i7=i7
m1361m21=n21

do m1361=m1360+1,nqul

i7=i1361i7
n21=m1361m21

print*,'loop1361'
call write_symm_xmi_1(i7,n21,m1361,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2061
if (sf2.eq.1)goto 100

i1362i7=i7
m1362m21=n21

do m1362=m1361+1,nqul

i7=i1362i7
n21=m1362m21

print*,'loop1362'
call write_symm_xmi_1(i7,n21,m1362,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2062
if (sf2.eq.1)goto 100

i1363i7=i7
m1363m21=n21

do m1363=m1362+1,nqul

i7=i1363i7
n21=m1363m21

print*,'loop1363'
call write_symm_xmi_1(i7,n21,m1363,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2063
if (sf2.eq.1)goto 100

i1364i7=i7
m1364m21=n21

do m1364=m1363+1,nqul

i7=i1364i7
n21=m1364m21

print*,'loop1364'
call write_symm_xmi_1(i7,n21,m1364,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2064
if (sf2.eq.1)goto 100

i1365i7=i7
m1365m21=n21

do m1365=m1364+1,nqul

i7=i1365i7
n21=m1365m21

print*,'loop1365'
call write_symm_xmi_1(i7,n21,m1365,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2065
if (sf2.eq.1)goto 100

i1366i7=i7
m1366m21=n21

do m1366=m1365+1,nqul

i7=i1366i7
n21=m1366m21

print*,'loop1366'
call write_symm_xmi_1(i7,n21,m1366,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2066
if (sf2.eq.1)goto 100

i1367i7=i7
m1367m21=n21

do m1367=m1366+1,nqul

i7=i1367i7
n21=m1367m21

print*,'loop1367'
call write_symm_xmi_1(i7,n21,m1367,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2067
if (sf2.eq.1)goto 100

i1368i7=i7
m1368m21=n21

do m1368=m1367+1,nqul

i7=i1368i7
n21=m1368m21

print*,'loop1368'
call write_symm_xmi_1(i7,n21,m1368,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2068
if (sf2.eq.1)goto 100

i1369i7=i7
m1369m21=n21

do m1369=m1368+1,nqul

i7=i1369i7
n21=m1369m21

print*,'loop1369'
call write_symm_xmi_1(i7,n21,m1369,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2069
if (sf2.eq.1)goto 100

i1370i7=i7
m1370m21=n21

do m1370=m1369+1,nqul

i7=i1370i7
n21=m1370m21

print*,'loop1370'
call write_symm_xmi_1(i7,n21,m1370,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2070
if (sf2.eq.1)goto 100

i1371i7=i7
m1371m21=n21

do m1371=m1370+1,nqul

i7=i1371i7
n21=m1371m21

print*,'loop1371'
call write_symm_xmi_1(i7,n21,m1371,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2071
if (sf2.eq.1)goto 100

i1372i7=i7
m1372m21=n21

do m1372=m1371+1,nqul

i7=i1372i7
n21=m1372m21

print*,'loop1372'
call write_symm_xmi_1(i7,n21,m1372,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2072
if (sf2.eq.1)goto 100

i1373i7=i7
m1373m21=n21

do m1373=m1372+1,nqul

i7=i1373i7
n21=m1373m21

print*,'loop1373'
call write_symm_xmi_1(i7,n21,m1373,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2073
if (sf2.eq.1)goto 100

i1374i7=i7
m1374m21=n21

do m1374=m1373+1,nqul

i7=i1374i7
n21=m1374m21

print*,'loop1374'
call write_symm_xmi_1(i7,n21,m1374,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2074
if (sf2.eq.1)goto 100

i1375i7=i7
m1375m21=n21

do m1375=m1374+1,nqul

i7=i1375i7
n21=m1375m21

print*,'loop1375'
call write_symm_xmi_1(i7,n21,m1375,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2075
if (sf2.eq.1)goto 100

i1376i7=i7
m1376m21=n21

do m1376=m1375+1,nqul

i7=i1376i7
n21=m1376m21

print*,'loop1376'
call write_symm_xmi_1(i7,n21,m1376,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2076
if (sf2.eq.1)goto 100

i1377i7=i7
m1377m21=n21

do m1377=m1376+1,nqul

i7=i1377i7
n21=m1377m21

print*,'loop1377'
call write_symm_xmi_1(i7,n21,m1377,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2077
if (sf2.eq.1)goto 100

i1378i7=i7
m1378m21=n21

do m1378=m1377+1,nqul

i7=i1378i7
n21=m1378m21

print*,'loop1378'
call write_symm_xmi_1(i7,n21,m1378,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2078
if (sf2.eq.1)goto 100

i1379i7=i7
m1379m21=n21

do m1379=m1378+1,nqul

i7=i1379i7
n21=m1379m21

print*,'loop1379'
call write_symm_xmi_1(i7,n21,m1379,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2079
if (sf2.eq.1)goto 100

i1380i7=i7
m1380m21=n21

do m1380=m1379+1,nqul

i7=i1380i7
n21=m1380m21

print*,'loop1380'
call write_symm_xmi_1(i7,n21,m1380,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2080
if (sf2.eq.1)goto 100

i1381i7=i7
m1381m21=n21

do m1381=m1380+1,nqul

i7=i1381i7
n21=m1381m21

print*,'loop1381'
call write_symm_xmi_1(i7,n21,m1381,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2081
if (sf2.eq.1)goto 100

i1382i7=i7
m1382m21=n21

do m1382=m1381+1,nqul

i7=i1382i7
n21=m1382m21

print*,'loop1382'
call write_symm_xmi_1(i7,n21,m1382,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2082
if (sf2.eq.1)goto 100

i1383i7=i7
m1383m21=n21

do m1383=m1382+1,nqul

i7=i1383i7
n21=m1383m21

print*,'loop1383'
call write_symm_xmi_1(i7,n21,m1383,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2083
if (sf2.eq.1)goto 100

i1384i7=i7
m1384m21=n21

do m1384=m1383+1,nqul

i7=i1384i7
n21=m1384m21

print*,'loop1384'
call write_symm_xmi_1(i7,n21,m1384,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2084
if (sf2.eq.1)goto 100

i1385i7=i7
m1385m21=n21

do m1385=m1384+1,nqul

i7=i1385i7
n21=m1385m21

print*,'loop1385'
call write_symm_xmi_1(i7,n21,m1385,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2085
if (sf2.eq.1)goto 100

i1386i7=i7
m1386m21=n21

do m1386=m1385+1,nqul

i7=i1386i7
n21=m1386m21

print*,'loop1386'
call write_symm_xmi_1(i7,n21,m1386,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2086
if (sf2.eq.1)goto 100

i1387i7=i7
m1387m21=n21

do m1387=m1386+1,nqul

i7=i1387i7
n21=m1387m21

print*,'loop1387'
call write_symm_xmi_1(i7,n21,m1387,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2087
if (sf2.eq.1)goto 100

i1388i7=i7
m1388m21=n21

do m1388=m1387+1,nqul

i7=i1388i7
n21=m1388m21

print*,'loop1388'
call write_symm_xmi_1(i7,n21,m1388,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2088
if (sf2.eq.1)goto 100

i1389i7=i7
m1389m21=n21

do m1389=m1388+1,nqul

i7=i1389i7
n21=m1389m21

print*,'loop1389'
call write_symm_xmi_1(i7,n21,m1389,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2089
if (sf2.eq.1)goto 100

i1390i7=i7
m1390m21=n21

do m1390=m1389+1,nqul

i7=i1390i7
n21=m1390m21

print*,'loop1390'
call write_symm_xmi_1(i7,n21,m1390,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2090
if (sf2.eq.1)goto 100

i1391i7=i7
m1391m21=n21

do m1391=m1390+1,nqul

i7=i1391i7
n21=m1391m21

print*,'loop1391'
call write_symm_xmi_1(i7,n21,m1391,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2091
if (sf2.eq.1)goto 100

i1392i7=i7
m1392m21=n21

do m1392=m1391+1,nqul

i7=i1392i7
n21=m1392m21

print*,'loop1392'
call write_symm_xmi_1(i7,n21,m1392,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2092
if (sf2.eq.1)goto 100

i1393i7=i7
m1393m21=n21

do m1393=m1392+1,nqul

i7=i1393i7
n21=m1393m21

print*,'loop1393'
call write_symm_xmi_1(i7,n21,m1393,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2093
if (sf2.eq.1)goto 100

i1394i7=i7
m1394m21=n21

do m1394=m1393+1,nqul

i7=i1394i7
n21=m1394m21

print*,'loop1394'
call write_symm_xmi_1(i7,n21,m1394,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2094
if (sf2.eq.1)goto 100

i1395i7=i7
m1395m21=n21

do m1395=m1394+1,nqul

i7=i1395i7
n21=m1395m21

print*,'loop1395'
call write_symm_xmi_1(i7,n21,m1395,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2095
if (sf2.eq.1)goto 100

i1396i7=i7
m1396m21=n21

do m1396=m1395+1,nqul

i7=i1396i7
n21=m1396m21

print*,'loop1396'
call write_symm_xmi_1(i7,n21,m1396,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2096
if (sf2.eq.1)goto 100

i1397i7=i7
m1397m21=n21

do m1397=m1396+1,nqul

i7=i1397i7
n21=m1397m21

print*,'loop1397'
call write_symm_xmi_1(i7,n21,m1397,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2097
if (sf2.eq.1)goto 100

i1398i7=i7
m1398m21=n21

do m1398=m1397+1,nqul

i7=i1398i7
n21=m1398m21

print*,'loop1398'
call write_symm_xmi_1(i7,n21,m1398,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2098
if (sf2.eq.1)goto 100

i1399i7=i7
m1399m21=n21

do m1399=m1398+1,nqul

i7=i1399i7
n21=m1399m21

print*,'loop1399'
call write_symm_xmi_1(i7,n21,m1399,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2099
if (sf2.eq.1)goto 100

i1400i7=i7
m1400m21=n21

do m1400=m1399+1,nqul

i7=i1400i7
n21=m1400m21

print*,'loop1400'
call write_symm_xmi_1(i7,n21,m1400,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2100
if (sf2.eq.1)goto 100

i1401i7=i7
m1401m21=n21

do m1401=m1400+1,nqul

i7=i1401i7
n21=m1401m21

print*,'loop1401'
call write_symm_xmi_1(i7,n21,m1401,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2101
if (sf2.eq.1)goto 100

i1402i7=i7
m1402m21=n21

do m1402=m1401+1,nqul

i7=i1402i7
n21=m1402m21

print*,'loop1402'
call write_symm_xmi_1(i7,n21,m1402,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2102
if (sf2.eq.1)goto 100

i1403i7=i7
m1403m21=n21

do m1403=m1402+1,nqul

i7=i1403i7
n21=m1403m21

print*,'loop1403'
call write_symm_xmi_1(i7,n21,m1403,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2103
if (sf2.eq.1)goto 100

i1404i7=i7
m1404m21=n21

do m1404=m1403+1,nqul

i7=i1404i7
n21=m1404m21

print*,'loop1404'
call write_symm_xmi_1(i7,n21,m1404,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2104
if (sf2.eq.1)goto 100

i1405i7=i7
m1405m21=n21

do m1405=m1404+1,nqul

i7=i1405i7
n21=m1405m21

print*,'loop1405'
call write_symm_xmi_1(i7,n21,m1405,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2105
if (sf2.eq.1)goto 100

i1406i7=i7
m1406m21=n21

do m1406=m1405+1,nqul

i7=i1406i7
n21=m1406m21

print*,'loop1406'
call write_symm_xmi_1(i7,n21,m1406,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2106
if (sf2.eq.1)goto 100

i1407i7=i7
m1407m21=n21

do m1407=m1406+1,nqul

i7=i1407i7
n21=m1407m21

print*,'loop1407'
call write_symm_xmi_1(i7,n21,m1407,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2107
if (sf2.eq.1)goto 100

i1408i7=i7
m1408m21=n21

do m1408=m1407+1,nqul

i7=i1408i7
n21=m1408m21

print*,'loop1408'
call write_symm_xmi_1(i7,n21,m1408,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2108
if (sf2.eq.1)goto 100

i1409i7=i7
m1409m21=n21

do m1409=m1408+1,nqul

i7=i1409i7
n21=m1409m21

print*,'loop1409'
call write_symm_xmi_1(i7,n21,m1409,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2109
if (sf2.eq.1)goto 100

i1410i7=i7
m1410m21=n21

do m1410=m1409+1,nqul

i7=i1410i7
n21=m1410m21

print*,'loop1410'
call write_symm_xmi_1(i7,n21,m1410,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2110
if (sf2.eq.1)goto 100

i1411i7=i7
m1411m21=n21

do m1411=m1410+1,nqul

i7=i1411i7
n21=m1411m21

print*,'loop1411'
call write_symm_xmi_1(i7,n21,m1411,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2111
if (sf2.eq.1)goto 100

i1412i7=i7
m1412m21=n21

do m1412=m1411+1,nqul

i7=i1412i7
n21=m1412m21

print*,'loop1412'
call write_symm_xmi_1(i7,n21,m1412,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2112
if (sf2.eq.1)goto 100

i1413i7=i7
m1413m21=n21

do m1413=m1412+1,nqul

i7=i1413i7
n21=m1413m21

print*,'loop1413'
call write_symm_xmi_1(i7,n21,m1413,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2113
if (sf2.eq.1)goto 100

i1414i7=i7
m1414m21=n21

do m1414=m1413+1,nqul

i7=i1414i7
n21=m1414m21

print*,'loop1414'
call write_symm_xmi_1(i7,n21,m1414,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2114
if (sf2.eq.1)goto 100

i1415i7=i7
m1415m21=n21

do m1415=m1414+1,nqul

i7=i1415i7
n21=m1415m21

print*,'loop1415'
call write_symm_xmi_1(i7,n21,m1415,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2115
if (sf2.eq.1)goto 100

i1416i7=i7
m1416m21=n21

do m1416=m1415+1,nqul

i7=i1416i7
n21=m1416m21

print*,'loop1416'
call write_symm_xmi_1(i7,n21,m1416,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2116
if (sf2.eq.1)goto 100

i1417i7=i7
m1417m21=n21

do m1417=m1416+1,nqul

i7=i1417i7
n21=m1417m21

print*,'loop1417'
call write_symm_xmi_1(i7,n21,m1417,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2117
if (sf2.eq.1)goto 100

i1418i7=i7
m1418m21=n21

do m1418=m1417+1,nqul

i7=i1418i7
n21=m1418m21

print*,'loop1418'
call write_symm_xmi_1(i7,n21,m1418,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2118
if (sf2.eq.1)goto 100

i1419i7=i7
m1419m21=n21

do m1419=m1418+1,nqul

i7=i1419i7
n21=m1419m21

print*,'loop1419'
call write_symm_xmi_1(i7,n21,m1419,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2119
if (sf2.eq.1)goto 100

i1420i7=i7
m1420m21=n21

do m1420=m1419+1,nqul

i7=i1420i7
n21=m1420m21

print*,'loop1420'
call write_symm_xmi_1(i7,n21,m1420,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2120
if (sf2.eq.1)goto 100

i1421i7=i7
m1421m21=n21

do m1421=m1420+1,nqul

i7=i1421i7
n21=m1421m21

print*,'loop1421'
call write_symm_xmi_1(i7,n21,m1421,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2121
if (sf2.eq.1)goto 100

i1422i7=i7
m1422m21=n21

do m1422=m1421+1,nqul

i7=i1422i7
n21=m1422m21

print*,'loop1422'
call write_symm_xmi_1(i7,n21,m1422,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2122
if (sf2.eq.1)goto 100

i1423i7=i7
m1423m21=n21

do m1423=m1422+1,nqul

i7=i1423i7
n21=m1423m21

print*,'loop1423'
call write_symm_xmi_1(i7,n21,m1423,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2123
if (sf2.eq.1)goto 100

i1424i7=i7
m1424m21=n21

do m1424=m1423+1,nqul

i7=i1424i7
n21=m1424m21

print*,'loop1424'
call write_symm_xmi_1(i7,n21,m1424,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2124
if (sf2.eq.1)goto 100

i1425i7=i7
m1425m21=n21

do m1425=m1424+1,nqul

i7=i1425i7
n21=m1425m21

print*,'loop1425'
call write_symm_xmi_1(i7,n21,m1425,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2125
if (sf2.eq.1)goto 100

i1426i7=i7
m1426m21=n21

do m1426=m1425+1,nqul

i7=i1426i7
n21=m1426m21

print*,'loop1426'
call write_symm_xmi_1(i7,n21,m1426,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2126
if (sf2.eq.1)goto 100

i1427i7=i7
m1427m21=n21

do m1427=m1426+1,nqul

i7=i1427i7
n21=m1427m21

print*,'loop1427'
call write_symm_xmi_1(i7,n21,m1427,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2127
if (sf2.eq.1)goto 100

i1428i7=i7
m1428m21=n21

do m1428=m1427+1,nqul

i7=i1428i7
n21=m1428m21

print*,'loop1428'
call write_symm_xmi_1(i7,n21,m1428,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2128
if (sf2.eq.1)goto 100

i1429i7=i7
m1429m21=n21

do m1429=m1428+1,nqul

i7=i1429i7
n21=m1429m21

print*,'loop1429'
call write_symm_xmi_1(i7,n21,m1429,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2129
if (sf2.eq.1)goto 100

i1430i7=i7
m1430m21=n21

do m1430=m1429+1,nqul

i7=i1430i7
n21=m1430m21

print*,'loop1430'
call write_symm_xmi_1(i7,n21,m1430,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2130
if (sf2.eq.1)goto 100

i1431i7=i7
m1431m21=n21

do m1431=m1430+1,nqul

i7=i1431i7
n21=m1431m21

print*,'loop1431'
call write_symm_xmi_1(i7,n21,m1431,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2131
if (sf2.eq.1)goto 100

i1432i7=i7
m1432m21=n21

do m1432=m1431+1,nqul

i7=i1432i7
n21=m1432m21

print*,'loop1432'
call write_symm_xmi_1(i7,n21,m1432,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2132
if (sf2.eq.1)goto 100

i1433i7=i7
m1433m21=n21

do m1433=m1432+1,nqul

i7=i1433i7
n21=m1433m21

print*,'loop1433'
call write_symm_xmi_1(i7,n21,m1433,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2133
if (sf2.eq.1)goto 100

i1434i7=i7
m1434m21=n21

do m1434=m1433+1,nqul

i7=i1434i7
n21=m1434m21

print*,'loop1434'
call write_symm_xmi_1(i7,n21,m1434,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2134
if (sf2.eq.1)goto 100

i1435i7=i7
m1435m21=n21

do m1435=m1434+1,nqul

i7=i1435i7
n21=m1435m21

print*,'loop1435'
call write_symm_xmi_1(i7,n21,m1435,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2135
if (sf2.eq.1)goto 100

i1436i7=i7
m1436m21=n21

do m1436=m1435+1,nqul

i7=i1436i7
n21=m1436m21

print*,'loop1436'
call write_symm_xmi_1(i7,n21,m1436,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2136
if (sf2.eq.1)goto 100

i1437i7=i7
m1437m21=n21

do m1437=m1436+1,nqul

i7=i1437i7
n21=m1437m21

print*,'loop1437'
call write_symm_xmi_1(i7,n21,m1437,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2137
if (sf2.eq.1)goto 100

i1438i7=i7
m1438m21=n21

do m1438=m1437+1,nqul

i7=i1438i7
n21=m1438m21

print*,'loop1438'
call write_symm_xmi_1(i7,n21,m1438,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2138
if (sf2.eq.1)goto 100

i1439i7=i7
m1439m21=n21

do m1439=m1438+1,nqul

i7=i1439i7
n21=m1439m21

print*,'loop1439'
call write_symm_xmi_1(i7,n21,m1439,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2139
if (sf2.eq.1)goto 100

i1440i7=i7
m1440m21=n21

do m1440=m1439+1,nqul

i7=i1440i7
n21=m1440m21

print*,'loop1440'
call write_symm_xmi_1(i7,n21,m1440,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2140
if (sf2.eq.1)goto 100

i1441i7=i7
m1441m21=n21

do m1441=m1440+1,nqul

i7=i1441i7
n21=m1441m21

print*,'loop1441'
call write_symm_xmi_1(i7,n21,m1441,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2141
if (sf2.eq.1)goto 100

i1442i7=i7
m1442m21=n21

do m1442=m1441+1,nqul

i7=i1442i7
n21=m1442m21

print*,'loop1442'
call write_symm_xmi_1(i7,n21,m1442,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2142
if (sf2.eq.1)goto 100

i1443i7=i7
m1443m21=n21

do m1443=m1442+1,nqul

i7=i1443i7
n21=m1443m21

print*,'loop1443'
call write_symm_xmi_1(i7,n21,m1443,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2143
if (sf2.eq.1)goto 100

i1444i7=i7
m1444m21=n21

do m1444=m1443+1,nqul

i7=i1444i7
n21=m1444m21

print*,'loop1444'
call write_symm_xmi_1(i7,n21,m1444,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2144
if (sf2.eq.1)goto 100

i1445i7=i7
m1445m21=n21

do m1445=m1444+1,nqul

i7=i1445i7
n21=m1445m21

print*,'loop1445'
call write_symm_xmi_1(i7,n21,m1445,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2145
if (sf2.eq.1)goto 100

i1446i7=i7
m1446m21=n21

do m1446=m1445+1,nqul

i7=i1446i7
n21=m1446m21

print*,'loop1446'
call write_symm_xmi_1(i7,n21,m1446,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2146
if (sf2.eq.1)goto 100

i1447i7=i7
m1447m21=n21

do m1447=m1446+1,nqul

i7=i1447i7
n21=m1447m21

print*,'loop1447'
call write_symm_xmi_1(i7,n21,m1447,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2147
if (sf2.eq.1)goto 100

i1448i7=i7
m1448m21=n21

do m1448=m1447+1,nqul

i7=i1448i7
n21=m1448m21

print*,'loop1448'
call write_symm_xmi_1(i7,n21,m1448,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2148
if (sf2.eq.1)goto 100

i1449i7=i7
m1449m21=n21

do m1449=m1448+1,nqul

i7=i1449i7
n21=m1449m21

print*,'loop1449'
call write_symm_xmi_1(i7,n21,m1449,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2149
if (sf2.eq.1)goto 100

i1450i7=i7
m1450m21=n21

do m1450=m1449+1,nqul

i7=i1450i7
n21=m1450m21

print*,'loop1450'
call write_symm_xmi_1(i7,n21,m1450,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2150
if (sf2.eq.1)goto 100

i1451i7=i7
m1451m21=n21

do m1451=m1450+1,nqul

i7=i1451i7
n21=m1451m21

print*,'loop1451'
call write_symm_xmi_1(i7,n21,m1451,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2151
if (sf2.eq.1)goto 100

i1452i7=i7
m1452m21=n21

do m1452=m1451+1,nqul

i7=i1452i7
n21=m1452m21

print*,'loop1452'
call write_symm_xmi_1(i7,n21,m1452,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2152
if (sf2.eq.1)goto 100

i1453i7=i7
m1453m21=n21

do m1453=m1452+1,nqul

i7=i1453i7
n21=m1453m21

print*,'loop1453'
call write_symm_xmi_1(i7,n21,m1453,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2153
if (sf2.eq.1)goto 100

i1454i7=i7
m1454m21=n21

do m1454=m1453+1,nqul

i7=i1454i7
n21=m1454m21

print*,'loop1454'
call write_symm_xmi_1(i7,n21,m1454,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2154
if (sf2.eq.1)goto 100

i1455i7=i7
m1455m21=n21

do m1455=m1454+1,nqul

i7=i1455i7
n21=m1455m21

print*,'loop1455'
call write_symm_xmi_1(i7,n21,m1455,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2155
if (sf2.eq.1)goto 100

i1456i7=i7
m1456m21=n21

do m1456=m1455+1,nqul

i7=i1456i7
n21=m1456m21

print*,'loop1456'
call write_symm_xmi_1(i7,n21,m1456,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2156
if (sf2.eq.1)goto 100

i1457i7=i7
m1457m21=n21

do m1457=m1456+1,nqul

i7=i1457i7
n21=m1457m21

print*,'loop1457'
call write_symm_xmi_1(i7,n21,m1457,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2157
if (sf2.eq.1)goto 100

i1458i7=i7
m1458m21=n21

do m1458=m1457+1,nqul

i7=i1458i7
n21=m1458m21

print*,'loop1458'
call write_symm_xmi_1(i7,n21,m1458,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2158
if (sf2.eq.1)goto 100

i1459i7=i7
m1459m21=n21

do m1459=m1458+1,nqul

i7=i1459i7
n21=m1459m21

print*,'loop1459'
call write_symm_xmi_1(i7,n21,m1459,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2159
if (sf2.eq.1)goto 100

i1460i7=i7
m1460m21=n21

do m1460=m1459+1,nqul

i7=i1460i7
n21=m1460m21

print*,'loop1460'
call write_symm_xmi_1(i7,n21,m1460,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2160
if (sf2.eq.1)goto 100

i1461i7=i7
m1461m21=n21

do m1461=m1460+1,nqul

i7=i1461i7
n21=m1461m21

print*,'loop1461'
call write_symm_xmi_1(i7,n21,m1461,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2161
if (sf2.eq.1)goto 100

i1462i7=i7
m1462m21=n21

do m1462=m1461+1,nqul

i7=i1462i7
n21=m1462m21

print*,'loop1462'
call write_symm_xmi_1(i7,n21,m1462,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2162
if (sf2.eq.1)goto 100

i1463i7=i7
m1463m21=n21

do m1463=m1462+1,nqul

i7=i1463i7
n21=m1463m21

print*,'loop1463'
call write_symm_xmi_1(i7,n21,m1463,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2163
if (sf2.eq.1)goto 100

i1464i7=i7
m1464m21=n21

do m1464=m1463+1,nqul

i7=i1464i7
n21=m1464m21

print*,'loop1464'
call write_symm_xmi_1(i7,n21,m1464,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2164
if (sf2.eq.1)goto 100

i1465i7=i7
m1465m21=n21

do m1465=m1464+1,nqul

i7=i1465i7
n21=m1465m21

print*,'loop1465'
call write_symm_xmi_1(i7,n21,m1465,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2165
if (sf2.eq.1)goto 100

i1466i7=i7
m1466m21=n21

do m1466=m1465+1,nqul

i7=i1466i7
n21=m1466m21

print*,'loop1466'
call write_symm_xmi_1(i7,n21,m1466,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2166
if (sf2.eq.1)goto 100

i1467i7=i7
m1467m21=n21

do m1467=m1466+1,nqul

i7=i1467i7
n21=m1467m21

print*,'loop1467'
call write_symm_xmi_1(i7,n21,m1467,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2167
if (sf2.eq.1)goto 100

i1468i7=i7
m1468m21=n21

do m1468=m1467+1,nqul

i7=i1468i7
n21=m1468m21

print*,'loop1468'
call write_symm_xmi_1(i7,n21,m1468,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2168
if (sf2.eq.1)goto 100

i1469i7=i7
m1469m21=n21

do m1469=m1468+1,nqul

i7=i1469i7
n21=m1469m21

print*,'loop1469'
call write_symm_xmi_1(i7,n21,m1469,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2169
if (sf2.eq.1)goto 100

i1470i7=i7
m1470m21=n21

do m1470=m1469+1,nqul

i7=i1470i7
n21=m1470m21

print*,'loop1470'
call write_symm_xmi_1(i7,n21,m1470,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2170
if (sf2.eq.1)goto 100

i1471i7=i7
m1471m21=n21

do m1471=m1470+1,nqul

i7=i1471i7
n21=m1471m21

print*,'loop1471'
call write_symm_xmi_1(i7,n21,m1471,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2171
if (sf2.eq.1)goto 100

i1472i7=i7
m1472m21=n21

do m1472=m1471+1,nqul

i7=i1472i7
n21=m1472m21

print*,'loop1472'
call write_symm_xmi_1(i7,n21,m1472,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2172
if (sf2.eq.1)goto 100

i1473i7=i7
m1473m21=n21

do m1473=m1472+1,nqul

i7=i1473i7
n21=m1473m21

print*,'loop1473'
call write_symm_xmi_1(i7,n21,m1473,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2173
if (sf2.eq.1)goto 100

i1474i7=i7
m1474m21=n21

do m1474=m1473+1,nqul

i7=i1474i7
n21=m1474m21

print*,'loop1474'
call write_symm_xmi_1(i7,n21,m1474,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2174
if (sf2.eq.1)goto 100

i1475i7=i7
m1475m21=n21

do m1475=m1474+1,nqul

i7=i1475i7
n21=m1475m21

print*,'loop1475'
call write_symm_xmi_1(i7,n21,m1475,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2175
if (sf2.eq.1)goto 100

i1476i7=i7
m1476m21=n21

do m1476=m1475+1,nqul

i7=i1476i7
n21=m1476m21

print*,'loop1476'
call write_symm_xmi_1(i7,n21,m1476,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2176
if (sf2.eq.1)goto 100

i1477i7=i7
m1477m21=n21

do m1477=m1476+1,nqul

i7=i1477i7
n21=m1477m21

print*,'loop1477'
call write_symm_xmi_1(i7,n21,m1477,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2177
if (sf2.eq.1)goto 100

i1478i7=i7
m1478m21=n21

do m1478=m1477+1,nqul

i7=i1478i7
n21=m1478m21

print*,'loop1478'
call write_symm_xmi_1(i7,n21,m1478,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2178
if (sf2.eq.1)goto 100

i1479i7=i7
m1479m21=n21

do m1479=m1478+1,nqul

i7=i1479i7
n21=m1479m21

print*,'loop1479'
call write_symm_xmi_1(i7,n21,m1479,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2179
if (sf2.eq.1)goto 100

i1480i7=i7
m1480m21=n21

do m1480=m1479+1,nqul

i7=i1480i7
n21=m1480m21

print*,'loop1480'
call write_symm_xmi_1(i7,n21,m1480,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2180
if (sf2.eq.1)goto 100

i1481i7=i7
m1481m21=n21

do m1481=m1480+1,nqul

i7=i1481i7
n21=m1481m21

print*,'loop1481'
call write_symm_xmi_1(i7,n21,m1481,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2181
if (sf2.eq.1)goto 100

i1482i7=i7
m1482m21=n21

do m1482=m1481+1,nqul

i7=i1482i7
n21=m1482m21

print*,'loop1482'
call write_symm_xmi_1(i7,n21,m1482,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2182
if (sf2.eq.1)goto 100

i1483i7=i7
m1483m21=n21

do m1483=m1482+1,nqul

i7=i1483i7
n21=m1483m21

print*,'loop1483'
call write_symm_xmi_1(i7,n21,m1483,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2183
if (sf2.eq.1)goto 100

i1484i7=i7
m1484m21=n21

do m1484=m1483+1,nqul

i7=i1484i7
n21=m1484m21

print*,'loop1484'
call write_symm_xmi_1(i7,n21,m1484,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2184
if (sf2.eq.1)goto 100

i1485i7=i7
m1485m21=n21

do m1485=m1484+1,nqul

i7=i1485i7
n21=m1485m21

print*,'loop1485'
call write_symm_xmi_1(i7,n21,m1485,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2185
if (sf2.eq.1)goto 100

i1486i7=i7
m1486m21=n21

do m1486=m1485+1,nqul

i7=i1486i7
n21=m1486m21

print*,'loop1486'
call write_symm_xmi_1(i7,n21,m1486,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2186
if (sf2.eq.1)goto 100

i1487i7=i7
m1487m21=n21

do m1487=m1486+1,nqul

i7=i1487i7
n21=m1487m21

print*,'loop1487'
call write_symm_xmi_1(i7,n21,m1487,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2187
if (sf2.eq.1)goto 100

i1488i7=i7
m1488m21=n21

do m1488=m1487+1,nqul

i7=i1488i7
n21=m1488m21

print*,'loop1488'
call write_symm_xmi_1(i7,n21,m1488,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2188
if (sf2.eq.1)goto 100

i1489i7=i7
m1489m21=n21

do m1489=m1488+1,nqul

i7=i1489i7
n21=m1489m21

print*,'loop1489'
call write_symm_xmi_1(i7,n21,m1489,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2189
if (sf2.eq.1)goto 100

i1490i7=i7
m1490m21=n21

do m1490=m1489+1,nqul

i7=i1490i7
n21=m1490m21

print*,'loop1490'
call write_symm_xmi_1(i7,n21,m1490,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2190
if (sf2.eq.1)goto 100

i1491i7=i7
m1491m21=n21

do m1491=m1490+1,nqul

i7=i1491i7
n21=m1491m21

print*,'loop1491'
call write_symm_xmi_1(i7,n21,m1491,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2191
if (sf2.eq.1)goto 100

i1492i7=i7
m1492m21=n21

do m1492=m1491+1,nqul

i7=i1492i7
n21=m1492m21

print*,'loop1492'
call write_symm_xmi_1(i7,n21,m1492,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2192
if (sf2.eq.1)goto 100

i1493i7=i7
m1493m21=n21

do m1493=m1492+1,nqul

i7=i1493i7
n21=m1493m21

print*,'loop1493'
call write_symm_xmi_1(i7,n21,m1493,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2193
if (sf2.eq.1)goto 100

i1494i7=i7
m1494m21=n21

do m1494=m1493+1,nqul

i7=i1494i7
n21=m1494m21

print*,'loop1494'
call write_symm_xmi_1(i7,n21,m1494,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2194
if (sf2.eq.1)goto 100

i1495i7=i7
m1495m21=n21

do m1495=m1494+1,nqul

i7=i1495i7
n21=m1495m21

print*,'loop1495'
call write_symm_xmi_1(i7,n21,m1495,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2195
if (sf2.eq.1)goto 100

i1496i7=i7
m1496m21=n21

do m1496=m1495+1,nqul

i7=i1496i7
n21=m1496m21

print*,'loop1496'
call write_symm_xmi_1(i7,n21,m1496,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2196
if (sf2.eq.1)goto 100

i1497i7=i7
m1497m21=n21

do m1497=m1496+1,nqul

i7=i1497i7
n21=m1497m21

print*,'loop1497'
call write_symm_xmi_1(i7,n21,m1497,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2197
if (sf2.eq.1)goto 100

i1498i7=i7
m1498m21=n21

do m1498=m1497+1,nqul

i7=i1498i7
n21=m1498m21

print*,'loop1498'
call write_symm_xmi_1(i7,n21,m1498,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2198
if (sf2.eq.1)goto 100

i1499i7=i7
m1499m21=n21

do m1499=m1498+1,nqul

i7=i1499i7
n21=m1499m21

print*,'loop1499'
call write_symm_xmi_1(i7,n21,m1499,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2199
if (sf2.eq.1)goto 100

i1500i7=i7
m1500m21=n21

do m1500=m1499+1,nqul

i7=i1500i7
n21=m1500m21

print*,'loop1500'
call write_symm_xmi_1(i7,n21,m1500,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2200
if (sf2.eq.1)goto 100

i1501i7=i7
m1501m21=n21

do m1501=m1500+1,nqul

i7=i1501i7
n21=m1501m21

print*,'loop1501'
call write_symm_xmi_1(i7,n21,m1501,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2201
if (sf2.eq.1)goto 100

i1502i7=i7
m1502m21=n21

do m1502=m1501+1,nqul

i7=i1502i7
n21=m1502m21

print*,'loop1502'
call write_symm_xmi_1(i7,n21,m1502,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2202
if (sf2.eq.1)goto 100

i1503i7=i7
m1503m21=n21

do m1503=m1502+1,nqul

i7=i1503i7
n21=m1503m21

print*,'loop1503'
call write_symm_xmi_1(i7,n21,m1503,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2203
if (sf2.eq.1)goto 100

i1504i7=i7
m1504m21=n21

do m1504=m1503+1,nqul

i7=i1504i7
n21=m1504m21

print*,'loop1504'
call write_symm_xmi_1(i7,n21,m1504,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2204
if (sf2.eq.1)goto 100

i1505i7=i7
m1505m21=n21

do m1505=m1504+1,nqul

i7=i1505i7
n21=m1505m21

print*,'loop1505'
call write_symm_xmi_1(i7,n21,m1505,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2205
if (sf2.eq.1)goto 100

i1506i7=i7
m1506m21=n21

do m1506=m1505+1,nqul

i7=i1506i7
n21=m1506m21

print*,'loop1506'
call write_symm_xmi_1(i7,n21,m1506,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2206
if (sf2.eq.1)goto 100

i1507i7=i7
m1507m21=n21

do m1507=m1506+1,nqul

i7=i1507i7
n21=m1507m21

print*,'loop1507'
call write_symm_xmi_1(i7,n21,m1507,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2207
if (sf2.eq.1)goto 100

i1508i7=i7
m1508m21=n21

do m1508=m1507+1,nqul

i7=i1508i7
n21=m1508m21

print*,'loop1508'
call write_symm_xmi_1(i7,n21,m1508,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2208
if (sf2.eq.1)goto 100

i1509i7=i7
m1509m21=n21

do m1509=m1508+1,nqul

i7=i1509i7
n21=m1509m21

print*,'loop1509'
call write_symm_xmi_1(i7,n21,m1509,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2209
if (sf2.eq.1)goto 100

i1510i7=i7
m1510m21=n21

do m1510=m1509+1,nqul

i7=i1510i7
n21=m1510m21

print*,'loop1510'
call write_symm_xmi_1(i7,n21,m1510,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2210
if (sf2.eq.1)goto 100

i1511i7=i7
m1511m21=n21

do m1511=m1510+1,nqul

i7=i1511i7
n21=m1511m21

print*,'loop1511'
call write_symm_xmi_1(i7,n21,m1511,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2211
if (sf2.eq.1)goto 100

i1512i7=i7
m1512m21=n21

do m1512=m1511+1,nqul

i7=i1512i7
n21=m1512m21

print*,'loop1512'
call write_symm_xmi_1(i7,n21,m1512,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2212
if (sf2.eq.1)goto 100

i1513i7=i7
m1513m21=n21

do m1513=m1512+1,nqul

i7=i1513i7
n21=m1513m21

print*,'loop1513'
call write_symm_xmi_1(i7,n21,m1513,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2213
if (sf2.eq.1)goto 100

i1514i7=i7
m1514m21=n21

do m1514=m1513+1,nqul

i7=i1514i7
n21=m1514m21

print*,'loop1514'
call write_symm_xmi_1(i7,n21,m1514,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2214
if (sf2.eq.1)goto 100

i1515i7=i7
m1515m21=n21

do m1515=m1514+1,nqul

i7=i1515i7
n21=m1515m21

print*,'loop1515'
call write_symm_xmi_1(i7,n21,m1515,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2215
if (sf2.eq.1)goto 100

i1516i7=i7
m1516m21=n21

do m1516=m1515+1,nqul

i7=i1516i7
n21=m1516m21

print*,'loop1516'
call write_symm_xmi_1(i7,n21,m1516,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2216
if (sf2.eq.1)goto 100

i1517i7=i7
m1517m21=n21

do m1517=m1516+1,nqul

i7=i1517i7
n21=m1517m21

print*,'loop1517'
call write_symm_xmi_1(i7,n21,m1517,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2217
if (sf2.eq.1)goto 100

i1518i7=i7
m1518m21=n21

do m1518=m1517+1,nqul

i7=i1518i7
n21=m1518m21

print*,'loop1518'
call write_symm_xmi_1(i7,n21,m1518,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2218
if (sf2.eq.1)goto 100

i1519i7=i7
m1519m21=n21

do m1519=m1518+1,nqul

i7=i1519i7
n21=m1519m21

print*,'loop1519'
call write_symm_xmi_1(i7,n21,m1519,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2219
if (sf2.eq.1)goto 100

i1520i7=i7
m1520m21=n21

do m1520=m1519+1,nqul

i7=i1520i7
n21=m1520m21

print*,'loop1520'
call write_symm_xmi_1(i7,n21,m1520,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2220
if (sf2.eq.1)goto 100

i1521i7=i7
m1521m21=n21

do m1521=m1520+1,nqul

i7=i1521i7
n21=m1521m21

print*,'loop1521'
call write_symm_xmi_1(i7,n21,m1521,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2221
if (sf2.eq.1)goto 100

i1522i7=i7
m1522m21=n21

do m1522=m1521+1,nqul

i7=i1522i7
n21=m1522m21

print*,'loop1522'
call write_symm_xmi_1(i7,n21,m1522,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2222
if (sf2.eq.1)goto 100

i1523i7=i7
m1523m21=n21

do m1523=m1522+1,nqul

i7=i1523i7
n21=m1523m21

print*,'loop1523'
call write_symm_xmi_1(i7,n21,m1523,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2223
if (sf2.eq.1)goto 100

i1524i7=i7
m1524m21=n21

do m1524=m1523+1,nqul

i7=i1524i7
n21=m1524m21

print*,'loop1524'
call write_symm_xmi_1(i7,n21,m1524,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2224
if (sf2.eq.1)goto 100

i1525i7=i7
m1525m21=n21

do m1525=m1524+1,nqul

i7=i1525i7
n21=m1525m21

print*,'loop1525'
call write_symm_xmi_1(i7,n21,m1525,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2225
if (sf2.eq.1)goto 100

i1526i7=i7
m1526m21=n21

do m1526=m1525+1,nqul

i7=i1526i7
n21=m1526m21

print*,'loop1526'
call write_symm_xmi_1(i7,n21,m1526,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2226
if (sf2.eq.1)goto 100

i1527i7=i7
m1527m21=n21

do m1527=m1526+1,nqul

i7=i1527i7
n21=m1527m21

print*,'loop1527'
call write_symm_xmi_1(i7,n21,m1527,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2227
if (sf2.eq.1)goto 100

i1528i7=i7
m1528m21=n21

do m1528=m1527+1,nqul

i7=i1528i7
n21=m1528m21

print*,'loop1528'
call write_symm_xmi_1(i7,n21,m1528,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2228
if (sf2.eq.1)goto 100

i1529i7=i7
m1529m21=n21

do m1529=m1528+1,nqul

i7=i1529i7
n21=m1529m21

print*,'loop1529'
call write_symm_xmi_1(i7,n21,m1529,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2229
if (sf2.eq.1)goto 100

i1530i7=i7
m1530m21=n21

do m1530=m1529+1,nqul

i7=i1530i7
n21=m1530m21

print*,'loop1530'
call write_symm_xmi_1(i7,n21,m1530,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2230
if (sf2.eq.1)goto 100

i1531i7=i7
m1531m21=n21

do m1531=m1530+1,nqul

i7=i1531i7
n21=m1531m21

print*,'loop1531'
call write_symm_xmi_1(i7,n21,m1531,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2231
if (sf2.eq.1)goto 100

i1532i7=i7
m1532m21=n21

do m1532=m1531+1,nqul

i7=i1532i7
n21=m1532m21

print*,'loop1532'
call write_symm_xmi_1(i7,n21,m1532,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2232
if (sf2.eq.1)goto 100

i1533i7=i7
m1533m21=n21

do m1533=m1532+1,nqul

i7=i1533i7
n21=m1533m21

print*,'loop1533'
call write_symm_xmi_1(i7,n21,m1533,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2233
if (sf2.eq.1)goto 100

i1534i7=i7
m1534m21=n21

do m1534=m1533+1,nqul

i7=i1534i7
n21=m1534m21

print*,'loop1534'
call write_symm_xmi_1(i7,n21,m1534,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2234
if (sf2.eq.1)goto 100

i1535i7=i7
m1535m21=n21

do m1535=m1534+1,nqul

i7=i1535i7
n21=m1535m21

print*,'loop1535'
call write_symm_xmi_1(i7,n21,m1535,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2235
if (sf2.eq.1)goto 100

i1536i7=i7
m1536m21=n21

do m1536=m1535+1,nqul

i7=i1536i7
n21=m1536m21

print*,'loop1536'
call write_symm_xmi_1(i7,n21,m1536,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2236
if (sf2.eq.1)goto 100

i1537i7=i7
m1537m21=n21

do m1537=m1536+1,nqul

i7=i1537i7
n21=m1537m21

print*,'loop1537'
call write_symm_xmi_1(i7,n21,m1537,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2237
if (sf2.eq.1)goto 100

i1538i7=i7
m1538m21=n21

do m1538=m1537+1,nqul

i7=i1538i7
n21=m1538m21

print*,'loop1538'
call write_symm_xmi_1(i7,n21,m1538,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2238
if (sf2.eq.1)goto 100

i1539i7=i7
m1539m21=n21

do m1539=m1538+1,nqul

i7=i1539i7
n21=m1539m21

print*,'loop1539'
call write_symm_xmi_1(i7,n21,m1539,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2239
if (sf2.eq.1)goto 100

i1540i7=i7
m1540m21=n21

do m1540=m1539+1,nqul

i7=i1540i7
n21=m1540m21

print*,'loop1540'
call write_symm_xmi_1(i7,n21,m1540,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2240
if (sf2.eq.1)goto 100

i1541i7=i7
m1541m21=n21

do m1541=m1540+1,nqul

i7=i1541i7
n21=m1541m21

print*,'loop1541'
call write_symm_xmi_1(i7,n21,m1541,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2241
if (sf2.eq.1)goto 100

i1542i7=i7
m1542m21=n21

do m1542=m1541+1,nqul

i7=i1542i7
n21=m1542m21

print*,'loop1542'
call write_symm_xmi_1(i7,n21,m1542,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2242
if (sf2.eq.1)goto 100

i1543i7=i7
m1543m21=n21

do m1543=m1542+1,nqul

i7=i1543i7
n21=m1543m21

print*,'loop1543'
call write_symm_xmi_1(i7,n21,m1543,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2243
if (sf2.eq.1)goto 100

i1544i7=i7
m1544m21=n21

do m1544=m1543+1,nqul

i7=i1544i7
n21=m1544m21

print*,'loop1544'
call write_symm_xmi_1(i7,n21,m1544,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2244
if (sf2.eq.1)goto 100

i1545i7=i7
m1545m21=n21

do m1545=m1544+1,nqul

i7=i1545i7
n21=m1545m21

print*,'loop1545'
call write_symm_xmi_1(i7,n21,m1545,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2245
if (sf2.eq.1)goto 100

i1546i7=i7
m1546m21=n21

do m1546=m1545+1,nqul

i7=i1546i7
n21=m1546m21

print*,'loop1546'
call write_symm_xmi_1(i7,n21,m1546,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2246
if (sf2.eq.1)goto 100

i1547i7=i7
m1547m21=n21

do m1547=m1546+1,nqul

i7=i1547i7
n21=m1547m21

print*,'loop1547'
call write_symm_xmi_1(i7,n21,m1547,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2247
if (sf2.eq.1)goto 100

i1548i7=i7
m1548m21=n21

do m1548=m1547+1,nqul

i7=i1548i7
n21=m1548m21

print*,'loop1548'
call write_symm_xmi_1(i7,n21,m1548,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2248
if (sf2.eq.1)goto 100

i1549i7=i7
m1549m21=n21

do m1549=m1548+1,nqul

i7=i1549i7
n21=m1549m21

print*,'loop1549'
call write_symm_xmi_1(i7,n21,m1549,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2249
if (sf2.eq.1)goto 100

i1550i7=i7
m1550m21=n21

do m1550=m1549+1,nqul

i7=i1550i7
n21=m1550m21

print*,'loop1550'
call write_symm_xmi_1(i7,n21,m1550,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2250
if (sf2.eq.1)goto 100

i1551i7=i7
m1551m21=n21

do m1551=m1550+1,nqul

i7=i1551i7
n21=m1551m21

print*,'loop1551'
call write_symm_xmi_1(i7,n21,m1551,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2251
if (sf2.eq.1)goto 100

i1552i7=i7
m1552m21=n21

do m1552=m1551+1,nqul

i7=i1552i7
n21=m1552m21

print*,'loop1552'
call write_symm_xmi_1(i7,n21,m1552,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2252
if (sf2.eq.1)goto 100

i1553i7=i7
m1553m21=n21

do m1553=m1552+1,nqul

i7=i1553i7
n21=m1553m21

print*,'loop1553'
call write_symm_xmi_1(i7,n21,m1553,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2253
if (sf2.eq.1)goto 100

i1554i7=i7
m1554m21=n21

do m1554=m1553+1,nqul

i7=i1554i7
n21=m1554m21

print*,'loop1554'
call write_symm_xmi_1(i7,n21,m1554,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2254
if (sf2.eq.1)goto 100

i1555i7=i7
m1555m21=n21

do m1555=m1554+1,nqul

i7=i1555i7
n21=m1555m21

print*,'loop1555'
call write_symm_xmi_1(i7,n21,m1555,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2255
if (sf2.eq.1)goto 100

i1556i7=i7
m1556m21=n21

do m1556=m1555+1,nqul

i7=i1556i7
n21=m1556m21

print*,'loop1556'
call write_symm_xmi_1(i7,n21,m1556,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2256
if (sf2.eq.1)goto 100

i1557i7=i7
m1557m21=n21

do m1557=m1556+1,nqul

i7=i1557i7
n21=m1557m21

print*,'loop1557'
call write_symm_xmi_1(i7,n21,m1557,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2257
if (sf2.eq.1)goto 100

i1558i7=i7
m1558m21=n21

do m1558=m1557+1,nqul

i7=i1558i7
n21=m1558m21

print*,'loop1558'
call write_symm_xmi_1(i7,n21,m1558,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2258
if (sf2.eq.1)goto 100

i1559i7=i7
m1559m21=n21

do m1559=m1558+1,nqul

i7=i1559i7
n21=m1559m21

print*,'loop1559'
call write_symm_xmi_1(i7,n21,m1559,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2259
if (sf2.eq.1)goto 100

i1560i7=i7
m1560m21=n21

do m1560=m1559+1,nqul

i7=i1560i7
n21=m1560m21

print*,'loop1560'
call write_symm_xmi_1(i7,n21,m1560,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2260
if (sf2.eq.1)goto 100

i1561i7=i7
m1561m21=n21

do m1561=m1560+1,nqul

i7=i1561i7
n21=m1561m21

print*,'loop1561'
call write_symm_xmi_1(i7,n21,m1561,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2261
if (sf2.eq.1)goto 100

i1562i7=i7
m1562m21=n21

do m1562=m1561+1,nqul

i7=i1562i7
n21=m1562m21

print*,'loop1562'
call write_symm_xmi_1(i7,n21,m1562,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2262
if (sf2.eq.1)goto 100

i1563i7=i7
m1563m21=n21

do m1563=m1562+1,nqul

i7=i1563i7
n21=m1563m21

print*,'loop1563'
call write_symm_xmi_1(i7,n21,m1563,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2263
if (sf2.eq.1)goto 100

i1564i7=i7
m1564m21=n21

do m1564=m1563+1,nqul

i7=i1564i7
n21=m1564m21

print*,'loop1564'
call write_symm_xmi_1(i7,n21,m1564,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2264
if (sf2.eq.1)goto 100

i1565i7=i7
m1565m21=n21

do m1565=m1564+1,nqul

i7=i1565i7
n21=m1565m21

print*,'loop1565'
call write_symm_xmi_1(i7,n21,m1565,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2265
if (sf2.eq.1)goto 100

i1566i7=i7
m1566m21=n21

do m1566=m1565+1,nqul

i7=i1566i7
n21=m1566m21

print*,'loop1566'
call write_symm_xmi_1(i7,n21,m1566,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2266
if (sf2.eq.1)goto 100

i1567i7=i7
m1567m21=n21

do m1567=m1566+1,nqul

i7=i1567i7
n21=m1567m21

print*,'loop1567'
call write_symm_xmi_1(i7,n21,m1567,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2267
if (sf2.eq.1)goto 100

i1568i7=i7
m1568m21=n21

do m1568=m1567+1,nqul

i7=i1568i7
n21=m1568m21

print*,'loop1568'
call write_symm_xmi_1(i7,n21,m1568,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2268
if (sf2.eq.1)goto 100

i1569i7=i7
m1569m21=n21

do m1569=m1568+1,nqul

i7=i1569i7
n21=m1569m21

print*,'loop1569'
call write_symm_xmi_1(i7,n21,m1569,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2269
if (sf2.eq.1)goto 100

i1570i7=i7
m1570m21=n21

do m1570=m1569+1,nqul

i7=i1570i7
n21=m1570m21

print*,'loop1570'
call write_symm_xmi_1(i7,n21,m1570,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2270
if (sf2.eq.1)goto 100

i1571i7=i7
m1571m21=n21

do m1571=m1570+1,nqul

i7=i1571i7
n21=m1571m21

print*,'loop1571'
call write_symm_xmi_1(i7,n21,m1571,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2271
if (sf2.eq.1)goto 100

i1572i7=i7
m1572m21=n21

do m1572=m1571+1,nqul

i7=i1572i7
n21=m1572m21

print*,'loop1572'
call write_symm_xmi_1(i7,n21,m1572,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2272
if (sf2.eq.1)goto 100

i1573i7=i7
m1573m21=n21

do m1573=m1572+1,nqul

i7=i1573i7
n21=m1573m21

print*,'loop1573'
call write_symm_xmi_1(i7,n21,m1573,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2273
if (sf2.eq.1)goto 100

i1574i7=i7
m1574m21=n21

do m1574=m1573+1,nqul

i7=i1574i7
n21=m1574m21

print*,'loop1574'
call write_symm_xmi_1(i7,n21,m1574,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2274
if (sf2.eq.1)goto 100

i1575i7=i7
m1575m21=n21

do m1575=m1574+1,nqul

i7=i1575i7
n21=m1575m21

print*,'loop1575'
call write_symm_xmi_1(i7,n21,m1575,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2275
if (sf2.eq.1)goto 100

i1576i7=i7
m1576m21=n21

do m1576=m1575+1,nqul

i7=i1576i7
n21=m1576m21

print*,'loop1576'
call write_symm_xmi_1(i7,n21,m1576,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2276
if (sf2.eq.1)goto 100

i1577i7=i7
m1577m21=n21

do m1577=m1576+1,nqul

i7=i1577i7
n21=m1577m21

print*,'loop1577'
call write_symm_xmi_1(i7,n21,m1577,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2277
if (sf2.eq.1)goto 100

i1578i7=i7
m1578m21=n21

do m1578=m1577+1,nqul

i7=i1578i7
n21=m1578m21

print*,'loop1578'
call write_symm_xmi_1(i7,n21,m1578,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2278
if (sf2.eq.1)goto 100

i1579i7=i7
m1579m21=n21

do m1579=m1578+1,nqul

i7=i1579i7
n21=m1579m21

print*,'loop1579'
call write_symm_xmi_1(i7,n21,m1579,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2279
if (sf2.eq.1)goto 100

i1580i7=i7
m1580m21=n21

do m1580=m1579+1,nqul

i7=i1580i7
n21=m1580m21

print*,'loop1580'
call write_symm_xmi_1(i7,n21,m1580,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2280
if (sf2.eq.1)goto 100

i1581i7=i7
m1581m21=n21

do m1581=m1580+1,nqul

i7=i1581i7
n21=m1581m21

print*,'loop1581'
call write_symm_xmi_1(i7,n21,m1581,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2281
if (sf2.eq.1)goto 100

i1582i7=i7
m1582m21=n21

do m1582=m1581+1,nqul

i7=i1582i7
n21=m1582m21

print*,'loop1582'
call write_symm_xmi_1(i7,n21,m1582,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2282
if (sf2.eq.1)goto 100

i1583i7=i7
m1583m21=n21

do m1583=m1582+1,nqul

i7=i1583i7
n21=m1583m21

print*,'loop1583'
call write_symm_xmi_1(i7,n21,m1583,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2283
if (sf2.eq.1)goto 100

i1584i7=i7
m1584m21=n21

do m1584=m1583+1,nqul

i7=i1584i7
n21=m1584m21

print*,'loop1584'
call write_symm_xmi_1(i7,n21,m1584,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2284
if (sf2.eq.1)goto 100

i1585i7=i7
m1585m21=n21

do m1585=m1584+1,nqul

i7=i1585i7
n21=m1585m21

print*,'loop1585'
call write_symm_xmi_1(i7,n21,m1585,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2285
if (sf2.eq.1)goto 100

i1586i7=i7
m1586m21=n21

do m1586=m1585+1,nqul

i7=i1586i7
n21=m1586m21

print*,'loop1586'
call write_symm_xmi_1(i7,n21,m1586,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2286
if (sf2.eq.1)goto 100

i1587i7=i7
m1587m21=n21

do m1587=m1586+1,nqul

i7=i1587i7
n21=m1587m21

print*,'loop1587'
call write_symm_xmi_1(i7,n21,m1587,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2287
if (sf2.eq.1)goto 100

i1588i7=i7
m1588m21=n21

do m1588=m1587+1,nqul

i7=i1588i7
n21=m1588m21

print*,'loop1588'
call write_symm_xmi_1(i7,n21,m1588,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2288
if (sf2.eq.1)goto 100

i1589i7=i7
m1589m21=n21

do m1589=m1588+1,nqul

i7=i1589i7
n21=m1589m21

print*,'loop1589'
call write_symm_xmi_1(i7,n21,m1589,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2289
if (sf2.eq.1)goto 100

i1590i7=i7
m1590m21=n21

do m1590=m1589+1,nqul

i7=i1590i7
n21=m1590m21

print*,'loop1590'
call write_symm_xmi_1(i7,n21,m1590,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2290
if (sf2.eq.1)goto 100

i1591i7=i7
m1591m21=n21

do m1591=m1590+1,nqul

i7=i1591i7
n21=m1591m21

print*,'loop1591'
call write_symm_xmi_1(i7,n21,m1591,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2291
if (sf2.eq.1)goto 100

i1592i7=i7
m1592m21=n21

do m1592=m1591+1,nqul

i7=i1592i7
n21=m1592m21

print*,'loop1592'
call write_symm_xmi_1(i7,n21,m1592,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2292
if (sf2.eq.1)goto 100

i1593i7=i7
m1593m21=n21

do m1593=m1592+1,nqul

i7=i1593i7
n21=m1593m21

print*,'loop1593'
call write_symm_xmi_1(i7,n21,m1593,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2293
if (sf2.eq.1)goto 100

i1594i7=i7
m1594m21=n21

do m1594=m1593+1,nqul

i7=i1594i7
n21=m1594m21

print*,'loop1594'
call write_symm_xmi_1(i7,n21,m1594,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2294
if (sf2.eq.1)goto 100

i1595i7=i7
m1595m21=n21

do m1595=m1594+1,nqul

i7=i1595i7
n21=m1595m21

print*,'loop1595'
call write_symm_xmi_1(i7,n21,m1595,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2295
if (sf2.eq.1)goto 100

i1596i7=i7
m1596m21=n21

do m1596=m1595+1,nqul

i7=i1596i7
n21=m1596m21

print*,'loop1596'
call write_symm_xmi_1(i7,n21,m1596,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2296
if (sf2.eq.1)goto 100

i1597i7=i7
m1597m21=n21

do m1597=m1596+1,nqul

i7=i1597i7
n21=m1597m21

print*,'loop1597'
call write_symm_xmi_1(i7,n21,m1597,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2297
if (sf2.eq.1)goto 100

i1598i7=i7
m1598m21=n21

do m1598=m1597+1,nqul

i7=i1598i7
n21=m1598m21

print*,'loop1598'
call write_symm_xmi_1(i7,n21,m1598,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2298
if (sf2.eq.1)goto 100

i1599i7=i7
m1599m21=n21

do m1599=m1598+1,nqul

i7=i1599i7
n21=m1599m21

print*,'loop1599'
call write_symm_xmi_1(i7,n21,m1599,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2299
if (sf2.eq.1)goto 100

i1600i7=i7
m1600m21=n21

do m1600=m1599+1,nqul

i7=i1600i7
n21=m1600m21

print*,'loop1600'
call write_symm_xmi_1(i7,n21,m1600,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2300
if (sf2.eq.1)goto 100

i1601i7=i7
m1601m21=n21

do m1601=m1600+1,nqul

i7=i1601i7
n21=m1601m21

print*,'loop1601'
call write_symm_xmi_1(i7,n21,m1601,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2301
if (sf2.eq.1)goto 100

i1602i7=i7
m1602m21=n21

do m1602=m1601+1,nqul

i7=i1602i7
n21=m1602m21

print*,'loop1602'
call write_symm_xmi_1(i7,n21,m1602,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2302
if (sf2.eq.1)goto 100

i1603i7=i7
m1603m21=n21

do m1603=m1602+1,nqul

i7=i1603i7
n21=m1603m21

print*,'loop1603'
call write_symm_xmi_1(i7,n21,m1603,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2303
if (sf2.eq.1)goto 100

i1604i7=i7
m1604m21=n21

do m1604=m1603+1,nqul

i7=i1604i7
n21=m1604m21

print*,'loop1604'
call write_symm_xmi_1(i7,n21,m1604,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2304
if (sf2.eq.1)goto 100

i1605i7=i7
m1605m21=n21

do m1605=m1604+1,nqul

i7=i1605i7
n21=m1605m21

print*,'loop1605'
call write_symm_xmi_1(i7,n21,m1605,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2305
if (sf2.eq.1)goto 100

i1606i7=i7
m1606m21=n21

do m1606=m1605+1,nqul

i7=i1606i7
n21=m1606m21

print*,'loop1606'
call write_symm_xmi_1(i7,n21,m1606,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2306
if (sf2.eq.1)goto 100

i1607i7=i7
m1607m21=n21

do m1607=m1606+1,nqul

i7=i1607i7
n21=m1607m21

print*,'loop1607'
call write_symm_xmi_1(i7,n21,m1607,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2307
if (sf2.eq.1)goto 100

i1608i7=i7
m1608m21=n21

do m1608=m1607+1,nqul

i7=i1608i7
n21=m1608m21

print*,'loop1608'
call write_symm_xmi_1(i7,n21,m1608,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2308
if (sf2.eq.1)goto 100

i1609i7=i7
m1609m21=n21

do m1609=m1608+1,nqul

i7=i1609i7
n21=m1609m21

print*,'loop1609'
call write_symm_xmi_1(i7,n21,m1609,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2309
if (sf2.eq.1)goto 100

i1610i7=i7
m1610m21=n21

do m1610=m1609+1,nqul

i7=i1610i7
n21=m1610m21

print*,'loop1610'
call write_symm_xmi_1(i7,n21,m1610,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2310
if (sf2.eq.1)goto 100

i1611i7=i7
m1611m21=n21

do m1611=m1610+1,nqul

i7=i1611i7
n21=m1611m21

print*,'loop1611'
call write_symm_xmi_1(i7,n21,m1611,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2311
if (sf2.eq.1)goto 100

i1612i7=i7
m1612m21=n21

do m1612=m1611+1,nqul

i7=i1612i7
n21=m1612m21

print*,'loop1612'
call write_symm_xmi_1(i7,n21,m1612,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2312
if (sf2.eq.1)goto 100

i1613i7=i7
m1613m21=n21

do m1613=m1612+1,nqul

i7=i1613i7
n21=m1613m21

print*,'loop1613'
call write_symm_xmi_1(i7,n21,m1613,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2313
if (sf2.eq.1)goto 100

i1614i7=i7
m1614m21=n21

do m1614=m1613+1,nqul

i7=i1614i7
n21=m1614m21

print*,'loop1614'
call write_symm_xmi_1(i7,n21,m1614,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2314
if (sf2.eq.1)goto 100

i1615i7=i7
m1615m21=n21

do m1615=m1614+1,nqul

i7=i1615i7
n21=m1615m21

print*,'loop1615'
call write_symm_xmi_1(i7,n21,m1615,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2315
if (sf2.eq.1)goto 100

i1616i7=i7
m1616m21=n21

do m1616=m1615+1,nqul

i7=i1616i7
n21=m1616m21

print*,'loop1616'
call write_symm_xmi_1(i7,n21,m1616,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2316
if (sf2.eq.1)goto 100

i1617i7=i7
m1617m21=n21

do m1617=m1616+1,nqul

i7=i1617i7
n21=m1617m21

print*,'loop1617'
call write_symm_xmi_1(i7,n21,m1617,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2317
if (sf2.eq.1)goto 100

i1618i7=i7
m1618m21=n21

do m1618=m1617+1,nqul

i7=i1618i7
n21=m1618m21

print*,'loop1618'
call write_symm_xmi_1(i7,n21,m1618,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2318
if (sf2.eq.1)goto 100

i1619i7=i7
m1619m21=n21

do m1619=m1618+1,nqul

i7=i1619i7
n21=m1619m21

print*,'loop1619'
call write_symm_xmi_1(i7,n21,m1619,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2319
if (sf2.eq.1)goto 100

i1620i7=i7
m1620m21=n21

do m1620=m1619+1,nqul

i7=i1620i7
n21=m1620m21

print*,'loop1620'
call write_symm_xmi_1(i7,n21,m1620,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2320
if (sf2.eq.1)goto 100

i1621i7=i7
m1621m21=n21

do m1621=m1620+1,nqul

i7=i1621i7
n21=m1621m21

print*,'loop1621'
call write_symm_xmi_1(i7,n21,m1621,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2321
if (sf2.eq.1)goto 100

i1622i7=i7
m1622m21=n21

do m1622=m1621+1,nqul

i7=i1622i7
n21=m1622m21

print*,'loop1622'
call write_symm_xmi_1(i7,n21,m1622,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2322
if (sf2.eq.1)goto 100

i1623i7=i7
m1623m21=n21

do m1623=m1622+1,nqul

i7=i1623i7
n21=m1623m21

print*,'loop1623'
call write_symm_xmi_1(i7,n21,m1623,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2323
if (sf2.eq.1)goto 100

i1624i7=i7
m1624m21=n21

do m1624=m1623+1,nqul

i7=i1624i7
n21=m1624m21

print*,'loop1624'
call write_symm_xmi_1(i7,n21,m1624,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2324
if (sf2.eq.1)goto 100

i1625i7=i7
m1625m21=n21

do m1625=m1624+1,nqul

i7=i1625i7
n21=m1625m21

print*,'loop1625'
call write_symm_xmi_1(i7,n21,m1625,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2325
if (sf2.eq.1)goto 100

i1626i7=i7
m1626m21=n21

do m1626=m1625+1,nqul

i7=i1626i7
n21=m1626m21

print*,'loop1626'
call write_symm_xmi_1(i7,n21,m1626,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2326
if (sf2.eq.1)goto 100

i1627i7=i7
m1627m21=n21

do m1627=m1626+1,nqul

i7=i1627i7
n21=m1627m21

print*,'loop1627'
call write_symm_xmi_1(i7,n21,m1627,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2327
if (sf2.eq.1)goto 100

i1628i7=i7
m1628m21=n21

do m1628=m1627+1,nqul

i7=i1628i7
n21=m1628m21

print*,'loop1628'
call write_symm_xmi_1(i7,n21,m1628,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2328
if (sf2.eq.1)goto 100

i1629i7=i7
m1629m21=n21

do m1629=m1628+1,nqul

i7=i1629i7
n21=m1629m21

print*,'loop1629'
call write_symm_xmi_1(i7,n21,m1629,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2329
if (sf2.eq.1)goto 100

i1630i7=i7
m1630m21=n21

do m1630=m1629+1,nqul

i7=i1630i7
n21=m1630m21

print*,'loop1630'
call write_symm_xmi_1(i7,n21,m1630,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2330
if (sf2.eq.1)goto 100

i1631i7=i7
m1631m21=n21

do m1631=m1630+1,nqul

i7=i1631i7
n21=m1631m21

print*,'loop1631'
call write_symm_xmi_1(i7,n21,m1631,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2331
if (sf2.eq.1)goto 100

i1632i7=i7
m1632m21=n21

do m1632=m1631+1,nqul

i7=i1632i7
n21=m1632m21

print*,'loop1632'
call write_symm_xmi_1(i7,n21,m1632,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2332
if (sf2.eq.1)goto 100

i1633i7=i7
m1633m21=n21

do m1633=m1632+1,nqul

i7=i1633i7
n21=m1633m21

print*,'loop1633'
call write_symm_xmi_1(i7,n21,m1633,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2333
if (sf2.eq.1)goto 100

i1634i7=i7
m1634m21=n21

do m1634=m1633+1,nqul

i7=i1634i7
n21=m1634m21

print*,'loop1634'
call write_symm_xmi_1(i7,n21,m1634,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2334
if (sf2.eq.1)goto 100

i1635i7=i7
m1635m21=n21

do m1635=m1634+1,nqul

i7=i1635i7
n21=m1635m21

print*,'loop1635'
call write_symm_xmi_1(i7,n21,m1635,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2335
if (sf2.eq.1)goto 100

i1636i7=i7
m1636m21=n21

do m1636=m1635+1,nqul

i7=i1636i7
n21=m1636m21

print*,'loop1636'
call write_symm_xmi_1(i7,n21,m1636,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2336
if (sf2.eq.1)goto 100

i1637i7=i7
m1637m21=n21

do m1637=m1636+1,nqul

i7=i1637i7
n21=m1637m21

print*,'loop1637'
call write_symm_xmi_1(i7,n21,m1637,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2337
if (sf2.eq.1)goto 100

i1638i7=i7
m1638m21=n21

do m1638=m1637+1,nqul

i7=i1638i7
n21=m1638m21

print*,'loop1638'
call write_symm_xmi_1(i7,n21,m1638,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2338
if (sf2.eq.1)goto 100

i1639i7=i7
m1639m21=n21

do m1639=m1638+1,nqul

i7=i1639i7
n21=m1639m21

print*,'loop1639'
call write_symm_xmi_1(i7,n21,m1639,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2339
if (sf2.eq.1)goto 100

i1640i7=i7
m1640m21=n21

do m1640=m1639+1,nqul

i7=i1640i7
n21=m1640m21

print*,'loop1640'
call write_symm_xmi_1(i7,n21,m1640,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2340
if (sf2.eq.1)goto 100

i1641i7=i7
m1641m21=n21

do m1641=m1640+1,nqul

i7=i1641i7
n21=m1641m21

print*,'loop1641'
call write_symm_xmi_1(i7,n21,m1641,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2341
if (sf2.eq.1)goto 100

i1642i7=i7
m1642m21=n21

do m1642=m1641+1,nqul

i7=i1642i7
n21=m1642m21

print*,'loop1642'
call write_symm_xmi_1(i7,n21,m1642,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2342
if (sf2.eq.1)goto 100

i1643i7=i7
m1643m21=n21

do m1643=m1642+1,nqul

i7=i1643i7
n21=m1643m21

print*,'loop1643'
call write_symm_xmi_1(i7,n21,m1643,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2343
if (sf2.eq.1)goto 100

i1644i7=i7
m1644m21=n21

do m1644=m1643+1,nqul

i7=i1644i7
n21=m1644m21

print*,'loop1644'
call write_symm_xmi_1(i7,n21,m1644,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2344
if (sf2.eq.1)goto 100

i1645i7=i7
m1645m21=n21

do m1645=m1644+1,nqul

i7=i1645i7
n21=m1645m21

print*,'loop1645'
call write_symm_xmi_1(i7,n21,m1645,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2345
if (sf2.eq.1)goto 100

i1646i7=i7
m1646m21=n21

do m1646=m1645+1,nqul

i7=i1646i7
n21=m1646m21

print*,'loop1646'
call write_symm_xmi_1(i7,n21,m1646,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2346
if (sf2.eq.1)goto 100

i1647i7=i7
m1647m21=n21

do m1647=m1646+1,nqul

i7=i1647i7
n21=m1647m21

print*,'loop1647'
call write_symm_xmi_1(i7,n21,m1647,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2347
if (sf2.eq.1)goto 100

i1648i7=i7
m1648m21=n21

do m1648=m1647+1,nqul

i7=i1648i7
n21=m1648m21

print*,'loop1648'
call write_symm_xmi_1(i7,n21,m1648,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2348
if (sf2.eq.1)goto 100

i1649i7=i7
m1649m21=n21

do m1649=m1648+1,nqul

i7=i1649i7
n21=m1649m21

print*,'loop1649'
call write_symm_xmi_1(i7,n21,m1649,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2349
if (sf2.eq.1)goto 100

i1650i7=i7
m1650m21=n21

do m1650=m1649+1,nqul

i7=i1650i7
n21=m1650m21

print*,'loop1650'
call write_symm_xmi_1(i7,n21,m1650,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2350
if (sf2.eq.1)goto 100

i1651i7=i7
m1651m21=n21

do m1651=m1650+1,nqul

i7=i1651i7
n21=m1651m21

print*,'loop1651'
call write_symm_xmi_1(i7,n21,m1651,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2351
if (sf2.eq.1)goto 100

i1652i7=i7
m1652m21=n21

do m1652=m1651+1,nqul

i7=i1652i7
n21=m1652m21

print*,'loop1652'
call write_symm_xmi_1(i7,n21,m1652,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2352
if (sf2.eq.1)goto 100

i1653i7=i7
m1653m21=n21

do m1653=m1652+1,nqul

i7=i1653i7
n21=m1653m21

print*,'loop1653'
call write_symm_xmi_1(i7,n21,m1653,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2353
if (sf2.eq.1)goto 100

i1654i7=i7
m1654m21=n21

do m1654=m1653+1,nqul

i7=i1654i7
n21=m1654m21

print*,'loop1654'
call write_symm_xmi_1(i7,n21,m1654,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2354
if (sf2.eq.1)goto 100

i1655i7=i7
m1655m21=n21

do m1655=m1654+1,nqul

i7=i1655i7
n21=m1655m21

print*,'loop1655'
call write_symm_xmi_1(i7,n21,m1655,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2355
if (sf2.eq.1)goto 100

i1656i7=i7
m1656m21=n21

do m1656=m1655+1,nqul

i7=i1656i7
n21=m1656m21

print*,'loop1656'
call write_symm_xmi_1(i7,n21,m1656,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2356
if (sf2.eq.1)goto 100

i1657i7=i7
m1657m21=n21

do m1657=m1656+1,nqul

i7=i1657i7
n21=m1657m21

print*,'loop1657'
call write_symm_xmi_1(i7,n21,m1657,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2357
if (sf2.eq.1)goto 100

i1658i7=i7
m1658m21=n21

do m1658=m1657+1,nqul

i7=i1658i7
n21=m1658m21

print*,'loop1658'
call write_symm_xmi_1(i7,n21,m1658,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2358
if (sf2.eq.1)goto 100

i1659i7=i7
m1659m21=n21

do m1659=m1658+1,nqul

i7=i1659i7
n21=m1659m21

print*,'loop1659'
call write_symm_xmi_1(i7,n21,m1659,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2359
if (sf2.eq.1)goto 100

i1660i7=i7
m1660m21=n21

do m1660=m1659+1,nqul

i7=i1660i7
n21=m1660m21

print*,'loop1660'
call write_symm_xmi_1(i7,n21,m1660,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2360
if (sf2.eq.1)goto 100

i1661i7=i7
m1661m21=n21

do m1661=m1660+1,nqul

i7=i1661i7
n21=m1661m21

print*,'loop1661'
call write_symm_xmi_1(i7,n21,m1661,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2361
if (sf2.eq.1)goto 100

i1662i7=i7
m1662m21=n21

do m1662=m1661+1,nqul

i7=i1662i7
n21=m1662m21

print*,'loop1662'
call write_symm_xmi_1(i7,n21,m1662,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2362
if (sf2.eq.1)goto 100

i1663i7=i7
m1663m21=n21

do m1663=m1662+1,nqul

i7=i1663i7
n21=m1663m21

print*,'loop1663'
call write_symm_xmi_1(i7,n21,m1663,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2363
if (sf2.eq.1)goto 100

i1664i7=i7
m1664m21=n21

do m1664=m1663+1,nqul

i7=i1664i7
n21=m1664m21

print*,'loop1664'
call write_symm_xmi_1(i7,n21,m1664,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2364
if (sf2.eq.1)goto 100

i1665i7=i7
m1665m21=n21

do m1665=m1664+1,nqul

i7=i1665i7
n21=m1665m21

print*,'loop1665'
call write_symm_xmi_1(i7,n21,m1665,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2365
if (sf2.eq.1)goto 100

i1666i7=i7
m1666m21=n21

do m1666=m1665+1,nqul

i7=i1666i7
n21=m1666m21

print*,'loop1666'
call write_symm_xmi_1(i7,n21,m1666,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2366
if (sf2.eq.1)goto 100

i1667i7=i7
m1667m21=n21

do m1667=m1666+1,nqul

i7=i1667i7
n21=m1667m21

print*,'loop1667'
call write_symm_xmi_1(i7,n21,m1667,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2367
if (sf2.eq.1)goto 100

i1668i7=i7
m1668m21=n21

do m1668=m1667+1,nqul

i7=i1668i7
n21=m1668m21

print*,'loop1668'
call write_symm_xmi_1(i7,n21,m1668,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2368
if (sf2.eq.1)goto 100

i1669i7=i7
m1669m21=n21

do m1669=m1668+1,nqul

i7=i1669i7
n21=m1669m21

print*,'loop1669'
call write_symm_xmi_1(i7,n21,m1669,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2369
if (sf2.eq.1)goto 100

i1670i7=i7
m1670m21=n21

do m1670=m1669+1,nqul

i7=i1670i7
n21=m1670m21

print*,'loop1670'
call write_symm_xmi_1(i7,n21,m1670,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2370
if (sf2.eq.1)goto 100

i1671i7=i7
m1671m21=n21

do m1671=m1670+1,nqul

i7=i1671i7
n21=m1671m21

print*,'loop1671'
call write_symm_xmi_1(i7,n21,m1671,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2371
if (sf2.eq.1)goto 100

i1672i7=i7
m1672m21=n21

do m1672=m1671+1,nqul

i7=i1672i7
n21=m1672m21

print*,'loop1672'
call write_symm_xmi_1(i7,n21,m1672,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2372
if (sf2.eq.1)goto 100

i1673i7=i7
m1673m21=n21

do m1673=m1672+1,nqul

i7=i1673i7
n21=m1673m21

print*,'loop1673'
call write_symm_xmi_1(i7,n21,m1673,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2373
if (sf2.eq.1)goto 100

i1674i7=i7
m1674m21=n21

do m1674=m1673+1,nqul

i7=i1674i7
n21=m1674m21

print*,'loop1674'
call write_symm_xmi_1(i7,n21,m1674,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2374
if (sf2.eq.1)goto 100

i1675i7=i7
m1675m21=n21

do m1675=m1674+1,nqul

i7=i1675i7
n21=m1675m21

print*,'loop1675'
call write_symm_xmi_1(i7,n21,m1675,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2375
if (sf2.eq.1)goto 100

i1676i7=i7
m1676m21=n21

do m1676=m1675+1,nqul

i7=i1676i7
n21=m1676m21

print*,'loop1676'
call write_symm_xmi_1(i7,n21,m1676,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2376
if (sf2.eq.1)goto 100

i1677i7=i7
m1677m21=n21

do m1677=m1676+1,nqul

i7=i1677i7
n21=m1677m21

print*,'loop1677'
call write_symm_xmi_1(i7,n21,m1677,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2377
if (sf2.eq.1)goto 100

i1678i7=i7
m1678m21=n21

do m1678=m1677+1,nqul

i7=i1678i7
n21=m1678m21

print*,'loop1678'
call write_symm_xmi_1(i7,n21,m1678,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2378
if (sf2.eq.1)goto 100

i1679i7=i7
m1679m21=n21

do m1679=m1678+1,nqul

i7=i1679i7
n21=m1679m21

print*,'loop1679'
call write_symm_xmi_1(i7,n21,m1679,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2379
if (sf2.eq.1)goto 100

i1680i7=i7
m1680m21=n21

do m1680=m1679+1,nqul

i7=i1680i7
n21=m1680m21

print*,'loop1680'
call write_symm_xmi_1(i7,n21,m1680,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2380
if (sf2.eq.1)goto 100

i1681i7=i7
m1681m21=n21

do m1681=m1680+1,nqul

i7=i1681i7
n21=m1681m21

print*,'loop1681'
call write_symm_xmi_1(i7,n21,m1681,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2381
if (sf2.eq.1)goto 100

i1682i7=i7
m1682m21=n21

do m1682=m1681+1,nqul

i7=i1682i7
n21=m1682m21

print*,'loop1682'
call write_symm_xmi_1(i7,n21,m1682,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2382
if (sf2.eq.1)goto 100

i1683i7=i7
m1683m21=n21

do m1683=m1682+1,nqul

i7=i1683i7
n21=m1683m21

print*,'loop1683'
call write_symm_xmi_1(i7,n21,m1683,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2383
if (sf2.eq.1)goto 100

i1684i7=i7
m1684m21=n21

do m1684=m1683+1,nqul

i7=i1684i7
n21=m1684m21

print*,'loop1684'
call write_symm_xmi_1(i7,n21,m1684,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2384
if (sf2.eq.1)goto 100

i1685i7=i7
m1685m21=n21

do m1685=m1684+1,nqul

i7=i1685i7
n21=m1685m21

print*,'loop1685'
call write_symm_xmi_1(i7,n21,m1685,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2385
if (sf2.eq.1)goto 100

i1686i7=i7
m1686m21=n21

do m1686=m1685+1,nqul

i7=i1686i7
n21=m1686m21

print*,'loop1686'
call write_symm_xmi_1(i7,n21,m1686,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2386
if (sf2.eq.1)goto 100

i1687i7=i7
m1687m21=n21

do m1687=m1686+1,nqul

i7=i1687i7
n21=m1687m21

print*,'loop1687'
call write_symm_xmi_1(i7,n21,m1687,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2387
if (sf2.eq.1)goto 100

i1688i7=i7
m1688m21=n21

do m1688=m1687+1,nqul

i7=i1688i7
n21=m1688m21

print*,'loop1688'
call write_symm_xmi_1(i7,n21,m1688,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2388
if (sf2.eq.1)goto 100

i1689i7=i7
m1689m21=n21

do m1689=m1688+1,nqul

i7=i1689i7
n21=m1689m21

print*,'loop1689'
call write_symm_xmi_1(i7,n21,m1689,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2389
if (sf2.eq.1)goto 100

i1690i7=i7
m1690m21=n21

do m1690=m1689+1,nqul

i7=i1690i7
n21=m1690m21

print*,'loop1690'
call write_symm_xmi_1(i7,n21,m1690,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2390
if (sf2.eq.1)goto 100

i1691i7=i7
m1691m21=n21

do m1691=m1690+1,nqul

i7=i1691i7
n21=m1691m21

print*,'loop1691'
call write_symm_xmi_1(i7,n21,m1691,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2391
if (sf2.eq.1)goto 100

i1692i7=i7
m1692m21=n21

do m1692=m1691+1,nqul

i7=i1692i7
n21=m1692m21

print*,'loop1692'
call write_symm_xmi_1(i7,n21,m1692,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2392
if (sf2.eq.1)goto 100

i1693i7=i7
m1693m21=n21

do m1693=m1692+1,nqul

i7=i1693i7
n21=m1693m21

print*,'loop1693'
call write_symm_xmi_1(i7,n21,m1693,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2393
if (sf2.eq.1)goto 100

i1694i7=i7
m1694m21=n21

do m1694=m1693+1,nqul

i7=i1694i7
n21=m1694m21

print*,'loop1694'
call write_symm_xmi_1(i7,n21,m1694,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2394
if (sf2.eq.1)goto 100

i1695i7=i7
m1695m21=n21

do m1695=m1694+1,nqul

i7=i1695i7
n21=m1695m21

print*,'loop1695'
call write_symm_xmi_1(i7,n21,m1695,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2395
if (sf2.eq.1)goto 100

i1696i7=i7
m1696m21=n21

do m1696=m1695+1,nqul

i7=i1696i7
n21=m1696m21

print*,'loop1696'
call write_symm_xmi_1(i7,n21,m1696,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2396
if (sf2.eq.1)goto 100

i1697i7=i7
m1697m21=n21

do m1697=m1696+1,nqul

i7=i1697i7
n21=m1697m21

print*,'loop1697'
call write_symm_xmi_1(i7,n21,m1697,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2397
if (sf2.eq.1)goto 100

i1698i7=i7
m1698m21=n21

do m1698=m1697+1,nqul

i7=i1698i7
n21=m1698m21

print*,'loop1698'
call write_symm_xmi_1(i7,n21,m1698,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2398
if (sf2.eq.1)goto 100

i1699i7=i7
m1699m21=n21

do m1699=m1698+1,nqul

i7=i1699i7
n21=m1699m21

print*,'loop1699'
call write_symm_xmi_1(i7,n21,m1699,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2399
if (sf2.eq.1)goto 100

i1700i7=i7
m1700m21=n21

do m1700=m1699+1,nqul

i7=i1700i7
n21=m1700m21

print*,'loop1700'
call write_symm_xmi_1(i7,n21,m1700,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2400
if (sf2.eq.1)goto 100

i1701i7=i7
m1701m21=n21

do m1701=m1700+1,nqul

i7=i1701i7
n21=m1701m21

print*,'loop1701'
call write_symm_xmi_1(i7,n21,m1701,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2401
if (sf2.eq.1)goto 100

i1702i7=i7
m1702m21=n21

do m1702=m1701+1,nqul

i7=i1702i7
n21=m1702m21

print*,'loop1702'
call write_symm_xmi_1(i7,n21,m1702,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2402
if (sf2.eq.1)goto 100

i1703i7=i7
m1703m21=n21

do m1703=m1702+1,nqul

i7=i1703i7
n21=m1703m21

print*,'loop1703'
call write_symm_xmi_1(i7,n21,m1703,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2403
if (sf2.eq.1)goto 100

i1704i7=i7
m1704m21=n21

do m1704=m1703+1,nqul

i7=i1704i7
n21=m1704m21

print*,'loop1704'
call write_symm_xmi_1(i7,n21,m1704,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2404
if (sf2.eq.1)goto 100

i1705i7=i7
m1705m21=n21

do m1705=m1704+1,nqul

i7=i1705i7
n21=m1705m21

print*,'loop1705'
call write_symm_xmi_1(i7,n21,m1705,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2405
if (sf2.eq.1)goto 100

i1706i7=i7
m1706m21=n21

do m1706=m1705+1,nqul

i7=i1706i7
n21=m1706m21

print*,'loop1706'
call write_symm_xmi_1(i7,n21,m1706,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2406
if (sf2.eq.1)goto 100

i1707i7=i7
m1707m21=n21

do m1707=m1706+1,nqul

i7=i1707i7
n21=m1707m21

print*,'loop1707'
call write_symm_xmi_1(i7,n21,m1707,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2407
if (sf2.eq.1)goto 100

i1708i7=i7
m1708m21=n21

do m1708=m1707+1,nqul

i7=i1708i7
n21=m1708m21

print*,'loop1708'
call write_symm_xmi_1(i7,n21,m1708,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2408
if (sf2.eq.1)goto 100

i1709i7=i7
m1709m21=n21

do m1709=m1708+1,nqul

i7=i1709i7
n21=m1709m21

print*,'loop1709'
call write_symm_xmi_1(i7,n21,m1709,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2409
if (sf2.eq.1)goto 100

i1710i7=i7
m1710m21=n21

do m1710=m1709+1,nqul

i7=i1710i7
n21=m1710m21

print*,'loop1710'
call write_symm_xmi_1(i7,n21,m1710,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2410
if (sf2.eq.1)goto 100

i1711i7=i7
m1711m21=n21

do m1711=m1710+1,nqul

i7=i1711i7
n21=m1711m21

print*,'loop1711'
call write_symm_xmi_1(i7,n21,m1711,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2411
if (sf2.eq.1)goto 100

i1712i7=i7
m1712m21=n21

do m1712=m1711+1,nqul

i7=i1712i7
n21=m1712m21

print*,'loop1712'
call write_symm_xmi_1(i7,n21,m1712,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2412
if (sf2.eq.1)goto 100

i1713i7=i7
m1713m21=n21

do m1713=m1712+1,nqul

i7=i1713i7
n21=m1713m21

print*,'loop1713'
call write_symm_xmi_1(i7,n21,m1713,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2413
if (sf2.eq.1)goto 100

i1714i7=i7
m1714m21=n21

do m1714=m1713+1,nqul

i7=i1714i7
n21=m1714m21

print*,'loop1714'
call write_symm_xmi_1(i7,n21,m1714,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2414
if (sf2.eq.1)goto 100

i1715i7=i7
m1715m21=n21

do m1715=m1714+1,nqul

i7=i1715i7
n21=m1715m21

print*,'loop1715'
call write_symm_xmi_1(i7,n21,m1715,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2415
if (sf2.eq.1)goto 100

i1716i7=i7
m1716m21=n21

do m1716=m1715+1,nqul

i7=i1716i7
n21=m1716m21

print*,'loop1716'
call write_symm_xmi_1(i7,n21,m1716,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2416
if (sf2.eq.1)goto 100

i1717i7=i7
m1717m21=n21

do m1717=m1716+1,nqul

i7=i1717i7
n21=m1717m21

print*,'loop1717'
call write_symm_xmi_1(i7,n21,m1717,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2417
if (sf2.eq.1)goto 100

i1718i7=i7
m1718m21=n21

do m1718=m1717+1,nqul

i7=i1718i7
n21=m1718m21

print*,'loop1718'
call write_symm_xmi_1(i7,n21,m1718,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2418
if (sf2.eq.1)goto 100

i1719i7=i7
m1719m21=n21

do m1719=m1718+1,nqul

i7=i1719i7
n21=m1719m21

print*,'loop1719'
call write_symm_xmi_1(i7,n21,m1719,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2419
if (sf2.eq.1)goto 100

i1720i7=i7
m1720m21=n21

do m1720=m1719+1,nqul

i7=i1720i7
n21=m1720m21

print*,'loop1720'
call write_symm_xmi_1(i7,n21,m1720,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2420
if (sf2.eq.1)goto 100

i1721i7=i7
m1721m21=n21

do m1721=m1720+1,nqul

i7=i1721i7
n21=m1721m21

print*,'loop1721'
call write_symm_xmi_1(i7,n21,m1721,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2421
if (sf2.eq.1)goto 100

i1722i7=i7
m1722m21=n21

do m1722=m1721+1,nqul

i7=i1722i7
n21=m1722m21

print*,'loop1722'
call write_symm_xmi_1(i7,n21,m1722,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2422
if (sf2.eq.1)goto 100

i1723i7=i7
m1723m21=n21

do m1723=m1722+1,nqul

i7=i1723i7
n21=m1723m21

print*,'loop1723'
call write_symm_xmi_1(i7,n21,m1723,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2423
if (sf2.eq.1)goto 100

i1724i7=i7
m1724m21=n21

do m1724=m1723+1,nqul

i7=i1724i7
n21=m1724m21

print*,'loop1724'
call write_symm_xmi_1(i7,n21,m1724,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2424
if (sf2.eq.1)goto 100

i1725i7=i7
m1725m21=n21

do m1725=m1724+1,nqul

i7=i1725i7
n21=m1725m21

print*,'loop1725'
call write_symm_xmi_1(i7,n21,m1725,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2425
if (sf2.eq.1)goto 100

i1726i7=i7
m1726m21=n21

do m1726=m1725+1,nqul

i7=i1726i7
n21=m1726m21

print*,'loop1726'
call write_symm_xmi_1(i7,n21,m1726,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2426
if (sf2.eq.1)goto 100

i1727i7=i7
m1727m21=n21

do m1727=m1726+1,nqul

i7=i1727i7
n21=m1727m21

print*,'loop1727'
call write_symm_xmi_1(i7,n21,m1727,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2427
if (sf2.eq.1)goto 100

i1728i7=i7
m1728m21=n21

do m1728=m1727+1,nqul

i7=i1728i7
n21=m1728m21

print*,'loop1728'
call write_symm_xmi_1(i7,n21,m1728,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2428
if (sf2.eq.1)goto 100

i1729i7=i7
m1729m21=n21

do m1729=m1728+1,nqul

i7=i1729i7
n21=m1729m21

print*,'loop1729'
call write_symm_xmi_1(i7,n21,m1729,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2429
if (sf2.eq.1)goto 100

i1730i7=i7
m1730m21=n21

do m1730=m1729+1,nqul

i7=i1730i7
n21=m1730m21

print*,'loop1730'
call write_symm_xmi_1(i7,n21,m1730,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2430
if (sf2.eq.1)goto 100

i1731i7=i7
m1731m21=n21

do m1731=m1730+1,nqul

i7=i1731i7
n21=m1731m21

print*,'loop1731'
call write_symm_xmi_1(i7,n21,m1731,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2431
if (sf2.eq.1)goto 100

i1732i7=i7
m1732m21=n21

do m1732=m1731+1,nqul

i7=i1732i7
n21=m1732m21

print*,'loop1732'
call write_symm_xmi_1(i7,n21,m1732,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2432
if (sf2.eq.1)goto 100

i1733i7=i7
m1733m21=n21

do m1733=m1732+1,nqul

i7=i1733i7
n21=m1733m21

print*,'loop1733'
call write_symm_xmi_1(i7,n21,m1733,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2433
if (sf2.eq.1)goto 100

i1734i7=i7
m1734m21=n21

do m1734=m1733+1,nqul

i7=i1734i7
n21=m1734m21

print*,'loop1734'
call write_symm_xmi_1(i7,n21,m1734,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2434
if (sf2.eq.1)goto 100

i1735i7=i7
m1735m21=n21

do m1735=m1734+1,nqul

i7=i1735i7
n21=m1735m21

print*,'loop1735'
call write_symm_xmi_1(i7,n21,m1735,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2435
if (sf2.eq.1)goto 100

i1736i7=i7
m1736m21=n21

do m1736=m1735+1,nqul

i7=i1736i7
n21=m1736m21

print*,'loop1736'
call write_symm_xmi_1(i7,n21,m1736,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2436
if (sf2.eq.1)goto 100

i1737i7=i7
m1737m21=n21

do m1737=m1736+1,nqul

i7=i1737i7
n21=m1737m21

print*,'loop1737'
call write_symm_xmi_1(i7,n21,m1737,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2437
if (sf2.eq.1)goto 100

i1738i7=i7
m1738m21=n21

do m1738=m1737+1,nqul

i7=i1738i7
n21=m1738m21

print*,'loop1738'
call write_symm_xmi_1(i7,n21,m1738,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2438
if (sf2.eq.1)goto 100

i1739i7=i7
m1739m21=n21

do m1739=m1738+1,nqul

i7=i1739i7
n21=m1739m21

print*,'loop1739'
call write_symm_xmi_1(i7,n21,m1739,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2439
if (sf2.eq.1)goto 100

i1740i7=i7
m1740m21=n21

do m1740=m1739+1,nqul

i7=i1740i7
n21=m1740m21

print*,'loop1740'
call write_symm_xmi_1(i7,n21,m1740,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2440
if (sf2.eq.1)goto 100

i1741i7=i7
m1741m21=n21

do m1741=m1740+1,nqul

i7=i1741i7
n21=m1741m21

print*,'loop1741'
call write_symm_xmi_1(i7,n21,m1741,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2441
if (sf2.eq.1)goto 100

i1742i7=i7
m1742m21=n21

do m1742=m1741+1,nqul

i7=i1742i7
n21=m1742m21

print*,'loop1742'
call write_symm_xmi_1(i7,n21,m1742,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2442
if (sf2.eq.1)goto 100

i1743i7=i7
m1743m21=n21

do m1743=m1742+1,nqul

i7=i1743i7
n21=m1743m21

print*,'loop1743'
call write_symm_xmi_1(i7,n21,m1743,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2443
if (sf2.eq.1)goto 100

i1744i7=i7
m1744m21=n21

do m1744=m1743+1,nqul

i7=i1744i7
n21=m1744m21

print*,'loop1744'
call write_symm_xmi_1(i7,n21,m1744,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2444
if (sf2.eq.1)goto 100

i1745i7=i7
m1745m21=n21

do m1745=m1744+1,nqul

i7=i1745i7
n21=m1745m21

print*,'loop1745'
call write_symm_xmi_1(i7,n21,m1745,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2445
if (sf2.eq.1)goto 100

i1746i7=i7
m1746m21=n21

do m1746=m1745+1,nqul

i7=i1746i7
n21=m1746m21

print*,'loop1746'
call write_symm_xmi_1(i7,n21,m1746,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2446
if (sf2.eq.1)goto 100

i1747i7=i7
m1747m21=n21

do m1747=m1746+1,nqul

i7=i1747i7
n21=m1747m21

print*,'loop1747'
call write_symm_xmi_1(i7,n21,m1747,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2447
if (sf2.eq.1)goto 100

i1748i7=i7
m1748m21=n21

do m1748=m1747+1,nqul

i7=i1748i7
n21=m1748m21

print*,'loop1748'
call write_symm_xmi_1(i7,n21,m1748,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2448
if (sf2.eq.1)goto 100

i1749i7=i7
m1749m21=n21

do m1749=m1748+1,nqul

i7=i1749i7
n21=m1749m21

print*,'loop1749'
call write_symm_xmi_1(i7,n21,m1749,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2449
if (sf2.eq.1)goto 100

i1750i7=i7
m1750m21=n21

do m1750=m1749+1,nqul

i7=i1750i7
n21=m1750m21

print*,'loop1750'
call write_symm_xmi_1(i7,n21,m1750,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2450
if (sf2.eq.1)goto 100

i1751i7=i7
m1751m21=n21

do m1751=m1750+1,nqul

i7=i1751i7
n21=m1751m21

print*,'loop1751'
call write_symm_xmi_1(i7,n21,m1751,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2451
if (sf2.eq.1)goto 100

i1752i7=i7
m1752m21=n21

do m1752=m1751+1,nqul

i7=i1752i7
n21=m1752m21

print*,'loop1752'
call write_symm_xmi_1(i7,n21,m1752,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2452
if (sf2.eq.1)goto 100

i1753i7=i7
m1753m21=n21

do m1753=m1752+1,nqul

i7=i1753i7
n21=m1753m21

print*,'loop1753'
call write_symm_xmi_1(i7,n21,m1753,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2453
if (sf2.eq.1)goto 100

i1754i7=i7
m1754m21=n21

do m1754=m1753+1,nqul

i7=i1754i7
n21=m1754m21

print*,'loop1754'
call write_symm_xmi_1(i7,n21,m1754,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2454
if (sf2.eq.1)goto 100

i1755i7=i7
m1755m21=n21

do m1755=m1754+1,nqul

i7=i1755i7
n21=m1755m21

print*,'loop1755'
call write_symm_xmi_1(i7,n21,m1755,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2455
if (sf2.eq.1)goto 100

i1756i7=i7
m1756m21=n21

do m1756=m1755+1,nqul

i7=i1756i7
n21=m1756m21

print*,'loop1756'
call write_symm_xmi_1(i7,n21,m1756,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2456
if (sf2.eq.1)goto 100

i1757i7=i7
m1757m21=n21

do m1757=m1756+1,nqul

i7=i1757i7
n21=m1757m21

print*,'loop1757'
call write_symm_xmi_1(i7,n21,m1757,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2457
if (sf2.eq.1)goto 100

i1758i7=i7
m1758m21=n21

do m1758=m1757+1,nqul

i7=i1758i7
n21=m1758m21

print*,'loop1758'
call write_symm_xmi_1(i7,n21,m1758,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2458
if (sf2.eq.1)goto 100

i1759i7=i7
m1759m21=n21

do m1759=m1758+1,nqul

i7=i1759i7
n21=m1759m21

print*,'loop1759'
call write_symm_xmi_1(i7,n21,m1759,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2459
if (sf2.eq.1)goto 100

i1760i7=i7
m1760m21=n21

do m1760=m1759+1,nqul

i7=i1760i7
n21=m1760m21

print*,'loop1760'
call write_symm_xmi_1(i7,n21,m1760,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2460
if (sf2.eq.1)goto 100

i1761i7=i7
m1761m21=n21

do m1761=m1760+1,nqul

i7=i1761i7
n21=m1761m21

print*,'loop1761'
call write_symm_xmi_1(i7,n21,m1761,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2461
if (sf2.eq.1)goto 100

i1762i7=i7
m1762m21=n21

do m1762=m1761+1,nqul

i7=i1762i7
n21=m1762m21

print*,'loop1762'
call write_symm_xmi_1(i7,n21,m1762,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2462
if (sf2.eq.1)goto 100

i1763i7=i7
m1763m21=n21

do m1763=m1762+1,nqul

i7=i1763i7
n21=m1763m21

print*,'loop1763'
call write_symm_xmi_1(i7,n21,m1763,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2463
if (sf2.eq.1)goto 100

i1764i7=i7
m1764m21=n21

do m1764=m1763+1,nqul

i7=i1764i7
n21=m1764m21

print*,'loop1764'
call write_symm_xmi_1(i7,n21,m1764,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2464
if (sf2.eq.1)goto 100

i1765i7=i7
m1765m21=n21

do m1765=m1764+1,nqul

i7=i1765i7
n21=m1765m21

print*,'loop1765'
call write_symm_xmi_1(i7,n21,m1765,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2465
if (sf2.eq.1)goto 100

i1766i7=i7
m1766m21=n21

do m1766=m1765+1,nqul

i7=i1766i7
n21=m1766m21

print*,'loop1766'
call write_symm_xmi_1(i7,n21,m1766,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2466
if (sf2.eq.1)goto 100

i1767i7=i7
m1767m21=n21

do m1767=m1766+1,nqul

i7=i1767i7
n21=m1767m21

print*,'loop1767'
call write_symm_xmi_1(i7,n21,m1767,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2467
if (sf2.eq.1)goto 100

i1768i7=i7
m1768m21=n21

do m1768=m1767+1,nqul

i7=i1768i7
n21=m1768m21

print*,'loop1768'
call write_symm_xmi_1(i7,n21,m1768,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2468
if (sf2.eq.1)goto 100

i1769i7=i7
m1769m21=n21

do m1769=m1768+1,nqul

i7=i1769i7
n21=m1769m21

print*,'loop1769'
call write_symm_xmi_1(i7,n21,m1769,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2469
if (sf2.eq.1)goto 100

i1770i7=i7
m1770m21=n21

do m1770=m1769+1,nqul

i7=i1770i7
n21=m1770m21

print*,'loop1770'
call write_symm_xmi_1(i7,n21,m1770,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2470
if (sf2.eq.1)goto 100

i1771i7=i7
m1771m21=n21

do m1771=m1770+1,nqul

i7=i1771i7
n21=m1771m21

print*,'loop1771'
call write_symm_xmi_1(i7,n21,m1771,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2471
if (sf2.eq.1)goto 100

i1772i7=i7
m1772m21=n21

do m1772=m1771+1,nqul

i7=i1772i7
n21=m1772m21

print*,'loop1772'
call write_symm_xmi_1(i7,n21,m1772,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2472
if (sf2.eq.1)goto 100

i1773i7=i7
m1773m21=n21

do m1773=m1772+1,nqul

i7=i1773i7
n21=m1773m21

print*,'loop1773'
call write_symm_xmi_1(i7,n21,m1773,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2473
if (sf2.eq.1)goto 100

i1774i7=i7
m1774m21=n21

do m1774=m1773+1,nqul

i7=i1774i7
n21=m1774m21

print*,'loop1774'
call write_symm_xmi_1(i7,n21,m1774,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2474
if (sf2.eq.1)goto 100

i1775i7=i7
m1775m21=n21

do m1775=m1774+1,nqul

i7=i1775i7
n21=m1775m21

print*,'loop1775'
call write_symm_xmi_1(i7,n21,m1775,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2475
if (sf2.eq.1)goto 100

i1776i7=i7
m1776m21=n21

do m1776=m1775+1,nqul

i7=i1776i7
n21=m1776m21

print*,'loop1776'
call write_symm_xmi_1(i7,n21,m1776,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2476
if (sf2.eq.1)goto 100

i1777i7=i7
m1777m21=n21

do m1777=m1776+1,nqul

i7=i1777i7
n21=m1777m21

print*,'loop1777'
call write_symm_xmi_1(i7,n21,m1777,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2477
if (sf2.eq.1)goto 100

i1778i7=i7
m1778m21=n21

do m1778=m1777+1,nqul

i7=i1778i7
n21=m1778m21

print*,'loop1778'
call write_symm_xmi_1(i7,n21,m1778,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2478
if (sf2.eq.1)goto 100

i1779i7=i7
m1779m21=n21

do m1779=m1778+1,nqul

i7=i1779i7
n21=m1779m21

print*,'loop1779'
call write_symm_xmi_1(i7,n21,m1779,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2479
if (sf2.eq.1)goto 100

i1780i7=i7
m1780m21=n21

do m1780=m1779+1,nqul

i7=i1780i7
n21=m1780m21

print*,'loop1780'
call write_symm_xmi_1(i7,n21,m1780,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2480
if (sf2.eq.1)goto 100

i1781i7=i7
m1781m21=n21

do m1781=m1780+1,nqul

i7=i1781i7
n21=m1781m21

print*,'loop1781'
call write_symm_xmi_1(i7,n21,m1781,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2481
if (sf2.eq.1)goto 100

i1782i7=i7
m1782m21=n21

do m1782=m1781+1,nqul

i7=i1782i7
n21=m1782m21

print*,'loop1782'
call write_symm_xmi_1(i7,n21,m1782,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2482
if (sf2.eq.1)goto 100

i1783i7=i7
m1783m21=n21

do m1783=m1782+1,nqul

i7=i1783i7
n21=m1783m21

print*,'loop1783'
call write_symm_xmi_1(i7,n21,m1783,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2483
if (sf2.eq.1)goto 100

i1784i7=i7
m1784m21=n21

do m1784=m1783+1,nqul

i7=i1784i7
n21=m1784m21

print*,'loop1784'
call write_symm_xmi_1(i7,n21,m1784,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2484
if (sf2.eq.1)goto 100

i1785i7=i7
m1785m21=n21

do m1785=m1784+1,nqul

i7=i1785i7
n21=m1785m21

print*,'loop1785'
call write_symm_xmi_1(i7,n21,m1785,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2485
if (sf2.eq.1)goto 100

i1786i7=i7
m1786m21=n21

do m1786=m1785+1,nqul

i7=i1786i7
n21=m1786m21

print*,'loop1786'
call write_symm_xmi_1(i7,n21,m1786,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2486
if (sf2.eq.1)goto 100

i1787i7=i7
m1787m21=n21

do m1787=m1786+1,nqul

i7=i1787i7
n21=m1787m21

print*,'loop1787'
call write_symm_xmi_1(i7,n21,m1787,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2487
if (sf2.eq.1)goto 100

i1788i7=i7
m1788m21=n21

do m1788=m1787+1,nqul

i7=i1788i7
n21=m1788m21

print*,'loop1788'
call write_symm_xmi_1(i7,n21,m1788,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2488
if (sf2.eq.1)goto 100

i1789i7=i7
m1789m21=n21

do m1789=m1788+1,nqul

i7=i1789i7
n21=m1789m21

print*,'loop1789'
call write_symm_xmi_1(i7,n21,m1789,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2489
if (sf2.eq.1)goto 100

i1790i7=i7
m1790m21=n21

do m1790=m1789+1,nqul

i7=i1790i7
n21=m1790m21

print*,'loop1790'
call write_symm_xmi_1(i7,n21,m1790,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2490
if (sf2.eq.1)goto 100

i1791i7=i7
m1791m21=n21

do m1791=m1790+1,nqul

i7=i1791i7
n21=m1791m21

print*,'loop1791'
call write_symm_xmi_1(i7,n21,m1791,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2491
if (sf2.eq.1)goto 100

i1792i7=i7
m1792m21=n21

do m1792=m1791+1,nqul

i7=i1792i7
n21=m1792m21

print*,'loop1792'
call write_symm_xmi_1(i7,n21,m1792,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2492
if (sf2.eq.1)goto 100

i1793i7=i7
m1793m21=n21

do m1793=m1792+1,nqul

i7=i1793i7
n21=m1793m21

print*,'loop1793'
call write_symm_xmi_1(i7,n21,m1793,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2493
if (sf2.eq.1)goto 100

i1794i7=i7
m1794m21=n21

do m1794=m1793+1,nqul

i7=i1794i7
n21=m1794m21

print*,'loop1794'
call write_symm_xmi_1(i7,n21,m1794,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2494
if (sf2.eq.1)goto 100

i1795i7=i7
m1795m21=n21

do m1795=m1794+1,nqul

i7=i1795i7
n21=m1795m21

print*,'loop1795'
call write_symm_xmi_1(i7,n21,m1795,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2495
if (sf2.eq.1)goto 100

i1796i7=i7
m1796m21=n21

do m1796=m1795+1,nqul

i7=i1796i7
n21=m1796m21

print*,'loop1796'
call write_symm_xmi_1(i7,n21,m1796,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2496
if (sf2.eq.1)goto 100

i1797i7=i7
m1797m21=n21

do m1797=m1796+1,nqul

i7=i1797i7
n21=m1797m21

print*,'loop1797'
call write_symm_xmi_1(i7,n21,m1797,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2497
if (sf2.eq.1)goto 100

i1798i7=i7
m1798m21=n21

do m1798=m1797+1,nqul

i7=i1798i7
n21=m1798m21

print*,'loop1798'
call write_symm_xmi_1(i7,n21,m1798,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2498
if (sf2.eq.1)goto 100

i1799i7=i7
m1799m21=n21

do m1799=m1798+1,nqul

i7=i1799i7
n21=m1799m21

print*,'loop1799'
call write_symm_xmi_1(i7,n21,m1799,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2499
if (sf2.eq.1)goto 100

i1800i7=i7
m1800m21=n21

do m1800=m1799+1,nqul

i7=i1800i7
n21=m1800m21

print*,'loop1800'
call write_symm_xmi_1(i7,n21,m1800,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2500
if (sf2.eq.1)goto 100

i1801i7=i7
m1801m21=n21

do m1801=m1800+1,nqul

i7=i1801i7
n21=m1801m21

print*,'loop1801'
call write_symm_xmi_1(i7,n21,m1801,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2501
if (sf2.eq.1)goto 100

i1802i7=i7
m1802m21=n21

do m1802=m1801+1,nqul

i7=i1802i7
n21=m1802m21

print*,'loop1802'
call write_symm_xmi_1(i7,n21,m1802,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2502
if (sf2.eq.1)goto 100

i1803i7=i7
m1803m21=n21

do m1803=m1802+1,nqul

i7=i1803i7
n21=m1803m21

print*,'loop1803'
call write_symm_xmi_1(i7,n21,m1803,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2503
if (sf2.eq.1)goto 100

i1804i7=i7
m1804m21=n21

do m1804=m1803+1,nqul

i7=i1804i7
n21=m1804m21

print*,'loop1804'
call write_symm_xmi_1(i7,n21,m1804,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2504
if (sf2.eq.1)goto 100

i1805i7=i7
m1805m21=n21

do m1805=m1804+1,nqul

i7=i1805i7
n21=m1805m21

print*,'loop1805'
call write_symm_xmi_1(i7,n21,m1805,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2505
if (sf2.eq.1)goto 100

i1806i7=i7
m1806m21=n21

do m1806=m1805+1,nqul

i7=i1806i7
n21=m1806m21

print*,'loop1806'
call write_symm_xmi_1(i7,n21,m1806,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2506
if (sf2.eq.1)goto 100

i1807i7=i7
m1807m21=n21

do m1807=m1806+1,nqul

i7=i1807i7
n21=m1807m21

print*,'loop1807'
call write_symm_xmi_1(i7,n21,m1807,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2507
if (sf2.eq.1)goto 100

i1808i7=i7
m1808m21=n21

do m1808=m1807+1,nqul

i7=i1808i7
n21=m1808m21

print*,'loop1808'
call write_symm_xmi_1(i7,n21,m1808,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2508
if (sf2.eq.1)goto 100

i1809i7=i7
m1809m21=n21

do m1809=m1808+1,nqul

i7=i1809i7
n21=m1809m21

print*,'loop1809'
call write_symm_xmi_1(i7,n21,m1809,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2509
if (sf2.eq.1)goto 100

i1810i7=i7
m1810m21=n21

do m1810=m1809+1,nqul

i7=i1810i7
n21=m1810m21

print*,'loop1810'
call write_symm_xmi_1(i7,n21,m1810,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2510
if (sf2.eq.1)goto 100

i1811i7=i7
m1811m21=n21

do m1811=m1810+1,nqul

i7=i1811i7
n21=m1811m21

print*,'loop1811'
call write_symm_xmi_1(i7,n21,m1811,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2511
if (sf2.eq.1)goto 100

i1812i7=i7
m1812m21=n21

do m1812=m1811+1,nqul

i7=i1812i7
n21=m1812m21

print*,'loop1812'
call write_symm_xmi_1(i7,n21,m1812,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2512
if (sf2.eq.1)goto 100

i1813i7=i7
m1813m21=n21

do m1813=m1812+1,nqul

i7=i1813i7
n21=m1813m21

print*,'loop1813'
call write_symm_xmi_1(i7,n21,m1813,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2513
if (sf2.eq.1)goto 100

i1814i7=i7
m1814m21=n21

do m1814=m1813+1,nqul

i7=i1814i7
n21=m1814m21

print*,'loop1814'
call write_symm_xmi_1(i7,n21,m1814,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2514
if (sf2.eq.1)goto 100

i1815i7=i7
m1815m21=n21

do m1815=m1814+1,nqul

i7=i1815i7
n21=m1815m21

print*,'loop1815'
call write_symm_xmi_1(i7,n21,m1815,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2515
if (sf2.eq.1)goto 100

i1816i7=i7
m1816m21=n21

do m1816=m1815+1,nqul

i7=i1816i7
n21=m1816m21

print*,'loop1816'
call write_symm_xmi_1(i7,n21,m1816,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2516
if (sf2.eq.1)goto 100

i1817i7=i7
m1817m21=n21

do m1817=m1816+1,nqul

i7=i1817i7
n21=m1817m21

print*,'loop1817'
call write_symm_xmi_1(i7,n21,m1817,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2517
if (sf2.eq.1)goto 100

i1818i7=i7
m1818m21=n21

do m1818=m1817+1,nqul

i7=i1818i7
n21=m1818m21

print*,'loop1818'
call write_symm_xmi_1(i7,n21,m1818,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2518
if (sf2.eq.1)goto 100

i1819i7=i7
m1819m21=n21

do m1819=m1818+1,nqul

i7=i1819i7
n21=m1819m21

print*,'loop1819'
call write_symm_xmi_1(i7,n21,m1819,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2519
if (sf2.eq.1)goto 100

i1820i7=i7
m1820m21=n21

do m1820=m1819+1,nqul

i7=i1820i7
n21=m1820m21

print*,'loop1820'
call write_symm_xmi_1(i7,n21,m1820,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2520
if (sf2.eq.1)goto 100

i1821i7=i7
m1821m21=n21

do m1821=m1820+1,nqul

i7=i1821i7
n21=m1821m21

print*,'loop1821'
call write_symm_xmi_1(i7,n21,m1821,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2521
if (sf2.eq.1)goto 100

i1822i7=i7
m1822m21=n21

do m1822=m1821+1,nqul

i7=i1822i7
n21=m1822m21

print*,'loop1822'
call write_symm_xmi_1(i7,n21,m1822,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2522
if (sf2.eq.1)goto 100

i1823i7=i7
m1823m21=n21

do m1823=m1822+1,nqul

i7=i1823i7
n21=m1823m21

print*,'loop1823'
call write_symm_xmi_1(i7,n21,m1823,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2523
if (sf2.eq.1)goto 100

i1824i7=i7
m1824m21=n21

do m1824=m1823+1,nqul

i7=i1824i7
n21=m1824m21

print*,'loop1824'
call write_symm_xmi_1(i7,n21,m1824,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2524
if (sf2.eq.1)goto 100

i1825i7=i7
m1825m21=n21

do m1825=m1824+1,nqul

i7=i1825i7
n21=m1825m21

print*,'loop1825'
call write_symm_xmi_1(i7,n21,m1825,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2525
if (sf2.eq.1)goto 100

i1826i7=i7
m1826m21=n21

do m1826=m1825+1,nqul

i7=i1826i7
n21=m1826m21

print*,'loop1826'
call write_symm_xmi_1(i7,n21,m1826,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2526
if (sf2.eq.1)goto 100

i1827i7=i7
m1827m21=n21

do m1827=m1826+1,nqul

i7=i1827i7
n21=m1827m21

print*,'loop1827'
call write_symm_xmi_1(i7,n21,m1827,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2527
if (sf2.eq.1)goto 100

i1828i7=i7
m1828m21=n21

do m1828=m1827+1,nqul

i7=i1828i7
n21=m1828m21

print*,'loop1828'
call write_symm_xmi_1(i7,n21,m1828,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2528
if (sf2.eq.1)goto 100

i1829i7=i7
m1829m21=n21

do m1829=m1828+1,nqul

i7=i1829i7
n21=m1829m21

print*,'loop1829'
call write_symm_xmi_1(i7,n21,m1829,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2529
if (sf2.eq.1)goto 100

i1830i7=i7
m1830m21=n21

do m1830=m1829+1,nqul

i7=i1830i7
n21=m1830m21

print*,'loop1830'
call write_symm_xmi_1(i7,n21,m1830,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2530
if (sf2.eq.1)goto 100

i1831i7=i7
m1831m21=n21

do m1831=m1830+1,nqul

i7=i1831i7
n21=m1831m21

print*,'loop1831'
call write_symm_xmi_1(i7,n21,m1831,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2531
if (sf2.eq.1)goto 100

i1832i7=i7
m1832m21=n21

do m1832=m1831+1,nqul

i7=i1832i7
n21=m1832m21

print*,'loop1832'
call write_symm_xmi_1(i7,n21,m1832,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2532
if (sf2.eq.1)goto 100

i1833i7=i7
m1833m21=n21

do m1833=m1832+1,nqul

i7=i1833i7
n21=m1833m21

print*,'loop1833'
call write_symm_xmi_1(i7,n21,m1833,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2533
if (sf2.eq.1)goto 100

i1834i7=i7
m1834m21=n21

do m1834=m1833+1,nqul

i7=i1834i7
n21=m1834m21

print*,'loop1834'
call write_symm_xmi_1(i7,n21,m1834,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2534
if (sf2.eq.1)goto 100

i1835i7=i7
m1835m21=n21

do m1835=m1834+1,nqul

i7=i1835i7
n21=m1835m21

print*,'loop1835'
call write_symm_xmi_1(i7,n21,m1835,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2535
if (sf2.eq.1)goto 100

i1836i7=i7
m1836m21=n21

do m1836=m1835+1,nqul

i7=i1836i7
n21=m1836m21

print*,'loop1836'
call write_symm_xmi_1(i7,n21,m1836,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2536
if (sf2.eq.1)goto 100

i1837i7=i7
m1837m21=n21

do m1837=m1836+1,nqul

i7=i1837i7
n21=m1837m21

print*,'loop1837'
call write_symm_xmi_1(i7,n21,m1837,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2537
if (sf2.eq.1)goto 100

i1838i7=i7
m1838m21=n21

do m1838=m1837+1,nqul

i7=i1838i7
n21=m1838m21

print*,'loop1838'
call write_symm_xmi_1(i7,n21,m1838,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2538
if (sf2.eq.1)goto 100

i1839i7=i7
m1839m21=n21

do m1839=m1838+1,nqul

i7=i1839i7
n21=m1839m21

print*,'loop1839'
call write_symm_xmi_1(i7,n21,m1839,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2539
if (sf2.eq.1)goto 100

i1840i7=i7
m1840m21=n21

do m1840=m1839+1,nqul

i7=i1840i7
n21=m1840m21

print*,'loop1840'
call write_symm_xmi_1(i7,n21,m1840,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2540
if (sf2.eq.1)goto 100

i1841i7=i7
m1841m21=n21

do m1841=m1840+1,nqul

i7=i1841i7
n21=m1841m21

print*,'loop1841'
call write_symm_xmi_1(i7,n21,m1841,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2541
if (sf2.eq.1)goto 100

i1842i7=i7
m1842m21=n21

do m1842=m1841+1,nqul

i7=i1842i7
n21=m1842m21

print*,'loop1842'
call write_symm_xmi_1(i7,n21,m1842,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2542
if (sf2.eq.1)goto 100

i1843i7=i7
m1843m21=n21

do m1843=m1842+1,nqul

i7=i1843i7
n21=m1843m21

print*,'loop1843'
call write_symm_xmi_1(i7,n21,m1843,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2543
if (sf2.eq.1)goto 100

i1844i7=i7
m1844m21=n21

do m1844=m1843+1,nqul

i7=i1844i7
n21=m1844m21

print*,'loop1844'
call write_symm_xmi_1(i7,n21,m1844,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2544
if (sf2.eq.1)goto 100

i1845i7=i7
m1845m21=n21

do m1845=m1844+1,nqul

i7=i1845i7
n21=m1845m21

print*,'loop1845'
call write_symm_xmi_1(i7,n21,m1845,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2545
if (sf2.eq.1)goto 100

i1846i7=i7
m1846m21=n21

do m1846=m1845+1,nqul

i7=i1846i7
n21=m1846m21

print*,'loop1846'
call write_symm_xmi_1(i7,n21,m1846,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2546
if (sf2.eq.1)goto 100

i1847i7=i7
m1847m21=n21

do m1847=m1846+1,nqul

i7=i1847i7
n21=m1847m21

print*,'loop1847'
call write_symm_xmi_1(i7,n21,m1847,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2547
if (sf2.eq.1)goto 100

i1848i7=i7
m1848m21=n21

do m1848=m1847+1,nqul

i7=i1848i7
n21=m1848m21

print*,'loop1848'
call write_symm_xmi_1(i7,n21,m1848,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2548
if (sf2.eq.1)goto 100

i1849i7=i7
m1849m21=n21

do m1849=m1848+1,nqul

i7=i1849i7
n21=m1849m21

print*,'loop1849'
call write_symm_xmi_1(i7,n21,m1849,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2549
if (sf2.eq.1)goto 100

i1850i7=i7
m1850m21=n21

do m1850=m1849+1,nqul

i7=i1850i7
n21=m1850m21

print*,'loop1850'
call write_symm_xmi_1(i7,n21,m1850,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2550
if (sf2.eq.1)goto 100

i1851i7=i7
m1851m21=n21

do m1851=m1850+1,nqul

i7=i1851i7
n21=m1851m21

print*,'loop1851'
call write_symm_xmi_1(i7,n21,m1851,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2551
if (sf2.eq.1)goto 100

i1852i7=i7
m1852m21=n21

do m1852=m1851+1,nqul

i7=i1852i7
n21=m1852m21

print*,'loop1852'
call write_symm_xmi_1(i7,n21,m1852,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2552
if (sf2.eq.1)goto 100

i1853i7=i7
m1853m21=n21

do m1853=m1852+1,nqul

i7=i1853i7
n21=m1853m21

print*,'loop1853'
call write_symm_xmi_1(i7,n21,m1853,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2553
if (sf2.eq.1)goto 100

i1854i7=i7
m1854m21=n21

do m1854=m1853+1,nqul

i7=i1854i7
n21=m1854m21

print*,'loop1854'
call write_symm_xmi_1(i7,n21,m1854,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2554
if (sf2.eq.1)goto 100

i1855i7=i7
m1855m21=n21

do m1855=m1854+1,nqul

i7=i1855i7
n21=m1855m21

print*,'loop1855'
call write_symm_xmi_1(i7,n21,m1855,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2555
if (sf2.eq.1)goto 100

i1856i7=i7
m1856m21=n21

do m1856=m1855+1,nqul

i7=i1856i7
n21=m1856m21

print*,'loop1856'
call write_symm_xmi_1(i7,n21,m1856,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2556
if (sf2.eq.1)goto 100

i1857i7=i7
m1857m21=n21

do m1857=m1856+1,nqul

i7=i1857i7
n21=m1857m21

print*,'loop1857'
call write_symm_xmi_1(i7,n21,m1857,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2557
if (sf2.eq.1)goto 100

i1858i7=i7
m1858m21=n21

do m1858=m1857+1,nqul

i7=i1858i7
n21=m1858m21

print*,'loop1858'
call write_symm_xmi_1(i7,n21,m1858,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2558
if (sf2.eq.1)goto 100

i1859i7=i7
m1859m21=n21

do m1859=m1858+1,nqul

i7=i1859i7
n21=m1859m21

print*,'loop1859'
call write_symm_xmi_1(i7,n21,m1859,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2559
if (sf2.eq.1)goto 100

i1860i7=i7
m1860m21=n21

do m1860=m1859+1,nqul

i7=i1860i7
n21=m1860m21

print*,'loop1860'
call write_symm_xmi_1(i7,n21,m1860,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2560
if (sf2.eq.1)goto 100

i1861i7=i7
m1861m21=n21

do m1861=m1860+1,nqul

i7=i1861i7
n21=m1861m21

print*,'loop1861'
call write_symm_xmi_1(i7,n21,m1861,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2561
if (sf2.eq.1)goto 100

i1862i7=i7
m1862m21=n21

do m1862=m1861+1,nqul

i7=i1862i7
n21=m1862m21

print*,'loop1862'
call write_symm_xmi_1(i7,n21,m1862,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2562
if (sf2.eq.1)goto 100

i1863i7=i7
m1863m21=n21

do m1863=m1862+1,nqul

i7=i1863i7
n21=m1863m21

print*,'loop1863'
call write_symm_xmi_1(i7,n21,m1863,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2563
if (sf2.eq.1)goto 100

i1864i7=i7
m1864m21=n21

do m1864=m1863+1,nqul

i7=i1864i7
n21=m1864m21

print*,'loop1864'
call write_symm_xmi_1(i7,n21,m1864,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2564
if (sf2.eq.1)goto 100

i1865i7=i7
m1865m21=n21

do m1865=m1864+1,nqul

i7=i1865i7
n21=m1865m21

print*,'loop1865'
call write_symm_xmi_1(i7,n21,m1865,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2565
if (sf2.eq.1)goto 100

i1866i7=i7
m1866m21=n21

do m1866=m1865+1,nqul

i7=i1866i7
n21=m1866m21

print*,'loop1866'
call write_symm_xmi_1(i7,n21,m1866,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2566
if (sf2.eq.1)goto 100

i1867i7=i7
m1867m21=n21

do m1867=m1866+1,nqul

i7=i1867i7
n21=m1867m21

print*,'loop1867'
call write_symm_xmi_1(i7,n21,m1867,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2567
if (sf2.eq.1)goto 100

i1868i7=i7
m1868m21=n21

do m1868=m1867+1,nqul

i7=i1868i7
n21=m1868m21

print*,'loop1868'
call write_symm_xmi_1(i7,n21,m1868,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2568
if (sf2.eq.1)goto 100

i1869i7=i7
m1869m21=n21

do m1869=m1868+1,nqul

i7=i1869i7
n21=m1869m21

print*,'loop1869'
call write_symm_xmi_1(i7,n21,m1869,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2569
if (sf2.eq.1)goto 100

i1870i7=i7
m1870m21=n21

do m1870=m1869+1,nqul

i7=i1870i7
n21=m1870m21

print*,'loop1870'
call write_symm_xmi_1(i7,n21,m1870,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2570
if (sf2.eq.1)goto 100

i1871i7=i7
m1871m21=n21

do m1871=m1870+1,nqul

i7=i1871i7
n21=m1871m21

print*,'loop1871'
call write_symm_xmi_1(i7,n21,m1871,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2571
if (sf2.eq.1)goto 100

i1872i7=i7
m1872m21=n21

do m1872=m1871+1,nqul

i7=i1872i7
n21=m1872m21

print*,'loop1872'
call write_symm_xmi_1(i7,n21,m1872,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2572
if (sf2.eq.1)goto 100

i1873i7=i7
m1873m21=n21

do m1873=m1872+1,nqul

i7=i1873i7
n21=m1873m21

print*,'loop1873'
call write_symm_xmi_1(i7,n21,m1873,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2573
if (sf2.eq.1)goto 100

i1874i7=i7
m1874m21=n21

do m1874=m1873+1,nqul

i7=i1874i7
n21=m1874m21

print*,'loop1874'
call write_symm_xmi_1(i7,n21,m1874,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2574
if (sf2.eq.1)goto 100

i1875i7=i7
m1875m21=n21

do m1875=m1874+1,nqul

i7=i1875i7
n21=m1875m21

print*,'loop1875'
call write_symm_xmi_1(i7,n21,m1875,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2575
if (sf2.eq.1)goto 100

i1876i7=i7
m1876m21=n21

do m1876=m1875+1,nqul

i7=i1876i7
n21=m1876m21

print*,'loop1876'
call write_symm_xmi_1(i7,n21,m1876,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2576
if (sf2.eq.1)goto 100

i1877i7=i7
m1877m21=n21

do m1877=m1876+1,nqul

i7=i1877i7
n21=m1877m21

print*,'loop1877'
call write_symm_xmi_1(i7,n21,m1877,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2577
if (sf2.eq.1)goto 100

i1878i7=i7
m1878m21=n21

do m1878=m1877+1,nqul

i7=i1878i7
n21=m1878m21

print*,'loop1878'
call write_symm_xmi_1(i7,n21,m1878,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2578
if (sf2.eq.1)goto 100

i1879i7=i7
m1879m21=n21

do m1879=m1878+1,nqul

i7=i1879i7
n21=m1879m21

print*,'loop1879'
call write_symm_xmi_1(i7,n21,m1879,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2579
if (sf2.eq.1)goto 100

i1880i7=i7
m1880m21=n21

do m1880=m1879+1,nqul

i7=i1880i7
n21=m1880m21

print*,'loop1880'
call write_symm_xmi_1(i7,n21,m1880,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2580
if (sf2.eq.1)goto 100

i1881i7=i7
m1881m21=n21

do m1881=m1880+1,nqul

i7=i1881i7
n21=m1881m21

print*,'loop1881'
call write_symm_xmi_1(i7,n21,m1881,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2581
if (sf2.eq.1)goto 100

i1882i7=i7
m1882m21=n21

do m1882=m1881+1,nqul

i7=i1882i7
n21=m1882m21

print*,'loop1882'
call write_symm_xmi_1(i7,n21,m1882,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2582
if (sf2.eq.1)goto 100

i1883i7=i7
m1883m21=n21

do m1883=m1882+1,nqul

i7=i1883i7
n21=m1883m21

print*,'loop1883'
call write_symm_xmi_1(i7,n21,m1883,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2583
if (sf2.eq.1)goto 100

i1884i7=i7
m1884m21=n21

do m1884=m1883+1,nqul

i7=i1884i7
n21=m1884m21

print*,'loop1884'
call write_symm_xmi_1(i7,n21,m1884,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2584
if (sf2.eq.1)goto 100

i1885i7=i7
m1885m21=n21

do m1885=m1884+1,nqul

i7=i1885i7
n21=m1885m21

print*,'loop1885'
call write_symm_xmi_1(i7,n21,m1885,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2585
if (sf2.eq.1)goto 100

i1886i7=i7
m1886m21=n21

do m1886=m1885+1,nqul

i7=i1886i7
n21=m1886m21

print*,'loop1886'
call write_symm_xmi_1(i7,n21,m1886,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2586
if (sf2.eq.1)goto 100

i1887i7=i7
m1887m21=n21

do m1887=m1886+1,nqul

i7=i1887i7
n21=m1887m21

print*,'loop1887'
call write_symm_xmi_1(i7,n21,m1887,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2587
if (sf2.eq.1)goto 100

i1888i7=i7
m1888m21=n21

do m1888=m1887+1,nqul

i7=i1888i7
n21=m1888m21

print*,'loop1888'
call write_symm_xmi_1(i7,n21,m1888,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2588
if (sf2.eq.1)goto 100

i1889i7=i7
m1889m21=n21

do m1889=m1888+1,nqul

i7=i1889i7
n21=m1889m21

print*,'loop1889'
call write_symm_xmi_1(i7,n21,m1889,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2589
if (sf2.eq.1)goto 100

i1890i7=i7
m1890m21=n21

do m1890=m1889+1,nqul

i7=i1890i7
n21=m1890m21

print*,'loop1890'
call write_symm_xmi_1(i7,n21,m1890,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2590
if (sf2.eq.1)goto 100

i1891i7=i7
m1891m21=n21

do m1891=m1890+1,nqul

i7=i1891i7
n21=m1891m21

print*,'loop1891'
call write_symm_xmi_1(i7,n21,m1891,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2591
if (sf2.eq.1)goto 100

i1892i7=i7
m1892m21=n21

do m1892=m1891+1,nqul

i7=i1892i7
n21=m1892m21

print*,'loop1892'
call write_symm_xmi_1(i7,n21,m1892,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2592
if (sf2.eq.1)goto 100

i1893i7=i7
m1893m21=n21

do m1893=m1892+1,nqul

i7=i1893i7
n21=m1893m21

print*,'loop1893'
call write_symm_xmi_1(i7,n21,m1893,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2593
if (sf2.eq.1)goto 100

i1894i7=i7
m1894m21=n21

do m1894=m1893+1,nqul

i7=i1894i7
n21=m1894m21

print*,'loop1894'
call write_symm_xmi_1(i7,n21,m1894,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2594
if (sf2.eq.1)goto 100

i1895i7=i7
m1895m21=n21

do m1895=m1894+1,nqul

i7=i1895i7
n21=m1895m21

print*,'loop1895'
call write_symm_xmi_1(i7,n21,m1895,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2595
if (sf2.eq.1)goto 100

i1896i7=i7
m1896m21=n21

do m1896=m1895+1,nqul

i7=i1896i7
n21=m1896m21

print*,'loop1896'
call write_symm_xmi_1(i7,n21,m1896,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2596
if (sf2.eq.1)goto 100

i1897i7=i7
m1897m21=n21

do m1897=m1896+1,nqul

i7=i1897i7
n21=m1897m21

print*,'loop1897'
call write_symm_xmi_1(i7,n21,m1897,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2597
if (sf2.eq.1)goto 100

i1898i7=i7
m1898m21=n21

do m1898=m1897+1,nqul

i7=i1898i7
n21=m1898m21

print*,'loop1898'
call write_symm_xmi_1(i7,n21,m1898,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2598
if (sf2.eq.1)goto 100

i1899i7=i7
m1899m21=n21

do m1899=m1898+1,nqul

i7=i1899i7
n21=m1899m21

print*,'loop1899'
call write_symm_xmi_1(i7,n21,m1899,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2599
if (sf2.eq.1)goto 100

i1900i7=i7
m1900m21=n21

do m1900=m1899+1,nqul

i7=i1900i7
n21=m1900m21

print*,'loop1900'
call write_symm_xmi_1(i7,n21,m1900,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2600
if (sf2.eq.1)goto 100

i1901i7=i7
m1901m21=n21

do m1901=m1900+1,nqul

i7=i1901i7
n21=m1901m21

print*,'loop1901'
call write_symm_xmi_1(i7,n21,m1901,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2601
if (sf2.eq.1)goto 100

i1902i7=i7
m1902m21=n21

do m1902=m1901+1,nqul

i7=i1902i7
n21=m1902m21

print*,'loop1902'
call write_symm_xmi_1(i7,n21,m1902,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2602
if (sf2.eq.1)goto 100

i1903i7=i7
m1903m21=n21

do m1903=m1902+1,nqul

i7=i1903i7
n21=m1903m21

print*,'loop1903'
call write_symm_xmi_1(i7,n21,m1903,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2603
if (sf2.eq.1)goto 100

i1904i7=i7
m1904m21=n21

do m1904=m1903+1,nqul

i7=i1904i7
n21=m1904m21

print*,'loop1904'
call write_symm_xmi_1(i7,n21,m1904,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2604
if (sf2.eq.1)goto 100

i1905i7=i7
m1905m21=n21

do m1905=m1904+1,nqul

i7=i1905i7
n21=m1905m21

print*,'loop1905'
call write_symm_xmi_1(i7,n21,m1905,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2605
if (sf2.eq.1)goto 100

i1906i7=i7
m1906m21=n21

do m1906=m1905+1,nqul

i7=i1906i7
n21=m1906m21

print*,'loop1906'
call write_symm_xmi_1(i7,n21,m1906,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2606
if (sf2.eq.1)goto 100

i1907i7=i7
m1907m21=n21

do m1907=m1906+1,nqul

i7=i1907i7
n21=m1907m21

print*,'loop1907'
call write_symm_xmi_1(i7,n21,m1907,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2607
if (sf2.eq.1)goto 100

i1908i7=i7
m1908m21=n21

do m1908=m1907+1,nqul

i7=i1908i7
n21=m1908m21

print*,'loop1908'
call write_symm_xmi_1(i7,n21,m1908,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2608
if (sf2.eq.1)goto 100

i1909i7=i7
m1909m21=n21

do m1909=m1908+1,nqul

i7=i1909i7
n21=m1909m21

print*,'loop1909'
call write_symm_xmi_1(i7,n21,m1909,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2609
if (sf2.eq.1)goto 100

i1910i7=i7
m1910m21=n21

do m1910=m1909+1,nqul

i7=i1910i7
n21=m1910m21

print*,'loop1910'
call write_symm_xmi_1(i7,n21,m1910,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2610
if (sf2.eq.1)goto 100

i1911i7=i7
m1911m21=n21

do m1911=m1910+1,nqul

i7=i1911i7
n21=m1911m21

print*,'loop1911'
call write_symm_xmi_1(i7,n21,m1911,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2611
if (sf2.eq.1)goto 100

i1912i7=i7
m1912m21=n21

do m1912=m1911+1,nqul

i7=i1912i7
n21=m1912m21

print*,'loop1912'
call write_symm_xmi_1(i7,n21,m1912,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2612
if (sf2.eq.1)goto 100

i1913i7=i7
m1913m21=n21

do m1913=m1912+1,nqul

i7=i1913i7
n21=m1913m21

print*,'loop1913'
call write_symm_xmi_1(i7,n21,m1913,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2613
if (sf2.eq.1)goto 100

i1914i7=i7
m1914m21=n21

do m1914=m1913+1,nqul

i7=i1914i7
n21=m1914m21

print*,'loop1914'
call write_symm_xmi_1(i7,n21,m1914,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2614
if (sf2.eq.1)goto 100

i1915i7=i7
m1915m21=n21

do m1915=m1914+1,nqul

i7=i1915i7
n21=m1915m21

print*,'loop1915'
call write_symm_xmi_1(i7,n21,m1915,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2615
if (sf2.eq.1)goto 100

i1916i7=i7
m1916m21=n21

do m1916=m1915+1,nqul

i7=i1916i7
n21=m1916m21

print*,'loop1916'
call write_symm_xmi_1(i7,n21,m1916,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2616
if (sf2.eq.1)goto 100

i1917i7=i7
m1917m21=n21

do m1917=m1916+1,nqul

i7=i1917i7
n21=m1917m21

print*,'loop1917'
call write_symm_xmi_1(i7,n21,m1917,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2617
if (sf2.eq.1)goto 100

i1918i7=i7
m1918m21=n21

do m1918=m1917+1,nqul

i7=i1918i7
n21=m1918m21

print*,'loop1918'
call write_symm_xmi_1(i7,n21,m1918,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2618
if (sf2.eq.1)goto 100

i1919i7=i7
m1919m21=n21

do m1919=m1918+1,nqul

i7=i1919i7
n21=m1919m21

print*,'loop1919'
call write_symm_xmi_1(i7,n21,m1919,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2619
if (sf2.eq.1)goto 100

i1920i7=i7
m1920m21=n21

do m1920=m1919+1,nqul

i7=i1920i7
n21=m1920m21

print*,'loop1920'
call write_symm_xmi_1(i7,n21,m1920,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2620
if (sf2.eq.1)goto 100

i1921i7=i7
m1921m21=n21

do m1921=m1920+1,nqul

i7=i1921i7
n21=m1921m21

print*,'loop1921'
call write_symm_xmi_1(i7,n21,m1921,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2621
if (sf2.eq.1)goto 100

i1922i7=i7
m1922m21=n21

do m1922=m1921+1,nqul

i7=i1922i7
n21=m1922m21

print*,'loop1922'
call write_symm_xmi_1(i7,n21,m1922,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2622
if (sf2.eq.1)goto 100

i1923i7=i7
m1923m21=n21

do m1923=m1922+1,nqul

i7=i1923i7
n21=m1923m21

print*,'loop1923'
call write_symm_xmi_1(i7,n21,m1923,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2623
if (sf2.eq.1)goto 100

i1924i7=i7
m1924m21=n21

do m1924=m1923+1,nqul

i7=i1924i7
n21=m1924m21

print*,'loop1924'
call write_symm_xmi_1(i7,n21,m1924,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2624
if (sf2.eq.1)goto 100

i1925i7=i7
m1925m21=n21

do m1925=m1924+1,nqul

i7=i1925i7
n21=m1925m21

print*,'loop1925'
call write_symm_xmi_1(i7,n21,m1925,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2625
if (sf2.eq.1)goto 100

i1926i7=i7
m1926m21=n21

do m1926=m1925+1,nqul

i7=i1926i7
n21=m1926m21

print*,'loop1926'
call write_symm_xmi_1(i7,n21,m1926,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2626
if (sf2.eq.1)goto 100

i1927i7=i7
m1927m21=n21

do m1927=m1926+1,nqul

i7=i1927i7
n21=m1927m21

print*,'loop1927'
call write_symm_xmi_1(i7,n21,m1927,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2627
if (sf2.eq.1)goto 100

i1928i7=i7
m1928m21=n21

do m1928=m1927+1,nqul

i7=i1928i7
n21=m1928m21

print*,'loop1928'
call write_symm_xmi_1(i7,n21,m1928,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2628
if (sf2.eq.1)goto 100

i1929i7=i7
m1929m21=n21

do m1929=m1928+1,nqul

i7=i1929i7
n21=m1929m21

print*,'loop1929'
call write_symm_xmi_1(i7,n21,m1929,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2629
if (sf2.eq.1)goto 100

i1930i7=i7
m1930m21=n21

do m1930=m1929+1,nqul

i7=i1930i7
n21=m1930m21

print*,'loop1930'
call write_symm_xmi_1(i7,n21,m1930,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2630
if (sf2.eq.1)goto 100

i1931i7=i7
m1931m21=n21

do m1931=m1930+1,nqul

i7=i1931i7
n21=m1931m21

print*,'loop1931'
call write_symm_xmi_1(i7,n21,m1931,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2631
if (sf2.eq.1)goto 100

i1932i7=i7
m1932m21=n21

do m1932=m1931+1,nqul

i7=i1932i7
n21=m1932m21

print*,'loop1932'
call write_symm_xmi_1(i7,n21,m1932,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2632
if (sf2.eq.1)goto 100

i1933i7=i7
m1933m21=n21

do m1933=m1932+1,nqul

i7=i1933i7
n21=m1933m21

print*,'loop1933'
call write_symm_xmi_1(i7,n21,m1933,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2633
if (sf2.eq.1)goto 100

i1934i7=i7
m1934m21=n21

do m1934=m1933+1,nqul

i7=i1934i7
n21=m1934m21

print*,'loop1934'
call write_symm_xmi_1(i7,n21,m1934,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2634
if (sf2.eq.1)goto 100

i1935i7=i7
m1935m21=n21

do m1935=m1934+1,nqul

i7=i1935i7
n21=m1935m21

print*,'loop1935'
call write_symm_xmi_1(i7,n21,m1935,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2635
if (sf2.eq.1)goto 100

i1936i7=i7
m1936m21=n21

do m1936=m1935+1,nqul

i7=i1936i7
n21=m1936m21

print*,'loop1936'
call write_symm_xmi_1(i7,n21,m1936,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2636
if (sf2.eq.1)goto 100

i1937i7=i7
m1937m21=n21

do m1937=m1936+1,nqul

i7=i1937i7
n21=m1937m21

print*,'loop1937'
call write_symm_xmi_1(i7,n21,m1937,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2637
if (sf2.eq.1)goto 100

i1938i7=i7
m1938m21=n21

do m1938=m1937+1,nqul

i7=i1938i7
n21=m1938m21

print*,'loop1938'
call write_symm_xmi_1(i7,n21,m1938,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2638
if (sf2.eq.1)goto 100

i1939i7=i7
m1939m21=n21

do m1939=m1938+1,nqul

i7=i1939i7
n21=m1939m21

print*,'loop1939'
call write_symm_xmi_1(i7,n21,m1939,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2639
if (sf2.eq.1)goto 100

i1940i7=i7
m1940m21=n21

do m1940=m1939+1,nqul

i7=i1940i7
n21=m1940m21

print*,'loop1940'
call write_symm_xmi_1(i7,n21,m1940,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2640
if (sf2.eq.1)goto 100

i1941i7=i7
m1941m21=n21

do m1941=m1940+1,nqul

i7=i1941i7
n21=m1941m21

print*,'loop1941'
call write_symm_xmi_1(i7,n21,m1941,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2641
if (sf2.eq.1)goto 100

i1942i7=i7
m1942m21=n21

do m1942=m1941+1,nqul

i7=i1942i7
n21=m1942m21

print*,'loop1942'
call write_symm_xmi_1(i7,n21,m1942,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2642
if (sf2.eq.1)goto 100

i1943i7=i7
m1943m21=n21

do m1943=m1942+1,nqul

i7=i1943i7
n21=m1943m21

print*,'loop1943'
call write_symm_xmi_1(i7,n21,m1943,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2643
if (sf2.eq.1)goto 100

i1944i7=i7
m1944m21=n21

do m1944=m1943+1,nqul

i7=i1944i7
n21=m1944m21

print*,'loop1944'
call write_symm_xmi_1(i7,n21,m1944,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2644
if (sf2.eq.1)goto 100

i1945i7=i7
m1945m21=n21

do m1945=m1944+1,nqul

i7=i1945i7
n21=m1945m21

print*,'loop1945'
call write_symm_xmi_1(i7,n21,m1945,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2645
if (sf2.eq.1)goto 100

i1946i7=i7
m1946m21=n21

do m1946=m1945+1,nqul

i7=i1946i7
n21=m1946m21

print*,'loop1946'
call write_symm_xmi_1(i7,n21,m1946,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2646
if (sf2.eq.1)goto 100

i1947i7=i7
m1947m21=n21

do m1947=m1946+1,nqul

i7=i1947i7
n21=m1947m21

print*,'loop1947'
call write_symm_xmi_1(i7,n21,m1947,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2647
if (sf2.eq.1)goto 100

i1948i7=i7
m1948m21=n21

do m1948=m1947+1,nqul

i7=i1948i7
n21=m1948m21

print*,'loop1948'
call write_symm_xmi_1(i7,n21,m1948,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2648
if (sf2.eq.1)goto 100

i1949i7=i7
m1949m21=n21

do m1949=m1948+1,nqul

i7=i1949i7
n21=m1949m21

print*,'loop1949'
call write_symm_xmi_1(i7,n21,m1949,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2649
if (sf2.eq.1)goto 100

i1950i7=i7
m1950m21=n21

do m1950=m1949+1,nqul

i7=i1950i7
n21=m1950m21

print*,'loop1950'
call write_symm_xmi_1(i7,n21,m1950,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2650
if (sf2.eq.1)goto 100

i1951i7=i7
m1951m21=n21

do m1951=m1950+1,nqul

i7=i1951i7
n21=m1951m21

print*,'loop1951'
call write_symm_xmi_1(i7,n21,m1951,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2651
if (sf2.eq.1)goto 100

i1952i7=i7
m1952m21=n21

do m1952=m1951+1,nqul

i7=i1952i7
n21=m1952m21

print*,'loop1952'
call write_symm_xmi_1(i7,n21,m1952,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2652
if (sf2.eq.1)goto 100

i1953i7=i7
m1953m21=n21

do m1953=m1952+1,nqul

i7=i1953i7
n21=m1953m21

print*,'loop1953'
call write_symm_xmi_1(i7,n21,m1953,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2653
if (sf2.eq.1)goto 100

i1954i7=i7
m1954m21=n21

do m1954=m1953+1,nqul

i7=i1954i7
n21=m1954m21

print*,'loop1954'
call write_symm_xmi_1(i7,n21,m1954,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2654
if (sf2.eq.1)goto 100

i1955i7=i7
m1955m21=n21

do m1955=m1954+1,nqul

i7=i1955i7
n21=m1955m21

print*,'loop1955'
call write_symm_xmi_1(i7,n21,m1955,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2655
if (sf2.eq.1)goto 100

i1956i7=i7
m1956m21=n21

do m1956=m1955+1,nqul

i7=i1956i7
n21=m1956m21

print*,'loop1956'
call write_symm_xmi_1(i7,n21,m1956,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2656
if (sf2.eq.1)goto 100

i1957i7=i7
m1957m21=n21

do m1957=m1956+1,nqul

i7=i1957i7
n21=m1957m21

print*,'loop1957'
call write_symm_xmi_1(i7,n21,m1957,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2657
if (sf2.eq.1)goto 100

i1958i7=i7
m1958m21=n21

do m1958=m1957+1,nqul

i7=i1958i7
n21=m1958m21

print*,'loop1958'
call write_symm_xmi_1(i7,n21,m1958,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2658
if (sf2.eq.1)goto 100

i1959i7=i7
m1959m21=n21

do m1959=m1958+1,nqul

i7=i1959i7
n21=m1959m21

print*,'loop1959'
call write_symm_xmi_1(i7,n21,m1959,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2659
if (sf2.eq.1)goto 100

i1960i7=i7
m1960m21=n21

do m1960=m1959+1,nqul

i7=i1960i7
n21=m1960m21

print*,'loop1960'
call write_symm_xmi_1(i7,n21,m1960,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2660
if (sf2.eq.1)goto 100

i1961i7=i7
m1961m21=n21

do m1961=m1960+1,nqul

i7=i1961i7
n21=m1961m21

print*,'loop1961'
call write_symm_xmi_1(i7,n21,m1961,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2661
if (sf2.eq.1)goto 100

i1962i7=i7
m1962m21=n21

do m1962=m1961+1,nqul

i7=i1962i7
n21=m1962m21

print*,'loop1962'
call write_symm_xmi_1(i7,n21,m1962,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2662
if (sf2.eq.1)goto 100

i1963i7=i7
m1963m21=n21

do m1963=m1962+1,nqul

i7=i1963i7
n21=m1963m21

print*,'loop1963'
call write_symm_xmi_1(i7,n21,m1963,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2663
if (sf2.eq.1)goto 100

i1964i7=i7
m1964m21=n21

do m1964=m1963+1,nqul

i7=i1964i7
n21=m1964m21

print*,'loop1964'
call write_symm_xmi_1(i7,n21,m1964,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2664
if (sf2.eq.1)goto 100

i1965i7=i7
m1965m21=n21

do m1965=m1964+1,nqul

i7=i1965i7
n21=m1965m21

print*,'loop1965'
call write_symm_xmi_1(i7,n21,m1965,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2665
if (sf2.eq.1)goto 100

i1966i7=i7
m1966m21=n21

do m1966=m1965+1,nqul

i7=i1966i7
n21=m1966m21

print*,'loop1966'
call write_symm_xmi_1(i7,n21,m1966,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2666
if (sf2.eq.1)goto 100

i1967i7=i7
m1967m21=n21

do m1967=m1966+1,nqul

i7=i1967i7
n21=m1967m21

print*,'loop1967'
call write_symm_xmi_1(i7,n21,m1967,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2667
if (sf2.eq.1)goto 100

i1968i7=i7
m1968m21=n21

do m1968=m1967+1,nqul

i7=i1968i7
n21=m1968m21

print*,'loop1968'
call write_symm_xmi_1(i7,n21,m1968,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2668
if (sf2.eq.1)goto 100

i1969i7=i7
m1969m21=n21

do m1969=m1968+1,nqul

i7=i1969i7
n21=m1969m21

print*,'loop1969'
call write_symm_xmi_1(i7,n21,m1969,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2669
if (sf2.eq.1)goto 100

i1970i7=i7
m1970m21=n21

do m1970=m1969+1,nqul

i7=i1970i7
n21=m1970m21

print*,'loop1970'
call write_symm_xmi_1(i7,n21,m1970,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2670
if (sf2.eq.1)goto 100

i1971i7=i7
m1971m21=n21

do m1971=m1970+1,nqul

i7=i1971i7
n21=m1971m21

print*,'loop1971'
call write_symm_xmi_1(i7,n21,m1971,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2671
if (sf2.eq.1)goto 100

i1972i7=i7
m1972m21=n21

do m1972=m1971+1,nqul

i7=i1972i7
n21=m1972m21

print*,'loop1972'
call write_symm_xmi_1(i7,n21,m1972,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2672
if (sf2.eq.1)goto 100

i1973i7=i7
m1973m21=n21

do m1973=m1972+1,nqul

i7=i1973i7
n21=m1973m21

print*,'loop1973'
call write_symm_xmi_1(i7,n21,m1973,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2673
if (sf2.eq.1)goto 100

i1974i7=i7
m1974m21=n21

do m1974=m1973+1,nqul

i7=i1974i7
n21=m1974m21

print*,'loop1974'
call write_symm_xmi_1(i7,n21,m1974,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2674
if (sf2.eq.1)goto 100

i1975i7=i7
m1975m21=n21

do m1975=m1974+1,nqul

i7=i1975i7
n21=m1975m21

print*,'loop1975'
call write_symm_xmi_1(i7,n21,m1975,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2675
if (sf2.eq.1)goto 100

i1976i7=i7
m1976m21=n21

do m1976=m1975+1,nqul

i7=i1976i7
n21=m1976m21

print*,'loop1976'
call write_symm_xmi_1(i7,n21,m1976,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2676
if (sf2.eq.1)goto 100

i1977i7=i7
m1977m21=n21

do m1977=m1976+1,nqul

i7=i1977i7
n21=m1977m21

print*,'loop1977'
call write_symm_xmi_1(i7,n21,m1977,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2677
if (sf2.eq.1)goto 100

i1978i7=i7
m1978m21=n21

do m1978=m1977+1,nqul

i7=i1978i7
n21=m1978m21

print*,'loop1978'
call write_symm_xmi_1(i7,n21,m1978,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2678
if (sf2.eq.1)goto 100

i1979i7=i7
m1979m21=n21

do m1979=m1978+1,nqul

i7=i1979i7
n21=m1979m21

print*,'loop1979'
call write_symm_xmi_1(i7,n21,m1979,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2679
if (sf2.eq.1)goto 100

i1980i7=i7
m1980m21=n21

do m1980=m1979+1,nqul

i7=i1980i7
n21=m1980m21

print*,'loop1980'
call write_symm_xmi_1(i7,n21,m1980,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2680
if (sf2.eq.1)goto 100

i1981i7=i7
m1981m21=n21

do m1981=m1980+1,nqul

i7=i1981i7
n21=m1981m21

print*,'loop1981'
call write_symm_xmi_1(i7,n21,m1981,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2681
if (sf2.eq.1)goto 100

i1982i7=i7
m1982m21=n21

do m1982=m1981+1,nqul

i7=i1982i7
n21=m1982m21

print*,'loop1982'
call write_symm_xmi_1(i7,n21,m1982,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2682
if (sf2.eq.1)goto 100

i1983i7=i7
m1983m21=n21

do m1983=m1982+1,nqul

i7=i1983i7
n21=m1983m21

print*,'loop1983'
call write_symm_xmi_1(i7,n21,m1983,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2683
if (sf2.eq.1)goto 100

i1984i7=i7
m1984m21=n21

do m1984=m1983+1,nqul

i7=i1984i7
n21=m1984m21

print*,'loop1984'
call write_symm_xmi_1(i7,n21,m1984,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2684
if (sf2.eq.1)goto 100

i1985i7=i7
m1985m21=n21

do m1985=m1984+1,nqul

i7=i1985i7
n21=m1985m21

print*,'loop1985'
call write_symm_xmi_1(i7,n21,m1985,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2685
if (sf2.eq.1)goto 100

i1986i7=i7
m1986m21=n21

do m1986=m1985+1,nqul

i7=i1986i7
n21=m1986m21

print*,'loop1986'
call write_symm_xmi_1(i7,n21,m1986,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2686
if (sf2.eq.1)goto 100

i1987i7=i7
m1987m21=n21

do m1987=m1986+1,nqul

i7=i1987i7
n21=m1987m21

print*,'loop1987'
call write_symm_xmi_1(i7,n21,m1987,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2687
if (sf2.eq.1)goto 100

i1988i7=i7
m1988m21=n21

do m1988=m1987+1,nqul

i7=i1988i7
n21=m1988m21

print*,'loop1988'
call write_symm_xmi_1(i7,n21,m1988,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2688
if (sf2.eq.1)goto 100

i1989i7=i7
m1989m21=n21

do m1989=m1988+1,nqul

i7=i1989i7
n21=m1989m21

print*,'loop1989'
call write_symm_xmi_1(i7,n21,m1989,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2689
if (sf2.eq.1)goto 100

i1990i7=i7
m1990m21=n21

do m1990=m1989+1,nqul

i7=i1990i7
n21=m1990m21

print*,'loop1990'
call write_symm_xmi_1(i7,n21,m1990,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2690
if (sf2.eq.1)goto 100

i1991i7=i7
m1991m21=n21

do m1991=m1990+1,nqul

i7=i1991i7
n21=m1991m21

print*,'loop1991'
call write_symm_xmi_1(i7,n21,m1991,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2691
if (sf2.eq.1)goto 100

i1992i7=i7
m1992m21=n21

do m1992=m1991+1,nqul

i7=i1992i7
n21=m1992m21

print*,'loop1992'
call write_symm_xmi_1(i7,n21,m1992,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2692
if (sf2.eq.1)goto 100

i1993i7=i7
m1993m21=n21

do m1993=m1992+1,nqul

i7=i1993i7
n21=m1993m21

print*,'loop1993'
call write_symm_xmi_1(i7,n21,m1993,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2693
if (sf2.eq.1)goto 100

i1994i7=i7
m1994m21=n21

do m1994=m1993+1,nqul

i7=i1994i7
n21=m1994m21

print*,'loop1994'
call write_symm_xmi_1(i7,n21,m1994,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2694
if (sf2.eq.1)goto 100

i1995i7=i7
m1995m21=n21

do m1995=m1994+1,nqul

i7=i1995i7
n21=m1995m21

print*,'loop1995'
call write_symm_xmi_1(i7,n21,m1995,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2695
if (sf2.eq.1)goto 100

i1996i7=i7
m1996m21=n21

do m1996=m1995+1,nqul

i7=i1996i7
n21=m1996m21

print*,'loop1996'
call write_symm_xmi_1(i7,n21,m1996,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2696
if (sf2.eq.1)goto 100

i1997i7=i7
m1997m21=n21

do m1997=m1996+1,nqul

i7=i1997i7
n21=m1997m21

print*,'loop1997'
call write_symm_xmi_1(i7,n21,m1997,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2697
if (sf2.eq.1)goto 100

i1998i7=i7
m1998m21=n21

do m1998=m1997+1,nqul

i7=i1998i7
n21=m1998m21

print*,'loop1998'
call write_symm_xmi_1(i7,n21,m1998,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2698
if (sf2.eq.1)goto 100

i1999i7=i7
m1999m21=n21

do m1999=m1998+1,nqul

i7=i1999i7
n21=m1999m21

print*,'loop1999'
call write_symm_xmi_1(i7,n21,m1999,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2699
if (sf2.eq.1)goto 100

i2000i7=i7
m2000m21=n21

do m2000=m1999+1,nqul

i7=i2000i7
n21=m2000m21

print*,'loop2000'
call write_symm_xmi_1(i7,n21,m2000,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2700
if (sf2.eq.1)goto 100

i2001i7=i7
m2001m21=n21

do m2001=m2000+1,nqul

i7=i2001i7
n21=m2001m21

print*,'loop2001'
call write_symm_xmi_1(i7,n21,m2001,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2701
if (sf2.eq.1)goto 100

i2002i7=i7
m2002m21=n21

do m2002=m2001+1,nqul

i7=i2002i7
n21=m2002m21

print*,'loop2002'
call write_symm_xmi_1(i7,n21,m2002,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2702
if (sf2.eq.1)goto 100

i2003i7=i7
m2003m21=n21

do m2003=m2002+1,nqul

i7=i2003i7
n21=m2003m21

print*,'loop2003'
call write_symm_xmi_1(i7,n21,m2003,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2703
if (sf2.eq.1)goto 100

i2004i7=i7
m2004m21=n21

do m2004=m2003+1,nqul

i7=i2004i7
n21=m2004m21

print*,'loop2004'
call write_symm_xmi_1(i7,n21,m2004,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2704
if (sf2.eq.1)goto 100

i2005i7=i7
m2005m21=n21

do m2005=m2004+1,nqul

i7=i2005i7
n21=m2005m21

print*,'loop2005'
call write_symm_xmi_1(i7,n21,m2005,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2705
if (sf2.eq.1)goto 100

i2006i7=i7
m2006m21=n21

do m2006=m2005+1,nqul

i7=i2006i7
n21=m2006m21

print*,'loop2006'
call write_symm_xmi_1(i7,n21,m2006,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2706
if (sf2.eq.1)goto 100

i2007i7=i7
m2007m21=n21

do m2007=m2006+1,nqul

i7=i2007i7
n21=m2007m21

print*,'loop2007'
call write_symm_xmi_1(i7,n21,m2007,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2707
if (sf2.eq.1)goto 100

i2008i7=i7
m2008m21=n21

do m2008=m2007+1,nqul

i7=i2008i7
n21=m2008m21

print*,'loop2008'
call write_symm_xmi_1(i7,n21,m2008,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2708
if (sf2.eq.1)goto 100

i2009i7=i7
m2009m21=n21

do m2009=m2008+1,nqul

i7=i2009i7
n21=m2009m21

print*,'loop2009'
call write_symm_xmi_1(i7,n21,m2009,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2709
if (sf2.eq.1)goto 100

i2010i7=i7
m2010m21=n21

do m2010=m2009+1,nqul

i7=i2010i7
n21=m2010m21

print*,'loop2010'
call write_symm_xmi_1(i7,n21,m2010,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2710
if (sf2.eq.1)goto 100

i2011i7=i7
m2011m21=n21

do m2011=m2010+1,nqul

i7=i2011i7
n21=m2011m21

print*,'loop2011'
call write_symm_xmi_1(i7,n21,m2011,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2711
if (sf2.eq.1)goto 100

i2012i7=i7
m2012m21=n21

do m2012=m2011+1,nqul

i7=i2012i7
n21=m2012m21

print*,'loop2012'
call write_symm_xmi_1(i7,n21,m2012,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2712
if (sf2.eq.1)goto 100

i2013i7=i7
m2013m21=n21

do m2013=m2012+1,nqul

i7=i2013i7
n21=m2013m21

print*,'loop2013'
call write_symm_xmi_1(i7,n21,m2013,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2713
if (sf2.eq.1)goto 100

i2014i7=i7
m2014m21=n21

do m2014=m2013+1,nqul

i7=i2014i7
n21=m2014m21

print*,'loop2014'
call write_symm_xmi_1(i7,n21,m2014,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2714
if (sf2.eq.1)goto 100

i2015i7=i7
m2015m21=n21

do m2015=m2014+1,nqul

i7=i2015i7
n21=m2015m21

print*,'loop2015'
call write_symm_xmi_1(i7,n21,m2015,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2715
if (sf2.eq.1)goto 100

i2016i7=i7
m2016m21=n21

do m2016=m2015+1,nqul

i7=i2016i7
n21=m2016m21

print*,'loop2016'
call write_symm_xmi_1(i7,n21,m2016,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2716
if (sf2.eq.1)goto 100

i2017i7=i7
m2017m21=n21

do m2017=m2016+1,nqul

i7=i2017i7
n21=m2017m21

print*,'loop2017'
call write_symm_xmi_1(i7,n21,m2017,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2717
if (sf2.eq.1)goto 100

i2018i7=i7
m2018m21=n21

do m2018=m2017+1,nqul

i7=i2018i7
n21=m2018m21

print*,'loop2018'
call write_symm_xmi_1(i7,n21,m2018,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2718
if (sf2.eq.1)goto 100

i2019i7=i7
m2019m21=n21

do m2019=m2018+1,nqul

i7=i2019i7
n21=m2019m21

print*,'loop2019'
call write_symm_xmi_1(i7,n21,m2019,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2719
if (sf2.eq.1)goto 100

i2020i7=i7
m2020m21=n21

do m2020=m2019+1,nqul

i7=i2020i7
n21=m2020m21

print*,'loop2020'
call write_symm_xmi_1(i7,n21,m2020,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2720
if (sf2.eq.1)goto 100

i2021i7=i7
m2021m21=n21

do m2021=m2020+1,nqul

i7=i2021i7
n21=m2021m21

print*,'loop2021'
call write_symm_xmi_1(i7,n21,m2021,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2721
if (sf2.eq.1)goto 100

i2022i7=i7
m2022m21=n21

do m2022=m2021+1,nqul

i7=i2022i7
n21=m2022m21

print*,'loop2022'
call write_symm_xmi_1(i7,n21,m2022,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2722
if (sf2.eq.1)goto 100

i2023i7=i7
m2023m21=n21

do m2023=m2022+1,nqul

i7=i2023i7
n21=m2023m21

print*,'loop2023'
call write_symm_xmi_1(i7,n21,m2023,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2723
if (sf2.eq.1)goto 100

i2024i7=i7
m2024m21=n21

do m2024=m2023+1,nqul

i7=i2024i7
n21=m2024m21

print*,'loop2024'
call write_symm_xmi_1(i7,n21,m2024,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2724
if (sf2.eq.1)goto 100

i2025i7=i7
m2025m21=n21

do m2025=m2024+1,nqul

i7=i2025i7
n21=m2025m21

print*,'loop2025'
call write_symm_xmi_1(i7,n21,m2025,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2725
if (sf2.eq.1)goto 100

i2026i7=i7
m2026m21=n21

do m2026=m2025+1,nqul

i7=i2026i7
n21=m2026m21

print*,'loop2026'
call write_symm_xmi_1(i7,n21,m2026,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2726
if (sf2.eq.1)goto 100

i2027i7=i7
m2027m21=n21

do m2027=m2026+1,nqul

i7=i2027i7
n21=m2027m21

print*,'loop2027'
call write_symm_xmi_1(i7,n21,m2027,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2727
if (sf2.eq.1)goto 100

i2028i7=i7
m2028m21=n21

do m2028=m2027+1,nqul

i7=i2028i7
n21=m2028m21

print*,'loop2028'
call write_symm_xmi_1(i7,n21,m2028,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2728
if (sf2.eq.1)goto 100

i2029i7=i7
m2029m21=n21

do m2029=m2028+1,nqul

i7=i2029i7
n21=m2029m21

print*,'loop2029'
call write_symm_xmi_1(i7,n21,m2029,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2729
if (sf2.eq.1)goto 100

i2030i7=i7
m2030m21=n21

do m2030=m2029+1,nqul

i7=i2030i7
n21=m2030m21

print*,'loop2030'
call write_symm_xmi_1(i7,n21,m2030,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2730
if (sf2.eq.1)goto 100

i2031i7=i7
m2031m21=n21

do m2031=m2030+1,nqul

i7=i2031i7
n21=m2031m21

print*,'loop2031'
call write_symm_xmi_1(i7,n21,m2031,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2731
if (sf2.eq.1)goto 100

i2032i7=i7
m2032m21=n21

do m2032=m2031+1,nqul

i7=i2032i7
n21=m2032m21

print*,'loop2032'
call write_symm_xmi_1(i7,n21,m2032,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2732
if (sf2.eq.1)goto 100

i2033i7=i7
m2033m21=n21

do m2033=m2032+1,nqul

i7=i2033i7
n21=m2033m21

print*,'loop2033'
call write_symm_xmi_1(i7,n21,m2033,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2733
if (sf2.eq.1)goto 100

i2034i7=i7
m2034m21=n21

do m2034=m2033+1,nqul

i7=i2034i7
n21=m2034m21

print*,'loop2034'
call write_symm_xmi_1(i7,n21,m2034,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2734
if (sf2.eq.1)goto 100

i2035i7=i7
m2035m21=n21

do m2035=m2034+1,nqul

i7=i2035i7
n21=m2035m21

print*,'loop2035'
call write_symm_xmi_1(i7,n21,m2035,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2735
if (sf2.eq.1)goto 100

i2036i7=i7
m2036m21=n21

do m2036=m2035+1,nqul

i7=i2036i7
n21=m2036m21

print*,'loop2036'
call write_symm_xmi_1(i7,n21,m2036,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2736
if (sf2.eq.1)goto 100

i2037i7=i7
m2037m21=n21

do m2037=m2036+1,nqul

i7=i2037i7
n21=m2037m21

print*,'loop2037'
call write_symm_xmi_1(i7,n21,m2037,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2737
if (sf2.eq.1)goto 100

i2038i7=i7
m2038m21=n21

do m2038=m2037+1,nqul

i7=i2038i7
n21=m2038m21

print*,'loop2038'
call write_symm_xmi_1(i7,n21,m2038,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2738
if (sf2.eq.1)goto 100

i2039i7=i7
m2039m21=n21

do m2039=m2038+1,nqul

i7=i2039i7
n21=m2039m21

print*,'loop2039'
call write_symm_xmi_1(i7,n21,m2039,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2739
if (sf2.eq.1)goto 100

i2040i7=i7
m2040m21=n21

do m2040=m2039+1,nqul

i7=i2040i7
n21=m2040m21

print*,'loop2040'
call write_symm_xmi_1(i7,n21,m2040,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2740
if (sf2.eq.1)goto 100

i2041i7=i7
m2041m21=n21

do m2041=m2040+1,nqul

i7=i2041i7
n21=m2041m21

print*,'loop2041'
call write_symm_xmi_1(i7,n21,m2041,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2741
if (sf2.eq.1)goto 100

i2042i7=i7
m2042m21=n21

do m2042=m2041+1,nqul

i7=i2042i7
n21=m2042m21

print*,'loop2042'
call write_symm_xmi_1(i7,n21,m2042,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2742
if (sf2.eq.1)goto 100

i2043i7=i7
m2043m21=n21

do m2043=m2042+1,nqul

i7=i2043i7
n21=m2043m21

print*,'loop2043'
call write_symm_xmi_1(i7,n21,m2043,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2743
if (sf2.eq.1)goto 100

i2044i7=i7
m2044m21=n21

do m2044=m2043+1,nqul

i7=i2044i7
n21=m2044m21

print*,'loop2044'
call write_symm_xmi_1(i7,n21,m2044,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2744
if (sf2.eq.1)goto 100

i2045i7=i7
m2045m21=n21

do m2045=m2044+1,nqul

i7=i2045i7
n21=m2045m21

print*,'loop2045'
call write_symm_xmi_1(i7,n21,m2045,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2745
if (sf2.eq.1)goto 100

i2046i7=i7
m2046m21=n21

do m2046=m2045+1,nqul

i7=i2046i7
n21=m2046m21

print*,'loop2046'
call write_symm_xmi_1(i7,n21,m2046,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2746
if (sf2.eq.1)goto 100

i2047i7=i7
m2047m21=n21

do m2047=m2046+1,nqul

i7=i2047i7
n21=m2047m21

print*,'loop2047'
call write_symm_xmi_1(i7,n21,m2047,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2747
if (sf2.eq.1)goto 100

i2048i7=i7
m2048m21=n21

do m2048=m2047+1,nqul

i7=i2048i7
n21=m2048m21

print*,'loop2048'
call write_symm_xmi_1(i7,n21,m2048,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2748
if (sf2.eq.1)goto 100

i2049i7=i7
m2049m21=n21

do m2049=m2048+1,nqul

i7=i2049i7
n21=m2049m21

print*,'loop2049'
call write_symm_xmi_1(i7,n21,m2049,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2749
if (sf2.eq.1)goto 100

i2050i7=i7
m2050m21=n21

do m2050=m2049+1,nqul

i7=i2050i7
n21=m2050m21

print*,'loop2050'
call write_symm_xmi_1(i7,n21,m2050,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2750
if (sf2.eq.1)goto 100

i2051i7=i7
m2051m21=n21

do m2051=m2050+1,nqul

i7=i2051i7
n21=m2051m21

print*,'loop2051'
call write_symm_xmi_1(i7,n21,m2051,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2751
if (sf2.eq.1)goto 100

i2052i7=i7
m2052m21=n21

do m2052=m2051+1,nqul

i7=i2052i7
n21=m2052m21

print*,'loop2052'
call write_symm_xmi_1(i7,n21,m2052,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2752
if (sf2.eq.1)goto 100

i2053i7=i7
m2053m21=n21

do m2053=m2052+1,nqul

i7=i2053i7
n21=m2053m21

print*,'loop2053'
call write_symm_xmi_1(i7,n21,m2053,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2753
if (sf2.eq.1)goto 100

i2054i7=i7
m2054m21=n21

do m2054=m2053+1,nqul

i7=i2054i7
n21=m2054m21

print*,'loop2054'
call write_symm_xmi_1(i7,n21,m2054,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2754
if (sf2.eq.1)goto 100

i2055i7=i7
m2055m21=n21

do m2055=m2054+1,nqul

i7=i2055i7
n21=m2055m21

print*,'loop2055'
call write_symm_xmi_1(i7,n21,m2055,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2755
if (sf2.eq.1)goto 100

i2056i7=i7
m2056m21=n21

do m2056=m2055+1,nqul

i7=i2056i7
n21=m2056m21

print*,'loop2056'
call write_symm_xmi_1(i7,n21,m2056,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2756
if (sf2.eq.1)goto 100

i2057i7=i7
m2057m21=n21

do m2057=m2056+1,nqul

i7=i2057i7
n21=m2057m21

print*,'loop2057'
call write_symm_xmi_1(i7,n21,m2057,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2757
if (sf2.eq.1)goto 100

i2058i7=i7
m2058m21=n21

do m2058=m2057+1,nqul

i7=i2058i7
n21=m2058m21

print*,'loop2058'
call write_symm_xmi_1(i7,n21,m2058,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2758
if (sf2.eq.1)goto 100

i2059i7=i7
m2059m21=n21

do m2059=m2058+1,nqul

i7=i2059i7
n21=m2059m21

print*,'loop2059'
call write_symm_xmi_1(i7,n21,m2059,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2759
if (sf2.eq.1)goto 100

i2060i7=i7
m2060m21=n21

do m2060=m2059+1,nqul

i7=i2060i7
n21=m2060m21

print*,'loop2060'
call write_symm_xmi_1(i7,n21,m2060,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2760
if (sf2.eq.1)goto 100

i2061i7=i7
m2061m21=n21

do m2061=m2060+1,nqul

i7=i2061i7
n21=m2061m21

print*,'loop2061'
call write_symm_xmi_1(i7,n21,m2061,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2761
if (sf2.eq.1)goto 100

i2062i7=i7
m2062m21=n21

do m2062=m2061+1,nqul

i7=i2062i7
n21=m2062m21

print*,'loop2062'
call write_symm_xmi_1(i7,n21,m2062,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2762
if (sf2.eq.1)goto 100

i2063i7=i7
m2063m21=n21

do m2063=m2062+1,nqul

i7=i2063i7
n21=m2063m21

print*,'loop2063'
call write_symm_xmi_1(i7,n21,m2063,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2763
if (sf2.eq.1)goto 100

i2064i7=i7
m2064m21=n21

do m2064=m2063+1,nqul

i7=i2064i7
n21=m2064m21

print*,'loop2064'
call write_symm_xmi_1(i7,n21,m2064,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2764
if (sf2.eq.1)goto 100

i2065i7=i7
m2065m21=n21

do m2065=m2064+1,nqul

i7=i2065i7
n21=m2065m21

print*,'loop2065'
call write_symm_xmi_1(i7,n21,m2065,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2765
if (sf2.eq.1)goto 100

i2066i7=i7
m2066m21=n21

do m2066=m2065+1,nqul

i7=i2066i7
n21=m2066m21

print*,'loop2066'
call write_symm_xmi_1(i7,n21,m2066,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2766
if (sf2.eq.1)goto 100

i2067i7=i7
m2067m21=n21

do m2067=m2066+1,nqul

i7=i2067i7
n21=m2067m21

print*,'loop2067'
call write_symm_xmi_1(i7,n21,m2067,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2767
if (sf2.eq.1)goto 100

i2068i7=i7
m2068m21=n21

do m2068=m2067+1,nqul

i7=i2068i7
n21=m2068m21

print*,'loop2068'
call write_symm_xmi_1(i7,n21,m2068,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2768
if (sf2.eq.1)goto 100

i2069i7=i7
m2069m21=n21

do m2069=m2068+1,nqul

i7=i2069i7
n21=m2069m21

print*,'loop2069'
call write_symm_xmi_1(i7,n21,m2069,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2769
if (sf2.eq.1)goto 100

i2070i7=i7
m2070m21=n21

do m2070=m2069+1,nqul

i7=i2070i7
n21=m2070m21

print*,'loop2070'
call write_symm_xmi_1(i7,n21,m2070,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2770
if (sf2.eq.1)goto 100

i2071i7=i7
m2071m21=n21

do m2071=m2070+1,nqul

i7=i2071i7
n21=m2071m21

print*,'loop2071'
call write_symm_xmi_1(i7,n21,m2071,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2771
if (sf2.eq.1)goto 100

i2072i7=i7
m2072m21=n21

do m2072=m2071+1,nqul

i7=i2072i7
n21=m2072m21

print*,'loop2072'
call write_symm_xmi_1(i7,n21,m2072,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2772
if (sf2.eq.1)goto 100

i2073i7=i7
m2073m21=n21

do m2073=m2072+1,nqul

i7=i2073i7
n21=m2073m21

print*,'loop2073'
call write_symm_xmi_1(i7,n21,m2073,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2773
if (sf2.eq.1)goto 100

i2074i7=i7
m2074m21=n21

do m2074=m2073+1,nqul

i7=i2074i7
n21=m2074m21

print*,'loop2074'
call write_symm_xmi_1(i7,n21,m2074,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2774
if (sf2.eq.1)goto 100

i2075i7=i7
m2075m21=n21

do m2075=m2074+1,nqul

i7=i2075i7
n21=m2075m21

print*,'loop2075'
call write_symm_xmi_1(i7,n21,m2075,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2775
if (sf2.eq.1)goto 100

i2076i7=i7
m2076m21=n21

do m2076=m2075+1,nqul

i7=i2076i7
n21=m2076m21

print*,'loop2076'
call write_symm_xmi_1(i7,n21,m2076,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2776
if (sf2.eq.1)goto 100

i2077i7=i7
m2077m21=n21

do m2077=m2076+1,nqul

i7=i2077i7
n21=m2077m21

print*,'loop2077'
call write_symm_xmi_1(i7,n21,m2077,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2777
if (sf2.eq.1)goto 100

i2078i7=i7
m2078m21=n21

do m2078=m2077+1,nqul

i7=i2078i7
n21=m2078m21

print*,'loop2078'
call write_symm_xmi_1(i7,n21,m2078,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2778
if (sf2.eq.1)goto 100

i2079i7=i7
m2079m21=n21

do m2079=m2078+1,nqul

i7=i2079i7
n21=m2079m21

print*,'loop2079'
call write_symm_xmi_1(i7,n21,m2079,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2779
if (sf2.eq.1)goto 100

i2080i7=i7
m2080m21=n21

do m2080=m2079+1,nqul

i7=i2080i7
n21=m2080m21

print*,'loop2080'
call write_symm_xmi_1(i7,n21,m2080,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2780
if (sf2.eq.1)goto 100

i2081i7=i7
m2081m21=n21

do m2081=m2080+1,nqul

i7=i2081i7
n21=m2081m21

print*,'loop2081'
call write_symm_xmi_1(i7,n21,m2081,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2781
if (sf2.eq.1)goto 100

i2082i7=i7
m2082m21=n21

do m2082=m2081+1,nqul

i7=i2082i7
n21=m2082m21

print*,'loop2082'
call write_symm_xmi_1(i7,n21,m2082,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2782
if (sf2.eq.1)goto 100

i2083i7=i7
m2083m21=n21

do m2083=m2082+1,nqul

i7=i2083i7
n21=m2083m21

print*,'loop2083'
call write_symm_xmi_1(i7,n21,m2083,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2783
if (sf2.eq.1)goto 100

i2084i7=i7
m2084m21=n21

do m2084=m2083+1,nqul

i7=i2084i7
n21=m2084m21

print*,'loop2084'
call write_symm_xmi_1(i7,n21,m2084,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2784
if (sf2.eq.1)goto 100

i2085i7=i7
m2085m21=n21

do m2085=m2084+1,nqul

i7=i2085i7
n21=m2085m21

print*,'loop2085'
call write_symm_xmi_1(i7,n21,m2085,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2785
if (sf2.eq.1)goto 100

i2086i7=i7
m2086m21=n21

do m2086=m2085+1,nqul

i7=i2086i7
n21=m2086m21

print*,'loop2086'
call write_symm_xmi_1(i7,n21,m2086,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2786
if (sf2.eq.1)goto 100

i2087i7=i7
m2087m21=n21

do m2087=m2086+1,nqul

i7=i2087i7
n21=m2087m21

print*,'loop2087'
call write_symm_xmi_1(i7,n21,m2087,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2787
if (sf2.eq.1)goto 100

i2088i7=i7
m2088m21=n21

do m2088=m2087+1,nqul

i7=i2088i7
n21=m2088m21

print*,'loop2088'
call write_symm_xmi_1(i7,n21,m2088,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2788
if (sf2.eq.1)goto 100

i2089i7=i7
m2089m21=n21

do m2089=m2088+1,nqul

i7=i2089i7
n21=m2089m21

print*,'loop2089'
call write_symm_xmi_1(i7,n21,m2089,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2789
if (sf2.eq.1)goto 100

i2090i7=i7
m2090m21=n21

do m2090=m2089+1,nqul

i7=i2090i7
n21=m2090m21

print*,'loop2090'
call write_symm_xmi_1(i7,n21,m2090,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2790
if (sf2.eq.1)goto 100

i2091i7=i7
m2091m21=n21

do m2091=m2090+1,nqul

i7=i2091i7
n21=m2091m21

print*,'loop2091'
call write_symm_xmi_1(i7,n21,m2091,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2791
if (sf2.eq.1)goto 100

i2092i7=i7
m2092m21=n21

do m2092=m2091+1,nqul

i7=i2092i7
n21=m2092m21

print*,'loop2092'
call write_symm_xmi_1(i7,n21,m2092,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2792
if (sf2.eq.1)goto 100

i2093i7=i7
m2093m21=n21

do m2093=m2092+1,nqul

i7=i2093i7
n21=m2093m21

print*,'loop2093'
call write_symm_xmi_1(i7,n21,m2093,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2793
if (sf2.eq.1)goto 100

i2094i7=i7
m2094m21=n21

do m2094=m2093+1,nqul

i7=i2094i7
n21=m2094m21

print*,'loop2094'
call write_symm_xmi_1(i7,n21,m2094,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2794
if (sf2.eq.1)goto 100

i2095i7=i7
m2095m21=n21

do m2095=m2094+1,nqul

i7=i2095i7
n21=m2095m21

print*,'loop2095'
call write_symm_xmi_1(i7,n21,m2095,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2795
if (sf2.eq.1)goto 100

i2096i7=i7
m2096m21=n21

do m2096=m2095+1,nqul

i7=i2096i7
n21=m2096m21

print*,'loop2096'
call write_symm_xmi_1(i7,n21,m2096,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2796
if (sf2.eq.1)goto 100

i2097i7=i7
m2097m21=n21

do m2097=m2096+1,nqul

i7=i2097i7
n21=m2097m21

print*,'loop2097'
call write_symm_xmi_1(i7,n21,m2097,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2797
if (sf2.eq.1)goto 100

i2098i7=i7
m2098m21=n21

do m2098=m2097+1,nqul

i7=i2098i7
n21=m2098m21

print*,'loop2098'
call write_symm_xmi_1(i7,n21,m2098,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2798
if (sf2.eq.1)goto 100

i2099i7=i7
m2099m21=n21

do m2099=m2098+1,nqul

i7=i2099i7
n21=m2099m21

print*,'loop2099'
call write_symm_xmi_1(i7,n21,m2099,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2799
if (sf2.eq.1)goto 100

i2100i7=i7
m2100m21=n21

do m2100=m2099+1,nqul

i7=i2100i7
n21=m2100m21

print*,'loop2100'
call write_symm_xmi_1(i7,n21,m2100,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2800
if (sf2.eq.1)goto 100

i2101i7=i7
m2101m21=n21

do m2101=m2100+1,nqul

i7=i2101i7
n21=m2101m21

print*,'loop2101'
call write_symm_xmi_1(i7,n21,m2101,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2801
if (sf2.eq.1)goto 100

i2102i7=i7
m2102m21=n21

do m2102=m2101+1,nqul

i7=i2102i7
n21=m2102m21

print*,'loop2102'
call write_symm_xmi_1(i7,n21,m2102,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2802
if (sf2.eq.1)goto 100

i2103i7=i7
m2103m21=n21

do m2103=m2102+1,nqul

i7=i2103i7
n21=m2103m21

print*,'loop2103'
call write_symm_xmi_1(i7,n21,m2103,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2803
if (sf2.eq.1)goto 100

i2104i7=i7
m2104m21=n21

do m2104=m2103+1,nqul

i7=i2104i7
n21=m2104m21

print*,'loop2104'
call write_symm_xmi_1(i7,n21,m2104,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2804
if (sf2.eq.1)goto 100

i2105i7=i7
m2105m21=n21

do m2105=m2104+1,nqul

i7=i2105i7
n21=m2105m21

print*,'loop2105'
call write_symm_xmi_1(i7,n21,m2105,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2805
if (sf2.eq.1)goto 100

i2106i7=i7
m2106m21=n21

do m2106=m2105+1,nqul

i7=i2106i7
n21=m2106m21

print*,'loop2106'
call write_symm_xmi_1(i7,n21,m2106,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2806
if (sf2.eq.1)goto 100

i2107i7=i7
m2107m21=n21

do m2107=m2106+1,nqul

i7=i2107i7
n21=m2107m21

print*,'loop2107'
call write_symm_xmi_1(i7,n21,m2107,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2807
if (sf2.eq.1)goto 100

i2108i7=i7
m2108m21=n21

do m2108=m2107+1,nqul

i7=i2108i7
n21=m2108m21

print*,'loop2108'
call write_symm_xmi_1(i7,n21,m2108,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2808
if (sf2.eq.1)goto 100

i2109i7=i7
m2109m21=n21

do m2109=m2108+1,nqul

i7=i2109i7
n21=m2109m21

print*,'loop2109'
call write_symm_xmi_1(i7,n21,m2109,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2809
if (sf2.eq.1)goto 100

i2110i7=i7
m2110m21=n21

do m2110=m2109+1,nqul

i7=i2110i7
n21=m2110m21

print*,'loop2110'
call write_symm_xmi_1(i7,n21,m2110,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2810
if (sf2.eq.1)goto 100

i2111i7=i7
m2111m21=n21

do m2111=m2110+1,nqul

i7=i2111i7
n21=m2111m21

print*,'loop2111'
call write_symm_xmi_1(i7,n21,m2111,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2811
if (sf2.eq.1)goto 100

i2112i7=i7
m2112m21=n21

do m2112=m2111+1,nqul

i7=i2112i7
n21=m2112m21

print*,'loop2112'
call write_symm_xmi_1(i7,n21,m2112,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2812
if (sf2.eq.1)goto 100

i2113i7=i7
m2113m21=n21

do m2113=m2112+1,nqul

i7=i2113i7
n21=m2113m21

print*,'loop2113'
call write_symm_xmi_1(i7,n21,m2113,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2813
if (sf2.eq.1)goto 100

i2114i7=i7
m2114m21=n21

do m2114=m2113+1,nqul

i7=i2114i7
n21=m2114m21

print*,'loop2114'
call write_symm_xmi_1(i7,n21,m2114,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2814
if (sf2.eq.1)goto 100

i2115i7=i7
m2115m21=n21

do m2115=m2114+1,nqul

i7=i2115i7
n21=m2115m21

print*,'loop2115'
call write_symm_xmi_1(i7,n21,m2115,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2815
if (sf2.eq.1)goto 100

i2116i7=i7
m2116m21=n21

do m2116=m2115+1,nqul

i7=i2116i7
n21=m2116m21

print*,'loop2116'
call write_symm_xmi_1(i7,n21,m2116,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2816
if (sf2.eq.1)goto 100

i2117i7=i7
m2117m21=n21

do m2117=m2116+1,nqul

i7=i2117i7
n21=m2117m21

print*,'loop2117'
call write_symm_xmi_1(i7,n21,m2117,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2817
if (sf2.eq.1)goto 100

i2118i7=i7
m2118m21=n21

do m2118=m2117+1,nqul

i7=i2118i7
n21=m2118m21

print*,'loop2118'
call write_symm_xmi_1(i7,n21,m2118,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2818
if (sf2.eq.1)goto 100

i2119i7=i7
m2119m21=n21

do m2119=m2118+1,nqul

i7=i2119i7
n21=m2119m21

print*,'loop2119'
call write_symm_xmi_1(i7,n21,m2119,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2819
if (sf2.eq.1)goto 100

i2120i7=i7
m2120m21=n21

do m2120=m2119+1,nqul

i7=i2120i7
n21=m2120m21

print*,'loop2120'
call write_symm_xmi_1(i7,n21,m2120,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2820
if (sf2.eq.1)goto 100

i2121i7=i7
m2121m21=n21

do m2121=m2120+1,nqul

i7=i2121i7
n21=m2121m21

print*,'loop2121'
call write_symm_xmi_1(i7,n21,m2121,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2821
if (sf2.eq.1)goto 100

i2122i7=i7
m2122m21=n21

do m2122=m2121+1,nqul

i7=i2122i7
n21=m2122m21

print*,'loop2122'
call write_symm_xmi_1(i7,n21,m2122,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2822
if (sf2.eq.1)goto 100

i2123i7=i7
m2123m21=n21

do m2123=m2122+1,nqul

i7=i2123i7
n21=m2123m21

print*,'loop2123'
call write_symm_xmi_1(i7,n21,m2123,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2823
if (sf2.eq.1)goto 100

i2124i7=i7
m2124m21=n21

do m2124=m2123+1,nqul

i7=i2124i7
n21=m2124m21

print*,'loop2124'
call write_symm_xmi_1(i7,n21,m2124,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2824
if (sf2.eq.1)goto 100

i2125i7=i7
m2125m21=n21

do m2125=m2124+1,nqul

i7=i2125i7
n21=m2125m21

print*,'loop2125'
call write_symm_xmi_1(i7,n21,m2125,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2825
if (sf2.eq.1)goto 100

i2126i7=i7
m2126m21=n21

do m2126=m2125+1,nqul

i7=i2126i7
n21=m2126m21

print*,'loop2126'
call write_symm_xmi_1(i7,n21,m2126,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2826
if (sf2.eq.1)goto 100

i2127i7=i7
m2127m21=n21

do m2127=m2126+1,nqul

i7=i2127i7
n21=m2127m21

print*,'loop2127'
call write_symm_xmi_1(i7,n21,m2127,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2827
if (sf2.eq.1)goto 100

i2128i7=i7
m2128m21=n21

do m2128=m2127+1,nqul

i7=i2128i7
n21=m2128m21

print*,'loop2128'
call write_symm_xmi_1(i7,n21,m2128,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2828
if (sf2.eq.1)goto 100

i2129i7=i7
m2129m21=n21

do m2129=m2128+1,nqul

i7=i2129i7
n21=m2129m21

print*,'loop2129'
call write_symm_xmi_1(i7,n21,m2129,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2829
if (sf2.eq.1)goto 100

i2130i7=i7
m2130m21=n21

do m2130=m2129+1,nqul

i7=i2130i7
n21=m2130m21

print*,'loop2130'
call write_symm_xmi_1(i7,n21,m2130,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2830
if (sf2.eq.1)goto 100

i2131i7=i7
m2131m21=n21

do m2131=m2130+1,nqul

i7=i2131i7
n21=m2131m21

print*,'loop2131'
call write_symm_xmi_1(i7,n21,m2131,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2831
if (sf2.eq.1)goto 100

i2132i7=i7
m2132m21=n21

do m2132=m2131+1,nqul

i7=i2132i7
n21=m2132m21

print*,'loop2132'
call write_symm_xmi_1(i7,n21,m2132,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2832
if (sf2.eq.1)goto 100

i2133i7=i7
m2133m21=n21

do m2133=m2132+1,nqul

i7=i2133i7
n21=m2133m21

print*,'loop2133'
call write_symm_xmi_1(i7,n21,m2133,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2833
if (sf2.eq.1)goto 100

i2134i7=i7
m2134m21=n21

do m2134=m2133+1,nqul

i7=i2134i7
n21=m2134m21

print*,'loop2134'
call write_symm_xmi_1(i7,n21,m2134,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2834
if (sf2.eq.1)goto 100

i2135i7=i7
m2135m21=n21

do m2135=m2134+1,nqul

i7=i2135i7
n21=m2135m21

print*,'loop2135'
call write_symm_xmi_1(i7,n21,m2135,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2835
if (sf2.eq.1)goto 100

i2136i7=i7
m2136m21=n21

do m2136=m2135+1,nqul

i7=i2136i7
n21=m2136m21

print*,'loop2136'
call write_symm_xmi_1(i7,n21,m2136,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2836
if (sf2.eq.1)goto 100

i2137i7=i7
m2137m21=n21

do m2137=m2136+1,nqul

i7=i2137i7
n21=m2137m21

print*,'loop2137'
call write_symm_xmi_1(i7,n21,m2137,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2837
if (sf2.eq.1)goto 100

i2138i7=i7
m2138m21=n21

do m2138=m2137+1,nqul

i7=i2138i7
n21=m2138m21

print*,'loop2138'
call write_symm_xmi_1(i7,n21,m2138,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2838
if (sf2.eq.1)goto 100

i2139i7=i7
m2139m21=n21

do m2139=m2138+1,nqul

i7=i2139i7
n21=m2139m21

print*,'loop2139'
call write_symm_xmi_1(i7,n21,m2139,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2839
if (sf2.eq.1)goto 100

i2140i7=i7
m2140m21=n21

do m2140=m2139+1,nqul

i7=i2140i7
n21=m2140m21

print*,'loop2140'
call write_symm_xmi_1(i7,n21,m2140,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2840
if (sf2.eq.1)goto 100

i2141i7=i7
m2141m21=n21

do m2141=m2140+1,nqul

i7=i2141i7
n21=m2141m21

print*,'loop2141'
call write_symm_xmi_1(i7,n21,m2141,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2841
if (sf2.eq.1)goto 100

i2142i7=i7
m2142m21=n21

do m2142=m2141+1,nqul

i7=i2142i7
n21=m2142m21

print*,'loop2142'
call write_symm_xmi_1(i7,n21,m2142,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2842
if (sf2.eq.1)goto 100

i2143i7=i7
m2143m21=n21

do m2143=m2142+1,nqul

i7=i2143i7
n21=m2143m21

print*,'loop2143'
call write_symm_xmi_1(i7,n21,m2143,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2843
if (sf2.eq.1)goto 100

i2144i7=i7
m2144m21=n21

do m2144=m2143+1,nqul

i7=i2144i7
n21=m2144m21

print*,'loop2144'
call write_symm_xmi_1(i7,n21,m2144,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2844
if (sf2.eq.1)goto 100

i2145i7=i7
m2145m21=n21

do m2145=m2144+1,nqul

i7=i2145i7
n21=m2145m21

print*,'loop2145'
call write_symm_xmi_1(i7,n21,m2145,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2845
if (sf2.eq.1)goto 100

i2146i7=i7
m2146m21=n21

do m2146=m2145+1,nqul

i7=i2146i7
n21=m2146m21

print*,'loop2146'
call write_symm_xmi_1(i7,n21,m2146,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2846
if (sf2.eq.1)goto 100

i2147i7=i7
m2147m21=n21

do m2147=m2146+1,nqul

i7=i2147i7
n21=m2147m21

print*,'loop2147'
call write_symm_xmi_1(i7,n21,m2147,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2847
if (sf2.eq.1)goto 100

i2148i7=i7
m2148m21=n21

do m2148=m2147+1,nqul

i7=i2148i7
n21=m2148m21

print*,'loop2148'
call write_symm_xmi_1(i7,n21,m2148,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2848
if (sf2.eq.1)goto 100

i2149i7=i7
m2149m21=n21

do m2149=m2148+1,nqul

i7=i2149i7
n21=m2149m21

print*,'loop2149'
call write_symm_xmi_1(i7,n21,m2149,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2849
if (sf2.eq.1)goto 100

i2150i7=i7
m2150m21=n21

do m2150=m2149+1,nqul

i7=i2150i7
n21=m2150m21

print*,'loop2150'
call write_symm_xmi_1(i7,n21,m2150,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2850
if (sf2.eq.1)goto 100

i2151i7=i7
m2151m21=n21

do m2151=m2150+1,nqul

i7=i2151i7
n21=m2151m21

print*,'loop2151'
call write_symm_xmi_1(i7,n21,m2151,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2851
if (sf2.eq.1)goto 100

i2152i7=i7
m2152m21=n21

do m2152=m2151+1,nqul

i7=i2152i7
n21=m2152m21

print*,'loop2152'
call write_symm_xmi_1(i7,n21,m2152,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2852
if (sf2.eq.1)goto 100

i2153i7=i7
m2153m21=n21

do m2153=m2152+1,nqul

i7=i2153i7
n21=m2153m21

print*,'loop2153'
call write_symm_xmi_1(i7,n21,m2153,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2853
if (sf2.eq.1)goto 100

i2154i7=i7
m2154m21=n21

do m2154=m2153+1,nqul

i7=i2154i7
n21=m2154m21

print*,'loop2154'
call write_symm_xmi_1(i7,n21,m2154,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2854
if (sf2.eq.1)goto 100

i2155i7=i7
m2155m21=n21

do m2155=m2154+1,nqul

i7=i2155i7
n21=m2155m21

print*,'loop2155'
call write_symm_xmi_1(i7,n21,m2155,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2855
if (sf2.eq.1)goto 100

i2156i7=i7
m2156m21=n21

do m2156=m2155+1,nqul

i7=i2156i7
n21=m2156m21

print*,'loop2156'
call write_symm_xmi_1(i7,n21,m2156,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2856
if (sf2.eq.1)goto 100

i2157i7=i7
m2157m21=n21

do m2157=m2156+1,nqul

i7=i2157i7
n21=m2157m21

print*,'loop2157'
call write_symm_xmi_1(i7,n21,m2157,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2857
if (sf2.eq.1)goto 100

i2158i7=i7
m2158m21=n21

do m2158=m2157+1,nqul

i7=i2158i7
n21=m2158m21

print*,'loop2158'
call write_symm_xmi_1(i7,n21,m2158,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2858
if (sf2.eq.1)goto 100

i2159i7=i7
m2159m21=n21

do m2159=m2158+1,nqul

i7=i2159i7
n21=m2159m21

print*,'loop2159'
call write_symm_xmi_1(i7,n21,m2159,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2859
if (sf2.eq.1)goto 100

i2160i7=i7
m2160m21=n21

do m2160=m2159+1,nqul

i7=i2160i7
n21=m2160m21

print*,'loop2160'
call write_symm_xmi_1(i7,n21,m2160,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2860
if (sf2.eq.1)goto 100

i2161i7=i7
m2161m21=n21

do m2161=m2160+1,nqul

i7=i2161i7
n21=m2161m21

print*,'loop2161'
call write_symm_xmi_1(i7,n21,m2161,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2861
if (sf2.eq.1)goto 100

i2162i7=i7
m2162m21=n21

do m2162=m2161+1,nqul

i7=i2162i7
n21=m2162m21

print*,'loop2162'
call write_symm_xmi_1(i7,n21,m2162,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2862
if (sf2.eq.1)goto 100

i2163i7=i7
m2163m21=n21

do m2163=m2162+1,nqul

i7=i2163i7
n21=m2163m21

print*,'loop2163'
call write_symm_xmi_1(i7,n21,m2163,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2863
if (sf2.eq.1)goto 100

i2164i7=i7
m2164m21=n21

do m2164=m2163+1,nqul

i7=i2164i7
n21=m2164m21

print*,'loop2164'
call write_symm_xmi_1(i7,n21,m2164,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2864
if (sf2.eq.1)goto 100

i2165i7=i7
m2165m21=n21

do m2165=m2164+1,nqul

i7=i2165i7
n21=m2165m21

print*,'loop2165'
call write_symm_xmi_1(i7,n21,m2165,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2865
if (sf2.eq.1)goto 100

i2166i7=i7
m2166m21=n21

do m2166=m2165+1,nqul

i7=i2166i7
n21=m2166m21

print*,'loop2166'
call write_symm_xmi_1(i7,n21,m2166,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2866
if (sf2.eq.1)goto 100

i2167i7=i7
m2167m21=n21

do m2167=m2166+1,nqul

i7=i2167i7
n21=m2167m21

print*,'loop2167'
call write_symm_xmi_1(i7,n21,m2167,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2867
if (sf2.eq.1)goto 100

i2168i7=i7
m2168m21=n21

do m2168=m2167+1,nqul

i7=i2168i7
n21=m2168m21

print*,'loop2168'
call write_symm_xmi_1(i7,n21,m2168,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2868
if (sf2.eq.1)goto 100

i2169i7=i7
m2169m21=n21

do m2169=m2168+1,nqul

i7=i2169i7
n21=m2169m21

print*,'loop2169'
call write_symm_xmi_1(i7,n21,m2169,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2869
if (sf2.eq.1)goto 100

i2170i7=i7
m2170m21=n21

do m2170=m2169+1,nqul

i7=i2170i7
n21=m2170m21

print*,'loop2170'
call write_symm_xmi_1(i7,n21,m2170,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2870
if (sf2.eq.1)goto 100

i2171i7=i7
m2171m21=n21

do m2171=m2170+1,nqul

i7=i2171i7
n21=m2171m21

print*,'loop2171'
call write_symm_xmi_1(i7,n21,m2171,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2871
if (sf2.eq.1)goto 100

i2172i7=i7
m2172m21=n21

do m2172=m2171+1,nqul

i7=i2172i7
n21=m2172m21

print*,'loop2172'
call write_symm_xmi_1(i7,n21,m2172,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2872
if (sf2.eq.1)goto 100

i2173i7=i7
m2173m21=n21

do m2173=m2172+1,nqul

i7=i2173i7
n21=m2173m21

print*,'loop2173'
call write_symm_xmi_1(i7,n21,m2173,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2873
if (sf2.eq.1)goto 100

i2174i7=i7
m2174m21=n21

do m2174=m2173+1,nqul

i7=i2174i7
n21=m2174m21

print*,'loop2174'
call write_symm_xmi_1(i7,n21,m2174,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2874
if (sf2.eq.1)goto 100

i2175i7=i7
m2175m21=n21

do m2175=m2174+1,nqul

i7=i2175i7
n21=m2175m21

print*,'loop2175'
call write_symm_xmi_1(i7,n21,m2175,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2875
if (sf2.eq.1)goto 100

i2176i7=i7
m2176m21=n21

do m2176=m2175+1,nqul

i7=i2176i7
n21=m2176m21

print*,'loop2176'
call write_symm_xmi_1(i7,n21,m2176,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2876
if (sf2.eq.1)goto 100

i2177i7=i7
m2177m21=n21

do m2177=m2176+1,nqul

i7=i2177i7
n21=m2177m21

print*,'loop2177'
call write_symm_xmi_1(i7,n21,m2177,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2877
if (sf2.eq.1)goto 100

i2178i7=i7
m2178m21=n21

do m2178=m2177+1,nqul

i7=i2178i7
n21=m2178m21

print*,'loop2178'
call write_symm_xmi_1(i7,n21,m2178,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2878
if (sf2.eq.1)goto 100

i2179i7=i7
m2179m21=n21

do m2179=m2178+1,nqul

i7=i2179i7
n21=m2179m21

print*,'loop2179'
call write_symm_xmi_1(i7,n21,m2179,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2879
if (sf2.eq.1)goto 100

i2180i7=i7
m2180m21=n21

do m2180=m2179+1,nqul

i7=i2180i7
n21=m2180m21

print*,'loop2180'
call write_symm_xmi_1(i7,n21,m2180,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2880
if (sf2.eq.1)goto 100

i2181i7=i7
m2181m21=n21

do m2181=m2180+1,nqul

i7=i2181i7
n21=m2181m21

print*,'loop2181'
call write_symm_xmi_1(i7,n21,m2181,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2881
if (sf2.eq.1)goto 100

i2182i7=i7
m2182m21=n21

do m2182=m2181+1,nqul

i7=i2182i7
n21=m2182m21

print*,'loop2182'
call write_symm_xmi_1(i7,n21,m2182,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2882
if (sf2.eq.1)goto 100

i2183i7=i7
m2183m21=n21

do m2183=m2182+1,nqul

i7=i2183i7
n21=m2183m21

print*,'loop2183'
call write_symm_xmi_1(i7,n21,m2183,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2883
if (sf2.eq.1)goto 100

i2184i7=i7
m2184m21=n21

do m2184=m2183+1,nqul

i7=i2184i7
n21=m2184m21

print*,'loop2184'
call write_symm_xmi_1(i7,n21,m2184,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2884
if (sf2.eq.1)goto 100

i2185i7=i7
m2185m21=n21

do m2185=m2184+1,nqul

i7=i2185i7
n21=m2185m21

print*,'loop2185'
call write_symm_xmi_1(i7,n21,m2185,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2885
if (sf2.eq.1)goto 100

i2186i7=i7
m2186m21=n21

do m2186=m2185+1,nqul

i7=i2186i7
n21=m2186m21

print*,'loop2186'
call write_symm_xmi_1(i7,n21,m2186,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2886
if (sf2.eq.1)goto 100

i2187i7=i7
m2187m21=n21

do m2187=m2186+1,nqul

i7=i2187i7
n21=m2187m21

print*,'loop2187'
call write_symm_xmi_1(i7,n21,m2187,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2887
if (sf2.eq.1)goto 100

i2188i7=i7
m2188m21=n21

do m2188=m2187+1,nqul

i7=i2188i7
n21=m2188m21

print*,'loop2188'
call write_symm_xmi_1(i7,n21,m2188,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2888
if (sf2.eq.1)goto 100

i2189i7=i7
m2189m21=n21

do m2189=m2188+1,nqul

i7=i2189i7
n21=m2189m21

print*,'loop2189'
call write_symm_xmi_1(i7,n21,m2189,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2889
if (sf2.eq.1)goto 100

i2190i7=i7
m2190m21=n21

do m2190=m2189+1,nqul

i7=i2190i7
n21=m2190m21

print*,'loop2190'
call write_symm_xmi_1(i7,n21,m2190,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2890
if (sf2.eq.1)goto 100

i2191i7=i7
m2191m21=n21

do m2191=m2190+1,nqul

i7=i2191i7
n21=m2191m21

print*,'loop2191'
call write_symm_xmi_1(i7,n21,m2191,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2891
if (sf2.eq.1)goto 100

i2192i7=i7
m2192m21=n21

do m2192=m2191+1,nqul

i7=i2192i7
n21=m2192m21

print*,'loop2192'
call write_symm_xmi_1(i7,n21,m2192,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2892
if (sf2.eq.1)goto 100

i2193i7=i7
m2193m21=n21

do m2193=m2192+1,nqul

i7=i2193i7
n21=m2193m21

print*,'loop2193'
call write_symm_xmi_1(i7,n21,m2193,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2893
if (sf2.eq.1)goto 100

i2194i7=i7
m2194m21=n21

do m2194=m2193+1,nqul

i7=i2194i7
n21=m2194m21

print*,'loop2194'
call write_symm_xmi_1(i7,n21,m2194,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2894
if (sf2.eq.1)goto 100

i2195i7=i7
m2195m21=n21

do m2195=m2194+1,nqul

i7=i2195i7
n21=m2195m21

print*,'loop2195'
call write_symm_xmi_1(i7,n21,m2195,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2895
if (sf2.eq.1)goto 100

i2196i7=i7
m2196m21=n21

do m2196=m2195+1,nqul

i7=i2196i7
n21=m2196m21

print*,'loop2196'
call write_symm_xmi_1(i7,n21,m2196,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2896
if (sf2.eq.1)goto 100

i2197i7=i7
m2197m21=n21

do m2197=m2196+1,nqul

i7=i2197i7
n21=m2197m21

print*,'loop2197'
call write_symm_xmi_1(i7,n21,m2197,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2897
if (sf2.eq.1)goto 100

i2198i7=i7
m2198m21=n21

do m2198=m2197+1,nqul

i7=i2198i7
n21=m2198m21

print*,'loop2198'
call write_symm_xmi_1(i7,n21,m2198,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2898
if (sf2.eq.1)goto 100

i2199i7=i7
m2199m21=n21

do m2199=m2198+1,nqul

i7=i2199i7
n21=m2199m21

print*,'loop2199'
call write_symm_xmi_1(i7,n21,m2199,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2899
if (sf2.eq.1)goto 100

i2200i7=i7
m2200m21=n21

do m2200=m2199+1,nqul

i7=i2200i7
n21=m2200m21

print*,'loop2200'
call write_symm_xmi_1(i7,n21,m2200,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2900
if (sf2.eq.1)goto 100

i2201i7=i7
m2201m21=n21

do m2201=m2200+1,nqul

i7=i2201i7
n21=m2201m21

print*,'loop2201'
call write_symm_xmi_1(i7,n21,m2201,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2901
if (sf2.eq.1)goto 100

i2202i7=i7
m2202m21=n21

do m2202=m2201+1,nqul

i7=i2202i7
n21=m2202m21

print*,'loop2202'
call write_symm_xmi_1(i7,n21,m2202,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2902
if (sf2.eq.1)goto 100

i2203i7=i7
m2203m21=n21

do m2203=m2202+1,nqul

i7=i2203i7
n21=m2203m21

print*,'loop2203'
call write_symm_xmi_1(i7,n21,m2203,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2903
if (sf2.eq.1)goto 100

i2204i7=i7
m2204m21=n21

do m2204=m2203+1,nqul

i7=i2204i7
n21=m2204m21

print*,'loop2204'
call write_symm_xmi_1(i7,n21,m2204,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2904
if (sf2.eq.1)goto 100

i2205i7=i7
m2205m21=n21

do m2205=m2204+1,nqul

i7=i2205i7
n21=m2205m21

print*,'loop2205'
call write_symm_xmi_1(i7,n21,m2205,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2905
if (sf2.eq.1)goto 100

i2206i7=i7
m2206m21=n21

do m2206=m2205+1,nqul

i7=i2206i7
n21=m2206m21

print*,'loop2206'
call write_symm_xmi_1(i7,n21,m2206,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2906
if (sf2.eq.1)goto 100

i2207i7=i7
m2207m21=n21

do m2207=m2206+1,nqul

i7=i2207i7
n21=m2207m21

print*,'loop2207'
call write_symm_xmi_1(i7,n21,m2207,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2907
if (sf2.eq.1)goto 100

i2208i7=i7
m2208m21=n21

do m2208=m2207+1,nqul

i7=i2208i7
n21=m2208m21

print*,'loop2208'
call write_symm_xmi_1(i7,n21,m2208,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2908
if (sf2.eq.1)goto 100

i2209i7=i7
m2209m21=n21

do m2209=m2208+1,nqul

i7=i2209i7
n21=m2209m21

print*,'loop2209'
call write_symm_xmi_1(i7,n21,m2209,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2909
if (sf2.eq.1)goto 100

i2210i7=i7
m2210m21=n21

do m2210=m2209+1,nqul

i7=i2210i7
n21=m2210m21

print*,'loop2210'
call write_symm_xmi_1(i7,n21,m2210,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2910
if (sf2.eq.1)goto 100

i2211i7=i7
m2211m21=n21

do m2211=m2210+1,nqul

i7=i2211i7
n21=m2211m21

print*,'loop2211'
call write_symm_xmi_1(i7,n21,m2211,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2911
if (sf2.eq.1)goto 100

i2212i7=i7
m2212m21=n21

do m2212=m2211+1,nqul

i7=i2212i7
n21=m2212m21

print*,'loop2212'
call write_symm_xmi_1(i7,n21,m2212,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2912
if (sf2.eq.1)goto 100

i2213i7=i7
m2213m21=n21

do m2213=m2212+1,nqul

i7=i2213i7
n21=m2213m21

print*,'loop2213'
call write_symm_xmi_1(i7,n21,m2213,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2913
if (sf2.eq.1)goto 100

i2214i7=i7
m2214m21=n21

do m2214=m2213+1,nqul

i7=i2214i7
n21=m2214m21

print*,'loop2214'
call write_symm_xmi_1(i7,n21,m2214,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2914
if (sf2.eq.1)goto 100

i2215i7=i7
m2215m21=n21

do m2215=m2214+1,nqul

i7=i2215i7
n21=m2215m21

print*,'loop2215'
call write_symm_xmi_1(i7,n21,m2215,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2915
if (sf2.eq.1)goto 100

i2216i7=i7
m2216m21=n21

do m2216=m2215+1,nqul

i7=i2216i7
n21=m2216m21

print*,'loop2216'
call write_symm_xmi_1(i7,n21,m2216,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2916
if (sf2.eq.1)goto 100

i2217i7=i7
m2217m21=n21

do m2217=m2216+1,nqul

i7=i2217i7
n21=m2217m21

print*,'loop2217'
call write_symm_xmi_1(i7,n21,m2217,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2917
if (sf2.eq.1)goto 100

i2218i7=i7
m2218m21=n21

do m2218=m2217+1,nqul

i7=i2218i7
n21=m2218m21

print*,'loop2218'
call write_symm_xmi_1(i7,n21,m2218,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2918
if (sf2.eq.1)goto 100

i2219i7=i7
m2219m21=n21

do m2219=m2218+1,nqul

i7=i2219i7
n21=m2219m21

print*,'loop2219'
call write_symm_xmi_1(i7,n21,m2219,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2919
if (sf2.eq.1)goto 100

i2220i7=i7
m2220m21=n21

do m2220=m2219+1,nqul

i7=i2220i7
n21=m2220m21

print*,'loop2220'
call write_symm_xmi_1(i7,n21,m2220,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2920
if (sf2.eq.1)goto 100

i2221i7=i7
m2221m21=n21

do m2221=m2220+1,nqul

i7=i2221i7
n21=m2221m21

print*,'loop2221'
call write_symm_xmi_1(i7,n21,m2221,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2921
if (sf2.eq.1)goto 100

i2222i7=i7
m2222m21=n21

do m2222=m2221+1,nqul

i7=i2222i7
n21=m2222m21

print*,'loop2222'
call write_symm_xmi_1(i7,n21,m2222,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2922
if (sf2.eq.1)goto 100

i2223i7=i7
m2223m21=n21

do m2223=m2222+1,nqul

i7=i2223i7
n21=m2223m21

print*,'loop2223'
call write_symm_xmi_1(i7,n21,m2223,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2923
if (sf2.eq.1)goto 100

i2224i7=i7
m2224m21=n21

do m2224=m2223+1,nqul

i7=i2224i7
n21=m2224m21

print*,'loop2224'
call write_symm_xmi_1(i7,n21,m2224,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2924
if (sf2.eq.1)goto 100

i2225i7=i7
m2225m21=n21

do m2225=m2224+1,nqul

i7=i2225i7
n21=m2225m21

print*,'loop2225'
call write_symm_xmi_1(i7,n21,m2225,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2925
if (sf2.eq.1)goto 100

i2226i7=i7
m2226m21=n21

do m2226=m2225+1,nqul

i7=i2226i7
n21=m2226m21

print*,'loop2226'
call write_symm_xmi_1(i7,n21,m2226,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2926
if (sf2.eq.1)goto 100

i2227i7=i7
m2227m21=n21

do m2227=m2226+1,nqul

i7=i2227i7
n21=m2227m21

print*,'loop2227'
call write_symm_xmi_1(i7,n21,m2227,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2927
if (sf2.eq.1)goto 100

i2228i7=i7
m2228m21=n21

do m2228=m2227+1,nqul

i7=i2228i7
n21=m2228m21

print*,'loop2228'
call write_symm_xmi_1(i7,n21,m2228,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2928
if (sf2.eq.1)goto 100

i2229i7=i7
m2229m21=n21

do m2229=m2228+1,nqul

i7=i2229i7
n21=m2229m21

print*,'loop2229'
call write_symm_xmi_1(i7,n21,m2229,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2929
if (sf2.eq.1)goto 100

i2230i7=i7
m2230m21=n21

do m2230=m2229+1,nqul

i7=i2230i7
n21=m2230m21

print*,'loop2230'
call write_symm_xmi_1(i7,n21,m2230,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2930
if (sf2.eq.1)goto 100

i2231i7=i7
m2231m21=n21

do m2231=m2230+1,nqul

i7=i2231i7
n21=m2231m21

print*,'loop2231'
call write_symm_xmi_1(i7,n21,m2231,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2931
if (sf2.eq.1)goto 100

i2232i7=i7
m2232m21=n21

do m2232=m2231+1,nqul

i7=i2232i7
n21=m2232m21

print*,'loop2232'
call write_symm_xmi_1(i7,n21,m2232,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2932
if (sf2.eq.1)goto 100

i2233i7=i7
m2233m21=n21

do m2233=m2232+1,nqul

i7=i2233i7
n21=m2233m21

print*,'loop2233'
call write_symm_xmi_1(i7,n21,m2233,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2933
if (sf2.eq.1)goto 100

i2234i7=i7
m2234m21=n21

do m2234=m2233+1,nqul

i7=i2234i7
n21=m2234m21

print*,'loop2234'
call write_symm_xmi_1(i7,n21,m2234,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2934
if (sf2.eq.1)goto 100

i2235i7=i7
m2235m21=n21

do m2235=m2234+1,nqul

i7=i2235i7
n21=m2235m21

print*,'loop2235'
call write_symm_xmi_1(i7,n21,m2235,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2935
if (sf2.eq.1)goto 100

i2236i7=i7
m2236m21=n21

do m2236=m2235+1,nqul

i7=i2236i7
n21=m2236m21

print*,'loop2236'
call write_symm_xmi_1(i7,n21,m2236,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2936
if (sf2.eq.1)goto 100

i2237i7=i7
m2237m21=n21

do m2237=m2236+1,nqul

i7=i2237i7
n21=m2237m21

print*,'loop2237'
call write_symm_xmi_1(i7,n21,m2237,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2937
if (sf2.eq.1)goto 100

i2238i7=i7
m2238m21=n21

do m2238=m2237+1,nqul

i7=i2238i7
n21=m2238m21

print*,'loop2238'
call write_symm_xmi_1(i7,n21,m2238,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2938
if (sf2.eq.1)goto 100

i2239i7=i7
m2239m21=n21

do m2239=m2238+1,nqul

i7=i2239i7
n21=m2239m21

print*,'loop2239'
call write_symm_xmi_1(i7,n21,m2239,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2939
if (sf2.eq.1)goto 100

i2240i7=i7
m2240m21=n21

do m2240=m2239+1,nqul

i7=i2240i7
n21=m2240m21

print*,'loop2240'
call write_symm_xmi_1(i7,n21,m2240,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2940
if (sf2.eq.1)goto 100

i2241i7=i7
m2241m21=n21

do m2241=m2240+1,nqul

i7=i2241i7
n21=m2241m21

print*,'loop2241'
call write_symm_xmi_1(i7,n21,m2241,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2941
if (sf2.eq.1)goto 100

i2242i7=i7
m2242m21=n21

do m2242=m2241+1,nqul

i7=i2242i7
n21=m2242m21

print*,'loop2242'
call write_symm_xmi_1(i7,n21,m2242,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2942
if (sf2.eq.1)goto 100

i2243i7=i7
m2243m21=n21

do m2243=m2242+1,nqul

i7=i2243i7
n21=m2243m21

print*,'loop2243'
call write_symm_xmi_1(i7,n21,m2243,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2943
if (sf2.eq.1)goto 100

i2244i7=i7
m2244m21=n21

do m2244=m2243+1,nqul

i7=i2244i7
n21=m2244m21

print*,'loop2244'
call write_symm_xmi_1(i7,n21,m2244,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2944
if (sf2.eq.1)goto 100

i2245i7=i7
m2245m21=n21

do m2245=m2244+1,nqul

i7=i2245i7
n21=m2245m21

print*,'loop2245'
call write_symm_xmi_1(i7,n21,m2245,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2945
if (sf2.eq.1)goto 100

i2246i7=i7
m2246m21=n21

do m2246=m2245+1,nqul

i7=i2246i7
n21=m2246m21

print*,'loop2246'
call write_symm_xmi_1(i7,n21,m2246,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2946
if (sf2.eq.1)goto 100

i2247i7=i7
m2247m21=n21

do m2247=m2246+1,nqul

i7=i2247i7
n21=m2247m21

print*,'loop2247'
call write_symm_xmi_1(i7,n21,m2247,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2947
if (sf2.eq.1)goto 100

i2248i7=i7
m2248m21=n21

do m2248=m2247+1,nqul

i7=i2248i7
n21=m2248m21

print*,'loop2248'
call write_symm_xmi_1(i7,n21,m2248,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2948
if (sf2.eq.1)goto 100

i2249i7=i7
m2249m21=n21

do m2249=m2248+1,nqul

i7=i2249i7
n21=m2249m21

print*,'loop2249'
call write_symm_xmi_1(i7,n21,m2249,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2949
if (sf2.eq.1)goto 100

i2250i7=i7
m2250m21=n21

do m2250=m2249+1,nqul

i7=i2250i7
n21=m2250m21

print*,'loop2250'
call write_symm_xmi_1(i7,n21,m2250,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2950
if (sf2.eq.1)goto 100

i2251i7=i7
m2251m21=n21

do m2251=m2250+1,nqul

i7=i2251i7
n21=m2251m21

print*,'loop2251'
call write_symm_xmi_1(i7,n21,m2251,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2951
if (sf2.eq.1)goto 100

i2252i7=i7
m2252m21=n21

do m2252=m2251+1,nqul

i7=i2252i7
n21=m2252m21

print*,'loop2252'
call write_symm_xmi_1(i7,n21,m2252,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2952
if (sf2.eq.1)goto 100

i2253i7=i7
m2253m21=n21

do m2253=m2252+1,nqul

i7=i2253i7
n21=m2253m21

print*,'loop2253'
call write_symm_xmi_1(i7,n21,m2253,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2953
if (sf2.eq.1)goto 100

i2254i7=i7
m2254m21=n21

do m2254=m2253+1,nqul

i7=i2254i7
n21=m2254m21

print*,'loop2254'
call write_symm_xmi_1(i7,n21,m2254,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2954
if (sf2.eq.1)goto 100

i2255i7=i7
m2255m21=n21

do m2255=m2254+1,nqul

i7=i2255i7
n21=m2255m21

print*,'loop2255'
call write_symm_xmi_1(i7,n21,m2255,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2955
if (sf2.eq.1)goto 100

i2256i7=i7
m2256m21=n21

do m2256=m2255+1,nqul

i7=i2256i7
n21=m2256m21

print*,'loop2256'
call write_symm_xmi_1(i7,n21,m2256,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2956
if (sf2.eq.1)goto 100

i2257i7=i7
m2257m21=n21

do m2257=m2256+1,nqul

i7=i2257i7
n21=m2257m21

print*,'loop2257'
call write_symm_xmi_1(i7,n21,m2257,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2957
if (sf2.eq.1)goto 100

i2258i7=i7
m2258m21=n21

do m2258=m2257+1,nqul

i7=i2258i7
n21=m2258m21

print*,'loop2258'
call write_symm_xmi_1(i7,n21,m2258,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2958
if (sf2.eq.1)goto 100

i2259i7=i7
m2259m21=n21

do m2259=m2258+1,nqul

i7=i2259i7
n21=m2259m21

print*,'loop2259'
call write_symm_xmi_1(i7,n21,m2259,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2959
if (sf2.eq.1)goto 100

i2260i7=i7
m2260m21=n21

do m2260=m2259+1,nqul

i7=i2260i7
n21=m2260m21

print*,'loop2260'
call write_symm_xmi_1(i7,n21,m2260,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2960
if (sf2.eq.1)goto 100

i2261i7=i7
m2261m21=n21

do m2261=m2260+1,nqul

i7=i2261i7
n21=m2261m21

print*,'loop2261'
call write_symm_xmi_1(i7,n21,m2261,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2961
if (sf2.eq.1)goto 100

i2262i7=i7
m2262m21=n21

do m2262=m2261+1,nqul

i7=i2262i7
n21=m2262m21

print*,'loop2262'
call write_symm_xmi_1(i7,n21,m2262,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2962
if (sf2.eq.1)goto 100

i2263i7=i7
m2263m21=n21

do m2263=m2262+1,nqul

i7=i2263i7
n21=m2263m21

print*,'loop2263'
call write_symm_xmi_1(i7,n21,m2263,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2963
if (sf2.eq.1)goto 100

i2264i7=i7
m2264m21=n21

do m2264=m2263+1,nqul

i7=i2264i7
n21=m2264m21

print*,'loop2264'
call write_symm_xmi_1(i7,n21,m2264,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2964
if (sf2.eq.1)goto 100

i2265i7=i7
m2265m21=n21

do m2265=m2264+1,nqul

i7=i2265i7
n21=m2265m21

print*,'loop2265'
call write_symm_xmi_1(i7,n21,m2265,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2965
if (sf2.eq.1)goto 100

i2266i7=i7
m2266m21=n21

do m2266=m2265+1,nqul

i7=i2266i7
n21=m2266m21

print*,'loop2266'
call write_symm_xmi_1(i7,n21,m2266,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2966
if (sf2.eq.1)goto 100

i2267i7=i7
m2267m21=n21

do m2267=m2266+1,nqul

i7=i2267i7
n21=m2267m21

print*,'loop2267'
call write_symm_xmi_1(i7,n21,m2267,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2967
if (sf2.eq.1)goto 100

i2268i7=i7
m2268m21=n21

do m2268=m2267+1,nqul

i7=i2268i7
n21=m2268m21

print*,'loop2268'
call write_symm_xmi_1(i7,n21,m2268,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2968
if (sf2.eq.1)goto 100

i2269i7=i7
m2269m21=n21

do m2269=m2268+1,nqul

i7=i2269i7
n21=m2269m21

print*,'loop2269'
call write_symm_xmi_1(i7,n21,m2269,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2969
if (sf2.eq.1)goto 100

i2270i7=i7
m2270m21=n21

do m2270=m2269+1,nqul

i7=i2270i7
n21=m2270m21

print*,'loop2270'
call write_symm_xmi_1(i7,n21,m2270,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2970
if (sf2.eq.1)goto 100

i2271i7=i7
m2271m21=n21

do m2271=m2270+1,nqul

i7=i2271i7
n21=m2271m21

print*,'loop2271'
call write_symm_xmi_1(i7,n21,m2271,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2971
if (sf2.eq.1)goto 100

i2272i7=i7
m2272m21=n21

do m2272=m2271+1,nqul

i7=i2272i7
n21=m2272m21

print*,'loop2272'
call write_symm_xmi_1(i7,n21,m2272,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2972
if (sf2.eq.1)goto 100

i2273i7=i7
m2273m21=n21

do m2273=m2272+1,nqul

i7=i2273i7
n21=m2273m21

print*,'loop2273'
call write_symm_xmi_1(i7,n21,m2273,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2973
if (sf2.eq.1)goto 100

i2274i7=i7
m2274m21=n21

do m2274=m2273+1,nqul

i7=i2274i7
n21=m2274m21

print*,'loop2274'
call write_symm_xmi_1(i7,n21,m2274,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2974
if (sf2.eq.1)goto 100

i2275i7=i7
m2275m21=n21

do m2275=m2274+1,nqul

i7=i2275i7
n21=m2275m21

print*,'loop2275'
call write_symm_xmi_1(i7,n21,m2275,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2975
if (sf2.eq.1)goto 100

i2276i7=i7
m2276m21=n21

do m2276=m2275+1,nqul

i7=i2276i7
n21=m2276m21

print*,'loop2276'
call write_symm_xmi_1(i7,n21,m2276,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2976
if (sf2.eq.1)goto 100

i2277i7=i7
m2277m21=n21

do m2277=m2276+1,nqul

i7=i2277i7
n21=m2277m21

print*,'loop2277'
call write_symm_xmi_1(i7,n21,m2277,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2977
if (sf2.eq.1)goto 100

i2278i7=i7
m2278m21=n21

do m2278=m2277+1,nqul

i7=i2278i7
n21=m2278m21

print*,'loop2278'
call write_symm_xmi_1(i7,n21,m2278,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2978
if (sf2.eq.1)goto 100

i2279i7=i7
m2279m21=n21

do m2279=m2278+1,nqul

i7=i2279i7
n21=m2279m21

print*,'loop2279'
call write_symm_xmi_1(i7,n21,m2279,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2979
if (sf2.eq.1)goto 100

i2280i7=i7
m2280m21=n21

do m2280=m2279+1,nqul

i7=i2280i7
n21=m2280m21

print*,'loop2280'
call write_symm_xmi_1(i7,n21,m2280,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2980
if (sf2.eq.1)goto 100

i2281i7=i7
m2281m21=n21

do m2281=m2280+1,nqul

i7=i2281i7
n21=m2281m21

print*,'loop2281'
call write_symm_xmi_1(i7,n21,m2281,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2981
if (sf2.eq.1)goto 100

i2282i7=i7
m2282m21=n21

do m2282=m2281+1,nqul

i7=i2282i7
n21=m2282m21

print*,'loop2282'
call write_symm_xmi_1(i7,n21,m2282,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2982
if (sf2.eq.1)goto 100

i2283i7=i7
m2283m21=n21

do m2283=m2282+1,nqul

i7=i2283i7
n21=m2283m21

print*,'loop2283'
call write_symm_xmi_1(i7,n21,m2283,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2983
if (sf2.eq.1)goto 100

i2284i7=i7
m2284m21=n21

do m2284=m2283+1,nqul

i7=i2284i7
n21=m2284m21

print*,'loop2284'
call write_symm_xmi_1(i7,n21,m2284,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2984
if (sf2.eq.1)goto 100

i2285i7=i7
m2285m21=n21

do m2285=m2284+1,nqul

i7=i2285i7
n21=m2285m21

print*,'loop2285'
call write_symm_xmi_1(i7,n21,m2285,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2985
if (sf2.eq.1)goto 100

i2286i7=i7
m2286m21=n21

do m2286=m2285+1,nqul

i7=i2286i7
n21=m2286m21

print*,'loop2286'
call write_symm_xmi_1(i7,n21,m2286,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2986
if (sf2.eq.1)goto 100

i2287i7=i7
m2287m21=n21

do m2287=m2286+1,nqul

i7=i2287i7
n21=m2287m21

print*,'loop2287'
call write_symm_xmi_1(i7,n21,m2287,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2987
if (sf2.eq.1)goto 100

i2288i7=i7
m2288m21=n21

do m2288=m2287+1,nqul

i7=i2288i7
n21=m2288m21

print*,'loop2288'
call write_symm_xmi_1(i7,n21,m2288,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2988
if (sf2.eq.1)goto 100

i2289i7=i7
m2289m21=n21

do m2289=m2288+1,nqul

i7=i2289i7
n21=m2289m21

print*,'loop2289'
call write_symm_xmi_1(i7,n21,m2289,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2989
if (sf2.eq.1)goto 100

i2290i7=i7
m2290m21=n21

do m2290=m2289+1,nqul

i7=i2290i7
n21=m2290m21

print*,'loop2290'
call write_symm_xmi_1(i7,n21,m2290,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2990
if (sf2.eq.1)goto 100

i2291i7=i7
m2291m21=n21

do m2291=m2290+1,nqul

i7=i2291i7
n21=m2291m21

print*,'loop2291'
call write_symm_xmi_1(i7,n21,m2291,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2991
if (sf2.eq.1)goto 100

i2292i7=i7
m2292m21=n21

do m2292=m2291+1,nqul

i7=i2292i7
n21=m2292m21

print*,'loop2292'
call write_symm_xmi_1(i7,n21,m2292,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2992
if (sf2.eq.1)goto 100

i2293i7=i7
m2293m21=n21

do m2293=m2292+1,nqul

i7=i2293i7
n21=m2293m21

print*,'loop2293'
call write_symm_xmi_1(i7,n21,m2293,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2993
if (sf2.eq.1)goto 100

i2294i7=i7
m2294m21=n21

do m2294=m2293+1,nqul

i7=i2294i7
n21=m2294m21

print*,'loop2294'
call write_symm_xmi_1(i7,n21,m2294,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2994
if (sf2.eq.1)goto 100

i2295i7=i7
m2295m21=n21

do m2295=m2294+1,nqul

i7=i2295i7
n21=m2295m21

print*,'loop2295'
call write_symm_xmi_1(i7,n21,m2295,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2995
if (sf2.eq.1)goto 100

i2296i7=i7
m2296m21=n21

do m2296=m2295+1,nqul

i7=i2296i7
n21=m2296m21

print*,'loop2296'
call write_symm_xmi_1(i7,n21,m2296,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2996
if (sf2.eq.1)goto 100

i2297i7=i7
m2297m21=n21

do m2297=m2296+1,nqul

i7=i2297i7
n21=m2297m21

print*,'loop2297'
call write_symm_xmi_1(i7,n21,m2297,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2997
if (sf2.eq.1)goto 100

i2298i7=i7
m2298m21=n21

do m2298=m2297+1,nqul

i7=i2298i7
n21=m2298m21

print*,'loop2298'
call write_symm_xmi_1(i7,n21,m2298,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2998
if (sf2.eq.1)goto 100

i2299i7=i7
m2299m21=n21

do m2299=m2298+1,nqul

i7=i2299i7
n21=m2299m21

print*,'loop2299'
call write_symm_xmi_1(i7,n21,m2299,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 2999
if (sf2.eq.1)goto 100

i2300i7=i7
m2300m21=n21

do m2300=m2299+1,nqul

i7=i2300i7
n21=m2300m21

print*,'loop2300'
call write_symm_xmi_1(i7,n21,m2300,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3000
if (sf2.eq.1)goto 100

i2301i7=i7
m2301m21=n21

do m2301=m2300+1,nqul

i7=i2301i7
n21=m2301m21

print*,'loop2301'
call write_symm_xmi_1(i7,n21,m2301,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3001
if (sf2.eq.1)goto 100

i2302i7=i7
m2302m21=n21

do m2302=m2301+1,nqul

i7=i2302i7
n21=m2302m21

print*,'loop2302'
call write_symm_xmi_1(i7,n21,m2302,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3002
if (sf2.eq.1)goto 100

i2303i7=i7
m2303m21=n21

do m2303=m2302+1,nqul

i7=i2303i7
n21=m2303m21

print*,'loop2303'
call write_symm_xmi_1(i7,n21,m2303,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3003
if (sf2.eq.1)goto 100

i2304i7=i7
m2304m21=n21

do m2304=m2303+1,nqul

i7=i2304i7
n21=m2304m21

print*,'loop2304'
call write_symm_xmi_1(i7,n21,m2304,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3004
if (sf2.eq.1)goto 100

i2305i7=i7
m2305m21=n21

do m2305=m2304+1,nqul

i7=i2305i7
n21=m2305m21

print*,'loop2305'
call write_symm_xmi_1(i7,n21,m2305,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3005
if (sf2.eq.1)goto 100

i2306i7=i7
m2306m21=n21

do m2306=m2305+1,nqul

i7=i2306i7
n21=m2306m21

print*,'loop2306'
call write_symm_xmi_1(i7,n21,m2306,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3006
if (sf2.eq.1)goto 100

i2307i7=i7
m2307m21=n21

do m2307=m2306+1,nqul

i7=i2307i7
n21=m2307m21

print*,'loop2307'
call write_symm_xmi_1(i7,n21,m2307,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3007
if (sf2.eq.1)goto 100

i2308i7=i7
m2308m21=n21

do m2308=m2307+1,nqul

i7=i2308i7
n21=m2308m21

print*,'loop2308'
call write_symm_xmi_1(i7,n21,m2308,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3008
if (sf2.eq.1)goto 100

i2309i7=i7
m2309m21=n21

do m2309=m2308+1,nqul

i7=i2309i7
n21=m2309m21

print*,'loop2309'
call write_symm_xmi_1(i7,n21,m2309,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3009
if (sf2.eq.1)goto 100

i2310i7=i7
m2310m21=n21

do m2310=m2309+1,nqul

i7=i2310i7
n21=m2310m21

print*,'loop2310'
call write_symm_xmi_1(i7,n21,m2310,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3010
if (sf2.eq.1)goto 100

i2311i7=i7
m2311m21=n21

do m2311=m2310+1,nqul

i7=i2311i7
n21=m2311m21

print*,'loop2311'
call write_symm_xmi_1(i7,n21,m2311,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3011
if (sf2.eq.1)goto 100

i2312i7=i7
m2312m21=n21

do m2312=m2311+1,nqul

i7=i2312i7
n21=m2312m21

print*,'loop2312'
call write_symm_xmi_1(i7,n21,m2312,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3012
if (sf2.eq.1)goto 100

i2313i7=i7
m2313m21=n21

do m2313=m2312+1,nqul

i7=i2313i7
n21=m2313m21

print*,'loop2313'
call write_symm_xmi_1(i7,n21,m2313,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3013
if (sf2.eq.1)goto 100

i2314i7=i7
m2314m21=n21

do m2314=m2313+1,nqul

i7=i2314i7
n21=m2314m21

print*,'loop2314'
call write_symm_xmi_1(i7,n21,m2314,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3014
if (sf2.eq.1)goto 100

i2315i7=i7
m2315m21=n21

do m2315=m2314+1,nqul

i7=i2315i7
n21=m2315m21

print*,'loop2315'
call write_symm_xmi_1(i7,n21,m2315,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3015
if (sf2.eq.1)goto 100

i2316i7=i7
m2316m21=n21

do m2316=m2315+1,nqul

i7=i2316i7
n21=m2316m21

print*,'loop2316'
call write_symm_xmi_1(i7,n21,m2316,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3016
if (sf2.eq.1)goto 100

i2317i7=i7
m2317m21=n21

do m2317=m2316+1,nqul

i7=i2317i7
n21=m2317m21

print*,'loop2317'
call write_symm_xmi_1(i7,n21,m2317,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3017
if (sf2.eq.1)goto 100

i2318i7=i7
m2318m21=n21

do m2318=m2317+1,nqul

i7=i2318i7
n21=m2318m21

print*,'loop2318'
call write_symm_xmi_1(i7,n21,m2318,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3018
if (sf2.eq.1)goto 100

i2319i7=i7
m2319m21=n21

do m2319=m2318+1,nqul

i7=i2319i7
n21=m2319m21

print*,'loop2319'
call write_symm_xmi_1(i7,n21,m2319,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3019
if (sf2.eq.1)goto 100

i2320i7=i7
m2320m21=n21

do m2320=m2319+1,nqul

i7=i2320i7
n21=m2320m21

print*,'loop2320'
call write_symm_xmi_1(i7,n21,m2320,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3020
if (sf2.eq.1)goto 100

i2321i7=i7
m2321m21=n21

do m2321=m2320+1,nqul

i7=i2321i7
n21=m2321m21

print*,'loop2321'
call write_symm_xmi_1(i7,n21,m2321,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3021
if (sf2.eq.1)goto 100

i2322i7=i7
m2322m21=n21

do m2322=m2321+1,nqul

i7=i2322i7
n21=m2322m21

print*,'loop2322'
call write_symm_xmi_1(i7,n21,m2322,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3022
if (sf2.eq.1)goto 100

i2323i7=i7
m2323m21=n21

do m2323=m2322+1,nqul

i7=i2323i7
n21=m2323m21

print*,'loop2323'
call write_symm_xmi_1(i7,n21,m2323,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3023
if (sf2.eq.1)goto 100

i2324i7=i7
m2324m21=n21

do m2324=m2323+1,nqul

i7=i2324i7
n21=m2324m21

print*,'loop2324'
call write_symm_xmi_1(i7,n21,m2324,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3024
if (sf2.eq.1)goto 100

i2325i7=i7
m2325m21=n21

do m2325=m2324+1,nqul

i7=i2325i7
n21=m2325m21

print*,'loop2325'
call write_symm_xmi_1(i7,n21,m2325,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3025
if (sf2.eq.1)goto 100

i2326i7=i7
m2326m21=n21

do m2326=m2325+1,nqul

i7=i2326i7
n21=m2326m21

print*,'loop2326'
call write_symm_xmi_1(i7,n21,m2326,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3026
if (sf2.eq.1)goto 100

i2327i7=i7
m2327m21=n21

do m2327=m2326+1,nqul

i7=i2327i7
n21=m2327m21

print*,'loop2327'
call write_symm_xmi_1(i7,n21,m2327,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3027
if (sf2.eq.1)goto 100

i2328i7=i7
m2328m21=n21

do m2328=m2327+1,nqul

i7=i2328i7
n21=m2328m21

print*,'loop2328'
call write_symm_xmi_1(i7,n21,m2328,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3028
if (sf2.eq.1)goto 100

i2329i7=i7
m2329m21=n21

do m2329=m2328+1,nqul

i7=i2329i7
n21=m2329m21

print*,'loop2329'
call write_symm_xmi_1(i7,n21,m2329,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3029
if (sf2.eq.1)goto 100

i2330i7=i7
m2330m21=n21

do m2330=m2329+1,nqul

i7=i2330i7
n21=m2330m21

print*,'loop2330'
call write_symm_xmi_1(i7,n21,m2330,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3030
if (sf2.eq.1)goto 100

i2331i7=i7
m2331m21=n21

do m2331=m2330+1,nqul

i7=i2331i7
n21=m2331m21

print*,'loop2331'
call write_symm_xmi_1(i7,n21,m2331,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3031
if (sf2.eq.1)goto 100

i2332i7=i7
m2332m21=n21

do m2332=m2331+1,nqul

i7=i2332i7
n21=m2332m21

print*,'loop2332'
call write_symm_xmi_1(i7,n21,m2332,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3032
if (sf2.eq.1)goto 100

i2333i7=i7
m2333m21=n21

do m2333=m2332+1,nqul

i7=i2333i7
n21=m2333m21

print*,'loop2333'
call write_symm_xmi_1(i7,n21,m2333,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3033
if (sf2.eq.1)goto 100

i2334i7=i7
m2334m21=n21

do m2334=m2333+1,nqul

i7=i2334i7
n21=m2334m21

print*,'loop2334'
call write_symm_xmi_1(i7,n21,m2334,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3034
if (sf2.eq.1)goto 100

i2335i7=i7
m2335m21=n21

do m2335=m2334+1,nqul

i7=i2335i7
n21=m2335m21

print*,'loop2335'
call write_symm_xmi_1(i7,n21,m2335,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3035
if (sf2.eq.1)goto 100

i2336i7=i7
m2336m21=n21

do m2336=m2335+1,nqul

i7=i2336i7
n21=m2336m21

print*,'loop2336'
call write_symm_xmi_1(i7,n21,m2336,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3036
if (sf2.eq.1)goto 100

i2337i7=i7
m2337m21=n21

do m2337=m2336+1,nqul

i7=i2337i7
n21=m2337m21

print*,'loop2337'
call write_symm_xmi_1(i7,n21,m2337,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3037
if (sf2.eq.1)goto 100

i2338i7=i7
m2338m21=n21

do m2338=m2337+1,nqul

i7=i2338i7
n21=m2338m21

print*,'loop2338'
call write_symm_xmi_1(i7,n21,m2338,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3038
if (sf2.eq.1)goto 100

i2339i7=i7
m2339m21=n21

do m2339=m2338+1,nqul

i7=i2339i7
n21=m2339m21

print*,'loop2339'
call write_symm_xmi_1(i7,n21,m2339,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3039
if (sf2.eq.1)goto 100

i2340i7=i7
m2340m21=n21

do m2340=m2339+1,nqul

i7=i2340i7
n21=m2340m21

print*,'loop2340'
call write_symm_xmi_1(i7,n21,m2340,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3040
if (sf2.eq.1)goto 100

i2341i7=i7
m2341m21=n21

do m2341=m2340+1,nqul

i7=i2341i7
n21=m2341m21

print*,'loop2341'
call write_symm_xmi_1(i7,n21,m2341,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3041
if (sf2.eq.1)goto 100

i2342i7=i7
m2342m21=n21

do m2342=m2341+1,nqul

i7=i2342i7
n21=m2342m21

print*,'loop2342'
call write_symm_xmi_1(i7,n21,m2342,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3042
if (sf2.eq.1)goto 100

i2343i7=i7
m2343m21=n21

do m2343=m2342+1,nqul

i7=i2343i7
n21=m2343m21

print*,'loop2343'
call write_symm_xmi_1(i7,n21,m2343,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3043
if (sf2.eq.1)goto 100

i2344i7=i7
m2344m21=n21

do m2344=m2343+1,nqul

i7=i2344i7
n21=m2344m21

print*,'loop2344'
call write_symm_xmi_1(i7,n21,m2344,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3044
if (sf2.eq.1)goto 100

i2345i7=i7
m2345m21=n21

do m2345=m2344+1,nqul

i7=i2345i7
n21=m2345m21

print*,'loop2345'
call write_symm_xmi_1(i7,n21,m2345,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3045
if (sf2.eq.1)goto 100

i2346i7=i7
m2346m21=n21

do m2346=m2345+1,nqul

i7=i2346i7
n21=m2346m21

print*,'loop2346'
call write_symm_xmi_1(i7,n21,m2346,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3046
if (sf2.eq.1)goto 100

i2347i7=i7
m2347m21=n21

do m2347=m2346+1,nqul

i7=i2347i7
n21=m2347m21

print*,'loop2347'
call write_symm_xmi_1(i7,n21,m2347,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3047
if (sf2.eq.1)goto 100

i2348i7=i7
m2348m21=n21

do m2348=m2347+1,nqul

i7=i2348i7
n21=m2348m21

print*,'loop2348'
call write_symm_xmi_1(i7,n21,m2348,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3048
if (sf2.eq.1)goto 100

i2349i7=i7
m2349m21=n21

do m2349=m2348+1,nqul

i7=i2349i7
n21=m2349m21

print*,'loop2349'
call write_symm_xmi_1(i7,n21,m2349,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3049
if (sf2.eq.1)goto 100

i2350i7=i7
m2350m21=n21

do m2350=m2349+1,nqul

i7=i2350i7
n21=m2350m21

print*,'loop2350'
call write_symm_xmi_1(i7,n21,m2350,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3050
if (sf2.eq.1)goto 100

i2351i7=i7
m2351m21=n21

do m2351=m2350+1,nqul

i7=i2351i7
n21=m2351m21

print*,'loop2351'
call write_symm_xmi_1(i7,n21,m2351,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3051
if (sf2.eq.1)goto 100

i2352i7=i7
m2352m21=n21

do m2352=m2351+1,nqul

i7=i2352i7
n21=m2352m21

print*,'loop2352'
call write_symm_xmi_1(i7,n21,m2352,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3052
if (sf2.eq.1)goto 100

i2353i7=i7
m2353m21=n21

do m2353=m2352+1,nqul

i7=i2353i7
n21=m2353m21

print*,'loop2353'
call write_symm_xmi_1(i7,n21,m2353,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3053
if (sf2.eq.1)goto 100

i2354i7=i7
m2354m21=n21

do m2354=m2353+1,nqul

i7=i2354i7
n21=m2354m21

print*,'loop2354'
call write_symm_xmi_1(i7,n21,m2354,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3054
if (sf2.eq.1)goto 100

i2355i7=i7
m2355m21=n21

do m2355=m2354+1,nqul

i7=i2355i7
n21=m2355m21

print*,'loop2355'
call write_symm_xmi_1(i7,n21,m2355,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3055
if (sf2.eq.1)goto 100

i2356i7=i7
m2356m21=n21

do m2356=m2355+1,nqul

i7=i2356i7
n21=m2356m21

print*,'loop2356'
call write_symm_xmi_1(i7,n21,m2356,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3056
if (sf2.eq.1)goto 100

i2357i7=i7
m2357m21=n21

do m2357=m2356+1,nqul

i7=i2357i7
n21=m2357m21

print*,'loop2357'
call write_symm_xmi_1(i7,n21,m2357,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3057
if (sf2.eq.1)goto 100

i2358i7=i7
m2358m21=n21

do m2358=m2357+1,nqul

i7=i2358i7
n21=m2358m21

print*,'loop2358'
call write_symm_xmi_1(i7,n21,m2358,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3058
if (sf2.eq.1)goto 100

i2359i7=i7
m2359m21=n21

do m2359=m2358+1,nqul

i7=i2359i7
n21=m2359m21

print*,'loop2359'
call write_symm_xmi_1(i7,n21,m2359,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3059
if (sf2.eq.1)goto 100

i2360i7=i7
m2360m21=n21

do m2360=m2359+1,nqul

i7=i2360i7
n21=m2360m21

print*,'loop2360'
call write_symm_xmi_1(i7,n21,m2360,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3060
if (sf2.eq.1)goto 100

i2361i7=i7
m2361m21=n21

do m2361=m2360+1,nqul

i7=i2361i7
n21=m2361m21

print*,'loop2361'
call write_symm_xmi_1(i7,n21,m2361,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3061
if (sf2.eq.1)goto 100

i2362i7=i7
m2362m21=n21

do m2362=m2361+1,nqul

i7=i2362i7
n21=m2362m21

print*,'loop2362'
call write_symm_xmi_1(i7,n21,m2362,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3062
if (sf2.eq.1)goto 100

i2363i7=i7
m2363m21=n21

do m2363=m2362+1,nqul

i7=i2363i7
n21=m2363m21

print*,'loop2363'
call write_symm_xmi_1(i7,n21,m2363,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3063
if (sf2.eq.1)goto 100

i2364i7=i7
m2364m21=n21

do m2364=m2363+1,nqul

i7=i2364i7
n21=m2364m21

print*,'loop2364'
call write_symm_xmi_1(i7,n21,m2364,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3064
if (sf2.eq.1)goto 100

i2365i7=i7
m2365m21=n21

do m2365=m2364+1,nqul

i7=i2365i7
n21=m2365m21

print*,'loop2365'
call write_symm_xmi_1(i7,n21,m2365,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3065
if (sf2.eq.1)goto 100

i2366i7=i7
m2366m21=n21

do m2366=m2365+1,nqul

i7=i2366i7
n21=m2366m21

print*,'loop2366'
call write_symm_xmi_1(i7,n21,m2366,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3066
if (sf2.eq.1)goto 100

i2367i7=i7
m2367m21=n21

do m2367=m2366+1,nqul

i7=i2367i7
n21=m2367m21

print*,'loop2367'
call write_symm_xmi_1(i7,n21,m2367,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3067
if (sf2.eq.1)goto 100

i2368i7=i7
m2368m21=n21

do m2368=m2367+1,nqul

i7=i2368i7
n21=m2368m21

print*,'loop2368'
call write_symm_xmi_1(i7,n21,m2368,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3068
if (sf2.eq.1)goto 100

i2369i7=i7
m2369m21=n21

do m2369=m2368+1,nqul

i7=i2369i7
n21=m2369m21

print*,'loop2369'
call write_symm_xmi_1(i7,n21,m2369,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3069
if (sf2.eq.1)goto 100

i2370i7=i7
m2370m21=n21

do m2370=m2369+1,nqul

i7=i2370i7
n21=m2370m21

print*,'loop2370'
call write_symm_xmi_1(i7,n21,m2370,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3070
if (sf2.eq.1)goto 100

i2371i7=i7
m2371m21=n21

do m2371=m2370+1,nqul

i7=i2371i7
n21=m2371m21

print*,'loop2371'
call write_symm_xmi_1(i7,n21,m2371,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3071
if (sf2.eq.1)goto 100

i2372i7=i7
m2372m21=n21

do m2372=m2371+1,nqul

i7=i2372i7
n21=m2372m21

print*,'loop2372'
call write_symm_xmi_1(i7,n21,m2372,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3072
if (sf2.eq.1)goto 100

i2373i7=i7
m2373m21=n21

do m2373=m2372+1,nqul

i7=i2373i7
n21=m2373m21

print*,'loop2373'
call write_symm_xmi_1(i7,n21,m2373,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3073
if (sf2.eq.1)goto 100

i2374i7=i7
m2374m21=n21

do m2374=m2373+1,nqul

i7=i2374i7
n21=m2374m21

print*,'loop2374'
call write_symm_xmi_1(i7,n21,m2374,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3074
if (sf2.eq.1)goto 100

i2375i7=i7
m2375m21=n21

do m2375=m2374+1,nqul

i7=i2375i7
n21=m2375m21

print*,'loop2375'
call write_symm_xmi_1(i7,n21,m2375,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3075
if (sf2.eq.1)goto 100

i2376i7=i7
m2376m21=n21

do m2376=m2375+1,nqul

i7=i2376i7
n21=m2376m21

print*,'loop2376'
call write_symm_xmi_1(i7,n21,m2376,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3076
if (sf2.eq.1)goto 100

i2377i7=i7
m2377m21=n21

do m2377=m2376+1,nqul

i7=i2377i7
n21=m2377m21

print*,'loop2377'
call write_symm_xmi_1(i7,n21,m2377,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3077
if (sf2.eq.1)goto 100

i2378i7=i7
m2378m21=n21

do m2378=m2377+1,nqul

i7=i2378i7
n21=m2378m21

print*,'loop2378'
call write_symm_xmi_1(i7,n21,m2378,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3078
if (sf2.eq.1)goto 100

i2379i7=i7
m2379m21=n21

do m2379=m2378+1,nqul

i7=i2379i7
n21=m2379m21

print*,'loop2379'
call write_symm_xmi_1(i7,n21,m2379,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3079
if (sf2.eq.1)goto 100

i2380i7=i7
m2380m21=n21

do m2380=m2379+1,nqul

i7=i2380i7
n21=m2380m21

print*,'loop2380'
call write_symm_xmi_1(i7,n21,m2380,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3080
if (sf2.eq.1)goto 100

i2381i7=i7
m2381m21=n21

do m2381=m2380+1,nqul

i7=i2381i7
n21=m2381m21

print*,'loop2381'
call write_symm_xmi_1(i7,n21,m2381,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3081
if (sf2.eq.1)goto 100

i2382i7=i7
m2382m21=n21

do m2382=m2381+1,nqul

i7=i2382i7
n21=m2382m21

print*,'loop2382'
call write_symm_xmi_1(i7,n21,m2382,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3082
if (sf2.eq.1)goto 100

i2383i7=i7
m2383m21=n21

do m2383=m2382+1,nqul

i7=i2383i7
n21=m2383m21

print*,'loop2383'
call write_symm_xmi_1(i7,n21,m2383,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3083
if (sf2.eq.1)goto 100

i2384i7=i7
m2384m21=n21

do m2384=m2383+1,nqul

i7=i2384i7
n21=m2384m21

print*,'loop2384'
call write_symm_xmi_1(i7,n21,m2384,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3084
if (sf2.eq.1)goto 100

i2385i7=i7
m2385m21=n21

do m2385=m2384+1,nqul

i7=i2385i7
n21=m2385m21

print*,'loop2385'
call write_symm_xmi_1(i7,n21,m2385,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3085
if (sf2.eq.1)goto 100

i2386i7=i7
m2386m21=n21

do m2386=m2385+1,nqul

i7=i2386i7
n21=m2386m21

print*,'loop2386'
call write_symm_xmi_1(i7,n21,m2386,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3086
if (sf2.eq.1)goto 100

i2387i7=i7
m2387m21=n21

do m2387=m2386+1,nqul

i7=i2387i7
n21=m2387m21

print*,'loop2387'
call write_symm_xmi_1(i7,n21,m2387,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3087
if (sf2.eq.1)goto 100

i2388i7=i7
m2388m21=n21

do m2388=m2387+1,nqul

i7=i2388i7
n21=m2388m21

print*,'loop2388'
call write_symm_xmi_1(i7,n21,m2388,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3088
if (sf2.eq.1)goto 100

i2389i7=i7
m2389m21=n21

do m2389=m2388+1,nqul

i7=i2389i7
n21=m2389m21

print*,'loop2389'
call write_symm_xmi_1(i7,n21,m2389,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3089
if (sf2.eq.1)goto 100

i2390i7=i7
m2390m21=n21

do m2390=m2389+1,nqul

i7=i2390i7
n21=m2390m21

print*,'loop2390'
call write_symm_xmi_1(i7,n21,m2390,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3090
if (sf2.eq.1)goto 100

i2391i7=i7
m2391m21=n21

do m2391=m2390+1,nqul

i7=i2391i7
n21=m2391m21

print*,'loop2391'
call write_symm_xmi_1(i7,n21,m2391,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3091
if (sf2.eq.1)goto 100

i2392i7=i7
m2392m21=n21

do m2392=m2391+1,nqul

i7=i2392i7
n21=m2392m21

print*,'loop2392'
call write_symm_xmi_1(i7,n21,m2392,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3092
if (sf2.eq.1)goto 100

i2393i7=i7
m2393m21=n21

do m2393=m2392+1,nqul

i7=i2393i7
n21=m2393m21

print*,'loop2393'
call write_symm_xmi_1(i7,n21,m2393,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3093
if (sf2.eq.1)goto 100

i2394i7=i7
m2394m21=n21

do m2394=m2393+1,nqul

i7=i2394i7
n21=m2394m21

print*,'loop2394'
call write_symm_xmi_1(i7,n21,m2394,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3094
if (sf2.eq.1)goto 100

i2395i7=i7
m2395m21=n21

do m2395=m2394+1,nqul

i7=i2395i7
n21=m2395m21

print*,'loop2395'
call write_symm_xmi_1(i7,n21,m2395,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3095
if (sf2.eq.1)goto 100

i2396i7=i7
m2396m21=n21

do m2396=m2395+1,nqul

i7=i2396i7
n21=m2396m21

print*,'loop2396'
call write_symm_xmi_1(i7,n21,m2396,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3096
if (sf2.eq.1)goto 100

i2397i7=i7
m2397m21=n21

do m2397=m2396+1,nqul

i7=i2397i7
n21=m2397m21

print*,'loop2397'
call write_symm_xmi_1(i7,n21,m2397,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3097
if (sf2.eq.1)goto 100

i2398i7=i7
m2398m21=n21

do m2398=m2397+1,nqul

i7=i2398i7
n21=m2398m21

print*,'loop2398'
call write_symm_xmi_1(i7,n21,m2398,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3098
if (sf2.eq.1)goto 100

i2399i7=i7
m2399m21=n21

do m2399=m2398+1,nqul

i7=i2399i7
n21=m2399m21

print*,'loop2399'
call write_symm_xmi_1(i7,n21,m2399,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3099
if (sf2.eq.1)goto 100

i2400i7=i7
m2400m21=n21

do m2400=m2399+1,nqul

i7=i2400i7
n21=m2400m21

print*,'loop2400'
call write_symm_xmi_1(i7,n21,m2400,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3100
if (sf2.eq.1)goto 100

i2401i7=i7
m2401m21=n21

do m2401=m2400+1,nqul

i7=i2401i7
n21=m2401m21

print*,'loop2401'
call write_symm_xmi_1(i7,n21,m2401,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3101
if (sf2.eq.1)goto 100

i2402i7=i7
m2402m21=n21

do m2402=m2401+1,nqul

i7=i2402i7
n21=m2402m21

print*,'loop2402'
call write_symm_xmi_1(i7,n21,m2402,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3102
if (sf2.eq.1)goto 100

i2403i7=i7
m2403m21=n21

do m2403=m2402+1,nqul

i7=i2403i7
n21=m2403m21

print*,'loop2403'
call write_symm_xmi_1(i7,n21,m2403,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3103
if (sf2.eq.1)goto 100

i2404i7=i7
m2404m21=n21

do m2404=m2403+1,nqul

i7=i2404i7
n21=m2404m21

print*,'loop2404'
call write_symm_xmi_1(i7,n21,m2404,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3104
if (sf2.eq.1)goto 100

i2405i7=i7
m2405m21=n21

do m2405=m2404+1,nqul

i7=i2405i7
n21=m2405m21

print*,'loop2405'
call write_symm_xmi_1(i7,n21,m2405,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3105
if (sf2.eq.1)goto 100

i2406i7=i7
m2406m21=n21

do m2406=m2405+1,nqul

i7=i2406i7
n21=m2406m21

print*,'loop2406'
call write_symm_xmi_1(i7,n21,m2406,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3106
if (sf2.eq.1)goto 100

i2407i7=i7
m2407m21=n21

do m2407=m2406+1,nqul

i7=i2407i7
n21=m2407m21

print*,'loop2407'
call write_symm_xmi_1(i7,n21,m2407,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3107
if (sf2.eq.1)goto 100

i2408i7=i7
m2408m21=n21

do m2408=m2407+1,nqul

i7=i2408i7
n21=m2408m21

print*,'loop2408'
call write_symm_xmi_1(i7,n21,m2408,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3108
if (sf2.eq.1)goto 100

i2409i7=i7
m2409m21=n21

do m2409=m2408+1,nqul

i7=i2409i7
n21=m2409m21

print*,'loop2409'
call write_symm_xmi_1(i7,n21,m2409,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3109
if (sf2.eq.1)goto 100

i2410i7=i7
m2410m21=n21

do m2410=m2409+1,nqul

i7=i2410i7
n21=m2410m21

print*,'loop2410'
call write_symm_xmi_1(i7,n21,m2410,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3110
if (sf2.eq.1)goto 100

i2411i7=i7
m2411m21=n21

do m2411=m2410+1,nqul

i7=i2411i7
n21=m2411m21

print*,'loop2411'
call write_symm_xmi_1(i7,n21,m2411,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3111
if (sf2.eq.1)goto 100

i2412i7=i7
m2412m21=n21

do m2412=m2411+1,nqul

i7=i2412i7
n21=m2412m21

print*,'loop2412'
call write_symm_xmi_1(i7,n21,m2412,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3112
if (sf2.eq.1)goto 100

i2413i7=i7
m2413m21=n21

do m2413=m2412+1,nqul

i7=i2413i7
n21=m2413m21

print*,'loop2413'
call write_symm_xmi_1(i7,n21,m2413,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3113
if (sf2.eq.1)goto 100

i2414i7=i7
m2414m21=n21

do m2414=m2413+1,nqul

i7=i2414i7
n21=m2414m21

print*,'loop2414'
call write_symm_xmi_1(i7,n21,m2414,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3114
if (sf2.eq.1)goto 100

i2415i7=i7
m2415m21=n21

do m2415=m2414+1,nqul

i7=i2415i7
n21=m2415m21

print*,'loop2415'
call write_symm_xmi_1(i7,n21,m2415,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3115
if (sf2.eq.1)goto 100

i2416i7=i7
m2416m21=n21

do m2416=m2415+1,nqul

i7=i2416i7
n21=m2416m21

print*,'loop2416'
call write_symm_xmi_1(i7,n21,m2416,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3116
if (sf2.eq.1)goto 100

i2417i7=i7
m2417m21=n21

do m2417=m2416+1,nqul

i7=i2417i7
n21=m2417m21

print*,'loop2417'
call write_symm_xmi_1(i7,n21,m2417,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3117
if (sf2.eq.1)goto 100

i2418i7=i7
m2418m21=n21

do m2418=m2417+1,nqul

i7=i2418i7
n21=m2418m21

print*,'loop2418'
call write_symm_xmi_1(i7,n21,m2418,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3118
if (sf2.eq.1)goto 100

i2419i7=i7
m2419m21=n21

do m2419=m2418+1,nqul

i7=i2419i7
n21=m2419m21

print*,'loop2419'
call write_symm_xmi_1(i7,n21,m2419,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3119
if (sf2.eq.1)goto 100

i2420i7=i7
m2420m21=n21

do m2420=m2419+1,nqul

i7=i2420i7
n21=m2420m21

print*,'loop2420'
call write_symm_xmi_1(i7,n21,m2420,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3120
if (sf2.eq.1)goto 100

i2421i7=i7
m2421m21=n21

do m2421=m2420+1,nqul

i7=i2421i7
n21=m2421m21

print*,'loop2421'
call write_symm_xmi_1(i7,n21,m2421,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3121
if (sf2.eq.1)goto 100

i2422i7=i7
m2422m21=n21

do m2422=m2421+1,nqul

i7=i2422i7
n21=m2422m21

print*,'loop2422'
call write_symm_xmi_1(i7,n21,m2422,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3122
if (sf2.eq.1)goto 100

i2423i7=i7
m2423m21=n21

do m2423=m2422+1,nqul

i7=i2423i7
n21=m2423m21

print*,'loop2423'
call write_symm_xmi_1(i7,n21,m2423,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3123
if (sf2.eq.1)goto 100

i2424i7=i7
m2424m21=n21

do m2424=m2423+1,nqul

i7=i2424i7
n21=m2424m21

print*,'loop2424'
call write_symm_xmi_1(i7,n21,m2424,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3124
if (sf2.eq.1)goto 100

i2425i7=i7
m2425m21=n21

do m2425=m2424+1,nqul

i7=i2425i7
n21=m2425m21

print*,'loop2425'
call write_symm_xmi_1(i7,n21,m2425,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3125
if (sf2.eq.1)goto 100

i2426i7=i7
m2426m21=n21

do m2426=m2425+1,nqul

i7=i2426i7
n21=m2426m21

print*,'loop2426'
call write_symm_xmi_1(i7,n21,m2426,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3126
if (sf2.eq.1)goto 100

i2427i7=i7
m2427m21=n21

do m2427=m2426+1,nqul

i7=i2427i7
n21=m2427m21

print*,'loop2427'
call write_symm_xmi_1(i7,n21,m2427,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3127
if (sf2.eq.1)goto 100

i2428i7=i7
m2428m21=n21

do m2428=m2427+1,nqul

i7=i2428i7
n21=m2428m21

print*,'loop2428'
call write_symm_xmi_1(i7,n21,m2428,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3128
if (sf2.eq.1)goto 100

i2429i7=i7
m2429m21=n21

do m2429=m2428+1,nqul

i7=i2429i7
n21=m2429m21

print*,'loop2429'
call write_symm_xmi_1(i7,n21,m2429,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3129
if (sf2.eq.1)goto 100

i2430i7=i7
m2430m21=n21

do m2430=m2429+1,nqul

i7=i2430i7
n21=m2430m21

print*,'loop2430'
call write_symm_xmi_1(i7,n21,m2430,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3130
if (sf2.eq.1)goto 100

i2431i7=i7
m2431m21=n21

do m2431=m2430+1,nqul

i7=i2431i7
n21=m2431m21

print*,'loop2431'
call write_symm_xmi_1(i7,n21,m2431,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3131
if (sf2.eq.1)goto 100

i2432i7=i7
m2432m21=n21

do m2432=m2431+1,nqul

i7=i2432i7
n21=m2432m21

print*,'loop2432'
call write_symm_xmi_1(i7,n21,m2432,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3132
if (sf2.eq.1)goto 100

i2433i7=i7
m2433m21=n21

do m2433=m2432+1,nqul

i7=i2433i7
n21=m2433m21

print*,'loop2433'
call write_symm_xmi_1(i7,n21,m2433,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3133
if (sf2.eq.1)goto 100

i2434i7=i7
m2434m21=n21

do m2434=m2433+1,nqul

i7=i2434i7
n21=m2434m21

print*,'loop2434'
call write_symm_xmi_1(i7,n21,m2434,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3134
if (sf2.eq.1)goto 100

i2435i7=i7
m2435m21=n21

do m2435=m2434+1,nqul

i7=i2435i7
n21=m2435m21

print*,'loop2435'
call write_symm_xmi_1(i7,n21,m2435,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3135
if (sf2.eq.1)goto 100

i2436i7=i7
m2436m21=n21

do m2436=m2435+1,nqul

i7=i2436i7
n21=m2436m21

print*,'loop2436'
call write_symm_xmi_1(i7,n21,m2436,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3136
if (sf2.eq.1)goto 100

i2437i7=i7
m2437m21=n21

do m2437=m2436+1,nqul

i7=i2437i7
n21=m2437m21

print*,'loop2437'
call write_symm_xmi_1(i7,n21,m2437,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3137
if (sf2.eq.1)goto 100

i2438i7=i7
m2438m21=n21

do m2438=m2437+1,nqul

i7=i2438i7
n21=m2438m21

print*,'loop2438'
call write_symm_xmi_1(i7,n21,m2438,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3138
if (sf2.eq.1)goto 100

i2439i7=i7
m2439m21=n21

do m2439=m2438+1,nqul

i7=i2439i7
n21=m2439m21

print*,'loop2439'
call write_symm_xmi_1(i7,n21,m2439,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3139
if (sf2.eq.1)goto 100

i2440i7=i7
m2440m21=n21

do m2440=m2439+1,nqul

i7=i2440i7
n21=m2440m21

print*,'loop2440'
call write_symm_xmi_1(i7,n21,m2440,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3140
if (sf2.eq.1)goto 100

i2441i7=i7
m2441m21=n21

do m2441=m2440+1,nqul

i7=i2441i7
n21=m2441m21

print*,'loop2441'
call write_symm_xmi_1(i7,n21,m2441,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3141
if (sf2.eq.1)goto 100

i2442i7=i7
m2442m21=n21

do m2442=m2441+1,nqul

i7=i2442i7
n21=m2442m21

print*,'loop2442'
call write_symm_xmi_1(i7,n21,m2442,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3142
if (sf2.eq.1)goto 100

i2443i7=i7
m2443m21=n21

do m2443=m2442+1,nqul

i7=i2443i7
n21=m2443m21

print*,'loop2443'
call write_symm_xmi_1(i7,n21,m2443,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3143
if (sf2.eq.1)goto 100

i2444i7=i7
m2444m21=n21

do m2444=m2443+1,nqul

i7=i2444i7
n21=m2444m21

print*,'loop2444'
call write_symm_xmi_1(i7,n21,m2444,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3144
if (sf2.eq.1)goto 100

i2445i7=i7
m2445m21=n21

do m2445=m2444+1,nqul

i7=i2445i7
n21=m2445m21

print*,'loop2445'
call write_symm_xmi_1(i7,n21,m2445,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3145
if (sf2.eq.1)goto 100

i2446i7=i7
m2446m21=n21

do m2446=m2445+1,nqul

i7=i2446i7
n21=m2446m21

print*,'loop2446'
call write_symm_xmi_1(i7,n21,m2446,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3146
if (sf2.eq.1)goto 100

i2447i7=i7
m2447m21=n21

do m2447=m2446+1,nqul

i7=i2447i7
n21=m2447m21

print*,'loop2447'
call write_symm_xmi_1(i7,n21,m2447,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3147
if (sf2.eq.1)goto 100

i2448i7=i7
m2448m21=n21

do m2448=m2447+1,nqul

i7=i2448i7
n21=m2448m21

print*,'loop2448'
call write_symm_xmi_1(i7,n21,m2448,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3148
if (sf2.eq.1)goto 100

i2449i7=i7
m2449m21=n21

do m2449=m2448+1,nqul

i7=i2449i7
n21=m2449m21

print*,'loop2449'
call write_symm_xmi_1(i7,n21,m2449,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3149
if (sf2.eq.1)goto 100

i2450i7=i7
m2450m21=n21

do m2450=m2449+1,nqul

i7=i2450i7
n21=m2450m21

print*,'loop2450'
call write_symm_xmi_1(i7,n21,m2450,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3150
if (sf2.eq.1)goto 100

i2451i7=i7
m2451m21=n21

do m2451=m2450+1,nqul

i7=i2451i7
n21=m2451m21

print*,'loop2451'
call write_symm_xmi_1(i7,n21,m2451,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3151
if (sf2.eq.1)goto 100

i2452i7=i7
m2452m21=n21

do m2452=m2451+1,nqul

i7=i2452i7
n21=m2452m21

print*,'loop2452'
call write_symm_xmi_1(i7,n21,m2452,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3152
if (sf2.eq.1)goto 100

i2453i7=i7
m2453m21=n21

do m2453=m2452+1,nqul

i7=i2453i7
n21=m2453m21

print*,'loop2453'
call write_symm_xmi_1(i7,n21,m2453,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3153
if (sf2.eq.1)goto 100

i2454i7=i7
m2454m21=n21

do m2454=m2453+1,nqul

i7=i2454i7
n21=m2454m21

print*,'loop2454'
call write_symm_xmi_1(i7,n21,m2454,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3154
if (sf2.eq.1)goto 100

i2455i7=i7
m2455m21=n21

do m2455=m2454+1,nqul

i7=i2455i7
n21=m2455m21

print*,'loop2455'
call write_symm_xmi_1(i7,n21,m2455,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3155
if (sf2.eq.1)goto 100

i2456i7=i7
m2456m21=n21

do m2456=m2455+1,nqul

i7=i2456i7
n21=m2456m21

print*,'loop2456'
call write_symm_xmi_1(i7,n21,m2456,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3156
if (sf2.eq.1)goto 100

i2457i7=i7
m2457m21=n21

do m2457=m2456+1,nqul

i7=i2457i7
n21=m2457m21

print*,'loop2457'
call write_symm_xmi_1(i7,n21,m2457,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3157
if (sf2.eq.1)goto 100

i2458i7=i7
m2458m21=n21

do m2458=m2457+1,nqul

i7=i2458i7
n21=m2458m21

print*,'loop2458'
call write_symm_xmi_1(i7,n21,m2458,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3158
if (sf2.eq.1)goto 100

i2459i7=i7
m2459m21=n21

do m2459=m2458+1,nqul

i7=i2459i7
n21=m2459m21

print*,'loop2459'
call write_symm_xmi_1(i7,n21,m2459,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3159
if (sf2.eq.1)goto 100

i2460i7=i7
m2460m21=n21

do m2460=m2459+1,nqul

i7=i2460i7
n21=m2460m21

print*,'loop2460'
call write_symm_xmi_1(i7,n21,m2460,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3160
if (sf2.eq.1)goto 100

i2461i7=i7
m2461m21=n21

do m2461=m2460+1,nqul

i7=i2461i7
n21=m2461m21

print*,'loop2461'
call write_symm_xmi_1(i7,n21,m2461,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3161
if (sf2.eq.1)goto 100

i2462i7=i7
m2462m21=n21

do m2462=m2461+1,nqul

i7=i2462i7
n21=m2462m21

print*,'loop2462'
call write_symm_xmi_1(i7,n21,m2462,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3162
if (sf2.eq.1)goto 100

i2463i7=i7
m2463m21=n21

do m2463=m2462+1,nqul

i7=i2463i7
n21=m2463m21

print*,'loop2463'
call write_symm_xmi_1(i7,n21,m2463,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3163
if (sf2.eq.1)goto 100

i2464i7=i7
m2464m21=n21

do m2464=m2463+1,nqul

i7=i2464i7
n21=m2464m21

print*,'loop2464'
call write_symm_xmi_1(i7,n21,m2464,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3164
if (sf2.eq.1)goto 100

i2465i7=i7
m2465m21=n21

do m2465=m2464+1,nqul

i7=i2465i7
n21=m2465m21

print*,'loop2465'
call write_symm_xmi_1(i7,n21,m2465,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3165
if (sf2.eq.1)goto 100

i2466i7=i7
m2466m21=n21

do m2466=m2465+1,nqul

i7=i2466i7
n21=m2466m21

print*,'loop2466'
call write_symm_xmi_1(i7,n21,m2466,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3166
if (sf2.eq.1)goto 100

i2467i7=i7
m2467m21=n21

do m2467=m2466+1,nqul

i7=i2467i7
n21=m2467m21

print*,'loop2467'
call write_symm_xmi_1(i7,n21,m2467,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3167
if (sf2.eq.1)goto 100

i2468i7=i7
m2468m21=n21

do m2468=m2467+1,nqul

i7=i2468i7
n21=m2468m21

print*,'loop2468'
call write_symm_xmi_1(i7,n21,m2468,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3168
if (sf2.eq.1)goto 100

i2469i7=i7
m2469m21=n21

do m2469=m2468+1,nqul

i7=i2469i7
n21=m2469m21

print*,'loop2469'
call write_symm_xmi_1(i7,n21,m2469,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3169
if (sf2.eq.1)goto 100

i2470i7=i7
m2470m21=n21

do m2470=m2469+1,nqul

i7=i2470i7
n21=m2470m21

print*,'loop2470'
call write_symm_xmi_1(i7,n21,m2470,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3170
if (sf2.eq.1)goto 100

i2471i7=i7
m2471m21=n21

do m2471=m2470+1,nqul

i7=i2471i7
n21=m2471m21

print*,'loop2471'
call write_symm_xmi_1(i7,n21,m2471,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3171
if (sf2.eq.1)goto 100

i2472i7=i7
m2472m21=n21

do m2472=m2471+1,nqul

i7=i2472i7
n21=m2472m21

print*,'loop2472'
call write_symm_xmi_1(i7,n21,m2472,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3172
if (sf2.eq.1)goto 100

i2473i7=i7
m2473m21=n21

do m2473=m2472+1,nqul

i7=i2473i7
n21=m2473m21

print*,'loop2473'
call write_symm_xmi_1(i7,n21,m2473,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3173
if (sf2.eq.1)goto 100

i2474i7=i7
m2474m21=n21

do m2474=m2473+1,nqul

i7=i2474i7
n21=m2474m21

print*,'loop2474'
call write_symm_xmi_1(i7,n21,m2474,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3174
if (sf2.eq.1)goto 100

i2475i7=i7
m2475m21=n21

do m2475=m2474+1,nqul

i7=i2475i7
n21=m2475m21

print*,'loop2475'
call write_symm_xmi_1(i7,n21,m2475,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3175
if (sf2.eq.1)goto 100

i2476i7=i7
m2476m21=n21

do m2476=m2475+1,nqul

i7=i2476i7
n21=m2476m21

print*,'loop2476'
call write_symm_xmi_1(i7,n21,m2476,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3176
if (sf2.eq.1)goto 100

i2477i7=i7
m2477m21=n21

do m2477=m2476+1,nqul

i7=i2477i7
n21=m2477m21

print*,'loop2477'
call write_symm_xmi_1(i7,n21,m2477,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3177
if (sf2.eq.1)goto 100

i2478i7=i7
m2478m21=n21

do m2478=m2477+1,nqul

i7=i2478i7
n21=m2478m21

print*,'loop2478'
call write_symm_xmi_1(i7,n21,m2478,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3178
if (sf2.eq.1)goto 100

i2479i7=i7
m2479m21=n21

do m2479=m2478+1,nqul

i7=i2479i7
n21=m2479m21

print*,'loop2479'
call write_symm_xmi_1(i7,n21,m2479,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3179
if (sf2.eq.1)goto 100

i2480i7=i7
m2480m21=n21

do m2480=m2479+1,nqul

i7=i2480i7
n21=m2480m21

print*,'loop2480'
call write_symm_xmi_1(i7,n21,m2480,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3180
if (sf2.eq.1)goto 100

i2481i7=i7
m2481m21=n21

do m2481=m2480+1,nqul

i7=i2481i7
n21=m2481m21

print*,'loop2481'
call write_symm_xmi_1(i7,n21,m2481,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3181
if (sf2.eq.1)goto 100

i2482i7=i7
m2482m21=n21

do m2482=m2481+1,nqul

i7=i2482i7
n21=m2482m21

print*,'loop2482'
call write_symm_xmi_1(i7,n21,m2482,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3182
if (sf2.eq.1)goto 100

i2483i7=i7
m2483m21=n21

do m2483=m2482+1,nqul

i7=i2483i7
n21=m2483m21

print*,'loop2483'
call write_symm_xmi_1(i7,n21,m2483,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3183
if (sf2.eq.1)goto 100

i2484i7=i7
m2484m21=n21

do m2484=m2483+1,nqul

i7=i2484i7
n21=m2484m21

print*,'loop2484'
call write_symm_xmi_1(i7,n21,m2484,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3184
if (sf2.eq.1)goto 100

i2485i7=i7
m2485m21=n21

do m2485=m2484+1,nqul

i7=i2485i7
n21=m2485m21

print*,'loop2485'
call write_symm_xmi_1(i7,n21,m2485,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3185
if (sf2.eq.1)goto 100

i2486i7=i7
m2486m21=n21

do m2486=m2485+1,nqul

i7=i2486i7
n21=m2486m21

print*,'loop2486'
call write_symm_xmi_1(i7,n21,m2486,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3186
if (sf2.eq.1)goto 100

i2487i7=i7
m2487m21=n21

do m2487=m2486+1,nqul

i7=i2487i7
n21=m2487m21

print*,'loop2487'
call write_symm_xmi_1(i7,n21,m2487,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3187
if (sf2.eq.1)goto 100

i2488i7=i7
m2488m21=n21

do m2488=m2487+1,nqul

i7=i2488i7
n21=m2488m21

print*,'loop2488'
call write_symm_xmi_1(i7,n21,m2488,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3188
if (sf2.eq.1)goto 100

i2489i7=i7
m2489m21=n21

do m2489=m2488+1,nqul

i7=i2489i7
n21=m2489m21

print*,'loop2489'
call write_symm_xmi_1(i7,n21,m2489,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3189
if (sf2.eq.1)goto 100

i2490i7=i7
m2490m21=n21

do m2490=m2489+1,nqul

i7=i2490i7
n21=m2490m21

print*,'loop2490'
call write_symm_xmi_1(i7,n21,m2490,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3190
if (sf2.eq.1)goto 100

i2491i7=i7
m2491m21=n21

do m2491=m2490+1,nqul

i7=i2491i7
n21=m2491m21

print*,'loop2491'
call write_symm_xmi_1(i7,n21,m2491,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3191
if (sf2.eq.1)goto 100

i2492i7=i7
m2492m21=n21

do m2492=m2491+1,nqul

i7=i2492i7
n21=m2492m21

print*,'loop2492'
call write_symm_xmi_1(i7,n21,m2492,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3192
if (sf2.eq.1)goto 100

i2493i7=i7
m2493m21=n21

do m2493=m2492+1,nqul

i7=i2493i7
n21=m2493m21

print*,'loop2493'
call write_symm_xmi_1(i7,n21,m2493,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3193
if (sf2.eq.1)goto 100

i2494i7=i7
m2494m21=n21

do m2494=m2493+1,nqul

i7=i2494i7
n21=m2494m21

print*,'loop2494'
call write_symm_xmi_1(i7,n21,m2494,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3194
if (sf2.eq.1)goto 100

i2495i7=i7
m2495m21=n21

do m2495=m2494+1,nqul

i7=i2495i7
n21=m2495m21

print*,'loop2495'
call write_symm_xmi_1(i7,n21,m2495,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3195
if (sf2.eq.1)goto 100

i2496i7=i7
m2496m21=n21

do m2496=m2495+1,nqul

i7=i2496i7
n21=m2496m21

print*,'loop2496'
call write_symm_xmi_1(i7,n21,m2496,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3196
if (sf2.eq.1)goto 100

i2497i7=i7
m2497m21=n21

do m2497=m2496+1,nqul

i7=i2497i7
n21=m2497m21

print*,'loop2497'
call write_symm_xmi_1(i7,n21,m2497,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3197
if (sf2.eq.1)goto 100

i2498i7=i7
m2498m21=n21

do m2498=m2497+1,nqul

i7=i2498i7
n21=m2498m21

print*,'loop2498'
call write_symm_xmi_1(i7,n21,m2498,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3198
if (sf2.eq.1)goto 100

i2499i7=i7
m2499m21=n21

do m2499=m2498+1,nqul

i7=i2499i7
n21=m2499m21

print*,'loop2499'
call write_symm_xmi_1(i7,n21,m2499,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3199
if (sf2.eq.1)goto 100

i2500i7=i7
m2500m21=n21

do m2500=m2499+1,nqul

i7=i2500i7
n21=m2500m21

print*,'loop2500'
call write_symm_xmi_1(i7,n21,m2500,sf1,sf2,str3,q_fac2)
if (sf1.eq.1)goto 3200
if (sf2.eq.1)goto 100

i2500i7=i7
m2500m21=n21

3200 enddo

3199 enddo

3198 enddo

3197 enddo

3196 enddo

3195 enddo

3194 enddo

3193 enddo

3192 enddo

3191 enddo

3190 enddo

3189 enddo

3188 enddo

3187 enddo

3186 enddo

3185 enddo

3184 enddo

3183 enddo

3182 enddo

3181 enddo

3180 enddo

3179 enddo

3178 enddo

3177 enddo

3176 enddo

3175 enddo

3174 enddo

3173 enddo

3172 enddo

3171 enddo

3170 enddo

3169 enddo

3168 enddo

3167 enddo

3166 enddo

3165 enddo

3164 enddo

3163 enddo

3162 enddo

3161 enddo

3160 enddo

3159 enddo

3158 enddo

3157 enddo

3156 enddo

3155 enddo

3154 enddo

3153 enddo

3152 enddo

3151 enddo

3150 enddo

3149 enddo

3148 enddo

3147 enddo

3146 enddo

3145 enddo

3144 enddo

3143 enddo

3142 enddo

3141 enddo

3140 enddo

3139 enddo

3138 enddo

3137 enddo

3136 enddo

3135 enddo

3134 enddo

3133 enddo

3132 enddo

3131 enddo

3130 enddo

3129 enddo

3128 enddo

3127 enddo

3126 enddo

3125 enddo

3124 enddo

3123 enddo

3122 enddo

3121 enddo

3120 enddo

3119 enddo

3118 enddo

3117 enddo

3116 enddo

3115 enddo

3114 enddo

3113 enddo

3112 enddo

3111 enddo

3110 enddo

3109 enddo

3108 enddo

3107 enddo

3106 enddo

3105 enddo

3104 enddo

3103 enddo

3102 enddo

3101 enddo

3100 enddo

3099 enddo

3098 enddo

3097 enddo

3096 enddo

3095 enddo

3094 enddo

3093 enddo

3092 enddo

3091 enddo

3090 enddo

3089 enddo

3088 enddo

3087 enddo

3086 enddo

3085 enddo

3084 enddo

3083 enddo

3082 enddo

3081 enddo

3080 enddo

3079 enddo

3078 enddo

3077 enddo

3076 enddo

3075 enddo

3074 enddo

3073 enddo

3072 enddo

3071 enddo

3070 enddo

3069 enddo

3068 enddo

3067 enddo

3066 enddo

3065 enddo

3064 enddo

3063 enddo

3062 enddo

3061 enddo

3060 enddo

3059 enddo

3058 enddo

3057 enddo

3056 enddo

3055 enddo

3054 enddo

3053 enddo

3052 enddo

3051 enddo

3050 enddo

3049 enddo

3048 enddo

3047 enddo

3046 enddo

3045 enddo

3044 enddo

3043 enddo

3042 enddo

3041 enddo

3040 enddo

3039 enddo

3038 enddo

3037 enddo

3036 enddo

3035 enddo

3034 enddo

3033 enddo

3032 enddo

3031 enddo

3030 enddo

3029 enddo

3028 enddo

3027 enddo

3026 enddo

3025 enddo

3024 enddo

3023 enddo

3022 enddo

3021 enddo

3020 enddo

3019 enddo

3018 enddo

3017 enddo

3016 enddo

3015 enddo

3014 enddo

3013 enddo

3012 enddo

3011 enddo

3010 enddo

3009 enddo

3008 enddo

3007 enddo

3006 enddo

3005 enddo

3004 enddo

3003 enddo

3002 enddo

3001 enddo

3000 enddo

2999 enddo

2998 enddo

2997 enddo

2996 enddo

2995 enddo

2994 enddo

2993 enddo

2992 enddo

2991 enddo

2990 enddo

2989 enddo

2988 enddo

2987 enddo

2986 enddo

2985 enddo

2984 enddo

2983 enddo

2982 enddo

2981 enddo

2980 enddo

2979 enddo

2978 enddo

2977 enddo

2976 enddo

2975 enddo

2974 enddo

2973 enddo

2972 enddo

2971 enddo

2970 enddo

2969 enddo

2968 enddo

2967 enddo

2966 enddo

2965 enddo

2964 enddo

2963 enddo

2962 enddo

2961 enddo

2960 enddo

2959 enddo

2958 enddo

2957 enddo

2956 enddo

2955 enddo

2954 enddo

2953 enddo

2952 enddo

2951 enddo

2950 enddo

2949 enddo

2948 enddo

2947 enddo

2946 enddo

2945 enddo

2944 enddo

2943 enddo

2942 enddo

2941 enddo

2940 enddo

2939 enddo

2938 enddo

2937 enddo

2936 enddo

2935 enddo

2934 enddo

2933 enddo

2932 enddo

2931 enddo

2930 enddo

2929 enddo

2928 enddo

2927 enddo

2926 enddo

2925 enddo

2924 enddo

2923 enddo

2922 enddo

2921 enddo

2920 enddo

2919 enddo

2918 enddo

2917 enddo

2916 enddo

2915 enddo

2914 enddo

2913 enddo

2912 enddo

2911 enddo

2910 enddo

2909 enddo

2908 enddo

2907 enddo

2906 enddo

2905 enddo

2904 enddo

2903 enddo

2902 enddo

2901 enddo

2900 enddo

2899 enddo

2898 enddo

2897 enddo

2896 enddo

2895 enddo

2894 enddo

2893 enddo

2892 enddo

2891 enddo

2890 enddo

2889 enddo

2888 enddo

2887 enddo

2886 enddo

2885 enddo

2884 enddo

2883 enddo

2882 enddo

2881 enddo

2880 enddo

2879 enddo

2878 enddo

2877 enddo

2876 enddo

2875 enddo

2874 enddo

2873 enddo

2872 enddo

2871 enddo

2870 enddo

2869 enddo

2868 enddo

2867 enddo

2866 enddo

2865 enddo

2864 enddo

2863 enddo

2862 enddo

2861 enddo

2860 enddo

2859 enddo

2858 enddo

2857 enddo

2856 enddo

2855 enddo

2854 enddo

2853 enddo

2852 enddo

2851 enddo

2850 enddo

2849 enddo

2848 enddo

2847 enddo

2846 enddo

2845 enddo

2844 enddo

2843 enddo

2842 enddo

2841 enddo

2840 enddo

2839 enddo

2838 enddo

2837 enddo

2836 enddo

2835 enddo

2834 enddo

2833 enddo

2832 enddo

2831 enddo

2830 enddo

2829 enddo

2828 enddo

2827 enddo

2826 enddo

2825 enddo

2824 enddo

2823 enddo

2822 enddo

2821 enddo

2820 enddo

2819 enddo

2818 enddo

2817 enddo

2816 enddo

2815 enddo

2814 enddo

2813 enddo

2812 enddo

2811 enddo

2810 enddo

2809 enddo

2808 enddo

2807 enddo

2806 enddo

2805 enddo

2804 enddo

2803 enddo

2802 enddo

2801 enddo

2800 enddo

2799 enddo

2798 enddo

2797 enddo

2796 enddo

2795 enddo

2794 enddo

2793 enddo

2792 enddo

2791 enddo

2790 enddo

2789 enddo

2788 enddo

2787 enddo

2786 enddo

2785 enddo

2784 enddo

2783 enddo

2782 enddo

2781 enddo

2780 enddo

2779 enddo

2778 enddo

2777 enddo

2776 enddo

2775 enddo

2774 enddo

2773 enddo

2772 enddo

2771 enddo

2770 enddo

2769 enddo

2768 enddo

2767 enddo

2766 enddo

2765 enddo

2764 enddo

2763 enddo

2762 enddo

2761 enddo

2760 enddo

2759 enddo

2758 enddo

2757 enddo

2756 enddo

2755 enddo

2754 enddo

2753 enddo

2752 enddo

2751 enddo

2750 enddo

2749 enddo

2748 enddo

2747 enddo

2746 enddo

2745 enddo

2744 enddo

2743 enddo

2742 enddo

2741 enddo

2740 enddo

2739 enddo

2738 enddo

2737 enddo

2736 enddo

2735 enddo

2734 enddo

2733 enddo

2732 enddo

2731 enddo

2730 enddo

2729 enddo

2728 enddo

2727 enddo

2726 enddo

2725 enddo

2724 enddo

2723 enddo

2722 enddo

2721 enddo

2720 enddo

2719 enddo

2718 enddo

2717 enddo

2716 enddo

2715 enddo

2714 enddo

2713 enddo

2712 enddo

2711 enddo

2710 enddo

2709 enddo

2708 enddo

2707 enddo

2706 enddo

2705 enddo

2704 enddo

2703 enddo

2702 enddo

2701 enddo

2700 enddo

2699 enddo

2698 enddo

2697 enddo

2696 enddo

2695 enddo

2694 enddo

2693 enddo

2692 enddo

2691 enddo

2690 enddo

2689 enddo

2688 enddo

2687 enddo

2686 enddo

2685 enddo

2684 enddo

2683 enddo

2682 enddo

2681 enddo

2680 enddo

2679 enddo

2678 enddo

2677 enddo

2676 enddo

2675 enddo

2674 enddo

2673 enddo

2672 enddo

2671 enddo

2670 enddo

2669 enddo

2668 enddo

2667 enddo

2666 enddo

2665 enddo

2664 enddo

2663 enddo

2662 enddo

2661 enddo

2660 enddo

2659 enddo

2658 enddo

2657 enddo

2656 enddo

2655 enddo

2654 enddo

2653 enddo

2652 enddo

2651 enddo

2650 enddo

2649 enddo

2648 enddo

2647 enddo

2646 enddo

2645 enddo

2644 enddo

2643 enddo

2642 enddo

2641 enddo

2640 enddo

2639 enddo

2638 enddo

2637 enddo

2636 enddo

2635 enddo

2634 enddo

2633 enddo

2632 enddo

2631 enddo

2630 enddo

2629 enddo

2628 enddo

2627 enddo

2626 enddo

2625 enddo

2624 enddo

2623 enddo

2622 enddo

2621 enddo

2620 enddo

2619 enddo

2618 enddo

2617 enddo

2616 enddo

2615 enddo

2614 enddo

2613 enddo

2612 enddo

2611 enddo

2610 enddo

2609 enddo

2608 enddo

2607 enddo

2606 enddo

2605 enddo

2604 enddo

2603 enddo

2602 enddo

2601 enddo

2600 enddo

2599 enddo

2598 enddo

2597 enddo

2596 enddo

2595 enddo

2594 enddo

2593 enddo

2592 enddo

2591 enddo

2590 enddo

2589 enddo

2588 enddo

2587 enddo

2586 enddo

2585 enddo

2584 enddo

2583 enddo

2582 enddo

2581 enddo

2580 enddo

2579 enddo

2578 enddo

2577 enddo

2576 enddo

2575 enddo

2574 enddo

2573 enddo

2572 enddo

2571 enddo

2570 enddo

2569 enddo

2568 enddo

2567 enddo

2566 enddo

2565 enddo

2564 enddo

2563 enddo

2562 enddo

2561 enddo

2560 enddo

2559 enddo

2558 enddo

2557 enddo

2556 enddo

2555 enddo

2554 enddo

2553 enddo

2552 enddo

2551 enddo

2550 enddo

2549 enddo

2548 enddo

2547 enddo

2546 enddo

2545 enddo

2544 enddo

2543 enddo

2542 enddo

2541 enddo

2540 enddo

2539 enddo

2538 enddo

2537 enddo

2536 enddo

2535 enddo

2534 enddo

2533 enddo

2532 enddo

2531 enddo

2530 enddo

2529 enddo

2528 enddo

2527 enddo

2526 enddo

2525 enddo

2524 enddo

2523 enddo

2522 enddo

2521 enddo

2520 enddo

2519 enddo

2518 enddo

2517 enddo

2516 enddo

2515 enddo

2514 enddo

2513 enddo

2512 enddo

2511 enddo

2510 enddo

2509 enddo

2508 enddo

2507 enddo

2506 enddo

2505 enddo

2504 enddo

2503 enddo

2502 enddo

2501 enddo

2500 enddo

2499 enddo

2498 enddo

2497 enddo

2496 enddo

2495 enddo

2494 enddo

2493 enddo

2492 enddo

2491 enddo

2490 enddo

2489 enddo

2488 enddo

2487 enddo

2486 enddo

2485 enddo

2484 enddo

2483 enddo

2482 enddo

2481 enddo

2480 enddo

2479 enddo

2478 enddo

2477 enddo

2476 enddo

2475 enddo

2474 enddo

2473 enddo

2472 enddo

2471 enddo

2470 enddo

2469 enddo

2468 enddo

2467 enddo

2466 enddo

2465 enddo

2464 enddo

2463 enddo

2462 enddo

2461 enddo

2460 enddo

2459 enddo

2458 enddo

2457 enddo

2456 enddo

2455 enddo

2454 enddo

2453 enddo

2452 enddo

2451 enddo

2450 enddo

2449 enddo

2448 enddo

2447 enddo

2446 enddo

2445 enddo

2444 enddo

2443 enddo

2442 enddo

2441 enddo

2440 enddo

2439 enddo

2438 enddo

2437 enddo

2436 enddo

2435 enddo

2434 enddo

2433 enddo

2432 enddo

2431 enddo

2430 enddo

2429 enddo

2428 enddo

2427 enddo

2426 enddo

2425 enddo

2424 enddo

2423 enddo

2422 enddo

2421 enddo

2420 enddo

2419 enddo

2418 enddo

2417 enddo

2416 enddo

2415 enddo

2414 enddo

2413 enddo

2412 enddo

2411 enddo

2410 enddo

2409 enddo

2408 enddo

2407 enddo

2406 enddo

2405 enddo

2404 enddo

2403 enddo

2402 enddo

2401 enddo

2400 enddo

2399 enddo

2398 enddo

2397 enddo

2396 enddo

2395 enddo

2394 enddo

2393 enddo

2392 enddo

2391 enddo

2390 enddo

2389 enddo

2388 enddo

2387 enddo

2386 enddo

2385 enddo

2384 enddo

2383 enddo

2382 enddo

2381 enddo

2380 enddo

2379 enddo

2378 enddo

2377 enddo

2376 enddo

2375 enddo

2374 enddo

2373 enddo

2372 enddo

2371 enddo

2370 enddo

2369 enddo

2368 enddo

2367 enddo

2366 enddo

2365 enddo

2364 enddo

2363 enddo

2362 enddo

2361 enddo

2360 enddo

2359 enddo

2358 enddo

2357 enddo

2356 enddo

2355 enddo

2354 enddo

2353 enddo

2352 enddo

2351 enddo

2350 enddo

2349 enddo

2348 enddo

2347 enddo

2346 enddo

2345 enddo

2344 enddo

2343 enddo

2342 enddo

2341 enddo

2340 enddo

2339 enddo

2338 enddo

2337 enddo

2336 enddo

2335 enddo

2334 enddo

2333 enddo

2332 enddo

2331 enddo

2330 enddo

2329 enddo

2328 enddo

2327 enddo

2326 enddo

2325 enddo

2324 enddo

2323 enddo

2322 enddo

2321 enddo

2320 enddo

2319 enddo

2318 enddo

2317 enddo

2316 enddo

2315 enddo

2314 enddo

2313 enddo

2312 enddo

2311 enddo

2310 enddo

2309 enddo

2308 enddo

2307 enddo

2306 enddo

2305 enddo

2304 enddo

2303 enddo

2302 enddo

2301 enddo

2300 enddo

2299 enddo

2298 enddo

2297 enddo

2296 enddo

2295 enddo

2294 enddo

2293 enddo

2292 enddo

2291 enddo

2290 enddo

2289 enddo

2288 enddo

2287 enddo

2286 enddo

2285 enddo

2284 enddo

2283 enddo

2282 enddo

2281 enddo

2280 enddo

2279 enddo

2278 enddo

2277 enddo

2276 enddo

2275 enddo

2274 enddo

2273 enddo

2272 enddo

2271 enddo

2270 enddo

2269 enddo

2268 enddo

2267 enddo

2266 enddo

2265 enddo

2264 enddo

2263 enddo

2262 enddo

2261 enddo

2260 enddo

2259 enddo

2258 enddo

2257 enddo

2256 enddo

2255 enddo

2254 enddo

2253 enddo

2252 enddo

2251 enddo

2250 enddo

2249 enddo

2248 enddo

2247 enddo

2246 enddo

2245 enddo

2244 enddo

2243 enddo

2242 enddo

2241 enddo

2240 enddo

2239 enddo

2238 enddo

2237 enddo

2236 enddo

2235 enddo

2234 enddo

2233 enddo

2232 enddo

2231 enddo

2230 enddo

2229 enddo

2228 enddo

2227 enddo

2226 enddo

2225 enddo

2224 enddo

2223 enddo

2222 enddo

2221 enddo

2220 enddo

2219 enddo

2218 enddo

2217 enddo

2216 enddo

2215 enddo

2214 enddo

2213 enddo

2212 enddo

2211 enddo

2210 enddo

2209 enddo

2208 enddo

2207 enddo

2206 enddo

2205 enddo

2204 enddo

2203 enddo

2202 enddo

2201 enddo

2200 enddo

2199 enddo

2198 enddo

2197 enddo

2196 enddo

2195 enddo

2194 enddo

2193 enddo

2192 enddo

2191 enddo

2190 enddo

2189 enddo

2188 enddo

2187 enddo

2186 enddo

2185 enddo

2184 enddo

2183 enddo

2182 enddo

2181 enddo

2180 enddo

2179 enddo

2178 enddo

2177 enddo

2176 enddo

2175 enddo

2174 enddo

2173 enddo

2172 enddo

2171 enddo

2170 enddo

2169 enddo

2168 enddo

2167 enddo

2166 enddo

2165 enddo

2164 enddo

2163 enddo

2162 enddo

2161 enddo

2160 enddo

2159 enddo

2158 enddo

2157 enddo

2156 enddo

2155 enddo

2154 enddo

2153 enddo

2152 enddo

2151 enddo

2150 enddo

2149 enddo

2148 enddo

2147 enddo

2146 enddo

2145 enddo

2144 enddo

2143 enddo

2142 enddo

2141 enddo

2140 enddo

2139 enddo

2138 enddo

2137 enddo

2136 enddo

2135 enddo

2134 enddo

2133 enddo

2132 enddo

2131 enddo

2130 enddo

2129 enddo

2128 enddo

2127 enddo

2126 enddo

2125 enddo

2124 enddo

2123 enddo

2122 enddo

2121 enddo

2120 enddo

2119 enddo

2118 enddo

2117 enddo

2116 enddo

2115 enddo

2114 enddo

2113 enddo

2112 enddo

2111 enddo

2110 enddo

2109 enddo

2108 enddo

2107 enddo

2106 enddo

2105 enddo

2104 enddo

2103 enddo

2102 enddo

2101 enddo

2100 enddo

2099 enddo

2098 enddo

2097 enddo

2096 enddo

2095 enddo

2094 enddo

2093 enddo

2092 enddo

2091 enddo

2090 enddo

2089 enddo

2088 enddo

2087 enddo

2086 enddo

2085 enddo

2084 enddo

2083 enddo

2082 enddo

2081 enddo

2080 enddo

2079 enddo

2078 enddo

2077 enddo

2076 enddo

2075 enddo

2074 enddo

2073 enddo

2072 enddo

2071 enddo

2070 enddo

2069 enddo

2068 enddo

2067 enddo

2066 enddo

2065 enddo

2064 enddo

2063 enddo

2062 enddo

2061 enddo

2060 enddo

2059 enddo

2058 enddo

2057 enddo

2056 enddo

2055 enddo

2054 enddo

2053 enddo

2052 enddo

2051 enddo

2050 enddo

2049 enddo

2048 enddo

2047 enddo

2046 enddo

2045 enddo

2044 enddo

2043 enddo

2042 enddo

2041 enddo

2040 enddo

2039 enddo

2038 enddo

2037 enddo

2036 enddo

2035 enddo

2034 enddo

2033 enddo

2032 enddo

2031 enddo

2030 enddo

2029 enddo

2028 enddo

2027 enddo

2026 enddo

2025 enddo

2024 enddo

2023 enddo

2022 enddo

2021 enddo

2020 enddo

2019 enddo

2018 enddo

2017 enddo

2016 enddo

2015 enddo

2014 enddo

2013 enddo

2012 enddo

2011 enddo

2010 enddo

2009 enddo

2008 enddo

2007 enddo

2006 enddo

2005 enddo

2004 enddo

2003 enddo

2002 enddo

2001 enddo

2000 enddo

1999 enddo

1998 enddo

1997 enddo

1996 enddo

1995 enddo

1994 enddo

1993 enddo

1992 enddo

1991 enddo

1990 enddo

1989 enddo

1988 enddo

1987 enddo

1986 enddo

1985 enddo

1984 enddo

1983 enddo

1982 enddo

1981 enddo

1980 enddo

1979 enddo

1978 enddo

1977 enddo

1976 enddo

1975 enddo

1974 enddo

1973 enddo

1972 enddo

1971 enddo

1970 enddo

1969 enddo

1968 enddo

1967 enddo

1966 enddo

1965 enddo

1964 enddo

1963 enddo

1962 enddo

1961 enddo

1960 enddo

1959 enddo

1958 enddo

1957 enddo

1956 enddo

1955 enddo

1954 enddo

1953 enddo

1952 enddo

1951 enddo

1950 enddo

1949 enddo

1948 enddo

1947 enddo

1946 enddo

1945 enddo

1944 enddo

1943 enddo

1942 enddo

1941 enddo

1940 enddo

1939 enddo

1938 enddo

1937 enddo

1936 enddo

1935 enddo

1934 enddo

1933 enddo

1932 enddo

1931 enddo

1930 enddo

1929 enddo

1928 enddo

1927 enddo

1926 enddo

1925 enddo

1924 enddo

1923 enddo

1922 enddo

1921 enddo

1920 enddo

1919 enddo

1918 enddo

1917 enddo

1916 enddo

1915 enddo

1914 enddo

1913 enddo

1912 enddo

1911 enddo

1910 enddo

1909 enddo

1908 enddo

1907 enddo

1906 enddo

1905 enddo

1904 enddo

1903 enddo

1902 enddo

1901 enddo

1900 enddo

1899 enddo

1898 enddo

1897 enddo

1896 enddo

1895 enddo

1894 enddo

1893 enddo

1892 enddo

1891 enddo

1890 enddo

1889 enddo

1888 enddo

1887 enddo

1886 enddo

1885 enddo

1884 enddo

1883 enddo

1882 enddo

1881 enddo

1880 enddo

1879 enddo

1878 enddo

1877 enddo

1876 enddo

1875 enddo

1874 enddo

1873 enddo

1872 enddo

1871 enddo

1870 enddo

1869 enddo

1868 enddo

1867 enddo

1866 enddo

1865 enddo

1864 enddo

1863 enddo

1862 enddo

1861 enddo

1860 enddo

1859 enddo

1858 enddo

1857 enddo

1856 enddo

1855 enddo

1854 enddo

1853 enddo

1852 enddo

1851 enddo

1850 enddo

1849 enddo

1848 enddo

1847 enddo

1846 enddo

1845 enddo

1844 enddo

1843 enddo

1842 enddo

1841 enddo

1840 enddo

1839 enddo

1838 enddo

1837 enddo

1836 enddo

1835 enddo

1834 enddo

1833 enddo

1832 enddo

1831 enddo

1830 enddo

1829 enddo

1828 enddo

1827 enddo

1826 enddo

1825 enddo

1824 enddo

1823 enddo

1822 enddo

1821 enddo

1820 enddo

1819 enddo

1818 enddo

1817 enddo

1816 enddo

1815 enddo

1814 enddo

1813 enddo

1812 enddo

1811 enddo

1810 enddo

1809 enddo

1808 enddo

1807 enddo

1806 enddo

1805 enddo

1804 enddo

1803 enddo

1802 enddo

1801 enddo

1800 enddo

1799 enddo

1798 enddo

1797 enddo

1796 enddo

1795 enddo

1794 enddo

1793 enddo

1792 enddo

1791 enddo

1790 enddo

1789 enddo

1788 enddo

1787 enddo

1786 enddo

1785 enddo

1784 enddo

1783 enddo

1782 enddo

1781 enddo

1780 enddo

1779 enddo

1778 enddo

1777 enddo

1776 enddo

1775 enddo

1774 enddo

1773 enddo

1772 enddo

1771 enddo

1770 enddo

1769 enddo

1768 enddo

1767 enddo

1766 enddo

1765 enddo

1764 enddo

1763 enddo

1762 enddo

1761 enddo

1760 enddo

1759 enddo

1758 enddo

1757 enddo

1756 enddo

1755 enddo

1754 enddo

1753 enddo

1752 enddo

1751 enddo

1750 enddo

1749 enddo

1748 enddo

1747 enddo

1746 enddo

1745 enddo

1744 enddo

1743 enddo

1742 enddo

1741 enddo

1740 enddo

1739 enddo

1738 enddo

1737 enddo

1736 enddo

1735 enddo

1734 enddo

1733 enddo

1732 enddo

1731 enddo

1730 enddo

1729 enddo

1728 enddo

1727 enddo

1726 enddo

1725 enddo

1724 enddo

1723 enddo

1722 enddo

1721 enddo

1720 enddo

1719 enddo

1718 enddo

1717 enddo

1716 enddo

1715 enddo

1714 enddo

1713 enddo

1712 enddo

1711 enddo

1710 enddo

1709 enddo

1708 enddo

1707 enddo

1706 enddo

1705 enddo

1704 enddo

1703 enddo

1702 enddo

1701 enddo

1700 enddo

1699 enddo

1698 enddo

1697 enddo

1696 enddo

1695 enddo

1694 enddo

1693 enddo

1692 enddo

1691 enddo

1690 enddo

1689 enddo

1688 enddo

1687 enddo

1686 enddo

1685 enddo

1684 enddo

1683 enddo

1682 enddo

1681 enddo

1680 enddo

1679 enddo

1678 enddo

1677 enddo

1676 enddo

1675 enddo

1674 enddo

1673 enddo

1672 enddo

1671 enddo

1670 enddo

1669 enddo

1668 enddo

1667 enddo

1666 enddo

1665 enddo

1664 enddo

1663 enddo

1662 enddo

1661 enddo

1660 enddo

1659 enddo

1658 enddo

1657 enddo

1656 enddo

1655 enddo

1654 enddo

1653 enddo

1652 enddo

1651 enddo

1650 enddo

1649 enddo

1648 enddo

1647 enddo

1646 enddo

1645 enddo

1644 enddo

1643 enddo

1642 enddo

1641 enddo

1640 enddo

1639 enddo

1638 enddo

1637 enddo

1636 enddo

1635 enddo

1634 enddo

1633 enddo

1632 enddo

1631 enddo

1630 enddo

1629 enddo

1628 enddo

1627 enddo

1626 enddo

1625 enddo

1624 enddo

1623 enddo

1622 enddo

1621 enddo

1620 enddo

1619 enddo

1618 enddo

1617 enddo

1616 enddo

1615 enddo

1614 enddo

1613 enddo

1612 enddo

1611 enddo

1610 enddo

1609 enddo

1608 enddo

1607 enddo

1606 enddo

1605 enddo

1604 enddo

1603 enddo

1602 enddo

1601 enddo

1600 enddo

1599 enddo

1598 enddo

1597 enddo

1596 enddo

1595 enddo

1594 enddo

1593 enddo

1592 enddo

1591 enddo

1590 enddo

1589 enddo

1588 enddo

1587 enddo

1586 enddo

1585 enddo

1584 enddo

1583 enddo

1582 enddo

1581 enddo

1580 enddo

1579 enddo

1578 enddo

1577 enddo

1576 enddo

1575 enddo

1574 enddo

1573 enddo

1572 enddo

1571 enddo

1570 enddo

1569 enddo

1568 enddo

1567 enddo

1566 enddo

1565 enddo

1564 enddo

1563 enddo

1562 enddo

1561 enddo

1560 enddo

1559 enddo

1558 enddo

1557 enddo

1556 enddo

1555 enddo

1554 enddo

1553 enddo

1552 enddo

1551 enddo

1550 enddo

1549 enddo

1548 enddo

1547 enddo

1546 enddo

1545 enddo

1544 enddo

1543 enddo

1542 enddo

1541 enddo

1540 enddo

1539 enddo

1538 enddo

1537 enddo

1536 enddo

1535 enddo

1534 enddo

1533 enddo

1532 enddo

1531 enddo

1530 enddo

1529 enddo

1528 enddo

1527 enddo

1526 enddo

1525 enddo

1524 enddo

1523 enddo

1522 enddo

1521 enddo

1520 enddo

1519 enddo

1518 enddo

1517 enddo

1516 enddo

1515 enddo

1514 enddo

1513 enddo

1512 enddo

1511 enddo

1510 enddo

1509 enddo

1508 enddo

1507 enddo

1506 enddo

1505 enddo

1504 enddo

1503 enddo

1502 enddo

1501 enddo

1500 enddo

1499 enddo

1498 enddo

1497 enddo

1496 enddo

1495 enddo

1494 enddo

1493 enddo

1492 enddo

1491 enddo

1490 enddo

1489 enddo

1488 enddo

1487 enddo

1486 enddo

1485 enddo

1484 enddo

1483 enddo

1482 enddo

1481 enddo

1480 enddo

1479 enddo

1478 enddo

1477 enddo

1476 enddo

1475 enddo

1474 enddo

1473 enddo

1472 enddo

1471 enddo

1470 enddo

1469 enddo

1468 enddo

1467 enddo

1466 enddo

1465 enddo

1464 enddo

1463 enddo

1462 enddo

1461 enddo

1460 enddo

1459 enddo

1458 enddo

1457 enddo

1456 enddo

1455 enddo

1454 enddo

1453 enddo

1452 enddo

1451 enddo

1450 enddo

1449 enddo

1448 enddo

1447 enddo

1446 enddo

1445 enddo

1444 enddo

1443 enddo

1442 enddo

1441 enddo

1440 enddo

1439 enddo

1438 enddo

1437 enddo

1436 enddo

1435 enddo

1434 enddo

1433 enddo

1432 enddo

1431 enddo

1430 enddo

1429 enddo

1428 enddo

1427 enddo

1426 enddo

1425 enddo

1424 enddo

1423 enddo

1422 enddo

1421 enddo

1420 enddo

1419 enddo

1418 enddo

1417 enddo

1416 enddo

1415 enddo

1414 enddo

1413 enddo

1412 enddo

1411 enddo

1410 enddo

1409 enddo

1408 enddo

1407 enddo

1406 enddo

1405 enddo

1404 enddo

1403 enddo

1402 enddo

1401 enddo

1400 enddo

1399 enddo

1398 enddo

1397 enddo

1396 enddo

1395 enddo

1394 enddo

1393 enddo

1392 enddo

1391 enddo

1390 enddo

1389 enddo

1388 enddo

1387 enddo

1386 enddo

1385 enddo

1384 enddo

1383 enddo

1382 enddo

1381 enddo

1380 enddo

1379 enddo

1378 enddo

1377 enddo

1376 enddo

1375 enddo

1374 enddo

1373 enddo

1372 enddo

1371 enddo

1370 enddo

1369 enddo

1368 enddo

1367 enddo

1366 enddo

1365 enddo

1364 enddo

1363 enddo

1362 enddo

1361 enddo

1360 enddo

1359 enddo

1358 enddo

1357 enddo

1356 enddo

1355 enddo

1354 enddo

1353 enddo

1352 enddo

1351 enddo

1350 enddo

1349 enddo

1348 enddo

1347 enddo

1346 enddo

1345 enddo

1344 enddo

1343 enddo

1342 enddo

1341 enddo

1340 enddo

1339 enddo

1338 enddo

1337 enddo

1336 enddo

1335 enddo

1334 enddo

1333 enddo

1332 enddo

1331 enddo

1330 enddo

1329 enddo

1328 enddo

1327 enddo

1326 enddo

1325 enddo

1324 enddo

1323 enddo

1322 enddo

1321 enddo

1320 enddo

1319 enddo

1318 enddo

1317 enddo

1316 enddo

1315 enddo

1314 enddo

1313 enddo

1312 enddo

1311 enddo

1310 enddo

1309 enddo

1308 enddo

1307 enddo

1306 enddo

1305 enddo

1304 enddo

1303 enddo

1302 enddo

1301 enddo

1300 enddo

1299 enddo

1298 enddo

1297 enddo

1296 enddo

1295 enddo

1294 enddo

1293 enddo

1292 enddo

1291 enddo

1290 enddo

1289 enddo

1288 enddo

1287 enddo

1286 enddo

1285 enddo

1284 enddo

1283 enddo

1282 enddo

1281 enddo

1280 enddo

1279 enddo

1278 enddo

1277 enddo

1276 enddo

1275 enddo

1274 enddo

1273 enddo

1272 enddo

1271 enddo

1270 enddo

1269 enddo

1268 enddo

1267 enddo

1266 enddo

1265 enddo

1264 enddo

1263 enddo

1262 enddo

1261 enddo

1260 enddo

1259 enddo

1258 enddo

1257 enddo

1256 enddo

1255 enddo

1254 enddo

1253 enddo

1252 enddo

1251 enddo

1250 enddo

1249 enddo

1248 enddo

1247 enddo

1246 enddo

1245 enddo

1244 enddo

1243 enddo

1242 enddo

1241 enddo

1240 enddo

1239 enddo

1238 enddo

1237 enddo

1236 enddo

1235 enddo

1234 enddo

1233 enddo

1232 enddo

1231 enddo

1230 enddo

1229 enddo

1228 enddo

1227 enddo

1226 enddo

1225 enddo

1224 enddo

1223 enddo

1222 enddo

1221 enddo

1220 enddo

1219 enddo

1218 enddo

1217 enddo

1216 enddo

1215 enddo

1214 enddo

1213 enddo

1212 enddo

1211 enddo

1210 enddo

1209 enddo

1208 enddo

1207 enddo

1206 enddo

1205 enddo

1204 enddo

1203 enddo

1202 enddo

1201 enddo

1200 enddo

1199 enddo

1198 enddo

1197 enddo

1196 enddo

1195 enddo

1194 enddo

1193 enddo

1192 enddo

1191 enddo

1190 enddo

1189 enddo

1188 enddo

1187 enddo

1186 enddo

1185 enddo

1184 enddo

1183 enddo

1182 enddo

1181 enddo

1180 enddo

1179 enddo

1178 enddo

1177 enddo

1176 enddo

1175 enddo

1174 enddo

1173 enddo

1172 enddo

1171 enddo

1170 enddo

1169 enddo

1168 enddo

1167 enddo

1166 enddo

1165 enddo

1164 enddo

1163 enddo

1162 enddo

1161 enddo

1160 enddo

1159 enddo

1158 enddo

1157 enddo

1156 enddo

1155 enddo

1154 enddo

1153 enddo

1152 enddo

1151 enddo

1150 enddo

1149 enddo

1148 enddo

1147 enddo

1146 enddo

1145 enddo

1144 enddo

1143 enddo

1142 enddo

1141 enddo

1140 enddo

1139 enddo

1138 enddo

1137 enddo

1136 enddo

1135 enddo

1134 enddo

1133 enddo

1132 enddo

1131 enddo

1130 enddo

1129 enddo

1128 enddo

1127 enddo

1126 enddo

1125 enddo

1124 enddo

1123 enddo

1122 enddo

1121 enddo

1120 enddo

1119 enddo

1118 enddo

1117 enddo

1116 enddo

1115 enddo

1114 enddo

1113 enddo

1112 enddo

1111 enddo

1110 enddo

1109 enddo

1108 enddo

1107 enddo

1106 enddo

1105 enddo

1104 enddo

1103 enddo

1102 enddo

1101 enddo

1100 enddo

1099 enddo

1098 enddo

1097 enddo

1096 enddo

1095 enddo

1094 enddo

1093 enddo

1092 enddo

1091 enddo

1090 enddo

1089 enddo

1088 enddo

1087 enddo

1086 enddo

1085 enddo

1084 enddo

1083 enddo

1082 enddo

1081 enddo

1080 enddo

1079 enddo

1078 enddo

1077 enddo

1076 enddo

1075 enddo

1074 enddo

1073 enddo

1072 enddo

1071 enddo

1070 enddo

1069 enddo

1068 enddo

1067 enddo

1066 enddo

1065 enddo

1064 enddo

1063 enddo

1062 enddo

1061 enddo

1060 enddo

1059 enddo

1058 enddo

1057 enddo

1056 enddo

1055 enddo

1054 enddo

1053 enddo

1052 enddo

1051 enddo

1050 enddo

1049 enddo

1048 enddo

1047 enddo

1046 enddo

1045 enddo

1044 enddo

1043 enddo

1042 enddo

1041 enddo

1040 enddo

1039 enddo

1038 enddo

1037 enddo

1036 enddo

1035 enddo

1034 enddo

1033 enddo

1032 enddo

1031 enddo

1030 enddo

1029 enddo

1028 enddo

1027 enddo

1026 enddo

1025 enddo

1024 enddo

1023 enddo

1022 enddo

1021 enddo

1020 enddo

1019 enddo

1018 enddo

1017 enddo

1016 enddo

1015 enddo

1014 enddo

1013 enddo

1012 enddo

1011 enddo

1010 enddo

1009 enddo

1008 enddo

1007 enddo

1006 enddo

1005 enddo

1004 enddo

1003 enddo

1002 enddo

1001 enddo

1000 enddo

999 enddo

998 enddo

997 enddo

996 enddo

995 enddo

994 enddo

993 enddo

992 enddo

991 enddo

990 enddo

989 enddo

988 enddo

987 enddo

986 enddo

985 enddo

984 enddo

983 enddo

982 enddo

981 enddo

980 enddo

979 enddo

978 enddo

977 enddo

976 enddo

975 enddo

974 enddo

973 enddo

972 enddo

971 enddo

970 enddo

969 enddo

968 enddo

967 enddo

966 enddo

965 enddo

964 enddo

963 enddo

962 enddo

961 enddo

960 enddo

959 enddo

958 enddo

957 enddo

956 enddo

955 enddo

954 enddo

953 enddo

952 enddo

951 enddo

950 enddo

949 enddo

948 enddo

947 enddo

946 enddo

945 enddo

944 enddo

943 enddo

942 enddo

941 enddo

940 enddo

939 enddo

938 enddo

937 enddo

936 enddo

935 enddo

934 enddo

933 enddo

932 enddo

931 enddo

930 enddo

929 enddo

928 enddo

927 enddo

926 enddo

925 enddo

924 enddo

923 enddo

922 enddo

921 enddo

920 enddo

919 enddo

918 enddo

917 enddo

916 enddo

915 enddo

914 enddo

913 enddo

912 enddo

911 enddo

910 enddo

909 enddo

908 enddo

907 enddo

906 enddo

905 enddo

904 enddo

903 enddo

902 enddo

901 enddo

900 enddo

899 enddo

898 enddo

897 enddo

896 enddo

895 enddo

894 enddo

893 enddo

892 enddo

891 enddo

890 enddo

889 enddo

888 enddo

887 enddo

886 enddo

885 enddo

884 enddo

883 enddo

882 enddo

881 enddo

880 enddo

879 enddo

878 enddo

877 enddo

876 enddo

875 enddo

874 enddo

873 enddo

872 enddo

871 enddo

870 enddo

869 enddo

868 enddo

867 enddo

866 enddo

865 enddo

864 enddo

863 enddo

862 enddo

861 enddo

860 enddo

859 enddo

858 enddo

857 enddo

856 enddo

855 enddo

854 enddo

853 enddo

852 enddo

851 enddo

850 enddo

849 enddo

848 enddo

847 enddo

846 enddo

845 enddo

844 enddo

843 enddo

842 enddo

841 enddo

840 enddo

839 enddo

838 enddo

837 enddo

836 enddo

835 enddo

834 enddo

833 enddo

832 enddo

831 enddo

830 enddo

829 enddo

828 enddo

827 enddo

826 enddo

825 enddo

824 enddo

823 enddo

822 enddo

821 enddo

820 enddo

819 enddo

818 enddo

817 enddo

816 enddo

815 enddo

814 enddo

813 enddo

812 enddo

811 enddo

810 enddo

809 enddo

808 enddo

807 enddo

806 enddo

805 enddo

804 enddo

803 enddo

802 enddo

801 enddo

800 enddo

799 enddo

798 enddo

797 enddo

796 enddo

795 enddo

794 enddo

793 enddo

792 enddo

791 enddo

790 enddo

789 enddo

788 enddo

787 enddo

786 enddo

785 enddo

784 enddo

783 enddo

782 enddo

781 enddo

780 enddo

779 enddo

778 enddo

777 enddo

776 enddo

775 enddo

774 enddo

773 enddo

772 enddo

771 enddo

770 enddo

769 enddo

768 enddo

767 enddo

766 enddo

765 enddo

764 enddo

763 enddo

762 enddo

761 enddo

760 enddo

759 enddo

758 enddo

757 enddo

756 enddo

755 enddo

754 enddo

753 enddo

752 enddo

751 enddo

750 enddo

749 enddo

748 enddo

747 enddo

746 enddo

745 enddo

744 enddo

743 enddo

742 enddo

741 enddo

740 enddo

739 enddo

738 enddo

737 enddo

736 enddo

735 enddo

734 enddo

733 enddo

732 enddo

731 enddo

730 enddo

729 enddo

728 enddo

727 enddo

726 enddo

725 enddo

724 enddo

723 enddo

722 enddo

721 enddo

720 enddo




719 enddo

718 enddo

717 enddo

716 enddo

715 enddo

714 enddo

713 enddo

712 enddo

711 enddo

710 enddo

709 enddo

708 enddo

707 enddo

706 enddo

705 enddo

704 enddo

703 enddo

702 enddo

701 enddo


close(21)

if(incmplt.eq.1)then
write(10,*)'----------- incomplete set -----------'
do i=1,mincmplt
 qq(i)=q_fac2(mincmplt_set(i))
 qq1(i)=str_quality_1(mincmplt_set(i))
 qq2(i)=str_quality_2(mincmplt_set(i))
 bondq4(i)=bondq(mincmplt_set(i))
    if(niao.eq.0)then
     write(10,9000),qq1(i),bondq4(i),qq2(i),qq(i),'|',(str3(mincmplt_set(i),m20),m20=1,nae)
    endif
    if(niao.gt.1)then
     write(10,9001),qq1(i),bondq4(i),qq2(i),qq(i),'|',1,':',niao,(str3(mincmplt_set(i),m20),m20=1,nae)
    endif
    if(niao.eq.1)then
     write(10,9009),qq1(i),bondq4(i),qq2(i),qq(i),'|',1,1,(str3(mincmplt_set(i),m20),m20=1,nae)
    endif
enddo
endif

9000 format(I3,x,I3,x,I3,x,I3,x,a,x,25I4)
9001 format(I3,x,I3,x,I3,x,I3,x,a,x,I1,a,I3,x,25I4)
9009 format(I3,x,I3,x,I3,x,I3,x,a,x,I3,I3,x,25I4)

open(unit=121,file='script10',status='unknown')
write(121,111)'rm -rf','Rumer_Sets.dat'
close(121)
CALL SYSTEM ("chmod +x script10 ")
CALL SYSTEM ("./script10 ")
CALL SYSTEM ("rm script10 ")
111 format(a,x,a)
100 print*,'end of this calculation'
print*,'exit write_symm_xmi_new,symm',symm
!stop
return
end subroutine write_symm_xmi_new
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
subroutine write_symm_xmi_1(i7,m21,m3,sf1,sf2,str3,q_fac2)
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
use commondat
implicit none

integer::nl,strn,ncqs,tostr,initstr,i,i1,i2,i3,i4,i5,i6,i7,i8,i9,m119,m18,m19,m20,m21,m23,m24,count&
,qul(15000),nqul,j,jj,jjj,fg,flg,ii5,m1,m2,m3,m4,m5,m6,m7,m8,m9,m10,m11,m12,m13,m14,m15,m16,m17,x,y,strs
integer::i5up16,i16i7,m16m21,i5up15,i15i7,m15m21,i5up14,i14i7,m14m21,i5up13,i13i7,m13m21,i5up12,i12i7,m12m21,&
i5up11,i11i7,m11m21,i5up10,i10i7,m10m21,i5up9,i9i7,m9m21,i5up8,i8i7,m8m21,i5up7,i7i7,m7m21,i5up6,i6i7,m6m21,&
i5up5,i5i7,m5m21,i5up4,i4i7,m4m21,i5up3,i3i7,m3m21,i5up2,i2i7,m2m21,i5up1,i1i7,m1m21,i5up17,i17i7,m17m21
integer::str3(15000,20),q_fac2(15000),finalvec(15000),strset(15000),col(15000),sigsym(15000),tnqs_sig,&
ffvec2(15000,1000),bondq(150000),bondq4(15000),nqset(15000),str5(2000,20),nstr7,&
tndet,totstr,Ifail,indpnt,strno(15000),str_quality_1(15000),str_quality_2(15000),ttqlty0,ttqlty&
,tqlty,bqlty,sqlty,hqlty,tnqs,nssym,qulsym(15000),symq(15000),set_number,ttqlty1,det_inv,ttqlty2,ttqlty3
integer::rumer(15000),rumer_rad(15000),quality_fac(15000),rumset,u1,max_set,mns,mm,group_num(15000)
!integer,dimension(:),allocatable::qq1,qq2,qq
integer::qq1(15000),qq2(15000),qq(15000),str2(15000,20),Rid,set_num(15000),sf1,sf2,incmplt,mincmplt,mincmplt_set(15000)
integer::j1,j2,grp(15000)
real*8::ovlp
Double Precision::D(15000)
character(10)::dd,a
character(len=100)::outfile

common/quality/str_quality_1,str_quality_2,bondq,tqlty,bqlty,sqlty,tnqs,nssym,qulsym,symq,&
sigsym,tnqs_sig
common/str/str5,nstr7
common/infosymm/set_number,hqlty,ttqlty0,ttqlty1,ttqlty2,ttqlty3,ncqs,qul,Rid&
,mns,u1,max_set,rumset,nqset,strset,strn,totstr,strno,incmplt,mincmplt,mincmplt_set,group_num

print*,'*****************************'
print*,'enter write_symm_xmi_1', strn
print*,''
print*,''

!do i=i4+1,i5
!do i=i5+1,15000
!finalvec(i)=0
!enddo
!do m19=1,20
!print*,(str2(m19,i8),i8=1,8)
!enddo

!print*,'i7,m21',i7,m21
!stop
do m19=i7+1,2000
strno(m19)=0
 do i8=1,20
 str2(m19,i8)=0
 enddo
enddo

!i7=i3
totstr=i7
!m21=mm

jj=0
sf1=0
sf2=0
flg=0

!print*,'nqset,strn',nqset(m3),strn
if(nqset(m3).gt.strn)then
sf1=1
!print*,'rejected'
write(*,558)'number of structures of this group is =',nqset(m3),'so the group is rejected'
goto 100
endif
558 format(a,x,I2,x,a)

do i=strset(m3-1)+1,strset(m3)
totstr=totstr+1
strno(totstr)=i
!print*,'strno',strno(totstr)
enddo

j=0
do i=1,totstr
if(i.ne.1)then
j1=group_num(strno(i-1))
j2=group_num(strno(i))
if(j1.eq.j2)goto 555
endif
j=j+1
grp(j)=group_num(strno(i))
555 enddo
write(*,556),'groups involved = ',(grp(i),i=1,j)
556 format(a,3x,20I5)
write(*,*)

if(totstr.gt.strn)then
sf1=1
!print*,'rejected'
write(*,557)'includig this group the total number of structures &
becomes',totstr,'which is biggere than',strn,'so group has been rejected'
goto 100
endif
557 format(a,x,I5,x,a,x,I5,x,a)

write(*,559)'grps','str_num','structures'
do i=1,totstr
write(*,191)i,group_num(strno(i)),strno(i),(str3(strno(i),j),j=1,nae)
enddo
191 format(I5,I5,3x,3x,I5,3X,20I5)
559 format(a,5x,a,6x,a)

call mat_ind(nl,totstr,ncqs,strno,Ifail,det_inv)

if(Ifail.eq.0)print*,'structures are INDEPENDENT',strn
if(Ifail.eq.1)print*,'structures are DEPENDENT'

if(Ifail.eq.1) then
sf1=1
goto 100
endif

if(totstr.gt.mincmplt)then
mincmplt=totstr
do i=1,mincmplt
mincmplt_set(i)=strno(i)
enddo
endif

if(totstr.gt.1.and.ovopt.eq.vpt) then
 call MatLDR('str',strno,totstr,D)

 ovlp=1.0
 do i=1,totstr
 ovlp=ovlp*D(i)
 enddo

 if(1.0-ovlp.gt.ovval)then 
 sf1=1
 goto 100
 endif
endif

 m21=m21+nqset(m3)
 if(m21.gt.strn)then
 sf1=1
 goto 100
 endif

 do m19=strset(m3-1)+1,strset(m3)
 if(q_fac2(m19).ne.qul(m3))goto 603
 i7=i7+1
! print*,'new struc',i7,m19,q_fac2(m19),str_quality_1(m19),str_quality_2(m19),bondq(m19)
  do i3=1,nae
  str2(i7,i3)=str3(m19,i3)
  enddo
 col(i7)=m19
 qq(i7)=q_fac2(m19)
 qq1(i7)=str_quality_1(m19)
 qq2(i7)=str_quality_2(m19)
 bondq4(i7)=bondq(m19)
 flg=1
 count=3
 603 enddo
print*,'i7i7i7',i7

 if(i7.eq.strn) then
  ttqlty=0
  tqlty=0
  bqlty=0
  sqlty=0
  do m119=1,i7
   ttqlty=ttqlty+qq(m119)
  enddo
   print*,'ttqlty,ttqlty0',ttqlty,ttqlty0
  if(ttqlty.le.ttqlty0)then
    set_number=set_number+1
    mns=mns+1
    if(nfset.eq.1.and.set_number.eq.1)ttqlty0=ttqlty
    if(nfset.eq.1.and.set_number.gt.1)then
     if(ttqlty.lt.ttqlty0)ttqlty0=ttqlty
!     write(9,*),'ttqlty,ttqlty0',ttqlty,ttqlty0
    endif

print*,'now we get a set here',i7,m21,nfset
   do m19=1,i7
incmplt=0
    if(niao.eq.0)then
     write(9+u1,900),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',(str2(m19,m20),m20=1,nae)
    endif
    if(niao.gt.1)then
     write(9+u1,901),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,':',niao,(str2(m19,m20),m20=1,nae)
    endif
    if(niao.eq.1)then
     write(9+u1,909),qq1(m19),bondq4(m19),qq2(m19),qq(m19),'|',1,1,(str2(m19,m20),m20=1,nae)
    endif
   enddo

   if(ovopt.eq.vpt) then
    call MatLDR('str',col,i7,D)

    ovlp=1.0
    do i=1,i7
     ovlp=ovlp*D(i)
    enddo
    write(9+u1,912)'Overlap of this set of the structures =',1.0-ovlp
   endif

    if(nfset.eq.3)then
    Rumwrite=1
    call Rumer_set_id(str2,i7,nl,Rid,set_num)
    endif

   if(Rid.eq.0)write(9+u1,910)'quality value',ttqlty
   if(Rid.eq.1)write(9+u1,920)'quality value',ttqlty,'Rumer_Set',(set_num(i),i=1,nrs)
   bqlty=0
   write(9+u1,*),'Set_number=',set_number
   write(9+u1,*),'    '
  endif

  if(nfset.eq.0.and.ttqlty.le.ttqlty0)then 
   sf2=1
   sf1=0
print*,'it should enter here',nfset,sf1,sf2,ttqlty,ttqlty0,symm
   goto 100
  endif
! endif

print*,'i am here',mns,max_set,u1,mset,mset-1
 if(mns.eq.max_set)then
  if(u1.eq.mset-1)then
print*,'i am here',mns,max_set,u1,mset,mset-1
   sf2=0
   sf1=1
   goto 100
  endif
  close(9+u1)
  mns=0
  u1=u1+1
  if(u1.le.9)then
   write(a,'(I1)')u1
  endif
  if(u1.gt.9.and.u1.lt.100)then
   write(a,'(I2)')u1
  endif
  if(u1.gt.99.and.u1.lt.1000)then
   write(a,'(I3)')u1
  endif
  if(u1.eq.1000)then
   write(*,*)'Maximum output file has been set to 1000, it seems that you have more&
   sets. Please increase the limit'
   sf2=1
   goto 100
  endif
  outfile='structure_set_'//trim(a)//trim('.dat')
  open(unit=9+u1,file=outfile,status='unknown')
 endif

!sf2=1
goto 100
endif

900 format(I3,x,I3,x,I3,x,I3,x,a,x,25I4)
901 format(I3,x,I3,x,I3,x,I3,x,a,x,I1,a,I3,x,25I4)
909 format(I3,x,I3,x,I3,x,I3,x,a,x,I3,I3,x,25I4)
!910 format(a,x,a,x,a,x,a)
!911 format(15x,I3,7x,I3,7x,I3)
910 format(a,I3)
920 format(a,2x,I5,2x,a,2x,100I5)
911 format(15x,I3,7x,I3,7x,I3)
912 format(a,3x,F10.3)

100 return
end subroutine write_symm_xmi_1







